<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>展示轮廓</title>
    <style>
        body {
            margin: 0;
            padding: 0;
        }

        #mapContainer {
            width: 100vw;
            height: 100vh;
            position: relative;
        }

        #mapLoading {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 999;
            transition: opacity 0.3s;
        }

        .loading-text {
            font-size: 16px;
            color: #333;
            padding: 10px 20px;
            background: white;
            border-radius: 4px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        .wkt-input-container {
            position: absolute;
            top: 20px;
            right: 10px;
            z-index: 1000;
            background: white;
            padding: 12px;
            border-radius: 6px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
            width: min(400px, 90vw);
            box-sizing: border-box;
            transition: all 0.3s;
        }

        .minimize-btn {
            position: absolute;
            top: -5px;
            right: -4px;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #f0f0f0;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            color: #666;
            z-index: 1001;
            transition: background 0.2s;
        }

        .minimize-btn:hover {
            background: #e0e0e0;
        }

        .content-wrapper {
            transition: all 0.3s;
        }

        .wkt-input-container.minimized {
            width: 60px;
            height: 40px;
            padding: 0;
        }

        .wkt-input-container.minimized .content-wrapper {
            display: none;
        }

        .wkt-input-container.minimized .min-icon {
            display: none;
        }

        .wkt-input-container.minimized .restore-icon {
            display: inline;
        }

        #wktTextarea {
            width: 100%;
            height: 120px;
            margin-bottom: 10px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-family: monospace;
            resize: vertical;
            box-sizing: border-box;
        }

        .button-group {
            display: flex;
            gap: 10px;
        }

        /* 页签样式 */
        .tabs-header {
            display: flex;
            gap: 8px;
            margin-bottom: 8px;
        }
        .tab-btn {
            flex: 1;
            padding: 6px 0;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 13px;
            background: #f5f5f5;
            color: #333;
            transition: background 0.2s;
        }
        .tab-btn.active { background: #337AFF; color: #fff; }
        .tab-pane { display: none; }
        .tab-pane.active { display: block; }

        /* Multi → Polygons 分割器样式 */
        .split-section {
            margin-top: 10px;
            padding: 10px;
            background: #fafafa;
            border: 1px solid #eee;
            border-radius: 6px;
        }
        .split-section .title {
            font-size: 13px;
            font-weight: 600;
            color: #333;
            margin-bottom: 6px;
        }
        .split-section .desc {
            font-size: 12px;
            color: #666;
            margin-bottom: 8px;
        }
        #multiInput, #polyOutput {
            width: 100%;
            height: 90px;
            margin-bottom: 8px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-family: monospace;
            resize: vertical;
            box-sizing: border-box;
        }
        .split-actions {
            display: flex;
            gap: 8px;
            margin-bottom: 8px;
        }
        .split-actions button {
            flex: 1;
            padding: 6px 0;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 13px;
            transition: background 0.2s;
        }
        #splitMultiBtn { background: #337AFF; color: #fff; }
        #splitMultiBtn:hover { background: #2860E0; }
        #copyPolysBtn { background: #f5f5f5; color: #333; }
        #copyPolysBtn:hover { background: #e0e0e0; }
        #drawButton,
        #clearButton,
        #drawTrackButton,
        #clearTrackButton {
            width: 50%;
            padding: 8px 0;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.2s;
        }

        #drawButton,
        #drawTrackButton {
            background: #337AFF;
            color: white;
        }

        #drawButton:hover,
        #drawTrackButton:hover {
            background: #2860E0;
        }

        #clearButton,
        #clearTrackButton {
            background: #f5f5f5;
            color: #333;
        }

        #clearButton:hover,
        #clearTrackButton:hover {
            background: #e0e0e0;
        }

        #drawButton:disabled,
        #clearButton:disabled,
        #drawTrackButton:disabled,
        #clearTrackButton:disabled {
            background: #e0e0e0;
            color: #999;
            cursor: not-allowed;
        }

        .tip {
            font-size: 12px;
            color: #666;
            margin-bottom: 8px;
            line-height: 1.4;
        }

        .area-label {
             position: absolute;
             background: rgba(255, 0, 0, 0.85);
             border: 1px solid #000;
             border-radius: 3px;
             padding: 4px 6px;
             font-size: 12px;
             color: #fff;
             font-weight: 600;
             box-shadow: 0 2px 6px rgba(0, 0, 0, 0.25);
             white-space: nowrap;
             z-index: 9999;
             pointer-events: none;
         }
         /* 默认隐藏标签容器下的标签 */
          .labels-hidden .area-label { display: none; }

          /* Batch → Generator 样式 */
          .batch-section { margin-top: 10px; padding: 10px; background: #fafafa; border: 1px solid #eee; border-radius: 6px; }
          .batch-section .title { font-size: 13px; font-weight: 600; color: #333; margin-bottom: 6px; }
          .batch-section .desc { font-size: 12px; color: #666; margin-bottom: 8px; }
          #batchInput, #multiOutput { width: 100%; height: 90px; margin-bottom: 8px; padding: 8px; border: 1px solid #ddd; border-radius: 4px; font-family: monospace; resize: vertical; box-sizing: border-box; }
          .batch-actions { display: flex; gap: 8px; margin-bottom: 8px; }
          .batch-actions button { flex: 1; padding: 6px 0; border: none; border-radius: 4px; cursor: pointer; font-size: 13px; transition: background 0.2s; }
          #generateMultiBtn { background: #337AFF; color: #fff; }
          #generateMultiBtn:hover { background: #2860E0; }
          #copyMultiBtn { background: #f5f5f5; color: #333; }
          #copyMultiBtn:hover { background: #e0e0e0; }
          
          /* 左侧工具条样式 */
          #leftToolbar {
              position: absolute;
              bottom: 20px;
              left: 20px;
              z-index: 1000;
              background: white;
              border-radius: 4px;
              box-shadow: 0 1px 4px rgba(0, 0, 0, 0.15);
              padding: 6px 0;
              display: flex;
              flex-direction: column;
              gap: 2px;
              width: 40px;
          }
          
          .toolbar-btn {
              width: 100%;
              padding: 6px 0;
              border: none;
              background: transparent;
              cursor: pointer;
              font-size: 12px;
              color: #333;
              transition: background 0.2s;
              display: flex;
              flex-direction: column;
              align-items: center;
              justify-content: center;
          }
          
          .toolbar-btn:hover {
              background: #f5f5f5;
          }
          
          .toolbar-btn span {
              font-size: 12px;
              margin-top: 4px;
          }
          
          .toolbar-divider {
            height: 1px;
            background-color: #e0e0e0;
            margin: 2px 4px;
        }
        
        /* 颜色选择器样式 */
        .color-picker-container {
            margin-top: 10px;
            padding: 10px;
            background-color: #f9f9f9;
            border-radius: 4px;
            border: 1px solid #e0e0e0;
        }
        
        .color-picker-title {
            font-size: 13px;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }
        
        .color-picker-row {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }
        
        .color-picker-label {
            font-size: 12px;
            color: #555;
            width: 60px;
            flex-shrink: 0;
        }
        
        .color-picker {
            width: 30px;
            height: 30px;
            border: 1px solid #ccc;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 8px;
            flex-shrink: 0;
        }
        
        .color-input {
            flex: 1;
            padding: 4px 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 12px;
            font-family: monospace;
        }
        
        .opacity-slider-container {
            display: flex;
            align-items: center;
            margin-top: 8px;
        }
        
        .opacity-slider {
            flex: 1;
            margin-right: 8px;
        }
        
        .opacity-value {
            font-size: 12px;
            color: #555;
            width: 40px;
            text-align: right;
        }
    </style>
    <script src="https://api.tianditu.gov.cn/api?v=4.0&tk=9ed3674d01dd7c129ab38e3c38bf651a"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/Turf.js/6.5.0/turf.min.js"></script>
    <script src="https://lib.baomitu.com/terraformer/1.0.12/terraformer.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://unpkg.com/terraformer-wkt-parser@1.2.1/terraformer-wkt-parser.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <!-- 已移除动态备用加载器 ensureTerraformer：改为仅使用静态脚本标签加载 Terraformer 核心库与 WKT 解析器 -->
    <script>
        // 检查Turf.js是否加载成功
        window.addEventListener('load', function () {
            if (typeof turf === 'undefined') {
                console.warn('Turf.js加载失败，已启用备用面积算法');
            } else {
                console.log('Turf.js加载成功');
            }
        });
    </script>
</head>

<body>
<!-- 左侧工具条 -->
<div id="leftToolbar">
    <button class="toolbar-btn" id="measureDistanceBtn" title="测距">
        <span>测距</span>
    </button>
    <div class="toolbar-divider"></div>
    <button class="toolbar-btn" id="measureAreaBtn" title="测面">
        <span>测面</span>
    </button>
    <div class="toolbar-divider"></div>
    <button class="toolbar-btn" id="mapTypeBtn" title="切换地图类型">
        <span>地图</span>
    </button>
</div>

<div id="mapContainer">
    <div id="mapLoading">
        <div class="loading-text">地图正在加载中...</div>
    </div>
</div>

<div class="wkt-input-container">
    <div class="minimize-btn" id="minimizeBtn">
        <span class="min-icon">−</span>
        <span class="restore-icon" style="display:none;">+</span>
    </div>

    <div class="content-wrapper">
        <div class="tabs-header">
            <button class="tab-btn active" id="tabDrawBtn">轮廓</button>
            <button class="tab-btn" id="tabTrackBtn">轨迹</button>
            <button class="tab-btn" id="tabSplitBtn">分割器</button>
            <button class="tab-btn" id="tabBatchBtn">合并器</button>
        </div>
        <div class="tab-pane active" id="tabDraw">
            <div class="tip">请输入WKT字符串（支持POLYGON/MULTIPOLYGON，支持多行输入，每行一个多边形）：</div>
            <textarea id="wktTextarea">MULTIPOLYGON (((124.51631041984515 45.3792847785296, 124.51630669408185 45.3792863853711, 124.5163034832334 45.37928847245449, 124.51630091006297 45.379290959982406, 124.51629907295323 45.37929375284688, 124.5162980421441 45.37929674426576, 124.51629785704769 45.37929981986534, 124.51629852474099 45.37930286205332, 124.51630001969559 45.37930575451486, 124.51630228475368 45.379308386659744, 124.51630523331326 45.37931065785066, 124.51630875263916 45.37931248125098, 124.51631270817371 45.37931378714487, 124.51631694868115 45.37931452560285, 124.51632131203013 45.37931466839074, 124.5163256313923 45.37931421004918, 124.5163297416215 45.37931316810239, 124.51668706906032 45.37919362127217, 124.51668858875716 45.379193061499286, 124.51708661157694 45.379032450993655, 124.51748459989973 45.378866871878344, 124.51785915050395 45.37872016550757, 124.51786047940013 45.378719601567866, 124.51824492326827 45.37854333406415, 124.51869124002874 45.37831668830424, 124.51916442259927 45.37808608664407, 124.51958561053844 45.3778739988574, 124.51994852188508 45.377696527560815, 124.52021477438704 45.37757825338358, 124.52021680482284 45.377577542923696, 124.52021892479401 45.3775769822088, 124.5202211146461 45.377576576241125, 124.5202231637557 45.37757634997779, 124.52022768672967 45.377576233173734, 124.52039873990267 45.3775821494723, 124.52040125398985 45.37758243985759, 124.52040349009643 45.3775828873858, 124.5204081469156 45.37758431383249, 124.52059536554574 45.37765741449366, 124.52059963295427 45.377659677157446, 124.52083236252876 45.377810894903234, 124.52114343265238 45.37800693618196, 124.52154075813239 45.378252519306265, 124.52180540381342 45.37842291985104, 124.52210705489523 45.37861170151691, 124.52237406184875 45.37878027193876, 124.52237500459779 45.3787808347939, 124.52260531020652 45.378910798585494, 124.5230149363878 45.379160025063165, 124.52301645657305 45.3791608717376, 124.52301837602198 45.37916184855257, 124.52302055657276 45.37916282813901, 124.52305789694542 45.37917753370835, 124.52306174765026 45.37917951571337, 124.52307794944358 45.379189518268426, 124.5230801701159 45.37919072441307, 124.5230823302097 45.37919175213436, 124.52308412435535 45.37919252178357, 124.52336528394386 45.37930070768705, 124.52336708698097 45.379301329067246, 124.52337024059514 45.37930229471871, 124.52337463379043 45.37930412526618, 124.52337784975778 45.37930614783649, 124.52338044990816 45.37930857058, 124.5233823360431 45.37931130199859, 124.52338343693 45.37931423893641, 124.5233837109927 45.3793172704768, 124.52338314788037 45.379320282128646, 124.52338176885944 45.379323160154755, 124.52337962601096 45.37932579586082, 124.52337656089665 45.37932828401555, 124.52337364614442 45.379329991987134, 124.52336413264105 45.37933470343051, 124.52336189295187 45.37933597176004, 124.52336109790154 45.379336484661295, 124.5233584000441 45.37933856754255, 124.5233562727793 45.37934095622532, 124.52335599547746 45.37934134019691, 124.52335470841457 45.379343509438115, 124.5233543965994 45.37934416967241, 124.52335393310271 45.379345287459856, 124.52331969119618 45.37944086448336, 124.52331783574522 45.379444025845615, 124.52331545644944 45.37944655000663, 124.52331243079014 45.37944870320548, 124.52330887247749 45.37945040452086, 124.52330491523739 45.379451590015115, 124.52330070778886 45.37945221513554, 124.52329640825445 45.37945225638914, 124.52329217821672 45.37945171222552, 124.52328817664774 45.37945060309536, 124.52328455393149 45.3794489706811, 124.52328118298647 45.379446698936476, 124.52327890675583 45.37944457088018, 124.52326312939222 45.379427033108094, 124.52326097083848 45.37942501301007, 124.52326038498289 45.379424547779266, 124.52325729017764 45.379422515419044, 124.52325584829775 45.379421734398555, 124.5232541403878 45.37942089550019, 124.52291053372424 45.379268374650934, 124.52290858803451 45.37926738590514, 124.52256436353 45.379075294118316, 124.52222659418103 45.37886071126789, 124.5219097571872 45.378648812654035, 124.5216089523481 45.378428748003735, 124.52160707060392 45.378427520792535, 124.52138775274227 45.378300147962, 124.52138544648089 45.3782985615827, 124.5212166990611 45.378167629098265, 124.52121510274391 45.3781665094961, 124.52121366378528 45.3781655972662, 124.5212124349018 45.378164872683314, 124.52089157074245 45.377989074541865, 124.52088984173615 45.3779882165757, 124.520852783067 45.377971618642, 124.5207577482249 45.37792752228931, 124.52071031278368 45.37790210493883, 124.52069398620866 45.377891576497895, 124.52068365344304 45.377883378891646, 124.5206812527661 45.37788173967803, 124.52067844224099 45.37788008920199, 124.52067595868003 45.37787882360215, 124.52061996643131 45.377854226765095, 124.52061600298252 45.377852848728956, 124.52061173215245 45.377852047590096, 124.5206073211116 45.377851854707025, 124.52060294251868 45.37785227762961, 124.5205987677625 45.37785329980368, 124.52059496025292 45.37785488121888, 124.52059166902505 45.37785695997479, 124.5205890229057 45.37785945470394, 124.52058712547037 45.37786226775657, 124.52058605098938 45.37786528902298, 124.52058584152071 45.377868400243486, 124.52058650526358 45.377871479637335, 124.52058801623762 45.37787440666955, 124.52059031529973 45.37787706676891, 124.52059331245904 45.37787935581262, 124.52059358027648 45.37787952352422, 124.5205949234522 45.377880300896784, 124.52068473651276 45.37792828245774, 124.52077328212732 45.37798520462462, 124.52083782911531 45.378023481374335, 124.52084047703576 45.37802483082922, 124.52084136498281 45.3780252169802, 124.52084529863234 45.37802657227795, 124.52084953184055 45.378027360760676, 124.52085054342183 45.378027475972374, 124.52085192821414 45.37802760253204, 124.52085869997585 45.378028070285495, 124.52086083046133 45.37802843579821, 124.52086318567291 45.37802904488902, 124.52086523972947 45.378029770430246, 124.52086939200758 45.37803175680868, 124.52100104460439 45.3781085139421, 124.52100270630696 45.3781097125261, 124.52100417259089 45.378111024346495, 124.52100543254926 45.37811243865178, 124.52100624422988 45.378113610673175, 124.52100884931073 45.37811952034221, 124.5210098343897 45.37812134644397, 124.52100987359205 45.37812140742653, 124.52101199174045 45.37812400971727, 124.52101259747211 45.37812461246689, 124.52101460970975 45.37812634024722, 124.521078891649 45.37817416396119, 124.52107984305202 45.37817483049476, 124.52116528956273 45.37823120017082, 124.52119348235438 45.37824867311686, 124.52119692806171 45.378250427853956, 124.5212007830542 45.378251690776565, 124.52120490771868 45.378252416146495, 124.52120915267564 45.37825257769361, 124.52121691255167 45.37825235142591, 124.5212187652205 45.37825248532723, 124.52122102455948 45.378252818036, 124.52122322282938 45.37825331392306, 124.52122533637029 45.37825396765121, 124.52122717384076 45.378254704569834, 124.52123088647375 45.378256646431474, 124.52125739118281 45.37827319356394, 124.52125992417908 45.37827456045208, 124.5212605672701 45.37827485869051, 124.52126453324236 45.378276319764055, 124.52126883286327 45.37827719439359, 124.52127455885311 45.37827793149733, 124.52127882013868 45.37827885657833, 124.52128253028086 45.3782801912289, 124.52128527388814 45.378281560722726, 124.52134496553249 45.37831624626315, 124.52134801111724 45.37831855750977, 124.52135014802647 45.37832090809868, 124.52135165830848 45.37832348887495, 124.52135253676289 45.378326357688614, 124.52135281181131 45.37833008388783, 124.52135298917013 45.37833140695249, 124.52135311667988 45.378332061617215, 124.52135411321679 45.37833501954421, 124.5213558978786 45.37833778732946, 124.52135840411378 45.37834026175965, 124.52135907432185 45.37834080395785, 124.52136134544297 45.37834239502517, 124.52140400363976 45.378368260702096, 124.52144827041144 45.378393448159976, 124.52151392084502 45.378433622311555, 124.52157431478936 45.37847188838755, 124.52164198811077 45.37851776260398, 124.52170642442222 45.37856755430855, 124.5217711781789 45.37861711803579, 124.52189285285527 45.37870653230578, 124.52189381441815 45.37870719754429, 124.52208796332627 45.378833641457696, 124.52215042060965 45.37887343842327, 124.52215176557428 45.37887423008772, 124.52220747821565 45.37890449002442, 124.5222096769854 45.37890588540719, 124.52226314505536 45.378943767117114, 124.52238120228886 45.379022304388286, 124.52238264812871 45.37902318686954, 124.52245179277665 45.379061866336585, 124.52253935537786 45.37912024141196, 124.52261395548113 45.37916820831456, 124.52261494193839 45.379168806391796, 124.52266222009112 45.37919582248254, 124.52270702629053 45.379222835379544, 124.5227550118447 45.37924927640216, 124.52279728752617 45.379271950353754, 124.52284065739258 45.37929412632133, 124.52288527455963 45.379315927607344, 124.52294790908091 45.379344330750115, 124.5229497451856 45.37934507899498, 124.52296480682101 45.37935056172578, 124.52296695710339 45.37935124566076, 124.52297197357292 45.379352621465756, 124.52297510722727 45.37935368545996, 124.52301420911937 45.37936915804023, 124.52307883394383 45.37939302725445, 124.52316189144861 45.37942527311161, 124.52322651801687 45.3794531451474, 124.5232301950202 45.3794552431011, 124.5232325088665 45.37945701597989, 124.52325481603695 45.37947688100108, 124.5232561877193 45.37947827453953, 124.52326168474562 45.37948450067522, 124.5232630879448 45.37948638590429, 124.52331461834096 45.37956589249304, 124.52331674727277 45.379568489570964, 124.52331953644801 45.379570754980264, 124.523322884632 45.379572606496666, 124.52332667030069 45.37957397691838, 124.52333075605121 45.3795748165052, 124.52333499358897 45.37957509478387, 124.52333922911016 45.379574801654115, 124.52334330888426 45.37957394775523, 124.52334708483362 45.37957256407996, 124.52335041990806 45.379570700849534, 124.52335319305942 45.37956842569096, 124.52335530363469 45.3795658211823, 124.52335667502939 45.37956298185563, 124.52335699267832 45.379562037213994, 124.52335744983962 45.3795601969564, 124.52337044624932 45.379480164951666, 124.52339215592582 45.37940352655068, 124.5233943120314 45.37939945325834, 124.52342410160142 45.3793585564005, 124.52342723198251 45.37935548101654, 124.52342998769967 45.37935355115266, 124.52348743825571 45.37931950921343, 124.5234897734954 45.37931790651293, 124.52349036317504 45.379317438034484, 124.52349293629746 45.37931493704706, 124.52349476687984 45.37931213009123, 124.5234957844366 45.37930912524731, 124.52349594978755 45.37930603821526, 124.52349525656582 45.379302987859546, 124.52349373146389 45.379300091632466, 124.523491433205 45.37929746105162, 124.52349140216201 45.37929743228319, 124.52348907358956 45.37929559310098, 124.52348387983062 45.379292086888306, 124.52348178647732 45.379290838017596, 124.52348063874145 45.379290234464214, 124.52347757850417 45.379288881994995, 124.52347663212696 45.379288535471595, 124.5234749995733 45.3792879955112, 124.52330640364629 45.37923798107889, 124.52330429214331 45.37923724391872, 124.52308649325484 45.379152481511824, 124.5230825249886 45.37915043043119, 124.52291721578628 45.379047287177144, 124.52263411081091 45.37888668741619, 124.52250145843148 45.37880599235729, 124.52223201746591 45.37863634436741, 124.52200563314439 45.37849610012524, 124.52169992156783 45.378301284060555, 124.52138562069943 45.37810172798749, 124.5211079041569 45.37791575078799, 124.52110648046852 45.377914875090205, 124.52081839282852 45.37775227695205, 124.5205238904763 45.37755899882359, 124.52052161771807 45.37755769262018, 124.52052085711405 45.37755731120878, 124.52051748120402 45.37755591496574, 124.52051381130617 45.37755495546373, 124.52051323229443 45.377554843619805, 124.5205100303904 45.37755439932134, 124.5205090711296 45.377554316916374, 124.5205074805478 45.377554220778826, 124.52041915665487 45.3775511175244, 124.5204166396236 45.37755082728249, 124.52041440830834 45.37755038161464, 124.52040975295682 45.377548958892824, 124.52030827979367 45.37750950593705, 124.52030504728185 45.37750847586795, 124.5203045425796 45.37750834798016, 124.52029993194647 45.37750755714653, 124.52029518832163 45.37750747051359, 124.52029052575945 45.37750809199063, 124.5202904091013 45.37750811682395, 124.52028667816685 45.37750917776426, 124.52028512821335 45.37750973771209, 124.5202834271402 45.3775104201717, 124.52021276273624 45.37754173606149, 124.5202107312227 45.37754244786231, 124.52020862216585 45.3775430074359, 124.52020644361816 45.37754341380075, 124.52020440490013 45.377543641871945, 124.52019989463554 45.377543766552996, 124.52015670366241 45.377542389315145, 124.52015301788455 45.37754248660708, 124.52015234935816 45.37754254346077, 124.52014751550007 45.37754334644811, 124.52014737120354 45.37754338275051, 124.52014353521153 45.37754464829882, 124.52014195738565 45.37754530397447, 124.52014020733013 45.37754611134125, 124.51979275575026 45.377723316593176, 124.51943562492531 45.37789938818899, 124.51907469632876 45.37808334165218, 124.51869373386484 45.37826833095839, 124.51831443761472 45.37845897720874, 124.51792946445138 45.37864632549236, 124.51753538803376 45.37880613983892, 124.51714993722022 45.378955932389886, 124.51679025738575 45.37910818244168, 124.51653757114372 45.37920877531712, 124.51631058791612 45.379284721689224, 124.51631041984515 45.3792847785296)), ((124.51345761443017 45.381101114123126, 124.51345436045322 45.381103077368834, 124.51345169801661 45.38110544220608, 124.51344972501145 45.38110812168563, 124.51344851398048 45.381111017289655, 124.51344810945041 45.38111402255398, 124.51344852629492 45.38111702698244, 124.51344974918766 45.38111992010958, 124.51345173316622 45.38112259556224, 124.51345440528445 45.38112495497058, 124.51345766729541 45.38112691158491, 124.51345793639611 45.38112704388462, 124.51346100072604 45.38112830795489, 124.51346189364683 45.381128611942145, 124.51346360720989 45.381129134252795, 124.51349395312332 45.38113734112247, 124.51349699671884 45.381137993274805, 124.51349792893046 45.38113814287933, 124.51350219821737 45.38113852833996, 124.51350649315687 45.3811383296639, 124.51351065431379 45.381137554226314, 124.5135145272193 45.3811362308127, 124.51351796810489 45.381134408550366, 124.51352084923944 45.38113215508455, 124.51352087414186 45.38113213136032, 124.51352322983414 45.381129316918624, 124.5135257217049 45.38112547736557, 124.51352829962192 45.38112235219, 124.51353100163962 45.38112014978373, 124.5135342375849 45.38111833834167, 124.51353789385051 45.38111698027979, 124.51354184327906 45.381116123833884, 124.5135459477178 45.38111579791144, 124.5135501619045 45.38111601935869, 124.51355676033155 45.38111721844416, 124.5135579321494 45.38111740784653, 124.51362004119567 45.38112621403174, 124.51362167858237 45.381126401910954, 124.51362259362965 45.381126482459216, 124.51362578264364 45.38112660107229, 124.51362623318755 45.38112659510046, 124.513630024453 45.38112631561221, 124.51363773513165 45.38112527254012, 124.51363993405599 45.381125167146294, 124.51364230152348 45.381125232070346, 124.51364430121667 45.38112543908664, 124.51365090322665 45.38112679519752, 124.51365265277059 45.38112710118351, 124.51365350000056 45.38112722402013, 124.5136578815641 45.381127546757334, 124.51366226780229 45.38112725726832, 124.5136632994956 45.381127115824974, 124.51366650764206 45.38112649827325, 124.5137141352248 45.381114581964766, 124.51371640106791 45.38111391409192, 124.5137577929081 45.381099782229754, 124.5137621057284 45.38109878355063, 124.51376627335043 45.38109837983541, 124.51377377575601 45.38109852061979, 124.51377810940188 45.381098304124556, 124.5137823016359 45.381097500605485, 124.51378359978442 45.381097153179304, 124.51378533573283 45.38109662838313, 124.51386563886392 45.38106946404296, 124.51386839389045 45.38106835604587, 124.51386914791425 45.38106800053589, 124.51387242768114 45.38106611405152, 124.51387514354329 45.38106382539915, 124.51387719796614 45.38106121677102, 124.51387851716929 45.38105838185065, 124.51387905377662 45.381055422448334, 124.51387878851698 45.38105244484486, 124.51387872479555 45.38105216226016, 124.51387829559918 45.381050706360774, 124.51387649564487 45.38104578140473, 124.51387627918145 45.381044428665646, 124.51387626087376 45.381042787825784, 124.5138764400155 45.381041486147964, 124.513878383325 45.38103596562652, 124.5138788657165 45.38103414074102, 124.5138788979281 45.38103396035878, 124.51387902353365 45.3810309501735, 124.51387900750889 45.38103078032826, 124.51387864499934 45.38102881617811, 124.51387711782175 45.381023288299886, 124.51387703024584 45.38102201833385, 124.51387715054565 45.38102042380632, 124.51387750163829 45.38101884572544, 124.513878079557 45.38101729740734, 124.51387887607555 45.38101580223458, 124.51387988580015 45.38101437107248, 124.51388088007229 45.38101326116891, 124.51388557518614 45.38100934462375, 124.51388695848837 45.381008063118735, 124.51388717841957 45.381007836158865, 124.51388925443595 45.38100517419111, 124.51389056641405 45.381002280811714, 124.5138910655145 45.38099926372944, 124.51389073315772 45.38099623525799, 124.51389069740806 45.380996091767756, 124.51388987113702 45.380993801181155, 124.51388879883157 45.380991551555034, 124.51388777291083 45.380987953543446, 124.51388777340928 45.38098485839404, 124.51388863875357 45.380981825376566, 124.51389033639921 45.380978971458454, 124.51389279873464 45.38097640848803, 124.51389619504396 45.3809740537506, 124.51389935641372 45.380972490211775, 124.51393222605196 45.3809589407539, 124.51393488122261 45.38095765675952, 124.5139355743209 45.380957266965545, 124.5139386914525 45.380955132755, 124.51394116323037 45.38095261360081, 124.51394289610523 45.380949804845514, 124.51394382449303 45.38094681279221, 124.51394391325701 45.38094375068119, 124.5139431590381 45.38094073440429, 124.51394159038107 45.38093787811859, 124.51393937232514 45.38093477560805, 124.51393776830832 45.38093161739044, 124.51393706436406 45.380928542097045, 124.5139370420704 45.38092615079524, 124.51393739225475 45.380923314803844, 124.51393851199826 45.380919771761896, 124.5139402988125 45.3809169370168, 124.51394284622346 45.38091440572213, 124.51394605203687 45.38091227948463, 124.51395013014385 45.38091049317777, 124.51395361731403 45.38090947480083, 124.51397573703964 45.380904370608675, 124.51397829033253 45.3809036561696, 124.51410247410625 45.38086251042661, 124.51410526184554 45.38086140871552, 124.51410594790418 45.38086109009614, 124.51410950931815 45.38085903602775, 124.5141123979097 45.38085651125733, 124.51411561978199 45.380853010434976, 124.51411928707734 45.38085007536713, 124.51412047066142 45.380849373687695, 124.5141242697823 45.3808476168813, 124.51424894951535 45.38080010626667, 124.51431876252695 45.380771457576536, 124.51432096833031 45.380770761478644, 124.51432286988737 45.38077032676891, 124.51433011775619 45.38076944934872, 124.51433214924825 45.38076913416859, 124.51433271962604 45.38076902582993, 124.5143368229108 45.38076793204447, 124.51433780073992 45.38076759065923, 124.51434056086852 45.38076644652936, 124.51437911728377 45.380747720159256, 124.51438068200989 45.3807468864814, 124.51444398034356 45.38070997468392, 124.514447071056 45.380708500795286, 124.51445808859816 45.380704000212475, 124.51446066875604 45.38070276924193, 124.5144615998292 45.38070225481892, 124.51446473825749 45.38070014351, 124.51446520806526 45.3806997593734, 124.51446705734887 45.380698017007816, 124.51446824873327 45.380696715845886, 124.51447110469599 45.38069418602116, 124.51447337656995 45.38069265170497, 124.51450238335369 45.38067554208377, 124.51450468575763 45.380673973008776, 124.51450536852774 45.38067343578501, 124.51450796423792 45.38067093684565, 124.51450981556891 45.38066812815806, 124.51451085088095 45.38066511840811, 124.5145110301115 45.38066202406204, 124.5145110054969 45.38066172386326, 124.51451058874714 45.38065947442476, 124.51451004379526 45.380657598572704, 124.51450961790145 45.38065422878815, 124.5145099919432 45.38065140169632, 124.51451108590771 45.38064866700046, 124.51451286199428 45.380646118028885, 124.51451546619845 45.380643644468286, 124.51451796074286 45.380641901652595, 124.51456529378237 45.38061365591154, 124.5146739654088 45.380559229846924, 124.51467646897518 45.3805577718722, 124.51467712365701 45.38055733039622, 124.51467997229577 45.38055499192573, 124.514682119873 45.38055230715044, 124.51468348408562 45.380549378961035, 124.5146846310024 45.38054575083039, 124.51468617518897 45.38054267578897, 124.51468814652372 45.38054024513025, 124.5146909160459 45.38053792073562, 124.51469348481228 45.38053632339232, 124.51470808155733 45.380528624125546, 124.51471011487914 45.38052775659575, 124.51471220294789 45.380527062199604, 124.51471438264124 45.380526524462695, 124.51471662963866 45.38052614826877, 124.51471891722932 45.3805259390592, 124.51472093625485 45.38052590286113, 124.51472856360465 45.38052646659293, 124.51473324809749 45.38052646478653, 124.51473782906145 45.380525774564944, 124.51474210506048 45.3805244262789, 124.51474404498741 45.380523633037676, 124.51474638404203 45.380522532332854, 124.51485816575138 45.38046243002856, 124.51486150940639 45.380460214290395, 124.51486413994732 45.38045756375294, 124.51486594633681 45.380454590297674, 124.51486685232575 45.38045141943673, 124.51486681967171 45.38044818501486, 124.51486584975318 45.38044502355978, 124.51486398351155 45.380442068519145, 124.51486181802431 45.38043941334892, 124.51486012289453 45.380436749364456, 124.51485930744494 45.38043487012402, 124.51485753933112 45.38042940203872, 124.51485710544603 45.380425825802845, 124.51485760717644 45.380422737263615, 124.51485896744606 45.38041977868642, 124.51486119680328 45.38041698602257, 124.51486561291388 45.38041329118447, 124.51486718431751 45.38041180744439, 124.51486737671623 45.38041160154268, 124.51486944555855 45.38040881700043, 124.51487068825035 45.3804057983227, 124.51487105525818 45.380402665834346, 124.51487103669001 45.38040192286556, 124.51487073587482 45.380399610536166, 124.51486148374468 45.38036051037332, 124.51486104911085 45.380355277130846, 124.5148605532547 45.38035277529448, 124.51485939361959 45.3803491050938, 124.51485890577176 45.38034583016607, 124.51485902379983 45.38034351421645, 124.51486097537651 45.38033063806745, 124.51486107238236 45.38032815925737, 124.5148606738375 45.38032268535934, 124.51486080557397 45.38032101742067, 124.51486121640782 45.38031924656327, 124.51486183212695 45.380317702947515, 124.5148637807391 45.38031449625094, 124.51488559424732 45.38028640010634, 124.51488702819088 45.38028495158973, 124.51488852339966 45.38028375104647, 124.51489224686526 45.38028144685724, 124.51492214179657 45.38026615697568, 124.51492459412486 45.3802647024967, 124.51492481103406 45.380264553855426, 124.51492771757646 45.380262112110636, 124.51492986673871 45.380259307857834, 124.51493117044099 45.3802562560251, 124.51493157525293 45.380253081687194, 124.51493106458409 45.38024991493949, 124.51492965936374 45.38024688556636, 124.51492741718278 45.38024411772198, 124.5149244299336 45.3802417248422, 124.5149208200441 45.3802398049955, 124.51491673546016 45.38023843686383, 124.51491234358197 45.38023767651795, 124.51490782440392 45.38023755511945, 124.51490336313746 45.38023807764365, 124.51490122908618 45.38023848754221, 124.51489670182886 45.38023900623861, 124.51489255025908 45.38023897246683, 124.51488994241586 45.380238684661634, 124.51488447286307 45.38023752667607, 124.51488280127877 45.38023698769673, 124.51488086362146 45.380236187761426, 124.51487904997157 45.38023525427301, 124.51487738075262 45.38023419796922, 124.5148758709223 45.38023302796806, 124.51487453568211 45.38023175668338, 124.51487338782192 45.380230395279575, 124.51487244103042 45.380228961344535, 124.51487170535397 45.38022746865248, 124.51487118519779 45.38022592711641, 124.51487088806229 45.38022435956081, 124.51487081722354 45.380222779411845, 124.51487097262438 45.380221199203326, 124.51487135235773 45.380219640808015, 124.51487195332358 45.38021811696002, 124.51487276877545 45.380216643861445, 124.51487379072441 45.380215236474484, 124.51487501107742 45.38021390616494, 124.51487641295125 45.38021267089683, 124.5148779844197 45.38021154196807, 124.51487956607697 45.38021061389306, 124.51488333433397 45.3802088874237, 124.5149415535622 45.38018686401744, 124.51503822639881 45.380147023024875, 124.51508276129628 45.38013012375489, 124.5150849339364 45.38012918282212, 124.51508559556272 45.38012885822253, 124.5150887623778 45.38012697449499, 124.51510903645413 45.380112441082254, 124.5151133647023 45.38011010260074, 124.51511679135987 45.380108820342876, 124.51512354153078 45.380106781122166, 124.51512630426146 45.38010578094761, 124.51512729522739 45.38010535840142, 124.51513084059107 45.38010348459655, 124.51513379133229 45.38010115445092, 124.51513603132848 45.38009845966444, 124.51513747242743 45.38009550628702, 124.51513805791687 45.38009241054507, 124.51513807257638 45.380092099028005, 124.51513794892752 45.38008984315747, 124.51513765082194 45.38008794741245, 124.51513770122608 45.38008429546726, 124.515138585799 45.38008130566347, 124.51514027738354 45.38007849542819, 124.5151427142788 45.3800759691132, 124.51514606194749 45.380073643438884, 124.5151491743895 45.38007209421848, 124.51517829341127 45.38005997283019, 124.5151802911109 45.38005903574546, 124.51527090015846 45.380011392059984, 124.51536824910839 45.37996583350665, 124.51556418272637 45.37989001950284, 124.51566119764927 45.37984993643114, 124.51567161681334 45.37984676895672, 124.51567354560527 45.379846103363064, 124.51578172604684 45.379804113652966, 124.51578433654866 45.37980292658718, 124.51578932025245 45.37980029728724, 124.51579193057434 45.37979912274996, 124.51581577526674 45.37978995890698, 124.51590297377807 45.37975334620718, 124.51596950302631 45.37972850209366, 124.51621725087821 45.379629935333575, 124.51630164862367 45.37959938001683, 124.5163031323428 45.379598791443314, 124.51637471076009 45.379567808256134, 124.51637658252932 45.37956690262283, 124.51639252452891 45.37955831769345, 124.5163947883723 45.37955735329743, 124.51639673225678 45.37955672769153, 124.51640591867215 45.37955490640967, 124.51641062558029 45.379553549442456, 124.51641477503163 45.379551477390294, 124.5164183055601 45.37954924838517, 124.51642316380726 45.37954672064885, 124.51643221968824 45.379542954544576, 124.5164347824694 45.379541711474374, 124.51643570700375 45.379541192623115, 124.51643883615579 45.37953905328144, 124.516441316114 45.3795365263606, 124.51644169769382 45.37953604261246, 124.5164424655563 45.37953497559106, 124.51644557798707 45.37953020983378, 124.51644666432509 45.379529044210074, 124.51644983612961 45.37952647807366, 124.51645271512757 45.37952466945792, 124.51646349472591 45.37951873019454, 124.51646657398798 45.379517339074674, 124.51647290147274 45.379514992375036, 124.51647774581491 45.37951367689469, 124.51653652810958 45.37950208309659, 124.51654129862457 45.379501457321645, 124.51654388072366 45.3795010050308, 124.51654526167906 45.379500700562424, 124.51654861556888 45.37949974479627, 124.51654956668081 45.37949940824571, 124.51655115247306 45.379498789104424, 124.51665560158784 45.379454005171645, 124.5167755749658 45.37939931140959, 124.51677830062539 45.37939784828377, 124.51678051309811 45.3793964593349, 124.51678203637208 45.37939540692703, 124.51679142743197 45.3793882678937, 124.51679663930442 45.37938536695506, 124.51689604647784 45.37934269220878, 124.51698066269303 45.37930791349888, 124.51698206720015 45.37930728570978, 124.51705762570748 45.37927066347579, 124.51714748573995 45.37923507012945, 124.51731575530586 45.37916205672504, 124.51752060478884 45.379079861571434, 124.51765904404984 45.37902130247717, 124.51766117115234 45.37902058057908, 124.51766268057199 45.37902001723493, 124.51780276326195 45.37896279939269, 124.51788991537333 45.37892533588069, 124.51801063540543 45.37887690838904, 124.51801230842338 45.37887616632027, 124.51808833081178 45.378839038691616, 124.51809035451052 45.37883792373001, 124.51809203491298 45.37883688284409, 124.51809334609962 45.37883600172745, 124.5181307006357 45.37880877753941, 124.5181341343245 45.37880678749774, 124.51820592345959 45.3787717547009, 124.51821646077974 45.378767053942795, 124.51830270015397 45.378725959887994, 124.51853517863387 45.37861977604542, 124.51859329510361 45.37859359602958, 124.51862512782733 45.37857800667702, 124.51878667218196 45.37850097092464, 124.5190005074079 45.3784025075013, 124.51910291028778 45.37835135442056, 124.51922143776787 45.37829458172828, 124.51933799515396 45.378235799832595, 124.51945258374734 45.37817518182656, 124.5194908399193 45.37815677046644, 124.51955448232766 45.37813063880929, 124.51955871230369 45.378129406495944, 124.51956653701717 45.37812823102415, 124.51956965453184 45.37812759270667, 124.51957034296099 45.37812741258833, 124.51957362616176 45.37812633269538, 124.51957455329558 45.378125960447534, 124.51957608642358 45.37812528556997, 124.52000638744089 45.377918353490855, 124.52001736385085 45.37791307552031, 124.52001948912762 45.37791191560491, 124.52002194072014 45.377910402839895, 124.52002451274431 45.37790852881135, 124.52006786379627 45.37787119679316, 124.52006949823522 45.377869593909175, 124.52007055544438 45.37786840652782, 124.5200725636621 45.37786554055912, 124.52007370911072 45.37786244779034, 124.5200739445729 45.37785925571152, 124.52007326034244 45.377856095906466, 124.52007168462477 45.377853098628584, 124.52006928237444 45.37785038743153, 124.52006615261678 45.377848074076184, 124.52006242436666 45.37784625392355, 124.52005825130989 45.37784500200387, 124.52005679242563 45.37784468310723, 124.520054934254 45.3778443379195, 124.51998486732488 45.377833569869544, 124.51998134411693 45.37783327162682, 124.51997817105085 45.37783254050128, 124.51996036171741 45.37782980378769, 124.51995675587114 45.377829463377374, 124.5199561769584 45.377829442289986, 124.5199513987149 45.37782963000248, 124.51994678685666 45.37783053070038, 124.51994665506668 45.37783056754581, 124.51994294841762 45.37783189743066, 124.51994145086256 45.37783256520237, 124.51993978598271 45.37783338455817, 124.51992495265701 45.37784141544447, 124.51992184231062 45.37784345912336, 124.51991933783404 45.37784588116753, 124.5199175299859 45.37784859380573, 124.51991648427999 45.377851498735986, 124.51991623861137 45.3778544906879, 124.5199165250914 45.37785600151023, 124.51991459315613 45.37785543071144, 124.51991041683821 45.377854816602536, 124.51990615102879 45.37785477324854, 124.5199019513214 45.37785530223081, 124.5198979708982 45.37785638425495, 124.51989435494339 45.37785797985464, 124.51974833434386 45.37793703409722, 124.5197465529749 45.37793810780413, 124.51968913384103 45.37797657102711, 124.51968702945788 45.377977793417, 124.51958215850401 45.378032571977776, 124.51948771507011 45.378076374044944, 124.51948669282072 45.378076877526134, 124.51926533896271 45.3781925120465, 124.5189557329968 45.37834183922943, 124.51885739560795 45.37838799008294, 124.51875567380915 45.37843335177878, 124.51854387767153 45.37853576933204, 124.51833256852989 45.378633915345645, 124.51800477556232 45.378781371927566, 124.51788832657114 45.3788305697102, 124.51764910686713 45.378927254502976, 124.5174132892127 45.37902508396096, 124.51735480150377 45.37904880387871, 124.5171364423476 45.379143095967024, 124.51702069825538 45.37918884718456, 124.51666489405153 45.37934143842994, 124.5166605181547 45.37934281678624, 124.51664551118226 45.37934639437105, 124.51664206643927 45.379346983824256, 124.51662233242536 45.37934941474229, 124.51661932903761 45.3793499379818, 124.51661846609323 45.37935013389667, 124.51661441892811 45.37935137561967, 124.51661079721923 45.37935315392861, 124.51660774237149 45.37935539939171, 124.51660293153438 45.379359719568136, 124.51659996184075 45.37936165511481, 124.51659732072922 45.37936295242783, 124.51644027712439 45.37942927672393, 124.51643828197217 45.37943022589365, 124.5164337801804 45.37943262617893, 124.51642783658667 45.379434972360045, 124.51639384448012 45.37944471770827, 124.51638900681199 45.37944555338566, 124.51638461990976 45.379445683625946, 124.51638028411234 45.379445202153285, 124.51637616722523 45.37944412762423, 124.51637243044236 45.379442501942734, 124.5163692198178 45.37944038882425, 124.51636666580332 45.379437874347985, 124.51636471175286 45.37943481275698, 124.51636372701776 45.379432179705894, 124.51633870553293 45.379332391244645, 124.51633745198508 45.37932928986881, 124.51633532806548 45.37932643355898, 124.51633242288649 45.37932394215602, 124.51632885833938 45.37932192019062, 124.51632478398022 45.379320452497375, 124.51632037075514 45.37931960065564, 124.51631580382772 45.379319400405734, 124.51631127481023 45.37931986014944, 124.51630697372464 45.379320960597504, 124.51616650231118 45.37936888437228, 124.51616408362267 45.37936984459521, 124.51615912657799 45.379372109462984, 124.51615583559328 45.37937394411317, 124.51615308950568 45.37937618012829, 124.51615098520725 45.37937873861346, 124.5161495969457 45.3793815292958, 124.51614897370412 45.37938445370964, 124.5161491374729 45.379387408670794, 124.51615008247374 45.379390289917204, 124.51615177536372 45.379392995787725, 124.51615415641139 45.37939543080912, 124.51615714160448 45.379397509064724, 124.51616062561433 45.37939915722588, 124.51628868736177 45.3794481238132, 124.51629057711541 45.37944903262687, 124.51629232004565 45.3794500705748, 124.51629390346946 45.37945122849357, 124.51629530836303 45.37945249310897, 124.51629652412528 45.379453854581534, 124.51629753566725 45.379455296059334, 124.51629833087875 45.37945680058764, 124.51629890442383 45.37945835753939, 124.51629924877437 45.37945994670212, 124.5162993605091 45.37946155308407, 124.51629923859245 45.379463156853376, 124.51629888402385 45.37946474334501, 124.51629829966083 45.37946629913369, 124.51629749373062 45.379467803078455, 124.51629647401798 45.379469239408515, 124.5162952497618 45.37947059650281, 124.51629383536253 45.37947185743393, 124.51629224449069 45.37947301021188, 124.51629049516565 45.37947404198452, 124.51628876462719 45.3794748661849, 124.5162847339702 45.37947632551851, 124.51627002855125 45.37948053517822, 124.5161668983798 45.37950612270557, 124.51616499893538 45.37950666417967, 124.51616338883872 45.37950718493272, 124.5161620786244 45.379507645914494, 124.51596195798983 45.37958392958485, 124.51575977095955 45.37965741415606, 124.51575877526085 45.37965779892574, 124.51562523692418 45.37971255838819, 124.51558907342917 45.379725670543884, 124.51504814090073 45.37994324136177, 124.51482409525657 45.380035601305615, 124.51470912366733 45.3800766467053, 124.51459681542708 45.380121363763955, 124.51447623624553 45.380167199539045, 124.51431280594034 45.3802269907187, 124.51418856056759 45.38027207187124, 124.51398626384196 45.38034157089601, 124.5139834304938 45.38034273286429, 124.51398278636682 45.38034304372882, 124.51397930444065 45.3803451222263, 124.51397649445227 45.380347655972336, 124.51397203805034 45.380352653167805, 124.51396947173677 45.38035467379848, 124.5139662266164 45.380356481204906, 124.51396332727712 45.38035766641729, 124.5138787995871 45.38038673648196, 124.51387585784393 45.380387952306236, 124.51387537388659 45.38038818906472, 124.51387192980732 45.380390268964895, 124.51387182589023 45.38039034592371, 124.51386940453722 45.38039248385903, 124.51386856147435 45.380393377715805, 124.51386750309722 45.380394620373835, 124.51386171075934 45.38040219049766, 124.5138608126038 45.38040350712078, 124.51385914526942 45.380406273105365, 124.51385685101278 45.380409232917884, 124.51384675073564 45.38041986537344, 124.51384378870338 45.3804222494917, 124.5138404407332 45.38042413224704, 124.5138377080405 45.38042524844609, 124.51383604055124 45.38042577749246, 124.5138315778027 45.3804268741251, 124.51377252441424 45.38043762754896, 124.51376948055265 45.38043834988085, 124.5137686254756 45.38043860235573, 124.51376483033056 45.38044004046636, 124.51376149756567 45.38044196530725, 124.51375875117809 45.38044430526389, 124.51375669334828 45.38044697327716, 124.51375540063886 45.380449870082444, 124.51375492114585 45.38045288790279, 124.51375491324045 45.38045326141468, 124.51375515035582 45.380455795800984, 124.51375530545097 45.38045653606038, 124.51375562198228 45.380457727418815, 124.51376517045561 45.380487318517446, 124.51376546038398 45.38048917416168, 124.51376544349279 45.380490752772715, 124.51376428295363 45.380495890256036, 124.51376409795334 45.38049693179219, 124.51376402065124 45.38049752756894, 124.5137640424677 45.380500553926176, 124.513764885578 45.3805035214237, 124.51376651882592 45.38050632040092, 124.51376658634274 45.380506410383305, 124.51376796147507 45.38050800623922, 124.51377287379208 45.38051301176083, 124.51377363984858 45.38051413286887, 124.51377519099317 45.380517443226715, 124.51378817426976 45.38055747398586, 124.51379587920128 45.380589797526014, 124.51379664811228 45.380592020010354, 124.51379697623521 45.38059273728114, 124.51379871507527 45.380595558868464, 124.51380119930752 45.38059808829478, 124.51380138472186 45.38059824239792, 124.51380385543435 45.38059999598427, 124.51380635923564 45.380601513797956, 124.51380973291238 45.38060412244852, 124.51381193638488 45.38060666454306, 124.51381341491428 45.380609455010486, 124.51381411684964 45.380612393528565, 124.51381401483671 45.38061537021177, 124.51381311284776 45.380618281683695, 124.5138114448594 45.38062101849729, 124.51380906995387 45.38062348306643, 124.5138058223607 45.38062576307814, 124.51380282048856 45.38062728742496, 124.51375484512705 45.38064771719631, 124.51362994049512 45.38069420398194, 124.51362658680972 45.38069573720225, 124.51362367457578 45.380697667105345, 124.51362129704772 45.38069993189265, 124.51361953035769 45.38070245904208, 124.51361843107807 45.38070516763028, 124.51361632702574 45.38071292009665, 124.51361595009219 45.38071519831736, 124.51361591184599 45.380715822369154, 124.51361604481129 45.38071834571271, 124.51361616936984 45.38071908997612, 124.51361645141083 45.38072034049697, 124.513674681763 45.380925038341665, 124.51367489677445 45.38092678288206, 124.51367483582116 45.380928528715124, 124.51367449903158 45.38093025822401, 124.5136739420315 45.38093181028713, 124.51367211601786 45.38093505179973, 124.51364904678705 45.38096687752486, 124.51364667618024 45.38096933606782, 124.51364387563784 45.380971392771826, 124.51364130138448 45.38097281834803, 124.51354345119978 45.381019587600576, 124.51354089788649 45.381021009878936, 124.51354010839981 45.3810215197185, 124.51353718846457 45.381023814654775, 124.51353678388439 45.381024203321665, 124.51353486063945 45.38102641132952, 124.51353437439774 45.38102708900708, 124.51353362931586 45.38102824009333, 124.51350343469855 45.381080336566605, 124.5135012099506 45.38108307157718, 124.51349866213444 45.38108520682571, 124.51349535815781 45.38108714047746, 124.51349238078413 45.38108841076496, 124.51346094543311 45.381099660378176, 124.5134582256001 45.38110081179635, 124.51345761443017 45.381101114123126), (124.5199720704316 45.37786357553998, 124.51997326978562 45.377863939181005, 124.519975987527 45.377864555079945, 124.51998030931615 45.37786605797976, 124.51998372150183 45.37786789477499, 124.51998656717193 45.37787016039569, 124.51998874134597 45.37787277127529, 124.51999016058407 45.37787562746091, 124.51999077206266 45.377878623216226, 124.51999055355104 45.37788164506908, 124.51998951223122 45.377884581031886, 124.51998768822712 45.377887320468524, 124.51998527832028 45.37788963666262, 124.51998006239594 45.37789289188359, 124.51994742482479 45.377908505301164, 124.51994307381683 45.37791000257736, 124.51993895002805 45.37791077988584, 124.5199346892887 45.37791098552249, 124.51993045025631 45.3779106120097, 124.5199263910267 45.37790967286837, 124.519922664602 45.377908203877695, 124.51991940525363 45.37790625757628, 124.5199167362838 45.377903908217746, 124.5199147557652 45.37790124104276, 124.519913536627 45.37789835598929, 124.51991312518432 45.37789536075831, 124.51991353610012 45.377892364400495, 124.51991475419008 45.37788947915718, 124.51991673418007 45.37788681171185, 124.51991963566958 45.3778842558877, 124.51992296369006 45.37788213037792, 124.51992583696384 45.37787990783125, 124.5199280583035 45.37787734084823, 124.51992954668684 45.37787452305843, 124.51993024782563 45.377871557239544, 124.51993013614646 45.37786855156848, 124.5199301109749 45.377868471278354, 124.51993415169868 45.37786933359873, 124.51993838142437 45.377869642864084, 124.51994261766707 45.377869381634426, 124.51994670691151 45.37786855937632, 124.51995050096944 45.377867205887185, 124.51995541124042 45.37786501739159, 124.51995742245066 45.37786435486407, 124.5199597108751 45.37786380545467, 124.51996207400795 45.37786343421181, 124.51996447867002 45.37786324569615, 124.51996683885856 45.37786324315719, 124.51997090988661 45.37786356658512, 124.5199720704316 45.37786357553998)), ((124.50197558139313 45.37622681699405, 124.50197133145844 45.376226891011044, 124.5019671783861 45.37622753115005, 124.50196327260043 45.376228714225306, 124.50195975556832 45.37623039738591, 124.5019567546768 45.37623251966791, 124.50195437861774 45.376235004202385, 124.50195271345216 45.37623776099968, 124.50195181949209 45.37624069020874, 124.50195172911712 45.37624368573379, 124.50195244560065 45.37624663907706, 124.50195394299173 45.37624944326859, 124.5019561670551 45.37625199674066, 124.5019590372353 45.37625420700661, 124.50196244957458 45.37625599401066, 124.50196628047807 45.37625729302758, 124.50197039119072 45.37625805700699, 124.50197310814065 45.376258370994975, 124.50197757335054 45.376259363019614, 124.50198173083466 45.376260939581016, 124.50202273223027 45.376282140418766, 124.50202633600526 45.376284392044866, 124.50202779197222 45.376285564959375, 124.50202917530906 45.37628695948932, 124.50203033600685 45.37628845148778, 124.50203126038541 45.37629002336982, 124.50203182275531 45.37629137973733, 124.50203321058062 45.37629836159031, 124.50203342385754 45.376299249070776, 124.50205710714135 45.3763831539576, 124.50212469471447 45.376647534863636, 124.50212509043568 45.37664878772001, 124.5021254532351 45.37664974962364, 124.50212633968238 45.376651619424834, 124.50212804471332 45.376654583898464, 124.50212943058371 45.376657931882356, 124.50215508934264 45.37674906422229, 124.50218197514525 45.376842667943244, 124.5022031470049 45.37692500340123, 124.50220338584322 45.3769286036462, 124.50219472742575 45.377053668961274, 124.50219368721136 45.37710969898089, 124.50219375949996 45.37711118378694, 124.5021938256678 45.37711175470249, 124.50219442096434 45.377114298342924, 124.5021945411273 45.37711463643562, 124.50219603398514 45.377117568431025, 124.50219831673847 45.37712023587437, 124.5022013000164 45.37712253433391, 124.50220486702223 45.37712437382376, 124.50220887810582 45.37712568232692, 124.50221317623118 45.37712640861484, 124.5022134624646 45.377126436266806, 124.50221934314978 45.37712645372594, 124.50221950197174 45.377126439342426, 124.50222504836312 45.37712541411255, 124.50223316924928 45.37712309353634, 124.50223502722248 45.37712275818774, 124.50223727977915 45.377122521005845, 124.5022395549379 45.37712244735537, 124.50224182886028 45.37712253800797, 124.50224407772099 45.377122792013864, 124.50224627795707 45.37712320671164, 124.5022484065146 45.3771237777561, 124.5022504410922 45.37712449916429, 124.50225236037123 45.37712536337724, 124.5022541442422 45.377126361339855, 124.50225577401507 45.37712748259655, 124.50225723261215 45.377128715397944, 124.50225850475181 45.37713004682813, 124.50225957710441 45.37713146293631, 124.50226036606291 45.377132824031214, 124.50226157559712 45.37713592410064, 124.50228692629663 45.377232451902906, 124.50230883140559 45.37732502061708, 124.50230914399745 45.3773261498015, 124.50231041754279 45.37732906354144, 124.50231246409318 45.37733174963904, 124.50231520689493 45.377334107354685, 124.50231854308197 45.377336048264496, 124.5023223475335 45.37733749957644, 124.50232647756731 45.377338406860396, 124.50233077829034 45.37733873608954, 124.50233508840775 45.377338474916435, 124.5023392462728 45.37733763313613, 124.50234309594838 45.37733624231882, 124.50234649305624 45.37733435462582, 124.50234931019092 45.37733204085332, 124.50235144169842 45.377329387777166, 124.50235280763887 45.37732649489851, 124.5023533567839 45.37732347071203, 124.50235306853854 45.37732042863695, 124.50234468211947 45.37728463750843, 124.50234453618347 45.37728305678622, 124.5023446148412 45.37728148605707, 124.50234491616476 45.37727992876145, 124.50234543712787 45.377278400539986, 124.50234617249893 45.37727691673924, 124.50234711489311 45.37727549225982, 124.50234825484674 45.3772741414066, 124.50234958091194 45.37727287774525, 124.50235107977261 45.37727171396534, 124.50235249638932 45.377270814184726, 124.5023577618204 45.37726825129417, 124.50235912715642 45.37726753096622, 124.50235983516583 45.377267126812036, 124.50236271344515 45.3772651570459, 124.50236601124061 45.37726245395681, 124.50236964809827 45.377260141086154, 124.50237323416576 45.377258609421055, 124.5023771650768 45.377257580609154, 124.50238130043469 45.37725709139558, 124.5023858473299 45.37725716499607, 124.50238947396494 45.377257631945874, 124.50242317640746 45.3772639391884, 124.50242631426464 45.37726435990005, 124.50242656346931 45.377264380443286, 124.50243084742178 45.377264441990214, 124.50243506923711 45.377263925940525, 124.5024390735794 45.37726285128156, 124.50244271311449 45.37726125755392, 124.50244585393078 45.377259203396584, 124.5024483804664 45.377256764389436, 124.50245019976097 45.37725403027231, 124.50245124487633 45.377251101643274, 124.50245147735896 45.37724808625706, 124.5024508886551 45.37724509506058, 124.50244950042543 45.377242238110654, 124.5024473637481 45.377239620524705, 124.50244455723909 45.37723733861304, 124.50244118415988 45.377235476335386, 124.5024404260375 45.377235135019745, 124.50243895747408 45.37723452810755, 124.50242252921872 45.37722831916407, 124.50241873226659 45.377226381803446, 124.50241590330843 45.37722427817097, 124.5024136736257 45.37722184279933, 124.50241198834802 45.377218932332966, 124.50241115430836 45.37721645333093, 124.50239787306052 45.377156779476465, 124.50237688625883 45.37707584499635, 124.50235192171444 45.376984972483534, 124.50232587102296 45.376887794209196, 124.50229697378693 45.37678515933883, 124.50226987159148 45.37668379627901, 124.50220888400347 45.37646682179943, 124.5021493031368 45.37623644279713, 124.50214890303103 45.37623518846285, 124.50214862432017 45.37623445589331, 124.5021473957745 45.37623203649376, 124.50214720986037 45.37623174727309, 124.50214511582809 45.37622916891591, 124.50214237180523 45.37622691372385, 124.50213907550601 45.37622506200404, 124.50213534431165 45.37622367969612, 124.50213131108961 45.376222816023905, 124.50212711946244 45.37622250174275, 124.50212291869379 45.37622274804413, 124.50211885837254 45.3762235461573, 124.50211041521675 45.37622583012275, 124.5021087081534 45.37622609384605, 124.50210643753181 45.37622627550871, 124.50210415244803 45.37622629206526, 124.50210187700738 45.376226143341114, 124.50209963521367 45.376225830905156, 124.50209745071562 45.376225358053226, 124.50209534655873 45.37622472977377, 124.50209334493869 45.376223952694154, 124.50209146697132 45.3762230350121, 124.50208973246772 45.376221986408424, 124.50208815972474 45.37622081794458, 124.50208676533425 45.37621954194749, 124.50208566494959 45.37621828700066, 124.50208374165769 45.376215359582055, 124.5020672886387 45.376183397141055, 124.50206600307014 45.376181361912444, 124.50206585205453 45.37618116220359, 124.50206331905292 45.37617850460744, 124.5020600755811 45.37617626312043, 124.50205625577102 45.376174530438036, 124.50205201758887 45.376173378214375, 124.5020475363023 45.37617285409901, 124.50204299723241 45.37617297976642, 124.50203858808982 45.37617375001973, 124.50203449121221 45.37617513300553, 124.50203087602358 45.37617707153123, 124.5020278920283 45.376179485430185, 124.50202566262774 45.3761822748769, 124.50202428001775 45.37618532451539, 124.50202380137546 45.37618850822946, 124.50202379776513 45.37618919425242, 124.50202385671228 45.376190397106576, 124.50202631628363 45.37621417981485, 124.50202625809116 45.37621579521982, 124.50202597276925 45.376217372442206, 124.50202546231682 45.3762189211969, 124.50202473198061 45.37622042556451, 124.50202378926816 45.376221870080954, 124.50202264386921 45.37622323989857, 124.50202130755783 45.37622452093653, 124.50201979406935 45.376225700027426, 124.5020181189612 45.37622676505106, 124.50201629945228 45.37622770505989, 124.50201435424546 45.376228510391606, 124.50201230333457 45.37622917276846, 124.5020101678022 45.376229685381475, 124.50200796959926 45.37623004296158, 124.50200573132066 45.376230241833284, 124.50200347597415 45.37623027995229, 124.50200122674273 45.3762301569268, 124.50199942731538 45.37622992761669, 124.50199230993803 45.37622827399434, 124.50198999998759 45.37622783246147, 124.50198860763005 45.37622762202983, 124.50198549964497 45.37622731129552, 124.50197558139313 45.37622681699405)), ((124.50108922363322 45.37541157798413, 124.50108781239993 45.37540875153699, 124.50108566692975 45.37540616472489, 124.50108286493897 45.37540391125095, 124.50107950792528 45.37540207274363, 124.50107571749119 45.37540071579994, 124.50107163093898 45.37539988957295, 124.50106739629753 45.37539962399138, 124.50106316695975 45.37539992867553, 124.50105909612671 45.37540079258869, 124.5010553312576 45.375402184437014, 124.50105200872898 45.37540405380304, 124.501049248894 45.37540633297199, 124.50104715172331 45.375408939384634, 124.50104579318372 45.37541177862783, 124.5010452224863 45.37541474785455, 124.50104546030367 45.37541773950925, 124.50105394035792 45.37545694656163, 124.50105470235653 45.37545927057338, 124.50105482206264 45.37545954050969, 124.5010566052459 45.37546247601501, 124.50105919219145 45.375465097539234, 124.50106247647243 45.37546729723284, 124.50106632297346 45.375468984600445, 124.50107057344967 45.37547009022371, 124.50107505303625 45.37547056861728, 124.501079577443 45.375470400100035, 124.50107959816506 45.37547039782715, 124.50108332123212 45.37546975487105, 124.50108489497259 45.37546937965525, 124.50108661856703 45.37546891189906, 124.50113647318356 45.37545368565308, 124.50113864038109 45.375453196864775, 124.50114084397553 45.37545286836199, 124.5011430833999 45.375452698546276, 124.5011453357093 45.3754526891575, 124.50114757782698 45.37545284029187, 124.50114978678036 45.37545315040089, 124.50115193993715 45.375453616307254, 124.50115401523624 45.37545423323733, 124.50115599141424 45.37545499487005, 124.50115784822403 45.375455893402076, 124.50115956664004 45.3754569196267, 124.50116112905714 45.375458063030315, 124.50116251946552 45.375459311896634, 124.50116372361981 45.3754606534304, 124.50116472918283 45.37546207388706, 124.5011654589249 45.37546343397531, 124.50116654605335 45.3754665198143, 124.50117513920156 45.375504258562465, 124.50123302802294 45.37572383717033, 124.50125997527346 45.37582464079811, 124.50128500790832 45.37592473086661, 124.50133178136774 45.37608798937801, 124.50133217153697 45.376089130240345, 124.50133243035854 45.37608977973538, 124.50133355207747 45.3760919618946, 124.50133422734316 45.37609302372762, 124.50133557770074 45.376094824876056, 124.50136708402889 45.37613097381777, 124.50136808215045 45.37613242763068, 124.50136879569047 45.376133811391014, 124.5013698261026 45.376136908526874, 124.50138020309463 45.37618613865956, 124.50138119011538 45.37618897631307, 124.50138290411707 45.376191636560975, 124.50138528606846 45.37619402778296, 124.50138825393417 45.37619606762409, 124.50139170549933 45.376197685831166, 124.50139552189033 45.376198826672294, 124.50139957166847 45.376199450856284, 124.50140156781173 45.37619962388291, 124.50140431828264 45.376199741608445, 124.50149479178548 45.37619967385955, 124.50149778720832 45.376199529405035, 124.50150399034766 45.37619893303126, 124.50150938968804 45.376198922650204, 124.50151404587778 45.37619945284896, 124.50151788605127 45.37619962877986, 124.50151883763553 45.37620002729094, 124.50152296623048 45.37620105592416, 124.5016106774268 45.376216290085615, 124.50161500623707 45.37621673111633, 124.50161937400517 45.37621656919197, 124.50162361327618 45.37621581052054, 124.50162756152206 45.376214484188516, 124.50163106737185 45.376212641045804, 124.50163399641599 45.37621035175616, 124.50163623635869 45.376207704088, 124.50163770132343 45.37620479954955, 124.50163833514551 45.376201749497056, 124.50163811352517 45.37619867086563, 124.50163704495928 45.37619568168595, 124.50163517041516 45.3761928965593, 124.50163256176062 45.376190422263775, 124.50162931900826 45.3761883536606, 124.50162556648068 45.37618677005733, 124.50162144804511 45.37618573216717, 124.50162134486747 45.37618571407186, 124.50153365616345 45.37617048387929, 124.50152932216567 45.37617004268217, 124.50152813477122 45.37617008699465, 124.50152719721945 45.3761696918663, 124.50152320270762 45.376168669340025, 124.50151540659364 45.37616724805931, 124.50151070057174 45.3761658818117, 124.50150704244601 45.37616415715984, 124.50150367672435 45.37616177075217, 124.50150146681986 45.376159573751735, 124.50149107005313 45.37614704949262, 124.50148930364732 45.37614427786766, 124.50144795247775 45.37606239618382, 124.5014471316575 45.376060208747795, 124.50142385190317 45.37597863565871, 124.50140169717477 45.375884406281365, 124.50140146719873 45.37588356932798, 124.50139969683896 45.37587794662101, 124.5013767981493 45.3757785269306, 124.50134697253121 45.37567014622954, 124.50131987393183 45.37556079926774, 124.50128789408865 45.37544276997611, 124.50125926403182 45.37531245408609, 124.50124944718796 45.375253108795675, 124.50124958737445 45.37524968455137, 124.50125054014978 45.375246726307594, 124.50125239184585 45.375243784820896, 124.5012561865836 45.37523977917095, 124.50125832247625 45.37523693098056, 124.50125959105512 45.37523383599582, 124.50125993920155 45.375230623812676, 124.50125935233767 45.375227428934444, 124.5012578550374 45.37522438513986, 124.501255509997 45.37522161988129, 124.50125241541016 45.375219248947985, 124.50124987335684 45.37521766294568, 124.50124623222656 45.37521489217729, 124.50124397619342 45.375212317275, 124.50124233851393 45.3752092442948, 124.50124162239587 45.3752067248224, 124.50124151984099 45.375206040872335, 124.50124123565483 45.37518382930618, 124.50124118524087 45.37518290467383, 124.50123686768232 45.375138091810825, 124.50123710525216 45.375131818952255, 124.50123700524432 45.37512985288902, 124.50122827761817 45.375067515270835, 124.50122740706475 45.37506445263183, 124.50122569576537 45.37506157140134, 124.50122321108165 45.37505898499284, 124.50122005081806 45.37505679521479, 124.50121633937155 45.37505508826312, 124.50121222283548 45.37505393132831, 124.50120786324835 45.375053369950635, 124.50120343221589 45.375053426227495, 124.50119910415633 45.37505409794369, 124.50119504943436 45.375055358658585, 124.50119142765529 45.3750571587468, 124.50118838138292 45.37505942735174, 124.50118603052736 45.37506207517463, 124.5011844676249 45.37506499798956, 124.50118375419618 45.37506808074616, 124.50118373699264 45.375068275052186, 124.50118369684202 45.375069522583686, 124.50118557647697 45.375147616631864, 124.50118540019082 45.37514968995118, 124.50117217540297 45.37522957652002, 124.50117164267196 45.375231233106874, 124.50117086409327 45.37523283129134, 124.50116984594311 45.37523436112022, 124.50116860005443 45.37523580481363, 124.50116714090525 45.375237145595186, 124.5011657104298 45.37523820177331, 124.50115929472177 45.375241796838786, 124.50115606179867 45.375244019519606, 124.50115352931472 45.37524665510259, 124.50115180079679 45.375249595846526, 124.50115094690578 45.375252721535304, 124.50115091409238 45.37525298085922, 124.50115084942456 45.37525510332902, 124.50115097036141 45.37525695479067, 124.50115065688937 45.37526030617682, 124.50114968315302 45.37526303827122, 124.50114803015441 45.37526560304075, 124.50114555889549 45.37526811294287, 124.50114314702188 45.37526991262133, 124.50113396565192 45.37527580702755, 124.5011317656241 45.375277436839866, 124.50113102692502 45.37527806896222, 124.5011285524985 45.37528067850915, 124.50112686172479 45.375283582148704, 124.50112602180523 45.37528666447314, 124.50112596472759 45.3752871107646, 124.50112593991155 45.3752897277728, 124.50112602012246 45.375290465031654, 124.50112624421548 45.37529178769782, 124.50115166972613 45.375402011797036, 124.50115176501362 45.37540533821442, 124.50115106305681 45.375408244473405, 124.5011495996581 45.37541100623597, 124.50114742682725 45.375413525347426, 124.50114462178678 45.37541571227842, 124.50114100178304 45.37541763968838, 124.50113780797794 45.37541883926755, 124.50111935314993 45.37542442682841, 124.50111714189185 45.37542492473565, 124.50111492757681 45.37542525328322, 124.50111267736648 45.37542542162405, 124.5011104145333 45.375425428017124, 124.50110816248038 45.375425272396285, 124.50110594449926 45.37542495637102, 124.50110378352957 45.37542448320987, 124.50110170192048 45.37542385780635, 124.50109972120121 45.37542308662874, 124.50109786185725 45.37542217765296, 124.50109614311768 45.37542114027939, 124.50109458276016 45.37541998523812, 124.50109319692113 45.37541872447413, 124.50109199993358 45.37541737102665, 124.50109100417794 45.37541593889457, 124.5010902552934 45.37541451030625, 124.50108922363322 45.37541157798413)))</textarea>
            <div class="coord-settings" style="margin-bottom:8px;font-size:12px;color:#333;">
                <label>WKT坐标系：
                    <select id="coordSysSelect" style="margin-left:6px;">
                        <option value="wgs84" selected>WGS84</option>
                        <option value="gcj02">GCJ-02（国测局）</option>
                        <option value="bd09">BD-09（百度）</option>
                        <option value="cgcs2000">CGCS2000</option>
                    </select>
                </label>
                <!-- 已移除“不进行绘制坐标转换”选项，统一使用WGS84绘制 -->
            </div>

            <div class="button-group">
                <button id="drawButton">绘制轮廓</button>
                <button id="clearButton">清空轮廓</button>
            </div>
            <!-- 显示开关：仅保留显示亩数 -->
            <div class="display-toggles" style="margin-top:8px;font-size:12px;color:#333;">
                <label><input type="checkbox" id="toggleLabelsCheckbox"> 显示亩数</label>
            </div>
        </div>

        <div class="tab-pane" id="tabSplit">
            <!-- MultiPolygon → 多个 Polygon 分割器 -->
            <div class="split-section">
                <div class="title">MultiPolygon → 多个 Polygon 分割器</div>
                <div class="desc">输入一个 MULTIPOLYGON WKT，分割为多行 POLYGON WKT。</div>
                <textarea id="multiInput"></textarea>
                <div class="split-actions">
                    <button id="splitMultiBtn">分割为多个 POLYGON</button>
                    <button id="copyPolysBtn">复制结果</button>
                </div>
                <textarea id="polyOutput" readonly></textarea>
            </div>
        </div>

        <div class="tab-pane" id="tabBatch">
            <!-- 批量POLYGON → MULTIPOLYGON 生成器 -->
            <div class="batch-section">
                <div class="title">批量POLYGON → MULTIPOLYGON 合并器</div>
                <div class="desc">每行一个 POLYGON WKT（或用分号分隔）。生成后可一键填充到上方并绘制。</div>
                <textarea id="batchInput"></textarea>
                <div class="batch-actions">
                    <button id="generateMultiBtn">生成 MULTIPOLYGON</button>
                    <button id="copyMultiBtn">复制结果</button>
                </div>
                <textarea id="multiOutput" readonly></textarea>
            </div>
        </div>
        <div class="tab-pane" id="tabTrack">
            <div class="tip">请粘贴轨迹文本（支持两种格式：1）每行一条：定位时间yyyyMMddHHmmss, 经度, 纬度；2）单行#分隔：经度,纬度,定位时间yyyyMMddHHmmss#经度,纬度,定位时间yyyyMMddHHmmss#…）。</div>
            <div class="coord-settings" style="margin-bottom:8px;font-size:12px;color:#333;">
                <label>轨迹坐标系：
                    <select id="trackCoordSysSelect" style="margin-left:6px;">
                        <option value="wgs84" selected>WGS84</option>
                        <option value="gcj02">GCJ-02（国测局）</option>
                        <option value="bd09">BD-09（百度）</option>
                        <option value="cgcs2000">CGCS2000</option>
                    </select>
                </label>
            </div>
            <div class="time-range-settings" style="margin-bottom:8px;font-size:12px;color:#333;">
                <label>时间范围选取(留空则显示所有轨迹)</label>
                <input type="text" id="timeRangeInput" style="width:100%;margin-top:4px;padding:4px;border:1px solid #ddd;border-radius:4px;font-size:12px;" placeholder="格式：yyyy-MM-ddTHH:mm:ss - yyyy-MM-ddTHH:mm:ss">
            </div>
            <textarea id="trackTextarea" style="width:100%;height:120px;margin-bottom:10px;padding:8px;border:1px solid #ddd;border-radius:4px;font-family:monospace;resize:vertical;box-sizing:border-box;">20251026070913,124.504478,45.342070
20251026070923,124.504457,45.342095
20251026070933,124.504473,45.342090
20251026070943,124.504470,45.342091
20251026070953,124.504470,45.342092
20251026072557,124.504442,45.342061
20251026072607,124.504448,45.342046
20251026072617,124.504211,45.341974
20251026072627,124.503904,45.341932
20251026072637,124.503733,45.341892
20251026072647,124.503316,45.341757
20251026072657,124.502903,45.341637
20251026072707,124.502600,45.341977
20251026072717,124.502340,45.342350
20251026072727,124.502025,45.342477
20251026072737,124.501643,45.342732
20251026072747,124.501239,45.342690
20251026072757,124.500959,45.342962
20251026072807,124.500619,45.343330
20251026072817,124.500228,45.343719
20251026072827,124.499718,45.344275
20251026072837,124.499090,45.344970
20251026072847,124.498582,45.345561
20251026072857,124.498217,45.346022
20251026072907,124.498007,45.346464
20251026072917,124.498392,45.347121
20251026072927,124.498615,45.347829
20251026072937,124.498705,45.348489
20251026072947,124.498687,45.349042
20251026072957,124.498666,45.349617
20251026073007,124.498683,45.350207
20251026073017,124.498755,45.350742
20251026073027,124.498802,45.351288
20251026073037,124.499082,45.351873
20251026073047,124.499531,45.352439
20251026073057,124.499927,45.353023
20251026073107,124.500244,45.353657
20251026073117,124.500475,45.354266
20251026073127,124.500717,45.354936
20251026073137,124.500959,45.355563
20251026073148,124.501259,45.356153
20251026073158,124.501540,45.356684
20251026073208,124.501929,45.357104
20251026073218,124.502194,45.357453
20251026073228,124.502431,45.357795
20251026073238,124.502765,45.358104
20251026073248,124.503148,45.358367
20251026073258,124.503463,45.358696
20251026073308,124.503532,45.359118
20251026073318,124.503284,45.359578
20251026073328,124.502889,45.360018
20251026073338,124.502482,45.360476
20251026073348,124.502045,45.360940
20251026073358,124.501325,45.361107
20251026073408,124.500777,45.361455
20251026073418,124.500428,45.361913
20251026073428,124.500497,45.362429
20251026073438,124.500407,45.362956
20251026073448,124.500054,45.363433
20251026073458,124.499718,45.363888
20251026073508,124.499564,45.364131
20251026073518,124.499413,45.364417
20251026073528,124.499492,45.365015
20251026073538,124.499636,45.365657
20251026073548,124.499764,45.366264
20251026073558,124.499874,45.366848
20251026073608,124.499961,45.367379
20251026073618,124.500044,45.367879
20251026073628,124.500097,45.368377
20251026073638,124.500122,45.368852
20251026073648,124.500146,45.369348
20251026073658,124.500175,45.369852
20251026073708,124.500208,45.370337
20251026073718,124.500242,45.370760
20251026073728,124.500282,45.371191
20251026073738,124.500305,45.371649
20251026073748,124.500260,45.372122
20251026073758,124.500218,45.372558
20251026073808,124.500190,45.372852
20251026073818,124.500261,45.373016
20251026073828,124.500566,45.373071
20251026073838,124.500988,45.372975
20251026073848,124.501321,45.372866
20251026073858,124.501660,45.372846
20251026073908,124.502022,45.373022
20251026073918,124.502371,45.373202
20251026073928,124.502721,45.373360
20251026073938,124.503082,45.373537
20251026073948,124.503427,45.373718
20251026073958,124.503776,45.373905
20251026074008,124.504092,45.374068
20251026074018,124.504445,45.374252
20251026074028,124.504804,45.374441
20251026074038,124.505154,45.374636
20251026074048,124.505503,45.374826
20251026074058,124.505852,45.374990
20251026074108,124.506182,45.375192
20251026074118,124.506428,45.375439
20251026074128,124.506654,45.375684
20251026074138,124.506853,45.375958
20251026074148,124.507000,45.376194
20251026074158,124.507145,45.376461
20251026074208,124.507278,45.376743
20251026074218,124.507422,45.377016
20251026074228,124.507591,45.377296
20251026074238,124.507804,45.377522
20251026074248,124.508117,45.377737
20251026074258,124.508544,45.377922
20251026074308,124.508943,45.378088
20251026074318,124.509335,45.378236
20251026074328,124.509728,45.378397
20251026074338,124.510169,45.378591
20251026074348,124.510560,45.378781
20251026074358,124.511020,45.379022
20251026074408,124.511403,45.379255
20251026074418,124.511765,45.379476
20251026074428,124.512224,45.379747
20251026074438,124.512577,45.379943
20251026074448,124.512966,45.380150
20251026074458,124.513358,45.380356
20251026074508,124.513603,45.380385
20251026074518,124.513845,45.380275
20251026074528,124.514199,45.380148
20251026074538,124.514588,45.380005
20251026074548,124.514934,45.379865
20251026074558,124.515257,45.379726
20251026074608,124.515598,45.379591
20251026074618,124.515917,45.379464
20251026074628,124.516153,45.379356
20251026074638,124.516320,45.379299
20251026074648,124.516676,45.379180
20251026074658,124.517075,45.379019
20251026074708,124.517474,45.378853
20251026074718,124.517847,45.378707
20251026074728,124.518231,45.378531
20251026074738,124.518678,45.378304
20251026074748,124.519152,45.378073
20251026074758,124.519573,45.377861
20251026074808,124.519937,45.377683
20251026074818,124.520297,45.377523
20251026074828,124.520610,45.377645
20251026074838,124.520847,45.377799
20251026074848,124.521158,45.377995
20251026074858,124.521556,45.378241
20251026074908,124.521820,45.378411
20251026074918,124.522122,45.378600
20251026074928,124.522388,45.378768
20251026074938,124.522684,45.378935
20251026074948,124.522904,45.379060
20251026074958,124.523093,45.379178
20251026075008,124.523376,45.379287
20251026075018,124.523474,45.379307
20251026075028,124.523408,45.379346
20251026075038,124.523371,45.379397
20251026075048,124.523348,45.379479
20251026075058,124.523335,45.379560
20251026075108,124.523279,45.379473
20251026075118,124.523243,45.379441
20251026075128,124.523243,45.379441
20251026075137,124.523243,45.379441
20251026075147,124.523243,45.379441
20251026075157,124.523239,45.379440
20251026075207,124.523174,45.379412
20251026075217,124.523089,45.379379
20251026075227,124.523024,45.379355
20251026075237,124.522971,45.379334
20251026075247,124.522976,45.379337
20251026075257,124.522963,45.379332
20251026075307,124.522963,45.379332
20251026075317,124.522963,45.379332
20251026075327,124.522963,45.379332
20251026075337,124.522963,45.379332
20251026075347,124.522963,45.379332
20251026075357,124.522963,45.379332
20251026075407,124.522963,45.379332
20251026075417,124.522963,45.379332
20251026075427,124.522963,45.379332
20251026075437,124.522963,45.379332
20251026075447,124.522962,45.379332
20251026075457,124.522962,45.379332
20251026075507,124.522962,45.379332
20251026075517,124.522962,45.379332
20251026075527,124.522962,45.379332
20251026075537,124.522962,45.379332
20251026075547,124.522962,45.379332
20251026075557,124.522962,45.379332
20251026075607,124.522942,45.379323
20251026075617,124.522898,45.379303
20251026075627,124.522853,45.379281
20251026075637,124.522810,45.379259
20251026075647,124.522769,45.379237
20251026075657,124.522720,45.379210
20251026075707,124.522677,45.379184
20251026075717,124.522628,45.379156
20251026075727,124.522555,45.379109
20251026075737,124.522465,45.379049
20251026075747,124.522395,45.379010
20251026075757,124.522341,45.378974
20251026075807,124.522278,45.378932
20251026075817,124.522223,45.378893
20251026075827,124.522164,45.378861
20251026075837,124.522103,45.378822
20251026075847,124.522043,45.378783
20251026075857,124.521971,45.378736
20251026075907,124.521908,45.378695
20251026075917,124.521851,45.378653
20251026075927,124.521787,45.378606
20251026075937,124.521723,45.378557
20251026075947,124.521657,45.378506
20251026075957,124.521589,45.378460
20251026080007,124.521529,45.378422
20251026080017,124.521462,45.378381
20251026080027,124.521418,45.378356
20251026080037,124.521375,45.378330
20251026080047,124.521446,45.378369
20251026080057,124.521200,45.378178
20251026080107,124.520904,45.378016
20251026080117,124.520877,45.378001
20251026080127,124.520877,45.378001
20251026080137,124.520877,45.378001
20251026080147,124.520877,45.378001
20251026080157,124.520877,45.378001
20251026080207,124.520877,45.378001
20251026080217,124.520877,45.378001
20251026080227,124.520877,45.378001
20251026080237,124.520877,45.378001
20251026080247,124.520877,45.378001
20251026080257,124.520877,45.378001
20251026080307,124.520877,45.378001
20251026080317,124.520877,45.378001
20251026080327,124.520877,45.378001
20251026080337,124.520877,45.378001
20251026080347,124.520877,45.378001
20251026080357,124.520877,45.378001
20251026080407,124.520877,45.378001
20251026080417,124.520877,45.378001
20251026080427,124.520877,45.378001
20251026080437,124.520877,45.378001
20251026080447,124.520877,45.378001
20251026080457,124.520877,45.378001
20251026080507,124.520841,45.377985
20251026080517,124.520746,45.377941
20251026080527,124.520607,45.377867
20251026080537,124.520666,45.377893
20251026080547,124.520677,45.377902
20251026080557,124.520789,45.377974
20251026080607,124.520853,45.378012
20251026080617,124.520819,45.377982
20251026080627,124.521032,45.378106
20251026080637,124.521106,45.378155
20251026080647,124.521179,45.378203
20251026080657,124.521273,45.378262
20251026080707,124.521095,45.378142
20251026080717,124.521030,45.378115
20251026080727,124.521096,45.378164
20251026080737,124.521181,45.378220
20251026080747,124.521208,45.378237
20251026080757,124.521175,45.378197
20251026080807,124.521222,45.378228
20251026080817,124.521224,45.378228
20251026080827,124.521224,45.378228
20251026080837,124.521222,45.378228
20251026080847,124.521222,45.378228
20251026080857,124.521266,45.378250
20251026080907,124.521592,45.378439
20251026080917,124.521894,45.378660
20251026080927,124.522211,45.378872
20251026080937,124.522551,45.379088
20251026080947,124.522897,45.379281
20251026080957,124.523244,45.379435
20251026081007,124.523326,45.379527
20251026081017,124.523336,45.379460
20251026081027,124.523376,45.379348
20251026081037,124.523468,45.379303
20251026081047,124.523296,45.379252
20251026081057,124.523031,45.379149
20251026081107,124.522791,45.379003
20251026081117,124.522487,45.378818
20251026081127,124.522217,45.378648
20251026081137,124.521991,45.378508
20251026081147,124.521685,45.378313
20251026081157,124.521370,45.378113
20251026081207,124.521094,45.377928
20251026081217,124.520805,45.377765
20251026081227,124.520508,45.377570
20251026081237,124.520155,45.377558
20251026081247,124.519806,45.377736
20251026081257,124.519449,45.377912
20251026081307,124.519088,45.378096
20251026081317,124.518707,45.378281
20251026081327,124.518327,45.378472
20251026081337,124.517943,45.378659
20251026081347,124.517546,45.378820
20251026081357,124.517160,45.378970
20251026081407,124.516801,45.379122
20251026081417,124.516550,45.379222
20251026083907,124.519705,45.377988
20251026083917,124.519681,45.378001
20251026083927,124.519596,45.378045
20251026083937,124.519501,45.378089
20251026083947,124.519404,45.378140
20251026083957,124.519279,45.378205
20251026084007,124.519159,45.378263
20251026084017,124.519064,45.378309
20251026084027,124.518968,45.378355
20251026084037,124.518870,45.378401
20251026084047,124.518769,45.378446
20251026084057,124.518662,45.378497
20251026084107,124.518556,45.378549
20251026084117,124.518453,45.378596
20251026084127,124.518345,45.378647
20251026084137,124.518241,45.378694
20251026084147,124.518125,45.378745
20251026084157,124.518016,45.378795
20251026084207,124.517900,45.378844
20251026084217,124.517780,45.378892
20251026084227,124.517660,45.378941
20251026084237,124.517544,45.378989
20251026084247,124.517428,45.379037
20251026084257,124.517513,45.379003
20251026084306,124.517520,45.379000
20251026084316,124.517519,45.379000
20251026084326,124.517518,45.379000
20251026084336,124.517518,45.379000
20251026084346,124.517484,45.379014
20251026084356,124.517367,45.379062
20251026084406,124.517260,45.379108
20251026084416,124.517147,45.379157
20251026084426,124.517033,45.379202
20251026084436,124.516911,45.379255
20251026084446,124.516826,45.379291
20251026084456,124.516826,45.379291
20251026084506,124.516826,45.379291
20251026084516,124.516787,45.379308
20251026084526,124.516674,45.379356
20251026084536,124.516553,45.379408
20251026084546,124.516420,45.379462
20251026084556,124.516554,45.379406
20251026084606,124.516617,45.379373
20251026084616,124.516451,45.379443
20251026084626,124.516445,45.379466
20251026084636,124.516400,45.379540
20251026084646,124.516428,45.379506
20251026084656,124.516408,45.379481
20251026084706,124.516441,45.379495
20251026084716,124.516506,45.379467
20251026084726,124.516575,45.379440
20251026084736,124.516423,45.379491
20251026084746,124.516444,45.379504
20251026084756,124.516535,45.379486
20251026084806,124.516654,45.379436
20251026084816,124.516653,45.379436
20251026084826,124.516648,45.379438
20251026084836,124.516535,45.379479
20251026084846,124.516619,45.379424
20251026084856,124.516652,45.379408
20251026084906,124.516699,45.379387
20251026084916,124.516805,45.379341
20251026084926,124.516802,45.379339
20251026084936,124.516706,45.379349
20251026084946,124.516707,45.379349
20251026084956,124.516708,45.379349
20251026085006,124.516708,45.379349
20251026085016,124.516707,45.379349
20251026085026,124.516708,45.379349
20251026085036,124.516708,45.379348
20251026085046,124.516709,45.379348
20251026085056,124.516709,45.379348
20251026085106,124.516650,45.379362
20251026085116,124.516625,45.379365
20251026085126,124.516625,45.379365
20251026085136,124.516625,45.379365
20251026085146,124.516625,45.379365
20251026085156,124.516625,45.379365
20251026085206,124.516625,45.379365
20251026085216,124.516625,45.379365
20251026085226,124.516625,45.379365
20251026085236,124.516625,45.379365
20251026085246,124.516625,45.379365
20251026085256,124.516625,45.379365
20251026085306,124.516625,45.379365
20251026085316,124.516625,45.379365
20251026085326,124.516625,45.379365
20251026085336,124.516625,45.379365
20251026085346,124.516625,45.379365
20251026085356,124.516625,45.379365
20251026085406,124.516625,45.379365
20251026085416,124.516625,45.379365
20251026085426,124.516625,45.379365
20251026085436,124.516729,45.379357
20251026085446,124.516860,45.379318
20251026085456,124.516967,45.379275
20251026085506,124.517076,45.379227
20251026085516,124.517185,45.379183
20251026085526,124.517286,45.379140
20251026085536,124.517390,45.379096
20251026085546,124.517514,45.379041
20251026085556,124.517638,45.378993
20251026085606,124.517756,45.378944
20251026085616,124.517877,45.378893
20251026085626,124.517995,45.378846
20251026085636,124.518046,45.378823
20251026085646,124.518159,45.378773
20251026085656,124.518204,45.378754
20251026085706,124.518207,45.378752
20251026085716,124.518290,45.378713
20251026085726,124.518386,45.378670
20251026085736,124.518490,45.378622
20251026085746,124.518579,45.378581
20251026085756,124.518669,45.378538
20251026085806,124.518774,45.378488
20251026085816,124.518884,45.378437
20251026085826,124.518989,45.378389
20251026085836,124.519095,45.378336
20251026085846,124.519208,45.378282
20251026085856,124.519325,45.378223
20251026085906,124.519432,45.378166
20251026085916,124.519548,45.378110
20251026085926,124.519662,45.378051
20251026085936,124.519777,45.377997
20251026085946,124.519731,45.378008
20251026085956,124.519660,45.378018
20251026090006,124.519660,45.378018
20251026090016,124.519660,45.378018
20251026090026,124.519660,45.378018
20251026090036,124.519660,45.378018
20251026090046,124.519761,45.377950
20251026090056,124.519955,45.377845
20251026090106,124.520052,45.377860
20251026090116,124.520007,45.377899
20251026090126,124.519899,45.377950
20251026090136,124.519795,45.378002
20251026090146,124.519691,45.378050
20251026090156,124.519650,45.378070
20251026090206,124.519562,45.378113
20251026090216,124.519599,45.378094
20251026090226,124.519463,45.378150
20251026090236,124.519340,45.378215
20251026090246,124.519245,45.378262
20251026090256,124.519176,45.378297
20251026090306,124.519064,45.378351
20251026090316,124.518946,45.378408
20251026090326,124.518830,45.378461
20251026090336,124.518692,45.378526
20251026090346,124.518582,45.378580
20251026090356,124.518473,45.378630
20251026090406,124.518360,45.378680
20251026090416,124.518242,45.378735
20251026090426,124.518117,45.378796
20251026090436,124.518076,45.378826
20251026090446,124.517998,45.378864
20251026090456,124.517925,45.378893
20251026090506,124.517985,45.378869
20251026090516,124.517983,45.378870
20251026090526,124.517983,45.378870
20251026090536,124.517983,45.378870
20251026090546,124.517983,45.378870
20251026090556,124.517983,45.378870
20251026090606,124.517983,45.378870
20251026090616,124.517962,45.378878
20251026090626,124.517878,45.378912
20251026090636,124.517792,45.378949
20251026090646,124.517723,45.378977
20251026090656,124.517650,45.379007
20251026090706,124.517675,45.378996
20251026090716,124.517675,45.378996
20251026090726,124.517675,45.378996
20251026090736,124.517675,45.378996
20251026090746,124.517645,45.379009
20251026090756,124.517575,45.379039
20251026090806,124.517510,45.379066
20251026090816,124.517445,45.379092
20251026090826,124.517377,45.379120
20251026090836,124.517306,45.379148
20251026090846,124.517326,45.379139
20251026090856,124.517230,45.379181
20251026090906,124.517135,45.379222
20251026090916,124.517044,45.379258
20251026090926,124.516968,45.379295
20251026090936,124.516885,45.379329
20251026090946,124.516794,45.379369
20251026090956,124.516687,45.379414
20251026091006,124.516801,45.379357
20251026091016,124.516764,45.379386
20251026091026,124.516643,45.379441
20251026091036,124.516538,45.379486
20251026091046,124.516580,45.379467
20251026091056,124.516580,45.379467
20251026091106,124.516579,45.379467
20251026091116,124.516579,45.379467
20251026091126,124.516579,45.379467
20251026091136,124.516579,45.379467
20251026091146,124.516579,45.379467
20251026091156,124.516632,45.379445
20251026091206,124.516542,45.379419
20251026091216,124.516413,45.379457
20251026091226,124.516279,45.379495
20251026091236,124.516174,45.379521
20251026091246,124.516065,45.379562
20251026091256,124.515972,45.379598
20251026091306,124.515880,45.379631
20251026091316,124.515771,45.379671
20251026091326,124.515749,45.379680
20251026091336,124.515637,45.379726
20251026091346,124.515601,45.379739
20251026091356,124.515497,45.379781
20251026091406,124.515391,45.379824
20251026091416,124.515277,45.379870
20251026091426,124.515167,45.379914
20251026091436,124.515059,45.379957
20251026091446,124.515059,45.379958
20251026091456,124.514938,45.380006
20251026091506,124.514836,45.380049
20251026091516,124.514721,45.380090
20251026091526,124.514608,45.380135
20251026091535,124.514487,45.380181
20251026091545,124.514364,45.380225
20251026091555,124.514323,45.380241
20251026091605,124.514199,45.380286
20251026091615,124.514108,45.380317
20251026091625,124.514048,45.380338
20251026091635,124.513995,45.380356
20251026091645,124.514069,45.380342
20251026091655,124.513963,45.380400
20251026091705,124.513837,45.380443
20251026091715,124.513905,45.380422
20251026091725,124.514063,45.380341
20251026091735,124.513888,45.380401
20251026091745,124.513881,45.380410
20251026091755,124.514035,45.380367
20251026091805,124.513953,45.380434
20251026091815,124.513901,45.380455
20251026091825,124.513874,45.380468
20251026091835,124.513786,45.380499
20251026091845,124.513873,45.380485
20251026091855,124.513872,45.380492
20251026091905,124.513828,45.380512
20251026091915,124.513837,45.380513
20251026091925,124.513848,45.380552
20251026091935,124.513854,45.380528
20251026091945,124.513815,45.380542
20251026091955,124.513810,45.380554
20251026092005,124.513818,45.380588
20251026092015,124.513822,45.380519
20251026092025,124.513803,45.380506
20251026092035,124.513865,45.380506
20251026092045,124.513902,45.380496
20251026092055,124.513888,45.380532
20251026092105,124.513929,45.380522
20251026092115,124.513858,45.380474
20251026092125,124.513849,45.380443
20251026092135,124.513903,45.380406
20251026092145,124.513902,45.380406
20251026092155,124.513902,45.380406
20251026092205,124.513902,45.380406
20251026092215,124.513902,45.380406
20251026092225,124.513902,45.380406
20251026092235,124.513902,45.380406
20251026092245,124.513979,45.380406
20251026092255,124.514040,45.380385
20251026092305,124.514098,45.380361
20251026092315,124.514203,45.380324
20251026092325,124.514321,45.380281
20251026092335,124.514445,45.380236
20251026092345,124.514576,45.380188
20251026092355,124.514707,45.380137
20251026092405,124.514837,45.380088
20251026092415,124.514968,45.380036
20251026092425,124.515015,45.380017
20251026092435,124.515016,45.380017
20251026092445,124.515016,45.380017
20251026092455,124.515016,45.380017
20251026092505,124.515016,45.380017
20251026092515,124.515016,45.380017
20251026092525,124.515030,45.380011
20251026092535,124.515130,45.379972
20251026092545,124.515247,45.379923
20251026092555,124.515362,45.379876
20251026092605,124.515471,45.379830
20251026092615,124.515595,45.379781
20251026092625,124.515727,45.379729
20251026092635,124.515858,45.379677
20251026092645,124.515991,45.379626
20251026092655,124.516125,45.379576
20251026092705,124.516216,45.379540
20251026092715,124.516259,45.379523
20251026092725,124.516175,45.379539
20251026092735,124.516118,45.379554
20251026092745,124.516118,45.379554
20251026092755,124.516118,45.379554
20251026092805,124.516118,45.379554
20251026092815,124.516118,45.379554
20251026092825,124.516118,45.379554
20251026092835,124.516224,45.379519
20251026092845,124.516422,45.379529
20251026092855,124.516400,45.379538
20251026092905,124.516463,45.379496
20251026092915,124.516462,45.379497
20251026092925,124.516462,45.379497
20251026092935,124.516462,45.379497
20251026092945,124.516462,45.379496
20251026092955,124.516462,45.379496
20251026093005,124.516462,45.379496
20251026093015,124.516462,45.379496
20251026093025,124.516462,45.379496
20251026093035,124.516462,45.379496
20251026093045,124.516462,45.379496
20251026093055,124.516462,45.379496
20251026093105,124.516462,45.379496
20251026093115,124.516462,45.379496
20251026093125,124.516462,45.379497
20251026093135,124.516461,45.379497
20251026093145,124.516460,45.379497
20251026093155,124.516397,45.379504
20251026093205,124.516300,45.379532
20251026093215,124.516202,45.379572
20251026093225,124.516091,45.379615
20251026093235,124.515989,45.379653
20251026093245,124.515894,45.379688
20251026093255,124.515795,45.379728
20251026093305,124.515705,45.379765
20251026093315,124.515658,45.379783
20251026093325,124.515585,45.379811
20251026093335,124.515617,45.379802
20251026093345,124.515527,45.379848
20251026093355,124.515451,45.379880
20251026093405,124.515360,45.379907
20251026093415,124.515265,45.379940
20251026093425,124.515151,45.379989
20251026093435,124.515039,45.380035
20251026093445,124.514925,45.380078
20251026093455,124.514808,45.380124
20251026093505,124.514681,45.380175
20251026093515,124.514557,45.380221
20251026093525,124.514433,45.380266
20251026093535,124.514310,45.380310
20251026093545,124.514184,45.380355
20251026093555,124.514070,45.380394
20251026093605,124.514104,45.380384
20251026093615,124.514104,45.380384
20251026093625,124.514104,45.380384
20251026093635,124.514026,45.380411
20251026093645,124.513882,45.380411
20251026093655,124.513802,45.380496
20251026093705,124.513854,45.380516
20251026093715,124.513985,45.380467
20251026093725,124.514082,45.380432
20251026093735,124.514201,45.380389
20251026093745,124.514329,45.380345
20251026093755,124.514454,45.380298
20251026093805,124.514582,45.380249
20251026093815,124.514714,45.380202
20251026093825,124.514850,45.380150
20251026093835,124.514979,45.380100
20251026093845,124.515110,45.380044
20251026093855,124.515237,45.379993
20251026093905,124.515366,45.379937
20251026093915,124.515492,45.379889
20251026093925,124.515627,45.379836
20251026093935,124.515753,45.379785
20251026093945,124.515886,45.379731
20251026093955,124.516013,45.379682
20251026094005,124.516039,45.379671
20251026094015,124.516160,45.379624
20251026094025,124.516264,45.379583
20251026094035,124.516363,45.379543
20251026094045,124.516140,45.379616
20251026094055,124.516130,45.379618
20251026094105,124.516130,45.379618
20251026094115,124.516207,45.379591
20251026094125,124.516346,45.379452
20251026094135,124.516139,45.379373
20251026094145,124.515983,45.379435
20251026094155,124.515902,45.379462
20251026094205,124.515902,45.379463
20251026094215,124.515902,45.379463
20251026094225,124.515903,45.379463
20251026094235,124.515902,45.379463
20251026094245,124.515902,45.379463
20251026094255,124.515902,45.379463
20251026094305,124.515902,45.379463
20251026094315,124.515906,45.379461
20251026094325,124.515982,45.379434
20251026094335,124.516036,45.379414
20251026094345,124.516180,45.379352
20251026094355,124.516309,45.379304
20251026094405,124.516342,45.379436
20251026094415,124.516326,45.379541
20251026094425,124.516460,45.379500
20251026094435,124.516465,45.379500
20251026094445,124.516452,45.379505
20251026094455,124.516364,45.379554
20251026094505,124.516290,45.379586
20251026094515,124.516204,45.379617
20251026094525,124.516237,45.379604
20251026094535,124.516131,45.379647
20251026094545,124.516039,45.379683
20251026094555,124.515958,45.379715
20251026094605,124.515891,45.379740
20251026094615,124.515803,45.379777
20251026094625,124.515820,45.379770
20251026094635,124.515711,45.379813
20251026094645,124.515772,45.379790
20251026094655,124.515745,45.379800
20251026094705,124.515661,45.379833
20251026094715,124.515653,45.379835
20251026094725,124.515585,45.379863
20251026094735,124.515554,45.379876
20251026094745,124.515462,45.379911
20251026094755,124.515355,45.379953
20251026094805,124.515257,45.379999
20251026094815,124.515168,45.380046
20251026094825,124.515066,45.380088
20251026094835,124.514961,45.380132
20251026094845,124.514853,45.380172
20251026094855,124.514733,45.380218
20251026094905,124.514604,45.380266
20251026094915,124.514468,45.380318
20251026094925,124.514334,45.380368
20251026094935,124.514197,45.380416
20251026094945,124.514053,45.380468
20251026094955,124.514149,45.380431
20251026095005,124.513976,45.380417
20251026095015,124.513777,45.380453
20251026095025,124.513817,45.380575
20251026095035,124.513927,45.380552
20251026095045,124.513941,45.380548
20251026095055,124.514056,45.380507
20251026095105,124.514161,45.380472
20251026095115,124.514272,45.380430
20251026095125,124.514229,45.380434
20251026095135,124.514253,45.380423
20251026095145,124.514371,45.380382
20251026095155,124.514484,45.380342
20251026095205,124.514580,45.380305
20251026095215,124.514688,45.380264
20251026095225,124.514797,45.380224
20251026095235,124.514931,45.380173
20251026095245,124.515028,45.380133
20251026095255,124.515073,45.380116
20251026095305,124.515099,45.380097
20251026095315,124.515116,45.380092
20251026095325,124.514986,45.380095
20251026095335,124.514999,45.380035
20251026095345,124.514920,45.380060
20251026095355,124.514743,45.380132
20251026095405,124.514716,45.380146
20251026095415,124.514716,45.380146
20251026095425,124.514716,45.380146
20251026095435,124.514716,45.380146
20251026095445,124.514538,45.380215
20251026095455,124.514230,45.380339
20251026095505,124.514221,45.380420
20251026095515,124.514226,45.380443
20251026095525,124.514189,45.380473
20251026095535,124.514194,45.380472
20251026095545,124.514125,45.380502
20251026095555,124.514066,45.380530
20251026095605,124.514125,45.380488
20251026095615,124.513972,45.380545
20251026095625,124.513852,45.380585
20251026095635,124.513952,45.380549
20251026095645,124.513952,45.380550
20251026095655,124.513952,45.380550
20251026095705,124.513952,45.380550
20251026095715,124.513952,45.380550
20251026095725,124.513952,45.380550
20251026095735,124.513952,45.380550
20251026095745,124.513951,45.380550
20251026095755,124.513882,45.380602
20251026095805,124.513870,45.380617
20251026095815,124.513767,45.380661
20251026095825,124.513640,45.380708
20251026095835,124.513700,45.380701
20251026095845,124.513720,45.380686
20251026095855,124.513679,45.380762
20251026095905,124.513712,45.380773
20251026095915,124.513766,45.380859
20251026095925,124.513714,45.380780
20251026095935,124.513708,45.380815
20251026095945,124.513750,45.380906
20251026095955,124.513716,45.380909
20251026100005,124.513664,45.380981
20251026100015,124.513555,45.381033
20251026100025,124.513503,45.381123
20251026100035,124.513470,45.381114
20251026100045,124.513605,45.381066
20251026100055,124.513718,45.381024
20251026100105,124.513826,45.380984
20251026100115,124.513922,45.380945
20251026100125,124.513800,45.380995
20251026100135,124.513637,45.381054
20251026100144,124.513554,45.381097
20251026100154,124.513655,45.381077
20251026100204,124.513733,45.381050
20251026100214,124.513843,45.381010
20251026100224,124.513869,45.380999
20251026100234,124.513688,45.381064
20251026100244,124.513562,45.381102
20251026100254,124.513626,45.381111
20251026100304,124.513723,45.381088
20251026100314,124.513831,45.381045
20251026100324,124.513857,45.381032
20251026100334,124.513660,45.381091
20251026100344,124.513658,45.381112
20251026100354,124.513706,45.381100
20251026100404,124.513834,45.381056
20251026100414,124.513774,45.381083
20251026100424,124.513857,45.381055
20251026100434,124.513656,45.381077
20251026100444,124.513528,45.381101
20251026100454,124.513578,45.381054
20251026100504,124.513684,45.381008
20251026100514,124.513808,45.380962
20251026100524,124.513915,45.380924
20251026100534,124.513709,45.381002
20251026100544,124.513705,45.380976
20251026100554,124.513817,45.380929
20251026100604,124.513947,45.380880
20251026100614,124.514070,45.380836
20251026100624,124.514193,45.380789
20251026100634,124.514323,45.380737
20251026100644,124.514448,45.380690
20251026100654,124.514294,45.380752
20251026100704,124.514126,45.380815
20251026100714,124.513978,45.380870
20251026100724,124.513877,45.380910
20251026100734,124.513967,45.380890
20251026100744,124.514094,45.380848
20251026100754,124.514068,45.380851
20251026100804,124.514239,45.380786
20251026100814,124.514370,45.380732
20251026100824,124.514327,45.380754
20251026100834,124.514368,45.380734
20251026100844,124.514489,45.380663
20251026100854,124.514375,45.380729
20251026100904,124.514482,45.380644
20251026100914,124.514455,45.380659
20251026100924,124.514555,45.380599
20251026100934,124.514662,45.380546
20251026100944,124.514540,45.380607
20251026100954,124.514653,45.380535
20251026101004,124.514629,45.380551
20251026101014,124.514732,45.380496
20251026101024,124.514845,45.380450
20251026101034,124.514731,45.380511
20251026101044,124.514709,45.380487
20251026101054,124.514826,45.380427
20251026101104,124.514837,45.380436
20251026101114,124.514763,45.380476
20251026101124,124.514741,45.380370
20251026101134,124.514729,45.380350
20251026101144,124.514782,45.380390
20251026101154,124.514735,45.380300
20251026101204,124.514789,45.380398
20251026101214,124.514820,45.380358
20251026101224,124.514792,45.380349
20251026101234,124.514797,45.380342
20251026101244,124.514811,45.380343
20251026101254,124.514778,45.380300
20251026101304,124.514772,45.380391
20251026101314,124.514802,45.380301
20251026101324,124.514910,45.380253
20251026101334,124.514853,45.380282
20251026101344,124.514803,45.380282
20251026101354,124.514864,45.380261
20251026101404,124.514885,45.380254
20251026101414,124.514821,45.380337
20251026101424,124.514767,45.380298
20251026101434,124.514700,45.380305
20251026101444,124.514742,45.380285
20251026101454,124.514742,45.380285
20251026101504,124.514742,45.380285
20251026101514,124.514742,45.380285
20251026101524,124.514742,45.380286
20251026101534,124.514742,45.380286
20251026101544,124.514742,45.380285
20251026101554,124.514735,45.380289
20251026101604,124.514665,45.380319
20251026101614,124.514565,45.380355
20251026101624,124.514473,45.380391
20251026101634,124.514407,45.380414
20251026101644,124.514363,45.380431
20251026101654,124.514242,45.380480
20251026101704,124.514212,45.380493
20251026101714,124.514077,45.380547
20251026101724,124.514106,45.380535
20251026101734,124.513944,45.380596
20251026101744,124.513916,45.380614
20251026101754,124.513772,45.380688
20251026101804,124.513695,45.380808
20251026101814,124.513708,45.380915
20251026101824,124.513700,45.381054
20251026101834,124.513675,45.380981
20251026101844,124.513793,45.380906
20251026101854,124.513903,45.380867
20251026101904,124.514019,45.380824
20251026101914,124.514159,45.380768
20251026101924,124.514298,45.380715
20251026101934,124.514371,45.380686
20251026101944,124.514447,45.380662
20251026101954,124.514566,45.380589
20251026102004,124.514646,45.380543
20251026102014,124.514827,45.380428
20251026102024,124.514793,45.380314
20251026102034,124.514708,45.380336
20251026102044,124.514614,45.380369
20251026102054,124.514520,45.380402
20251026102104,124.514416,45.380443
20251026102114,124.514299,45.380492
20251026102124,124.514167,45.380544
20251026102134,124.514030,45.380594
20251026102144,124.513878,45.380653
20251026102154,124.513859,45.380659
20251026102204,124.513735,45.380686
20251026102214,124.513638,45.380716
20251026102325,124.513711,45.380972
20251026102335,124.513760,45.380894
20251026102345,124.513868,45.380847
20251026102355,124.514000,45.380799
20251026102405,124.514146,45.380744
20251026102416,124.514293,45.380685
20251026102426,124.514449,45.380625
20251026102436,124.514535,45.380593
20251026102446,124.514708,45.380508
20251026102456,124.514827,45.380404
20251026102506,124.514839,45.380328
20251026102516,124.514696,45.380371
20251026102526,124.514569,45.380418
20251026102536,124.514437,45.380468
20251026102546,124.514297,45.380523
20251026102556,124.514153,45.380579
20251026102606,124.514010,45.380634
20251026102616,124.513857,45.380693
20251026102626,124.513764,45.380727
20251026102636,124.513935,45.380638
20251026102646,124.514008,45.380569
20251026102656,124.514007,45.380569
20251026102706,124.514007,45.380569
20251026102716,124.514007,45.380569
20251026102726,124.514007,45.380569
20251026102736,124.514007,45.380569
20251026102746,124.514007,45.380569
20251026102756,124.514007,45.380569
20251026102806,124.513976,45.380582
20251026103206,124.513797,45.380855
20251026103216,124.513755,45.380835
20251026103226,124.513864,45.380818
20251026103236,124.513983,45.380774
20251026103246,124.514112,45.380722
20251026103256,124.514248,45.380672
20251026103306,124.514386,45.380617
20251026103316,124.514525,45.380565
20251026103326,124.514623,45.380529
20251026103336,124.514826,45.380433
20251026103346,124.514839,45.380356
20251026103356,124.514725,45.380394
20251026103406,124.514623,45.380432
20251026103416,124.514510,45.380472
20251026103426,124.514393,45.380519
20251026103436,124.514260,45.380569
20251026103446,124.514129,45.380620
20251026103456,124.513995,45.380670
20251026103506,124.513860,45.380724
20251026103516,124.513848,45.380729
20251026103526,124.513724,45.380769
20251026103536,124.513692,45.380797
20251026103546,124.513782,45.380813
20251026103556,124.513900,45.380774
20251026103606,124.514027,45.380724
20251026103616,124.514168,45.380669
20251026103626,124.514316,45.380610
20251026103636,124.514470,45.380555
20251026103646,124.514628,45.380496
20251026103656,124.514662,45.380482
20251026103706,124.514849,45.380403
20251026103716,124.514836,45.380349
20251026103726,124.514718,45.380427
20251026103736,124.514593,45.380478
20251026103746,124.514462,45.380526
20251026103756,124.514322,45.380580
20251026103806,124.514166,45.380638
20251026103816,124.514000,45.380700
20251026103826,124.513832,45.380768
20251026103836,124.513945,45.380733
20251026103846,124.513959,45.380734
20251026103856,124.513959,45.380734
20251026103906,124.513959,45.380734
20251026103916,124.513894,45.380671
20251026103926,124.513887,45.380560
20251026103936,124.514099,45.380446
20251026103946,124.514490,45.380282
20251026103956,124.514862,45.380108
20251026104006,124.515180,45.379984
20251026104016,124.515323,45.379919
20251026104026,124.515639,45.379771
20251026104036,124.515870,45.379683
20251026104046,124.516119,45.379627
20251026104056,124.516296,45.379567
20251026104106,124.516377,45.379473
20251026104116,124.516219,45.379338
20251026104126,124.515954,45.379442
20251026104136,124.515714,45.379532
20251026104146,124.515694,45.379539
20251026104156,124.515694,45.379539
20251026104206,124.515694,45.379539
20251026104216,124.515694,45.379539
20251026104226,124.515711,45.379533
20251026104236,124.515718,45.379530
20251026104246,124.515459,45.379645
20251026104256,124.515240,45.379722
20251026104306,124.515240,45.379722
20251026104316,124.515240,45.379722
20251026104326,124.515240,45.379722
20251026104336,124.515240,45.379722
20251026104346,124.515240,45.379722
20251026104356,124.515240,45.379722
20251026104406,124.515240,45.379722
20251026104416,124.515053,45.379805
20251026104426,124.514792,45.379930
20251026104436,124.514479,45.380035
20251026104446,124.514084,45.380181
20251026104456,124.513976,45.380221
20251026104506,124.513671,45.380342
20251026104516,124.513589,45.380386
20251026104526,124.513585,45.380389
20251026104536,124.513583,45.380390
20251026104546,124.513581,45.380391
20251026104556,124.513553,45.380410
20251026104606,124.513512,45.380482
20251026104616,124.513378,45.380730
20251026104626,124.513122,45.381007
20251026104636,124.512816,45.381279
20251026104646,124.512519,45.381525
20251026104656,124.512261,45.381744
20251026104706,124.512008,45.381964
20251026104716,124.511707,45.382224
20251026104726,124.511408,45.382470
20251026104736,124.511059,45.382816
20251026104746,124.510654,45.383055
20251026104756,124.510159,45.383217
20251026104806,124.509592,45.383380
20251026104816,124.508979,45.383412
20251026104826,124.508399,45.383336
20251026104836,124.507906,45.383253
20251026104846,124.507496,45.383179
20251026104856,124.507040,45.383098
20251026104906,124.506566,45.383016
20251026104916,124.506020,45.382929
20251026110716,124.502423,45.377497
20251026110726,124.502356,45.377409
20251026110736,124.502331,45.377323
20251026110746,124.502309,45.377230
20251026110756,124.502283,45.377131
20251026110806,124.502269,45.377082
20251026110816,124.502243,45.376989
20251026110826,124.502233,45.377004
20251026110836,124.502217,45.377111
20251026110846,124.502216,45.377111
20251026110856,124.502216,45.377111
20251026110906,124.502216,45.377111
20251026110916,124.502216,45.377111
20251026110926,124.502216,45.377111
20251026110936,124.502216,45.377111
20251026110946,124.502216,45.377111
20251026110956,124.502216,45.377110
20251026111006,124.502217,45.377055
20251026111016,124.502226,45.376925
20251026111026,124.502204,45.376840
20251026111036,124.502177,45.376746
20251026111046,124.502148,45.376643
20251026111056,124.502147,45.376646
20251026111106,124.502128,45.376571
20251026111116,124.502106,45.376485
20251026111126,124.502083,45.376396
20251026111136,124.502079,45.376380
20251026111146,124.502055,45.376295
20251026111156,124.502050,45.376225
20251026111206,124.502046,45.376188
20251026111216,124.502068,45.376231
20251026111226,124.502087,45.376302
20251026111236,124.502111,45.376390
20251026111246,124.502134,45.376479
20251026111256,124.502157,45.376574
20251026111306,124.502185,45.376669
20251026111316,124.502214,45.376768
20251026111326,124.502240,45.376859
20251026111336,124.502268,45.376960
20251026111346,124.502294,45.377058
20251026111356,124.502321,45.377157
20251026111406,124.502346,45.377255
20251026111416,124.502339,45.377215
20251026111426,124.502430,45.377249
20251026111436,124.502393,45.377242
20251026111446,124.502392,45.377232
20251026111455,124.502376,45.377160
20251026111506,124.502355,45.377079
20251026111516,124.502330,45.376988
20251026111526,124.502304,45.376891
20251026111536,124.502275,45.376788
20251026111546,124.502248,45.376687
20251026111556,124.502218,45.376581
20251026111606,124.502187,45.376470
20251026111616,124.502157,45.376354
20251026111626,124.502127,45.376238
20251026111636,124.502157,45.376357
20251026111646,124.502135,45.376333
20251026111656,124.502116,45.376311
20251026111706,124.501985,45.376243
20251026111716,124.501803,45.376234
20251026111726,124.501616,45.376201
20251026111736,124.501426,45.376168
20251026111746,124.501354,45.376086
20251026111756,124.501333,45.376013
20251026111806,124.501307,45.375922
20251026111816,124.501282,45.375822
20251026111826,124.501255,45.375721
20251026111836,124.501226,45.375611
20251026111846,124.501197,45.375501
20251026111856,124.501172,45.375391
20251026111906,124.501164,45.375358
20251026111916,124.501148,45.375288
20251026111925,124.501238,45.375231
20251026111936,124.501231,45.375232
20251026111946,124.501173,45.375254
20251026111955,124.501174,45.375258
20251026112006,124.501174,45.375258
20251026112016,124.501174,45.375258
20251026112025,124.501187,45.375311
20251026112036,124.501205,45.375400
20251026112046,124.501229,45.375499
20251026112056,124.501256,45.375605
20251026112106,124.501286,45.375713
20251026112116,124.501315,45.375821
20251026112126,124.501341,45.375931
20251026112136,124.501372,45.376037
20251026112146,124.501402,45.376184
20251026112156,124.501496,45.376184
20251026112206,124.501470,45.376153
20251026112216,124.501426,45.376066
20251026112226,124.501402,45.375982
20251026112236,124.501380,45.375888
20251026112246,124.501378,45.375882
20251026112256,124.501355,45.375782
20251026112306,124.501325,45.375673
20251026112316,124.501298,45.375564
20251026112326,124.501266,45.375446
20251026112336,124.501237,45.375314
20251026112346,124.501219,45.375206
20251026112356,124.501219,45.375185
20251026112406,124.501214,45.375134
20251026112416,124.501215,45.375133
20251026112426,124.501206,45.375068
20251026112436,124.501208,45.375149
20251026112446,124.501208,45.375149
20251026112456,124.501208,45.375149
20251026112506,124.501208,45.375149
20251026112516,124.501208,45.375149
20251026112526,124.501208,45.375149
20251026112536,124.501208,45.375149
20251026112546,124.501208,45.375149
20251026112556,124.501208,45.375149
20251026112606,124.501208,45.375149
20251026112616,124.501188,45.375271
20251026112626,124.501211,45.375341
20251026112635,124.501215,45.375402
20251026112645,124.501215,45.375402
20251026112655,124.501215,45.375402
20251026112705,124.501215,45.375402
20251026112715,124.501215,45.375402
20251026112725,124.501215,45.375402
20251026112735,124.501215,45.375402
20251026112745,124.501215,45.375402
20251026112755,124.501215,45.375402
20251026112805,124.501216,45.375412
20251026112815,124.501076,45.375455
20251026112825,124.501056,45.375362
20251026112835,124.501051,45.375245
20251026112845,124.501052,45.375245
20251026112855,124.501051,45.375245
20251026112905,124.501052,45.375245
20251026112915,124.501052,45.375245
20251026112925,124.501052,45.375245
20251026112935,124.501058,45.375046
20251026112945,124.501026,45.374737
20251026112955,124.500997,45.374437
20251026113005,124.500950,45.374151
20251026113015,124.500915,45.373834
20251026113025,124.500882,45.373518
20251026113035,124.500774,45.373212
20251026113045,124.500600,45.373050
20251026113055,124.500622,45.373051
20251026113105,124.500621,45.373051
20251026113115,124.500613,45.373052
20251026113125,124.500613,45.373052
20251026113135,124.500612,45.373051
20251026113145,124.500612,45.373051
20251026113155,124.500612,45.373051
20251026113205,124.500605,45.373052
20251026113215,124.500713,45.373048
20251026113225,124.500753,45.373047
20251026113235,124.500611,45.373214
20251026113245,124.500646,45.373244
20251026113255,124.500645,45.373244
20251026114822,124.500646,45.373244
20251026114832,124.500657,45.373224
20251026114842,124.500655,45.373226
20251026114852,124.500654,45.373231
20251026114902,124.500654,45.373233
20251026114912,124.500655,45.373235
20251026114922,124.500664,45.373214
20251026114932,124.500665,45.373217
20251026114942,124.500665,45.373222
20251026114952,124.500663,45.373226
20251026115002,124.500660,45.373227
20251026115012,124.500658,45.373226
20251026115022,124.500654,45.373216
20251026115032,124.500654,45.373220
20251026115042,124.500656,45.373224
20251026115052,124.500657,45.373229
20251026115102,124.500659,45.373232
20251026115112,124.500660,45.373232
20251026115122,124.500656,45.373212
20251026115132,124.500652,45.373213
20251026115142,124.500649,45.373216
20251026115152,124.500647,45.373225
20251026115202,124.500684,45.373108
20251026115212,124.500362,45.373049
20251026115222,124.500191,45.372936
20251026115232,124.500204,45.372704
20251026115242,124.500249,45.372258
20251026115252,124.500300,45.371801
20251026115302,124.500288,45.371147
20251026115312,124.500229,45.370479
20251026115322,124.500184,45.369804
20251026115332,124.500149,45.369130
20251026115342,124.500111,45.368390
20251026115352,124.500018,45.367624
20251026115402,124.499884,45.366823
20251026115412,124.499731,45.366062
20251026115422,124.499591,45.365406
20251026115432,124.499429,45.364674
20251026115442,124.499639,45.364006
20251026115452,124.500085,45.363408
20251026115502,124.500429,45.362926
20251026115512,124.500509,45.362805
20251026115522,124.500454,45.362284
20251026115532,124.500580,45.361714
20251026115542,124.500995,45.361238
20251026115552,124.501799,45.361064
20251026115602,124.502405,45.360576
20251026115612,124.502953,45.359957
20251026115622,124.503461,45.359364
20251026115632,124.503460,45.358707
20251026115642,124.503115,45.358362
20251026115652,124.502644,45.358004
20251026115702,124.502217,45.357489
20251026115712,124.501722,45.356886
20251026115722,124.501321,45.356324
20251026115732,124.501083,45.355794
20251026115742,124.500815,45.355186
20251026115752,124.500599,45.354574
20251026115802,124.500351,45.353935
20251026115812,124.500326,45.353881
20251026115822,124.500326,45.353881
20251026115832,124.500321,45.353867
20251026115842,124.500199,45.353531
20251026115852,124.499857,45.352911
20251026115902,124.499417,45.352301
20251026115912,124.498962,45.351677
20251026115922,124.498767,45.351037
20251026115932,124.498741,45.350608
20251026115942,124.498689,45.350260
20251026115952,124.498668,45.349864
20251026120002,124.498673,45.349261
20251026120012,124.498719,45.348655
20251026120022,124.498651,45.348035
20251026120032,124.498534,45.347386
20251026120042,124.498231,45.346884
20251026120052,124.498125,45.346678
20251026120102,124.498041,45.346249
20251026120112,124.498577,45.345591
20251026120122,124.498906,45.345172
20251026120132,124.499417,45.344621
20251026120142,124.499962,45.344025
20251026120152,124.500387,45.343543
20251026120202,124.500738,45.343217
20251026120212,124.501089,45.342808
20251026120222,124.501512,45.342726
20251026120232,124.502016,45.342493
20251026120242,124.502419,45.342262
20251026120252,124.502784,45.341741
20251026120302,124.503203,45.341728
20251026120312,124.503735,45.341889
20251026120322,124.504188,45.341972
20251026120332,124.504545,45.342075
20251026120342,124.504552,45.342070
20251026120352,124.504518,45.342077
20251026120402,124.504465,45.342087
20251026120412,124.504387,45.342124</textarea>
            <div class="button-group">
                <button id="drawTrackButton" disabled style="flex: 1;">绘制轨迹</button>
                <button id="showTrackPointsButton" disabled style="flex: 1;" class="btn-warning">打点</button>
                <button id="clearTrackButton" disabled style="flex: 1;">清空轨迹</button>
            </div>
            <!-- 轨迹颜色选择器 -->
            <div class="color-picker-container" style="margin-top:8px;">
                <div style="margin-bottom:6px;font-size:12px;color:#333;">轨迹颜色设置：</div>
                <div style="display:flex;align-items:center;gap:8px;">
                    <div style="display:flex;align-items:center;gap:4px;">
                        <label style="font-size:12px;">轨迹线颜色:</label>
                        <div id="trackLineColorPicker" class="color-picker" style="width:24px;height:24px;border:1px solid #ccc;cursor:pointer;background-color:#FF0000;"></div>
                        <input type="color" id="trackLineColorInput" value="#FF0000" style="display:none;">
                    </div>
                    <div style="display:flex;align-items:center;gap:4px;">
                        <label style="font-size:12px;">轨迹点颜色:</label>
                        <div id="trackPointColorPicker" class="color-picker" style="width:24px;height:24px;border:1px solid #ccc;cursor:pointer;background-color:#68EAF3;"></div>
                        <input type="color" id="trackPointColorInput" value="#68EAF3" style="display:none;">
                    </div>
                </div>
            </div>
            <!-- 回放控制 -->
            <div class="split-section" style="margin-top:8px;">
                <div class="title">轨迹回放</div>
                <div class="playback-actions" style="display:flex;gap:8px;margin-bottom:8px;">
                    <button id="playbackStartBtn" disabled>开始</button>
                    <button id="playbackPauseBtn" disabled>继续</button>
                    <button id="playbackStopBtn" disabled>结束</button>
                </div>
                <div class="playback-speed" style="display:flex;align-items:center;gap:8px;margin-bottom:8px;">
                    <label>速度：
                        <select id="playbackSpeedSelect" disabled>
                            <option value="1" selected>1×</option>
                            <option value="2">2×</option>
                            <option value="4">4×</option>
                            <option value="8">8×</option>
                            <option value="16">16×</option>
                            <option value="32">32×</option>
                            <option value="64">64×</option>
                            <option value="128">128×</option>
                            <option value="256">256×</option>
                            <option value="512">512×</option>
                            <option value="1024">1024×</option>
                        </select>
                    </label>
                    <span id="playbackTimeLabel" style="font-size:12px;color:#666;">时间：—</span>
                </div>
                <div class="playback-time" style="display:flex;flex-direction:column;gap:4px;margin-bottom:8px;">
                    <label class="playback-time-label" style="display:flex;align-items:center;gap:8px;flex:1 1 auto;min-width:0;">
                        <span class="playback-time-text" style="white-space:nowrap;">起始时间：</span>
                        <input type="range" id="playbackTimeSlider" disabled min="0" max="0" step="1000" value="0" style="flex:1 1 auto;min-width:0;max-width:100%;vertical-align:middle;">
                    </label>
                    <span id="playbackTimeCursor" style="font-size:12px;color:#666;align-self:flex-end;">—</span>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    let map;
    let currentPolygons = []; // 存储多边形和其标签
    let currentTracks = []; // 存储轨迹折线及相关覆盖物
    let mapLoaded = false;
    let mapLabelHandlers = []; // 存储地图事件处理器
    let labelsEnabled = false; // 标签显示开关（默认关闭）
    let isDrawing = false; // 绘制进行中防止重复点击
    let currentMapType = 'satellite'; // 当前地图类型：'satellite'（卫星图）或'street'（街道图）

    window.onload = function () {
        if (typeof T === 'undefined') {
            alert("天地图API加载失败，请检查网络或密钥！");
            return;
        }
        initMap();
        bindDrawEvent();
        bindMinimizeEvent();
        bindTabs();
        bindBatchGenerator();
        bindMultiSplitter();
        bindLabelsToggle(); // 绑定标签显示开关
        bindTrackEvents();  // 绑定轨迹绘制与清空
        bindPlaybackControls(); // 绑定轨迹回放
        bindMeasureEvents(); // 绑定测量功能
        bindMapTypeEvent(); // 绑定地图类型切换功能
        initColorPickers(); // 初始化颜色选择器
    };

    function initMap() {
        showLoading();
        disableButtons(true);

        try {
            map = new T.Map("mapContainer", {
                zoom: 12,
                center: new T.LngLat(116.40769, 39.90403)
            });

            // 已移除测试标签
            map.enableScrollWheelZoom();

            // 不再添加地图类型控件到地图，改为使用左侧工具条按钮切换
            // const mapTypeCtrl = new T.Control.MapType({
            //     mapTypes: [TMAP_NORMAL_MAP, TMAP_SATELLITE_MAP, TMAP_TERRAIN_MAP],
            //     position: T_ANCHOR_TOP_LEFT
            // });
            // map.addControl(mapTypeCtrl);

            // 加载影像底图（卫星）
            const tk = "9ed3674d01dd7c129ab38e3c38bf651a";

            // 方案1：使用默认地图类型（作为备选）
            map.setMapType(TMAP_SATELLITE_MAP);
            currentMapType = 'satellite';
            updateMapTypeButton('卫星图');

            // 方案2：手动添加影像图层（底图 + 标注）
            const vecLayer = new T.TileLayer(`https://t0.tianditu.gov.cn/img_w/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=img&STYLE=default&TILEMATRIXSET=w&FORMAT=tiles&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}&tk=${tk}`);
            const cvaLayer = new T.TileLayer(`https://t0.tianditu.gov.cn/cia_w/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=cia&STYLE=default&TILEMATRIXSET=w&FORMAT=tiles&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}&tk=${tk}`);

            // 添加图层并监听加载状态
            vecLayer.addEventListener("load", function () {
                console.log("影像底图加载完成");
            });

            vecLayer.addEventListener("error", function (e) {
                console.error("影像底图加载错误:", e);
                alert("影像底图加载错误，将使用默认地图类型");
            });

            map.addLayer(vecLayer);
            map.addLayer(cvaLayer);

            // 监听地图加载事件
            map.addEventListener("loaded", function () {
                console.log("地图加载完成");
                markMapLoaded();
            });
            map.addEventListener("load", function () {
                console.log("地图load事件触发");
                markMapLoaded();
            });
            map.addEventListener("tilesloaded", function () {
                console.log("地图瓦片加载完成");
                markMapLoaded();
            });
            // 监听地图加载失败事件
            map.addEventListener("error", function (e) {
                console.error("地图加载错误:", e);
                alert("地图加载错误: " + e.message);
                hideLoading();
            });

            // 监听地图移动事件，用于更新标签位置
            const moveHandler = function () {
                updateAllLabelsPosition();
            };
            map.addEventListener("move", moveHandler);
            map.addEventListener("zoom", moveHandler);

            // 存储事件处理器，用于清理
            mapLabelHandlers.push({ event: "move", handler: moveHandler });
            mapLabelHandlers.push({ event: "zoom", handler: moveHandler });

            // 超时容错
            setTimeout(() => {
                if (!mapLoaded) markMapLoaded();
            }, 8000);

        } catch (error) {
            alert("地图初始化失败：" + error.message);
            console.error(error);
            hideLoading();
        }
    }

    function markMapLoaded() {
        if (!mapLoaded) {
            mapLoaded = true;
            hideLoading();
            // 不再禁用按钮，保持按钮始终可用
            // disableButtons(false);
            disableTrackButtons(false);
            // 仅开启速度选择，回放按钮按状态控制
            const speedSel = document.getElementById('playbackSpeedSelect');
            if (speedSel) speedSel.disabled = false;
            updatePlaybackButtonsState('idle');
        }
    }

    function showLoading() {
        const loading = document.getElementById("mapLoading");
        loading.style.display = "flex";
        loading.style.opacity = "1";
    }

    function hideLoading() {
        const loading = document.getElementById("mapLoading");
        loading.style.opacity = "0";
        setTimeout(() => loading.style.display = "none", 300);
    }

    function disableButtons(disabled) {
        // 不再禁用按钮，保持按钮始终可用
        // document.getElementById("drawButton").disabled = disabled;
        // document.getElementById("clearButton").disabled = disabled;
    }

    function disableTrackButtons(disabled) {
        const drawTrackBtn = document.getElementById("drawTrackButton");
        const showTrackPointsBtn = document.getElementById("showTrackPointsButton");
        const clearTrackBtn = document.getElementById("clearTrackButton");
        if (drawTrackBtn) drawTrackBtn.disabled = disabled;
        if (showTrackPointsBtn) showTrackPointsBtn.disabled = disabled;
        if (clearTrackBtn) clearTrackBtn.disabled = disabled;
    }
    // 回放控件的禁用/启用
    function disablePlaybackButtons(disabled) {
        ["playbackStartBtn","playbackPauseBtn","playbackStopBtn","playbackSpeedSelect","playbackTimeSlider"].forEach(id=>{
            const el = document.getElementById(id);
            if (el) el.disabled = disabled;
        });
    }

    // 回放按钮状态管理：空闲/播放/暂停
    function updatePlaybackButtonsState(state){
        try {
            const startBtn = document.getElementById('playbackStartBtn');
            const pauseBtn = document.getElementById('playbackPauseBtn');
            const stopBtn = document.getElementById('playbackStopBtn');
            if (!startBtn || !pauseBtn || !stopBtn) return;
            if (state === 'idle') {
                startBtn.disabled = false;
                pauseBtn.disabled = true;
                stopBtn.disabled = true;
                pauseBtn.textContent = '继续';
            } else if (state === 'playing') {
                startBtn.disabled = true;
                pauseBtn.disabled = false;
                stopBtn.disabled = false;
                pauseBtn.textContent = '暂停';
            } else if (state === 'paused') {
                startBtn.disabled = true;
                pauseBtn.disabled = false;
                stopBtn.disabled = false;
                pauseBtn.textContent = '继续';
            }
        } catch(e) { console.warn('更新按钮状态失败:', e); }
    }

    function bindDrawEvent() {
        document.getElementById("drawButton").addEventListener("click", function () {
            if (isDrawing) { console.log('绘制进行中，忽略重复点击'); return; }
            isDrawing = true;
            showLoading();
            try {
                const wktText = document.getElementById("wktTextarea").value.trim();
                if (!wktText) { alert("请输入WKT字符串！"); return; }
                
                clearOverlays();
                
                // 检查是否为多行WKT
                const wktLines = wktText.split('\n').filter(line => line.trim());
                let polygonData = [];
                
                if (wktLines.length === 1) {
                    // 单行WKT - 使用原始逻辑
                    const geojson = parseWkt(wktLines[0].trim());
                    if (geojson.type === "Polygon") {
                        polygonData.push({ index: 1, coordinates: geojson.coordinates, colorIndex: 0 });
                    } else if (geojson.type === "MultiPolygon") {
                        geojson.coordinates.forEach((polygon, index) => {
                            polygonData.push({ index: index + 1, coordinates: polygon, colorIndex: index });
                        });
                    }
                } else {
                    // 多行WKT - 每行一个多边形
                    wktLines.forEach((line, index) => {
                        if (line.trim()) {
                            try {
                                const geojson = parseWkt(line.trim());
                                if (geojson.type === "Polygon") {
                                    polygonData.push({ index: index + 1, coordinates: geojson.coordinates, colorIndex: index });
                                } else if (geojson.type === "MultiPolygon") {
                                    // 如果一行是MultiPolygon，拆分成多个Polygon
                                    geojson.coordinates.forEach((polygon, subIndex) => {
                                        polygonData.push({ 
                                            index: index + 1 + subIndex * 0.1, 
                                            coordinates: polygon, 
                                            colorIndex: index 
                                        });
                                    });
                                }
                            } catch (e) {
                                console.warn(`第${index + 1}行WKT解析失败:`, e);
                            }
                        }
                    });
                }
                
                // 重置并绘制
                polygonInfoList = [];
                polygonData.forEach(pd => processPolygon(pd.index, pd.coordinates, pd.colorIndex));
    
                // 视图居中到所有已绘制轮廓
                try { fitViewportToPolygons(); } catch (e) { console.warn('视图居中失败', e); }
    
                // 在视图稳定后再创建/更新标签
                setTimeout(() => {
                    if (labelsEnabled) {
                        try {
                            createAllLabels();
                            updateAllLabelsPosition();
                        } catch (e) {
                            console.warn('创建或更新标签失败:', e);
                        }
                    }
                }, 150);
            } catch (e) {
                alert('绘制失败：' + (e && e.message ? e.message : e));
                console.error('绘制异常:', e);
            } finally {
                hideLoading();
                isDrawing = false;
                // 不再禁用按钮，保持按钮始终可用
                // disableButtons(false);
            }
        });

        document.getElementById("clearButton").addEventListener("click", function () {
            if (isDrawing) { console.log('绘制进行中，暂不清空'); return; }
            clearOverlays();
            console.log("已清空所有轮廓");
        });
    }

    // 存储多边形数据，用于后续标签创建
    let polygonInfoList = [];

    // 处理单个多边形的绘制和面积计算
    function processPolygon(actualPolygonIndex, polygonCoords, colorIndex = 0) {
        console.log('开始处理多边形', actualPolygonIndex);

        // 根据颜色索引获取颜色方案
        const colorScheme = polygonColors[colorIndex % polygonColors.length];

        // 坐标系选择（绘制始终使用WGS84坐标）
        const coordSys = (document.getElementById('coordSysSelect') && document.getElementById('coordSysSelect').value) || 'wgs84';

        // 统一转换为WGS84用于绘制与面积计算
        function toWgs(point){
            const lng = point[0], lat = point[1];
            if (coordSys === 'wgs84' || coordSys === 'cgcs2000') {
                return [lng, lat];
            } else if (coordSys === 'gcj02') {
                const w = gcj02ToWgs84(lng, lat);
                return [w.lng, w.lat];
            } else if (coordSys === 'bd09') {
                const gcj = bd09ToGcj02(lng, lat);
                const w = gcj02ToWgs84(gcj.lng, gcj.lat);
                return [w.lng, w.lat];
            }
            return [lng, lat];
        }
        const coordsWGS84 = polygonCoords.map(ring => ring.map(toWgs));
        let outerRingWGS = coordsWGS84[0] || [];

        // 生成用于绘制的坐标（直接使用WGS84坐标）
        const rings = coordsWGS84.map(ring => ring.map(([lng, lat]) => new T.LngLat(lng, lat)));


         // 创建半透明填充的多边形（无边框）
          const polygon = new T.Polygon(rings, {
              color: colorScheme.outline,
              weight: 1,
              opacity: 1,
              fillColor: colorScheme.fill,
              fillOpacity: colorScheme.opacity
          });
 
          // 使用WGS84坐标计算面积（更准确的面积计算）
         let areaSqm;
         let areaMu;



         try {
             // 检查Turf.js是否可用
             if (typeof turf !== 'undefined' && turf.area) {
                 // 使用Turf.js计算多边形面积
                // 构造GeoJSON格式的多边形
                const geoJsonPolygon = {
                    type: "Polygon",
                    coordinates: coordsWGS84
                };


                 // 使用Turf.js计算面积（平方米）
                 areaSqm = turf.area(geoJsonPolygon);
                 areaMu = (areaSqm / 666.6667).toFixed(4); // 转换为亩
                 console.log(`多边形${actualPolygonIndex}面积计算结果(Turf.js): ${areaSqm}平方米 = ${areaMu}亩`);
             } else {
                 // 如果Turf.js不可用，回退到之前的计算方法
                 console.warn('Turf.js不可用，使用备用计算方法');
                 // 计算带孔洞的多边形面积
                 areaSqm = 0;
                 // 计算外环面积
                 outerRingWGS = coordsWGS84[0] || [];
                 areaSqm += calculatePolygonArea(outerRingWGS);

                 // 减去内环（孔洞）面积
                 for (let i = 1; i < coordsWGS84.length; i++) {
                     const innerRingArea = calculatePolygonArea(coordsWGS84[i]);
                     areaSqm -= innerRingArea;
                 }

                  areaMu = (areaSqm / 666.6667).toFixed(4); // 使用更精确的转换系数
                  console.log(`多边形${actualPolygonIndex}面积计算结果(备用): ${areaSqm}平方米 = ${areaMu}亩`);
              }
          } catch (error) {
              console.error(`面积计算失败:`, error);
              areaSqm = 0;
              areaMu = '0.0000';
          }

          // 计算多边形的中心点和底部中心点（WGS84）
          const centerPoint = calculatePolygonCenter(outerRingWGS);
          const bottomCenterPoint = calculatePolygonBottomCenter(outerRingWGS);

          // 添加多边形到地图
          if (map) {
              map.addOverLay(polygon);
              console.log(`多边形${actualPolygonIndex}已添加到地图`);
          } else {
              console.error('地图对象不存在');
          }

          // 存储多边形信息，用于后续标签创建
          polygonInfoList.push({
              index: actualPolygonIndex,
              polygon: polygon,
              area: areaMu,
              bottomCenter: { lng: bottomCenterPoint.lng, lat: bottomCenterPoint.lat },
              ringPoints: rings
          });
      }

    // 视图居中：根据已绘制的GCJ-02点
    function fitViewportToPolygons() {
        const points = [];
        try {
            if (!map || !map.setViewport) return;
            polygonInfoList.forEach(info => {
                if (!info || !info.ringPoints) return;
                info.ringPoints.forEach(ring => {
                    ring.forEach(ll => points.push(ll));
                });
            });
            if (!points.length) return;
            map.setViewport(points);
        } catch (e) {
            try {
                const lngs = points.map(p => p.lng);
                const lats = points.map(p => p.lat);
                const center = new T.LngLat(
                    (Math.min(...lngs) + Math.max(...lngs)) / 2,
                    (Math.min(...lats) + Math.max(...lats)) / 2
                );
                if (map && map.panTo) map.panTo(center);
            } catch (e2) {
                console.warn('视图居中失败:', e2);
            }
        }
    }

    // 统一创建所有多边形的标签
    function createAllLabels() {
        const mapContainer = document.getElementById('mapContainer');
        if (!mapContainer || !map) return;

        polygonInfoList.forEach(info => {
            if (!info) return;
            // 防止重复创建
            if (info.labelRef) return;
            // 创建标签元素
            const labelDiv = document.createElement('div');
            labelDiv.className = 'area-label';
            labelDiv.innerHTML = `地块${info.index}：${info.area}亩`;

            // 添加到地图容器并根据屏幕边界定位到轮廓下方
            mapContainer.appendChild(labelDiv);
            positionLabelForPolygon(labelDiv, info);

            // 记录引用，避免重复创建
            info.labelRef = labelDiv;

            // 存储到 currentPolygons 以复用现有定位/清理逻辑
            const labelObj = {
                domElement: labelDiv,
                isDomLabel: true,
                polygonInfo: info
            };
            currentPolygons.push({ polygon: info.polygon, label: labelObj });
        });

        // 不清空 polygonInfoList，便于开关随时创建/隐藏标签
    }

    // 根据多边形屏幕边界定位标签，保证始终在轮廓下方
    function positionLabelForPolygon(labelDiv, info) {
        if (!map || !info || !info.ringPoints) return;
        const points = [];
        info.ringPoints.forEach(ring => {
            ring.forEach(ll => {
                const p = map.lngLatToContainerPoint(ll);
                points.push(p);
            });
        });
        if (!points.length) return;
        const minX = Math.min(...points.map(p => p.x));
        const maxX = Math.max(...points.map(p => p.x));
        const maxY = Math.max(...points.map(p => p.y));
        const container = document.getElementById('mapContainer');
        const labelWidth = labelDiv.offsetWidth;
        const labelHeight = labelDiv.offsetHeight;
        const targetLeft = Math.round((minX + maxX) / 2 - labelWidth / 2);
        const targetTop = Math.round(maxY + 6);
        const clampedLeft = Math.max(0, Math.min(targetLeft, container.clientWidth - labelWidth));
        const clampedTop = Math.max(0, Math.min(targetTop, container.clientHeight - labelHeight));
        labelDiv.style.left = clampedLeft + 'px';
        labelDiv.style.top = clampedTop + 'px';
    }

    // 更新所有标签位置（地图move/zoom时调用）
    function updateAllLabelsPosition() {
        try {
            if (!map) return;
            const container = document.getElementById('mapContainer');
            if (!container) return;
            currentPolygons.forEach(item => {
                if (!item || !item.label) return;
                const labelObj = item.label;
                if (labelObj.isDomLabel && labelObj.domElement && labelObj.polygonInfo) {
                    // 确保标签在容器中
                    if (!labelObj.domElement.parentNode) {
                        container.appendChild(labelObj.domElement);
                    }
                    positionLabelForPolygon(labelObj.domElement, labelObj.polygonInfo);
                }
            });
        } catch (e) {
            console.warn('更新标签位置时出错:', e);
        }
    }
    // 确保在全局可用（处理第三方库事件回调作用域差异）
    window.updateAllLabelsPosition = updateAllLabelsPosition;

    // 绑定“显示亩数标签”开关（默认隐藏）
    function bindLabelsToggle() {
        const cb = document.getElementById('toggleLabelsCheckbox');
        const container = document.getElementById('mapContainer');
        if (!cb || !container) return;
        // 默认隐藏标签
        container.classList.add('labels-hidden');
        cb.addEventListener('change', () => {
            labelsEnabled = cb.checked;
            if (labelsEnabled) {
                container.classList.remove('labels-hidden');
                const hasAnyLabel = currentPolygons.some(item => item && item.label && item.label.domElement);
                if (!hasAnyLabel) {
                    try { createAllLabels(); } catch (e) { console.warn('创建标签失败:', e); }
                }
                updateAllLabelsPosition();
            } else {
                container.classList.add('labels-hidden');
            }
        });
    }

    /**
     * 计算多边形中心点（比底部中心更适合显示标签）
     */
    function calculatePolygonCenter(outerRing) {
        let sumLng = 0, sumLat = 0;
        const len = outerRing.length;

        for (let i = 0; i < len; i++) {
            sumLng += outerRing[i][0];
            sumLat += outerRing[i][1];
        }

        return {
            lng: sumLng / len,
            lat: sumLat / len
        };
    }

    /**
     * 计算多边形面积（球面多边形面积计算）
     * 使用更准确的球面坐标面积计算方法，确保面积与视觉大小一致
     */
    function calculatePolygonArea(coordinates) {
        // 地球半径（米）- 使用更精确的值
        const R = 6371000.8;
        const n = coordinates.length;

        // 将所有坐标转换为弧度
        const coordsRad = coordinates.map(point => [
            point[0] * Math.PI / 180,
            point[1] * Math.PI / 180
        ]);

        let areaRad = 0;

        // 使用更准确的球面多边形面积公式（Girard定理）
        for (let i = 0; i < n; i++) {
            const j = (i + 1) % n;
            const lon1 = coordsRad[i][0];
            const lat1 = coordsRad[i][1];
            const lon2 = coordsRad[j][0];
            const lat2 = coordsRad[j][1];

            // 计算球面多边形面积增量
            const dlon = lon2 - lon1;
            const sinLat1 = Math.sin(lat1);
            const sinLat2 = Math.sin(lat2);
            const cosLat1 = Math.cos(lat1);
            const cosLat2 = Math.cos(lat2);

            // 使用更精确的公式
            areaRad += dlon * (sinLat1 * cosLat2 * Math.cos(dlon / 2) + sinLat2 * cosLat1);
        }

        // 计算总面积（平方米）
        const areaSqm = Math.abs(areaRad) * R * R * 0.5;

        return areaSqm;
    }

    /**
     * 清空所有多边形和标签（同时处理 polygonInfoList 与 currentPolygons）
     */
    function clearOverlays() {
        try {
            // 先移除 polygonInfoList 中记录的多边形与其DOM标签
            polygonInfoList.forEach(info => {
                if (info && info.polygon && map && map.removeOverLay) {
                    try { map.removeOverLay(info.polygon); } catch (e) { console.warn('移除多边形失败:', e); }
                }
                if (info && info.labelRef && info.labelRef.parentNode) {
                    try { info.labelRef.parentNode.removeChild(info.labelRef); } catch (e) { console.warn('移除DOM标签失败:', e); }
                    info.labelRef = null;
                }
            });

            // 再处理 currentPolygons（兼容旧路径与标签对象）
            currentPolygons.forEach(item => {
                if (item.polygon && map && map.removeOverLay) {
                    try { map.removeOverLay(item.polygon); } catch (e) { console.warn('移除多边形失败:', e); }
                }
                if (item.label) {
                    if (item.label.domElement && item.label.domElement.parentNode) {
                        try { item.label.domElement.parentNode.removeChild(item.label.domElement); } catch (e) { console.warn('移除DOM标签失败:', e); }
                    } else if (map && map.removeOverLay && !item.label.isDomLabel) {
                        try { map.removeOverLay(item.label); } catch (e) { console.warn('移除地图覆盖物标签失败:', e); }
                    }
                }
            });

            // 清空记录数组
            currentPolygons = [];
            polygonInfoList = [];

            console.log('已清空所有多边形和标签（保留事件监听器）');
        } catch (error) {
            console.error('清空覆盖物时出错:', error);
        }
    }

    // 其他辅助函数（保持不变）
    function bindMinimizeEvent() {
        const container = document.querySelector(".wkt-input-container");
        const btn = document.getElementById("minimizeBtn");
        const minIcon = btn?.querySelector(".min-icon");
        const restoreIcon = btn?.querySelector(".restore-icon");

        btn?.addEventListener("click", () => {
            const minimized = container.classList.toggle("minimized");
            if (minIcon && restoreIcon) {
                if (minimized) {
                    minIcon.style.display = "none";
                    restoreIcon.style.display = "";
                } else {
                    minIcon.style.display = "";
                    restoreIcon.style.display = "none";
                }
            }
        });
    }

    // 在脚本内部补充：页签切换（3个页签）
     function bindTabs() {
         const tabs = [
             { btn: document.getElementById('tabDrawBtn'), pane: document.getElementById('tabDraw'), key: 'draw' },
             { btn: document.getElementById('tabTrackBtn'), pane: document.getElementById('tabTrack'), key: 'track' },
             { btn: document.getElementById('tabSplitBtn'), pane: document.getElementById('tabSplit'), key: 'split' },
             { btn: document.getElementById('tabBatchBtn'), pane: document.getElementById('tabBatch'), key: 'batch' },
         ];
         if (tabs.some(t => !t.btn || !t.pane)) return;
         function activate(key) {
             tabs.forEach(t => {
                 const active = t.key === key;
                 t.btn.classList.toggle('active', active);
                 t.pane.classList.toggle('active', active);
             });
         }
         tabs.forEach(t => t.btn.addEventListener('click', () => activate(t.key)));
         activate('draw');
     }
    function updateParserStatus() {
        const el = document.getElementById('parserStatus');
        if (!el) return;
        const ok = (typeof Terraformer !== 'undefined' && Terraformer.WKT && typeof Terraformer.WKT.parse === 'function');
        if (ok) {
            el.textContent = 'Terraformer WKT Parser';
            el.style.color = '#2f8f2f';
        } else {
            el.textContent = '本地回退解析（仅支持POLYGON/MULTIPOLYGON）';
            el.style.color = '#c77d1e';
        }
    }
     function parseWkt(wkt) {
         wkt = wkt.trim();
         // 优先使用成熟库（Terraformer WKT Parser）
         if (typeof Terraformer !== 'undefined' && Terraformer.WKT && Terraformer.WKT.parse) {
             try {
                 return Terraformer.WKT.parse(wkt);
             } catch (e) {
                 console.warn('Terraformer解析失败，尝试本地回退解析:', e);
             }
         } else {
             // 不再提示“未加载”，由状态栏展示回退信息
         }
         // 回退解析：仅支持 POLYGON / MULTIPOLYGON
         const typeMatch = wkt.match(/^\s*(POLYGON|MULTIPOLYGON)\s*\(/i);
         if (!typeMatch) throw new Error('仅支持POLYGON/MULTIPOLYGON');
         const type = typeMatch[1].toUpperCase();
         const inner = wkt.substring(wkt.indexOf('('));
         if (type === 'POLYGON') {
             const coords = parsePolygonCoords(inner.replace(/^\(/, '').replace(/\)$/, ''));
             return { type: 'Polygon', coordinates: coords };
         } else {
             const trimmed = inner.replace(/^\(\(/, '').replace(/\)\)$/, '');
             const coords = parseMultiPolygonCoords(trimmed);
             return { type: 'MultiPolygon', coordinates: coords };
         }
     }

     function bindMultiSplitter() {
         const input = document.getElementById('multiInput');
         const output = document.getElementById('polyOutput');
         const splitBtn = document.getElementById('splitMultiBtn');
         const copyBtn = document.getElementById('copyPolysBtn');
         if (!input || !output || !splitBtn || !copyBtn) return;

         // 本地WKT序列化辅助
         function ringToText(ring) {
             if (!ring || !ring.length) return '()';
             const first = ring[0];
             const last = ring[ring.length - 1];
             const closed = (first[0] === last[0] && first[1] === last[1]) ? ring : ring.concat([[first[0], first[1]]]);
             return '(' + closed.map(pt => pt[0] + ' ' + pt[1]).join(', ') + ')';
         }
         function toWktPolygonCoords(coords) {
             return 'POLYGON(' + coords.map(ringToText).join(', ') + ')';
         }
         function toWktMulti(coords) {
             return 'MULTIPOLYGON(' + coords.map(poly => '(' + poly.map(ringToText).join(', ') + ')').join(', ') + ')';
         }

         function polygonsFromMulti(text) {
             const geo = parseWkt(text.trim());
             if (geo.type !== 'MultiPolygon') throw new Error('请输入有效的 MULTIPOLYGON WKT');
             const polys = geo.coordinates.map(rings => toWktPolygonCoords(rings));
             return polys;
         }
         splitBtn.addEventListener('click', () => {
             try {
                 const list = polygonsFromMulti(input.value.trim());
                 output.value = list.join('\n');
             } catch (e) {
                 alert('分割失败：' + e.message);
             }
         });
         copyBtn.addEventListener('click', async () => {
             const val = output.value.trim();
             if (!val) { alert('没有可复制的结果'); return; }
             try { await navigator.clipboard.writeText(val); alert('已复制到剪贴板'); } catch (e) { console.warn('复制失败', e); }
         });
     }

     function bindBatchGenerator() {
         const batchInput = document.getElementById('batchInput');
         const output = document.getElementById('multiOutput');
         const genBtn = document.getElementById('generateMultiBtn');
         const copyBtn = document.getElementById('copyMultiBtn');

         // 本地WKT序列化辅助（与分割器保持一致）
         function ringToText(ring) {
             if (!ring || !ring.length) return '()';
             const first = ring[0];
             const last = ring[ring.length - 1];
             const closed = (first[0] === last[0] && first[1] === last[1]) ? ring : ring.concat([[first[0], first[1]]]);
             return '(' + closed.map(pt => pt[0] + ' ' + pt[1]).join(', ') + ')';
         }
         function toWktMulti(coords) {
             return 'MULTIPOLYGON(' + coords.map(poly => '(' + poly.map(ringToText).join(', ') + ')').join(', ') + ')';
         }

         genBtn.addEventListener('click', () => {
             try {
                 const lines = batchInput.value.trim().split(/\n|;/).map(s => s.trim()).filter(Boolean);
                 if (lines.length === 0) throw new Error('请按每行或分号输入至少一个POLYGON');
                 const polygons = lines.map((line, idx) => {
                     const g = parseWkt(line);
                     if (g.type !== 'Polygon') throw new Error(`第${idx + 1}行不是有效的POLYGON WKT`);
                     return g;
                 });
                 const multiGeo = { type: 'MultiPolygon', coordinates: polygons.map(p => p.coordinates) };
                 output.value = toWktMulti(multiGeo.coordinates);
             } catch (e) {
                 alert('生成失败：' + e.message);
             }
         });

         copyBtn.addEventListener('click', async () => {
             const val = output.value.trim();
             if (!val) { alert('没有可复制的结果'); return; }
             try { await navigator.clipboard.writeText(val); alert('已复制到剪贴板'); } catch (e) { console.warn('复制失败', e); }
         });

     }

     function setExampleWkt() {
         const exampleWkt = "MULTIPOLYGON(" +
             "(" +
             "(116.35 39.93, 116.39 39.93, 116.39 39.90, 116.35 39.90, 116.35 39.93)," + // 外环
             "(116.36 39.92, 116.38 39.92, 116.38 39.91, 116.36 39.91, 116.36 39.92)" +  // 内环
             ")," +
             "(" +
             "(116.40 39.95, 116.43 39.97, 116.46 39.96, 116.49 39.98, 116.52 39.95, 116.55 39.93, 116.58 39.94, 116.61 39.92, 116.64 39.95, 116.40 39.95)" +
             ")" +
             ")";
         document.getElementById("wktTextarea").value = exampleWkt;
     }

     function parsePolygonCoords(coordStr) {
         const ringStrs = coordStr.split(/\)\s*,\s*\(/).map(s => s.replace(/[()]/g, '').trim());
         const rings = [];
         ringStrs.forEach(ringStr => {
             const pts = ringStr.split(/,\s*/).map(pointStr => {
                 const [lng, lat] = pointStr.split(/\s+/).map(Number);
                 if (isNaN(lng) || isNaN(lat)) throw new Error("坐标格式错误：" + pointStr);
                 return [lng, lat];
             });
             // 自动拆分：如果一个ring中包含多次回到起点（闭合），则拆分为多个环
             // 兼容用户将外环与内环错误地写在同一对括号中的情况
             let start = 0;
             while (start < pts.length) {
                 const startPt = pts[start];
                 let closeIdx = -1;
                 for (let i = start + 1; i < pts.length; i++) {
                     if (pts[i][0] === startPt[0] && pts[i][1] === startPt[1]) {
                         closeIdx = i;
                         break;
                     }
                 }
                 if (closeIdx === -1) {
                     // 未找到闭合：将剩余点视为一个环，并强制闭合
                     const ring = pts.slice(start);
                     if (ring.length && (ring[0][0] !== ring[ring.length - 1][0] || ring[0][1] !== ring[ring.length - 1][1])) {
                         ring.push([ring[0][0], ring[0][1]]);
                     }
                     rings.push(ring);
                     break;
                 } else {
                     const ring = pts.slice(start, closeIdx + 1);
                     rings.push(ring);
                     start = closeIdx + 1;
                 }
             }
         });
         return rings;
     }

     function parseMultiPolygonCoords(coordStr) {
         const polygonStrs = coordStr.split(/\)\s*\)\s*,\s*\(\s*\(/).map(s => s.replace(/[()]/g, '').trim());
         return polygonStrs.map(polygonStr => parsePolygonCoords(polygonStr));
     }

     function wgs84ToGcj02(lng, lat) {
         const x_PI = 3.14159265358979324 * 3000.0 / 180.0;
         const PI = 3.1415926535897932384626;
         const a = 6378245.0;
         const ee = 0.00669342162296594323;

         if (outOfChina(lng, lat)) return { lng, lat };

         let dlat = transformLat(lng - 105.0, lat - 35.0);
         let dlng = transformLng(lng - 105.0, lat - 35.0);
         const radlat = lat / 180.0 * PI;
         let magic = Math.sin(radlat);
         magic = 1 - ee * magic * magic;
         const sqrtmagic = Math.sqrt(magic);
         dlat = (dlat * 180.0) / ((a * (1 - ee)) / (magic * sqrtmagic) * PI);
         dlng = (dlng * 180.0) / (a / sqrtmagic * Math.cos(radlat) * PI);

         return { lng: lng + dlng, lat: lat + dlat };

         function outOfChina(lng, lat) {
             return (lng < 72.004 || lng > 137.8347) || (lat < 0.8293 || lat > 55.8271);
         }

         function transformLat(x, y) {
             let ret = -100.0 + 2.0 * x + 3.0 * y + 0.2 * y * y + 0.1 * x * y + 0.2 * Math.sqrt(Math.abs(x));
             ret += (20.0 * Math.sin(6.0 * x * PI) + 20.0 * Math.sin(2.0 * x * PI)) * 2.0 / 3.0;
             ret += (20.0 * Math.sin(y * PI) + 40.0 * Math.sin(y / 3.0 * PI)) * 2.0 / 3.0;
             ret += (160.0 * Math.sin(y / 12.0 * PI) + 320 * Math.sin(y * PI / 30.0)) * 2.0 / 3.0;
             return ret;
         }

         function transformLng(x, y) {
             let ret = 300.0 + x + 2.0 * y + 0.1 * x * x + 0.1 * x * y + 0.1 * Math.sqrt(Math.abs(x));
             ret += (20.0 * Math.sin(6.0 * x * PI) + 20.0 * Math.sin(2.0 * x * PI)) * 2.0 / 3.0;
             ret += (20.0 * Math.sin(x * PI) + 40.0 * Math.sin(x / 3.0 * PI)) * 2.0 / 3.0;
             ret += (150.0 * Math.sin(x / 12.0 * PI) + 300.0 * Math.sin(x / 30.0 * PI)) * 2.0 / 3.0;
             return ret;
         }
     }

     function gcj02ToWgs84(lng, lat) {
         const g = wgs84ToGcj02(lng, lat);
         return { lng: lng * 2 - g.lng, lat: lat * 2 - g.lat };
     }

     function bd09ToGcj02(bdLng, bdLat) {
         const x_PI = 3.14159265358979324 * 3000.0 / 180.0;
         const x = bdLng - 0.0065;
         const y = bdLat - 0.006;
         const z = Math.sqrt(x * x + y * y) - 0.00002 * Math.sin(y * x_PI);
         const theta = Math.atan2(y, x) - 0.000003 * Math.cos(x * x_PI);
         const ggLng = z * Math.cos(theta);
         const ggLat = z * Math.sin(theta);
         return { lng: ggLng, lat: ggLat };
     }

     function calculatePolygonBottomCenter(outerRing) {
         let minLat = Infinity;
         let bottomPoints = [];
         outerRing.forEach(point => {
             const lat = point[1];
             if (lat < minLat) {
                 minLat = lat;
                 bottomPoints = [point];
             } else if (lat === minLat) {
                 bottomPoints.push(point);
             }
         });

         const sumLng = bottomPoints.reduce((sum, point) => sum + point[0], 0);
         const centerLng = sumLng / bottomPoints.length;

         return { lng: centerLng, lat: minLat };
     }

     function fitBounds(geojson) {
         try {
             const allPoints = [];
             function collectPoints(coords) {
                 if (typeof coords[0] === 'number') {
                     allPoints.push(coords);
                 } else {
                     coords.forEach(coord => collectPoints(coord));
                 }
             }
             collectPoints(geojson.coordinates);

             if (allPoints.length === 0) return;

             const lats = allPoints.map(p => p[1]);
             const lngs = allPoints.map(p => p[0]);
             const minLng = Math.min(...lngs);
             const maxLng = Math.max(...lngs);
             const minLat = Math.min(...lats);
             const maxLat = Math.max(...lats);

             const sw = wgs84ToGcj02(minLng, minLat);
             const ne = wgs84ToGcj02(maxLng, maxLat);

             // 修复setViewport方法的使用，确保参数格式正确
             if (map && map.setViewport) {
                 map.setViewport([
                     new T.LngLat(sw.lng, sw.lat),
                     new T.LngLat(ne.lng, ne.lat)
                 ], { padding: [50, 50] });
             } else {
                 console.warn('地图对象或setViewport方法不可用');
             }
         } catch (error) {
             console.error('调整视图范围时出错:', error);
         }
     }
// 轨迹绘制与解析
    function bindTrackEvents() {
        const drawBtn = document.getElementById('drawTrackButton');
        const showPointsBtn = document.getElementById('showTrackPointsButton');
        const clearBtn = document.getElementById('clearTrackButton');
        const ta = document.getElementById('trackTextarea');
        if (!drawBtn || !showPointsBtn || !clearBtn || !ta) return;

        drawBtn.addEventListener('click', function(){
            try {
                const text = ta.value.trim();
                if (!text) { alert('请粘贴轨迹文本（时间戳,经度,纬度）'); return; }
                const pointsWithTime = parseTrackTextWithTime(text);
                
                // 解析时间范围
                const timeRangeInput = document.getElementById('timeRangeInput');
                const timeRangeText = timeRangeInput ? timeRangeInput.value.trim() : '';
                let filteredPoints = pointsWithTime;
                
                if (timeRangeText) {
                    // 解析时间范围：格式如 "2025-10-23T13:56:49 - 2025-10-23T15:51:31"
                    const timeRangeMatch = timeRangeText.match(/^([\d-]+T[\d:]+)\s*-\s*([\d-]+T[\d:]+)$/);
                    if (timeRangeMatch) {
                        const startTimeStr = timeRangeMatch[1];
                        const endTimeStr = timeRangeMatch[2];
                        
                        const startTime = new Date(startTimeStr);
                        const endTime = new Date(endTimeStr);
                        
                        if (!isNaN(startTime.getTime()) && !isNaN(endTime.getTime())) {
                            filteredPoints = pointsWithTime.filter(point => 
                                point.time >= startTime && point.time <= endTime
                            );
                            
                            if (filteredPoints.length < 2) {
                                alert('该时间范围内的有效轨迹点不足，至少需要两点');
                                return;
                            }
                        } else {
                            alert('时间范围格式不正确，请使用格式：2025-10-23T13:56:49 - 2025-10-23T15:51:31');
                            return;
                        }
                    } else {
                        alert('时间范围格式不正确，请使用格式：2025-10-23T13:56:49 - 2025-10-23T15:51:31');
                        return;
                    }
                }
                
                // 提取坐标点
                const points = filteredPoints.map(point => point.ll);
                
                if (points.length < 2) { alert('有效轨迹点不足，至少需要两点'); return; }
                drawTrackFromPoints(points);
                fitViewportToTrack(points);
            } catch (e) {
                alert('绘制轨迹失败：' + (e && e.message ? e.message : e));
                console.error('绘制轨迹异常:', e);
            }
        });

        showPointsBtn.addEventListener('click', function(){
            try {
                const text = ta.value.trim();
                if (!text) { alert('请粘贴轨迹文本（时间戳,经度,纬度）'); return; }
                const pointsWithTime = parseTrackTextWithTime(text);
                if (pointsWithTime.length === 0) { alert('未找到有效轨迹点'); return; }
                
                // 解析时间范围
                const timeRangeInput = document.getElementById('timeRangeInput');
                const timeRangeText = timeRangeInput ? timeRangeInput.value.trim() : '';
                let filteredPointsWithTime = pointsWithTime;
                
                if (timeRangeText) {
                    // 解析时间范围：格式如 "2025-10-23T13:56:49 - 2025-10-23T15:51:31"
                    const timeRangeMatch = timeRangeText.match(/^([\d-]+T[\d:]+)\s*-\s*([\d-]+T[\d:]+)$/);
                    if (timeRangeMatch) {
                        const startTimeStr = timeRangeMatch[1];
                        const endTimeStr = timeRangeMatch[2];
                        
                        const startTime = new Date(startTimeStr);
                        const endTime = new Date(endTimeStr);
                        
                        if (!isNaN(startTime.getTime()) && !isNaN(endTime.getTime())) {
                            filteredPointsWithTime = pointsWithTime.filter(point => 
                                point.time >= startTime && point.time <= endTime
                            );
                            
                            if (filteredPointsWithTime.length === 0) {
                                alert('该时间范围内没有找到轨迹点');
                                return;
                            }
                        } else {
                            alert('时间范围格式不正确，请使用格式：2025-10-23T13:56:49 - 2025-10-23T15:51:31');
                            return;
                        }
                    } else {
                        alert('时间范围格式不正确，请使用格式：2025-10-23T13:56:49 - 2025-10-23T15:51:31');
                        return;
                    }
                }
                
                // 传递包含时间信息的点对象
                showTrackPoints(filteredPointsWithTime);
                
                // 提取坐标点用于地图适配
                const points = filteredPointsWithTime.map(point => point.ll);
                fitViewportToTrack(points);
            } catch (e) {
                alert('显示轨迹点失败：' + (e && e.message ? e.message : e));
                console.error('显示轨迹点异常:', e);
            }
        });

        clearBtn.addEventListener('click', function(){
            clearTrackOverlays();
            console.log('已清空轨迹');
        });
    }

    function showTrackPoints(pointsWithTime) {
        // 先移除旧轨迹（不影响轮廓）
        clearTrackOverlays(false);
        
        if (!map || !pointsWithTime || pointsWithTime.length === 0) {
            console.log('无轨迹点可显示');
            return;
        }
        
        console.log(`准备显示${pointsWithTime.length}个轨迹点`);
        
        // 使用批量处理和更小的图标来提高性能
        // 创建一个更小的自定义颜色点SVG图标
        const smallColoredDotIcon = new T.Icon({
            iconUrl: `data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="1" height="1"><circle cx="0.5" cy="0.5" r="0.3" fill="%23${currentTrackPointColor.substring(1)}"/></svg>`,
            iconSize: new T.Point(1, 1),
            iconAnchor: new T.Point(0.5, 0.5)
        });
        
        // 优化批量添加点的速度
        const batchSize = 2000; // 增加每批处理的点数
        const concurrentBatches = 4; // 并发批次数量
        
        // 预创建点击事件处理函数，避免重复创建
        function createClickHandler(pointWithTime, index) {
            return function() {
                // 格式化时间显示
                const formattedTime = pointWithTime.time.toLocaleString('zh-CN', {
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit',
                    hour12: false
                });
                
                const infoWindow = new T.InfoWindow({
                    content: `点${index + 1}<br/>经度: ${pointWithTime.ll.lng.toFixed(6)}<br/>纬度: ${pointWithTime.ll.lat.toFixed(6)}<br/>时间: ${formattedTime}`,
                    offset: new T.Point(0, -20)
                });
                infoWindow.open(map, pointWithTime.ll);
            };
        }
        
        // 使用setTimeout实现更高效的批量添加，避免阻塞UI
        let currentIndex = 0;
        
        function addBatch() {
            if (currentIndex >= pointsWithTime.length) {
                console.log(`已显示${pointsWithTime.length}个轨迹点`);
                return;
            }
            
            // 添加当前批次的点
            const endIndex = Math.min(currentIndex + batchSize, pointsWithTime.length);
            const markersToAdd = [];
            
            // 先创建所有标记
            for (let i = currentIndex; i < endIndex; i++) {
                const pointWithTime = pointsWithTime[i];
                const index = i;
                
                const marker = new T.Marker(pointWithTime.ll, {
                    icon: smallColoredDotIcon
                });
                
                // 添加点击事件
                marker.addEventListener('click', createClickHandler(pointWithTime, index));
                
                markersToAdd.push(marker);
            }
            
            // 批量添加到地图和数组
            markersToAdd.forEach(marker => {
                map.addOverLay(marker);
                currentTracks.push(marker);
            });
            
            currentIndex = endIndex;
            
            // 使用setTimeout而不是requestAnimationFrame，减少对渲染周期的依赖
            // 设置为0，将任务放入微任务队列，但允许UI有短暂的呼吸空间
            setTimeout(addBatch, 0);
        }
        
        // 启动批量添加
        addBatch();
    }
    
    // 恢复原始的clearTrackOverlays函数
    function clearTrackOverlays(resetArray = true){        
        try {
            currentTracks.forEach(pl => {
                if (pl && map && map.removeOverLay) {
                    try { map.removeOverLay(pl); } catch (e) { console.warn('移除轨迹失败:', e); }
                }
            });
            if (resetArray) currentTracks = [];
        } catch (e) {
            console.warn('清空轨迹时出错:', e);
        }
    }

    function parseTrackText(text){
        // 选择输入坐标系（优先使用轨迹页签专属选择器，若未设置则回退到绘制页签选择器）
        const coordSysEl = document.getElementById('trackCoordSysSelect') || document.getElementById('coordSysSelect');
        const coordSys = (coordSysEl && coordSysEl.value) || 'wgs84';
        const isHash = text.indexOf('#') !== -1;
        const items = isHash ? text.split('#') : text.split(/\r?\n/);
        const pts = [];
        for (let i=0;i<items.length;i++){
            const raw = items[i];
            if (!raw) continue;
            const line = raw.trim();
            if (!line) continue;
            const splitParts = line.split(',');
            if (splitParts.length < 3) continue;
            let lng = parseFloat((splitParts[isHash ? 0 : 1] || '').trim());
            let lat = parseFloat((splitParts[isHash ? 1 : 2] || '').trim());
            // 初步过滤：数值合法性与正常范围
            if (!isFinite(lng) || !isFinite(lat)) continue;
            if (lng === 0 || lat === 0) continue; // 丢弃0.0异常点
            if (lng < -180 || lng > 180 || lat < -90 || lat > 90) continue; // 超出经纬度范围丢弃

            // 将输入坐标转换为WGS84
            let w;
            if (coordSys === 'wgs84' || coordSys === 'cgcs2000') {
                w = { lng, lat };
            } else if (coordSys === 'gcj02') {
                w = gcj02ToWgs84(lng, lat);
            } else if (coordSys === 'bd09') {
                const g = bd09ToGcj02(lng, lat);
                w = gcj02ToWgs84(g.lng, g.lat);
            } else {
                w = { lng, lat };
            }
            // 转换结果兜底检查
            if (!isFinite(w.lng) || !isFinite(w.lat)) continue;
            if (w.lng < -180 || w.lng > 180 || w.lat < -90 || w.lat > 90) continue;

            // 使用WGS84坐标绘制到地图
            pts.push(new T.LngLat(w.lng, w.lat));
        }
        return pts;
    }

    function drawTrackFromPoints(points){
        // 先移除旧轨迹（不影响轮廓）
        clearTrackOverlays(false);
        const polyline = new T.Polyline(points, {
            color: currentTrackLineColor,
            weight: 1,
            opacity: 0.9
        });
        if (map) {
            map.addOverLay(polyline);
        }
        currentTracks.push(polyline);
    }

    function clearTrackOverlays(resetArray = true){
        try {
            currentTracks.forEach(pl => {
                if (pl && map && map.removeOverLay) {
                    try { map.removeOverLay(pl); } catch (e) { console.warn('移除轨迹失败:', e); }
                }
            });
            if (resetArray) currentTracks = [];
        } catch (e) {
            console.warn('清空轨迹时出错:', e);
        }
    }


    function fitViewportToTrack(points){
        try {
            if (!map || !map.setViewport || !points || !points.length) return;
            map.setViewport(points);
        } catch (e) {
            console.warn('轨迹视图居中失败:', e);
        }
    }

    // ========= 轨迹回放功能 =========
    let playbackState = { points: [], idx: 0, speed: 1, timer: null, running: false, marker: null, line: null, path: [] };

    function bindPlaybackControls(){
        const startBtn = document.getElementById('playbackStartBtn');
        const pauseBtn = document.getElementById('playbackPauseBtn');
        const stopBtn = document.getElementById('playbackStopBtn');
        const speedSel = document.getElementById('playbackSpeedSelect');
        const timeSlider = document.getElementById('playbackTimeSlider');
        const timeCursor = document.getElementById('playbackTimeCursor');
        const ta = document.getElementById('trackTextarea');
        if (!startBtn || !pauseBtn || !stopBtn || !speedSel) return;

        // 初始按钮状态
        updatePlaybackButtonsState('idle');

        startBtn.addEventListener('click', function(){            
            try {
                const text = (ta && ta.value || '').trim();
                if (!text) { alert('请粘贴轨迹文本（时间戳,经度,纬度）'); return; }
                const pts = parseTrackTextWithTime(text);
                if (pts.length < 2) { alert('有效轨迹点不足，至少需要两点'); return; }
                
                // 解析时间范围
                const timeRangeInput = document.getElementById('timeRangeInput');
                const timeRangeText = timeRangeInput ? timeRangeInput.value.trim() : '';
                let filteredPoints = pts;
                
                if (timeRangeText) {
                    // 解析时间范围：格式如 "2025-10-23T13:56:49 - 2025-10-23T15:51:31"
                    const timeRangeMatch = timeRangeText.match(/^([\d-]+T[\d:]+)\s*-\s*([\d-]+T[\d:]+)$/);
                    if (timeRangeMatch) {
                        const startTimeStr = timeRangeMatch[1];
                        const endTimeStr = timeRangeMatch[2];
                        
                        const startTime = new Date(startTimeStr);
                        const endTime = new Date(endTimeStr);
                        
                        if (!isNaN(startTime.getTime()) && !isNaN(endTime.getTime())) {
                            filteredPoints = pts.filter(point => 
                                point.time >= startTime && point.time <= endTime
                            );
                            
                            if (filteredPoints.length < 2) {
                                alert('该时间范围内的有效轨迹点不足，至少需要两点');
                                return;
                            }
                        } else {
                            alert('时间范围格式不正确，请使用格式：2025-10-23T13:56:49 - 2025-10-23T15:51:31');
                            return;
                        }
                    } else {
                        alert('时间范围格式不正确，请使用格式：2025-10-23T13:56:49 - 2025-10-23T15:51:31');
                        return;
                    }
                }
                
                startPlayback(filteredPoints);
                // 状态在startPlayback中已设置为playing
            } catch (e) {
                alert('开始回放失败：' + (e && e.message ? e.message : e));
                console.error('开始回放异常:', e);
            }
        });

        pauseBtn.addEventListener('click', function(){
            if (!playbackState.running) {
                // 继续
                playbackState.running = true;
                scheduleNext();
                updatePlaybackButtonsState('playing');
            } else {
                // 暂停
                if (playbackState.timer) { clearTimeout(playbackState.timer); playbackState.timer = null; }
                playbackState.running = false;
                updatePlaybackButtonsState('paused');
            }
        });

        stopBtn.addEventListener('click', function(){ 
            stopPlayback(); 
            updatePlaybackButtonsState('idle');
        });

        speedSel.addEventListener('change', function(){
            const v = parseFloat(speedSel.value);
            playbackState.speed = (isFinite(v) && v > 0) ? v : 1;
        });

        if (timeSlider) {
            timeSlider.addEventListener('input', function(){
                const ms = parseInt(timeSlider.value, 10);
                const txt = formatTimeForLabel(ms);
                if (timeCursor) timeCursor.textContent = txt;
            });
            timeSlider.addEventListener('change', function(){
                jumpToSliderTime();
            });
        }
    }

    function parseTrackTextWithTime(text){
        const coordSysEl = document.getElementById('trackCoordSysSelect') || document.getElementById('coordSysSelect');
        const coordSys = (coordSysEl && coordSysEl.value) || 'wgs84';
        const isHash = text.indexOf('#') !== -1;
        const items = isHash ? text.split('#') : text.split(/\r?\n/);
        const out = [];
        for (let i=0;i<items.length;i++){
            const raw = items[i];
            if (!raw) continue;
            const line = raw.trim();
            if (!line) continue;
            const splitParts = line.split(',');
            if (splitParts.length < 3) continue;
            const tsRaw = (splitParts[isHash ? 2 : 0] || '').trim();
            const ts = (tsRaw || '').replace(/\D/g,'');
            let lng = parseFloat((splitParts[isHash ? 0 : 1] || '').trim());
            let lat = parseFloat((splitParts[isHash ? 1 : 2] || '').trim());
            if (!isFinite(lng) || !isFinite(lat)) continue;
            if (lng === 0 || lat === 0) continue;
            if (lng < -180 || lng > 180 || lat < -90 || lat > 90) continue;
            const t = parseTimestamp(ts);
            if (!t) continue;
            let w;
            if (coordSys === 'wgs84' || coordSys === 'cgcs2000') {
                w = { lng, lat };
            } else if (coordSys === 'gcj02') {
                w = gcj02ToWgs84(lng, lat);
            } else if (coordSys === 'bd09') {
                const g = bd09ToGcj02(lng, lat);
                w = gcj02ToWgs84(g.lng, g.lat);
            } else { w = { lng, lat }; }
            if (!isFinite(w.lng) || !isFinite(w.lat)) continue;
            if (w.lng < -180 || w.lng > 180 || w.lat < -90 || w.lat > 90) continue;
            out.push({ ll: new T.LngLat(w.lng, w.lat), time: t, ts });
        }
        out.sort((a,b)=>a.time - b.time);
        return out;
    }

    function parseTimestamp(ts){
        const tstr = (ts || '').replace(/\D/g,'');
        const m = tstr && tstr.match(/^\d{14}$/);
        if (!m) return null;
        const y = parseInt(tstr.slice(0,4),10);
        const M = parseInt(tstr.slice(4,6),10) - 1;
        const d = parseInt(tstr.slice(6,8),10);
        const h = parseInt(tstr.slice(8,10),10);
        const m2 = parseInt(tstr.slice(10,12),10);
        const s = parseInt(tstr.slice(12,14),10);
        const dt = new Date(y,M,d,h,m2,s);
        return isNaN(dt.getTime()) ? null : dt;
    }

    function startPlayback(points){
        console.log('[Playback] startPlayback: 点数=', points && points.length);
        stopPlayback();
        playbackState.points = points;
        playbackState.idx = 0;
        playbackState.speed = playbackState.speed || 1;
        playbackState.running = true;
        // 配置时间滑动条，并尊重现有滑块位置作为起始
        configureTimeSlider(points);
        // 启用滑块
        const slider = document.getElementById('playbackTimeSlider');
        if (slider) slider.disabled = false;
        let initIdx = 0;
        if (slider && slider.min && slider.max) {
            const ms = parseInt(slider.value, 10);
            if (isFinite(ms)) initIdx = findIndexByTime(points, ms);
        }
        playbackState.idx = initIdx;
        const first = points[initIdx];
        console.log('[Playback] 首点:', first && first.ts, first && first.ll, 'initIdx=', initIdx);
        playbackState.path = points.slice(0, initIdx+1).map(p=>p.ll);
        playbackState.line = new T.Polyline(playbackState.path, { color: currentTrackLineColor, weight: 1, opacity: 0.9 });
        if (map) {
            map.addOverLay(playbackState.line);
        }
        currentTracks.push(playbackState.line);
        // 创建并定位DOM标记以保证可见移动
        ensurePlaybackDom(first.ll);
        updatePlaybackDom(first.ll);
        updatePlaybackTimeLabel(first.ts);
        try { fitViewportToTrack(points.map(p=>p.ll)); } catch(e){}
        // 更新按钮状态
        updatePlaybackButtonsState('playing');
        scheduleNext();
    }

    function scheduleNext(){
        if (!playbackState.running) return;
        if (!playbackState.points || playbackState.idx >= playbackState.points.length - 1) {
            playbackState.running = false;
            console.log('[Playback] 回放结束：idx=', playbackState.idx, '点数=', playbackState.points ? playbackState.points.length : 0);
            updatePlaybackButtonsState('idle'); // 播放结束后按钮回到初始状态：开始可点，继续/结束灰化
            return;
        }
        const next = playbackState.points[playbackState.idx+1];
        const speed = playbackState.speed || 1;
        const delay = Math.max(4, Math.round(1000 / speed)); // 1x=1000ms/点，2x=500ms/点...
        console.log('[Playback] scheduleNext: idx=', playbackState.idx, '->', playbackState.idx+1, 'delay=', delay, 'speed=', speed);
        playbackState.timer = setTimeout(()=>{
            playbackState.idx++;
            const nextLL = next.ll;
            console.log('[Playback] 下一点:', next && next.ts, nextLL);
            try {
                // 维护路径数组
                playbackState.path = playbackState.path || [];
                playbackState.path.push(nextLL);
                console.log('[Playback] 路径长度=', playbackState.path.length);
                // 使用DOM标记进行移动（容器/图层坐标）
                if (!playbackDom.el) console.log('[Playback] DOM标记不存在，将尝试创建');
                updatePlaybackDom(nextLL);
                // 折线更新：优先setLngLats，兜底重建
                if (playbackState.line && typeof playbackState.line.setLngLats === 'function') {
                    try { playbackState.line.setLngLats(playbackState.path); }
                    catch(e){
                        console.warn('[Playback] setLngLats失败，重建折线', e);
                        if (map) { try { map.removeOverLay(playbackState.line); } catch(e){} }
                        playbackState.line = new T.Polyline(playbackState.path, { color: currentTrackLineColor, weight: 1, opacity: 0.9 });
                        if (map) map.addOverLay(playbackState.line);
                    }
                } else {
                    console.log('[Playback] 折线不支持setLngLats，重建');
                    if (playbackState.line && map) { try { map.removeOverLay(playbackState.line); } catch(e){} }
                    playbackState.line = new T.Polyline(playbackState.path, { color: currentTrackLineColor, weight: 1, opacity: 0.9 });
                    if (map) map.addOverLay(playbackState.line);
                }
            } catch(e) { console.warn('更新回放覆盖物失败:', e); }
            updatePlaybackTimeLabel(next.ts);
            scheduleNext();
        }, delay);
    }

    function stopPlayback(){
        if (playbackState.timer) { clearTimeout(playbackState.timer); playbackState.timer = null; }
        playbackState.running = false;
        playbackState.idx = 0;
        try {
            // 移除DOM标记
            removePlaybackDom();
            if (playbackState.marker && map) map.removeOverLay(playbackState.marker);
            if (playbackState.line && map) map.removeOverLay(playbackState.line);
        } catch(e){}
        playbackState.marker = null;
        playbackState.line = null;
        updatePlaybackTimeLabel('—');
        // 按钮回到初始状态
        updatePlaybackButtonsState('idle');
    }

    function updatePlaybackTimeLabel(text){
        const el = document.getElementById('playbackTimeLabel');
        if (el) el.textContent = '时间：' + (text || '—');
    }

    // 时间滑动条：配置与跳转
    function configureTimeSlider(points){
        try {
            const slider = document.getElementById('playbackTimeSlider');
            const cursor = document.getElementById('playbackTimeCursor');
            if (!slider || !points || !points.length) return;
            const minMs = points[0].time.getTime();
            const maxMs = points[points.length - 1].time.getTime();
            const prev = parseInt(slider.value, 10);
            slider.min = String(minMs);
            slider.max = String(maxMs);
            slider.step = '1000'; // 以秒为步进
            let val = (isFinite(prev) && prev >= minMs && prev <= maxMs) ? prev : minMs;
            slider.value = String(val);
            if (cursor) cursor.textContent = formatTimeForLabel(val);
        } catch(e) { console.warn('配置时间滑动条失败:', e); }
    }
    function formatTimeForLabel(ms){
        if (!isFinite(ms)) return '—';
        const d = new Date(ms);
        const pad = n => String(n).padStart(2,'0');
        const y = d.getFullYear();
        const M = pad(d.getMonth()+1);
        const da = pad(d.getDate());
        const h = pad(d.getHours());
        const m = pad(d.getMinutes());
        const s = pad(d.getSeconds());
        return `${y}-${M}-${da} ${h}:${m}:${s}`;
    }
    function findIndexByTime(points, ms){
        try {
            if (!points || !points.length) return 0;
            const n = points.length;
            const minMs = points[0].time.getTime();
            const maxMs = points[n-1].time.getTime();
            if (!isFinite(ms)) return 0;
            if (ms <= minMs) return 0;
            if (ms >= maxMs) return n-1;
            let lo = 0, hi = n - 1, ans = 0;
            while (lo <= hi) {
                const mid = (lo + hi) >> 1;
                const t = points[mid].time.getTime();
                if (t < ms) { lo = mid + 1; ans = lo; }
                else { hi = mid - 1; ans = mid; }
            }
            return Math.max(0, Math.min(n-1, ans));
        } catch(e){ console.warn('findIndexByTime失败:', e); return 0; }
    }
    function jumpToSliderTime(){
        try {
            const slider = document.getElementById('playbackTimeSlider');
            if (!slider || !playbackState.points || !playbackState.points.length) return;
            const ms = parseInt(slider.value, 10);
            if (!isFinite(ms)) return;
            const idx = findIndexByTime(playbackState.points, ms);
            playbackState.idx = idx;
            const pts = playbackState.points;
            const ll = pts[idx].ll;
            playbackState.path = pts.slice(0, idx+1).map(p=>p.ll);
            // 更新折线
            try {
                if (playbackState.line && typeof playbackState.line.setLngLats === 'function') {
                    playbackState.line.setLngLats(playbackState.path);
                } else {
                    if (playbackState.line && map) { try { map.removeOverLay(playbackState.line); } catch(e){} }
                    playbackState.line = new T.Polyline(playbackState.path, { color: currentTrackLineColor, weight: 1, opacity: 0.9 });
                    if (map) map.addOverLay(playbackState.line);
                }
            } catch(e){ console.warn('滑块更新折线失败:', e); }
            // 更新标记与时间
            ensurePlaybackDom(ll);
            updatePlaybackDom(ll);
            updatePlaybackTimeLabel(pts[idx].ts);
            // 若正在播放，立即按新位置继续
            if (playbackState.running) {
                if (playbackState.timer) { clearTimeout(playbackState.timer); playbackState.timer = null; }
                scheduleNext();
            }
        } catch(e) { console.warn('滑块跳转失败:', e); }
    }

    // DOM标记：使用容器坐标实现可见移动
    let playbackDom = { el: null, lastLL: null, bound: false };

    function ensurePlaybackDom(ll){
        try {
            playbackDom.lastLL = ll;
            const pane = (map && map.getPanes && map.getPanes().overlayPane) || document.getElementById('mapContainer');
            if (!pane) { console.warn('未找到overlayPane或mapContainer'); return; }
            if (!playbackDom.el) {
                const el = document.createElement('div');
                el.id = 'playbackDomMarker';
                el.style.position = 'absolute';
                el.style.width = '0';
                el.style.height = '0';
                el.style.borderLeft = '3px solid transparent';
                el.style.borderRight = '3px solid transparent';
                el.style.borderBottom = '4px solid #2C64A7';
                el.style.borderTop = '0';
                el.style.transform = 'translate(-50%, -50%)';
                el.style.zIndex = '9999';
                // 添加伪元素来增强箭头效果
                el.style.clipPath = 'polygon(50% 0, 100% 100%, 0 100%)';
                pane.appendChild(el);
                playbackDom.el = el;
                console.log('[Playback] 创建DOM标记，父节点=', pane === document.getElementById('mapContainer') ? '#mapContainer' : 'overlayPane');
                bindPlaybackDomEvents();
            }
            updatePlaybackDom(ll);
        } catch(e) { console.warn('创建DOM标记失败:', e); }
    }

    function updatePlaybackDom(ll){
        try {
            playbackDom.lastLL = ll;
            if (!map || !playbackDom.el || !ll) { console.log('[Playback] update取消：map/el/ll缺失'); return; }
            let p;
            if (typeof map.lngLatToLayerPoint === 'function') {
                p = map.lngLatToLayerPoint(ll);
                console.log('[Playback] 使用layerPoint定位:', ll && ll.lng, ll && ll.lat, '=>', p && p.x, p && p.y);
            } else if (typeof map.lngLatToContainerPoint === 'function') {
                p = map.lngLatToContainerPoint(ll);
                console.log('[Playback] 使用containerPoint定位:', ll && ll.lng, ll && ll.lat, '=>', p && p.x, p && p.y);
            } else {
                console.warn('地图对象不支持lngLat到像素坐标转换');
                return;
            }
            playbackDom.el.style.left = p.x + 'px';
            playbackDom.el.style.top = p.y + 'px';
        } catch(e) { console.warn('更新DOM标记位置失败:', e); }
    }

    function bindPlaybackDomEvents(){
        if (playbackDom.bound) return;
        const updater = function(){
            try {
                if (!map || !playbackDom.el || !playbackDom.lastLL) return;
                let p;
                if (typeof map.lngLatToLayerPoint === 'function') {
                    p = map.lngLatToLayerPoint(playbackDom.lastLL);
                } else if (typeof map.lngLatToContainerPoint === 'function') {
                    p = map.lngLatToContainerPoint(playbackDom.lastLL);
                }
                if (!p) return;
                playbackDom.el.style.left = p.x + 'px';
                playbackDom.el.style.top = p.y + 'px';
            } catch(e){}
        };
        try {
            map.addEventListener('move', updater);
            map.addEventListener('zoom', updater);
            playbackDom.bound = true;
        } catch(e){}
    }

    function removePlaybackDom(){
        try {
            const el = playbackDom.el;
            playbackDom.lastLL = null;
            if (el && el.parentNode) el.parentNode.removeChild(el);
        } catch(e){}
        playbackDom.el = null;
        playbackDom.bound = false;
    }

    // 测量功能相关变量
    let measureState = {
        isActive: false,
        mode: '', // 'distance' or 'area'
        points: [],
        tempLine: null,
        lines: [],
        markers: [],
        labels: [],
        polygon: null,
        areaLabel: null
    };

    // 绑定测量按钮事件
    function bindMeasureEvents() {
        const distanceBtn = document.getElementById('measureDistanceBtn');
        const areaBtn = document.getElementById('measureAreaBtn');
        
        if (distanceBtn) {
            distanceBtn.addEventListener('click', function() {
                startMeasureDistance();
            });
        }
        
        if (areaBtn) {
            areaBtn.addEventListener('click', function() {
                startMeasureArea();
            });
        }
    }

    // 绑定地图类型切换按钮事件
    function bindMapTypeEvent() {
        const mapTypeBtn = document.getElementById('mapTypeBtn');
        
        if (mapTypeBtn) {
            mapTypeBtn.addEventListener('click', function() {
                toggleMapType();
            });
        }
    }

    // 切换地图类型
    function toggleMapType() {
        if (!map) {
            alert('地图未初始化');
            return;
        }
        
        // 切换地图类型
        if (currentMapType === 'satellite') {
            // 切换到街道地图
            map.setMapType(TMAP_NORMAL_MAP);
            currentMapType = 'street';
            updateMapTypeButton('街道图');
        } else {
            // 切换到卫星地图
            map.setMapType(TMAP_SATELLITE_MAP);
            currentMapType = 'satellite';
            updateMapTypeButton('卫星图');
        }
    }

    // 更新地图类型按钮显示
    function updateMapTypeButton(typeName) {
        const mapTypeBtn = document.getElementById('mapTypeBtn');
        if (mapTypeBtn) {
            mapTypeBtn.innerHTML = `<span>${typeName}</span>`;
            mapTypeBtn.title = `当前：${typeName}，点击切换`;
        }
    }

    // 开始测距
    function startMeasureDistance() {
        if (!map) {
            alert('地图未初始化');
            return;
        }
        
        // 先移除所有可能存在的事件监听器
        try {
            map.removeEventListener('click', handleMapClick);
            map.removeEventListener('click', handleAreaMapClick);
            map.removeEventListener('mousemove', handleMouseMove);
            map.removeEventListener('mousemove', handleAreaMouseMove);
            map.removeEventListener('dblclick', finishMeasure);
            map.removeEventListener('dblclick', finishAreaMeasure);
        } catch(e) {
            console.log('移除事件监听器时出错:', e);
        }
        
        // 重置测量状态
        clearMeasureResult();
        
        // 设置测量状态为激活
        measureState.isActive = true;
        measureState.mode = 'distance'; // 设置为距离测量模式
        
        // 禁用其他按钮
        disableButtons(true);
        
        // 添加地图点击事件监听器
        map.addEventListener('click', handleMapClick);
        
        // 添加鼠标移动事件监听器
        map.addEventListener('mousemove', handleMouseMove);
        
        // 添加双击事件监听器结束测量
        map.addEventListener('dblclick', finishMeasure);
        
        console.log('测距功能已启动');
    }

    // 开始测面
    function startMeasureArea() {
        if (!map) {
            alert('地图未初始化');
            return;
        }
        
        // 先移除所有可能存在的事件监听器
        try {
            map.removeEventListener('click', handleMapClick);
            map.removeEventListener('click', handleAreaMapClick);
            map.removeEventListener('mousemove', handleMouseMove);
            map.removeEventListener('mousemove', handleAreaMouseMove);
            map.removeEventListener('dblclick', finishMeasure);
            map.removeEventListener('dblclick', finishAreaMeasure);
        } catch(e) {
            console.log('移除事件监听器时出错:', e);
        }
        
        // 重置测量状态
        clearMeasureResult();
        
        // 设置测量状态为激活
        measureState.isActive = true;
        measureState.mode = 'area'; // 设置为面积测量模式
        
        // 禁用其他按钮
        disableButtons(true);
        
        // 添加地图点击事件监听器
        map.addEventListener('click', handleAreaMapClick);
        
        // 添加鼠标移动事件监听器
        map.addEventListener('mousemove', handleAreaMouseMove);
        
        // 添加双击事件监听器结束测量
        map.addEventListener('dblclick', finishAreaMeasure);
        
        console.log('测面功能已启动');
    }

    // 处理地图点击事件
    function handleMapClick(event) {
        if (!measureState.isActive || measureState.mode !== 'distance') return;
        
        const point = event.lnglat;
        measureState.points.push(point);
        
        // 创建小圆点图标
        const smallDotIcon = new T.Icon({
            iconUrl: 'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="8" height="8"><circle cx="4" cy="4" r="3" fill="%23FF0000" stroke="%23FFFFFF" stroke-width="1"/></svg>',
            iconSize: new T.Point(8, 8),
            iconAnchor: new T.Point(4, 4)
        });
        
        // 创建点标记
        const marker = new T.Marker(point, {icon: smallDotIcon});
        map.addOverLay(marker);
        measureState.markers.push(marker);
        
        // 如果不是第一个点，创建线段
        if (measureState.points.length > 1) {
            const prevPoint = measureState.points[measureState.points.length - 2];
            const line = new T.Polyline([prevPoint, point], {
                color: '#FF0000',
                weight: 3,
                opacity: 0.8
            });
            map.addOverLay(line);
            measureState.lines.push(line);
            
            // 计算距离并显示标签
            const distance = calculateDistance(prevPoint, point);
            showDistanceLabel(point, distance);
        }
        
        // 移除临时线
        if (measureState.tempLine) {
            map.removeOverLay(measureState.tempLine);
            measureState.tempLine = null;
        }
    }

    // 处理测面地图点击事件
    function handleAreaMapClick(event) {
        if (!measureState.isActive || measureState.mode !== 'area') return;
        
        const point = event.lnglat;
        measureState.points.push(point);
        
        // 创建小圆点图标（与测距功能一致）
        const smallDotIcon = new T.Icon({
            iconUrl: 'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="8" height="8"><circle cx="4" cy="4" r="3" fill="%23FF0000" stroke="%23FFFFFF" stroke-width="1"/></svg>',
            iconSize: new T.Point(8, 8),
            iconAnchor: new T.Point(4, 4)
        });
        
        // 创建点标记
        const marker = new T.Marker(point, {icon: smallDotIcon});
        map.addOverLay(marker);
        measureState.markers.push(marker);
        
        // 移除之前的多边形
        if (measureState.polygon) {
            map.removeOverLay(measureState.polygon);
        }
        
        // 如果点数大于2，创建多边形
        if (measureState.points.length >= 3) {
            const polygon = new T.Polygon(measureState.points, {
                color: currentOutlineColor,
                weight: 3,
                opacity: 0.8,
                fillColor: currentFillColor,
                fillOpacity: currentFillOpacity
            });
            map.addOverLay(polygon);
            measureState.polygon = polygon;
            
            // 计算面积并显示标签
            const area = calculatePolygonArea(measureState.points);
            showAreaLabel(getPolygonCenter(measureState.points), area);
        }
        
        // 移除临时线
        if (measureState.tempLine) {
            map.removeOverLay(measureState.tempLine);
            measureState.tempLine = null;
        }
    }

    // 处理鼠标移动事件
    function handleMouseMove(event) {
        if (!measureState.isActive || measureState.mode !== 'distance' || measureState.points.length === 0) return;
        
        const lastPoint = measureState.points[measureState.points.length - 1];
        const currentPoint = event.lnglat;
        
        // 移除之前的临时线
        if (measureState.tempLine) {
            map.removeOverLay(measureState.tempLine);
        }
        
        // 创建新的临时线
        measureState.tempLine = new T.Polyline([lastPoint, currentPoint], {
            color: '#0000FF',
            weight: 2,
            opacity: 0.6,
            dashArray: [5, 5]
        });
        map.addOverLay(measureState.tempLine);
    }

    // 处理测面鼠标移动事件
    function handleAreaMouseMove(event) {
        if (!measureState.isActive || measureState.mode !== 'area' || measureState.points.length === 0) return;
        
        const firstPoint = measureState.points[0];
        const lastPoint = measureState.points[measureState.points.length - 1];
        const currentPoint = event.lnglat;
        
        // 移除之前的临时线
        if (measureState.tempLine) {
            map.removeOverLay(measureState.tempLine);
        }
        
        // 创建新的临时线（从最后一个点到当前点，再到第一个点形成闭合效果）
        const tempPoints = [lastPoint, currentPoint];
        if (measureState.points.length >= 2) {
            tempPoints.push(firstPoint);
        }
        
        measureState.tempLine = new T.Polyline(tempPoints, {
            color: '#0000FF',
            weight: 2,
            opacity: 0.6,
            dashArray: [5, 5]
        });
        map.addOverLay(measureState.tempLine);
    }

    // 结束测量
    function finishMeasure() {
        if (!measureState.isActive || measureState.mode !== 'distance') return;
        
        // 移除事件监听器
        map.removeEventListener('click', handleMapClick);
        map.removeEventListener('mousemove', handleMouseMove);
        map.removeEventListener('dblclick', finishMeasure);
        
        // 移除临时线
        if (measureState.tempLine) {
            map.removeOverLay(measureState.tempLine);
            measureState.tempLine = null;
        }
        
        // 显示总距离
        if (measureState.points.length > 1) {
            const totalDistance = calculateTotalDistance();
            showTotalDistanceLabel(totalDistance);
        }
        
        // 重置测量状态
        measureState.isActive = false;
        measureState.mode = '';
        
        // 恢复其他按钮
        disableButtons(false);
        
        console.log('测距功能已完成');
    }

    // 结束测面测量
    function finishAreaMeasure() {
        if (!measureState.isActive || measureState.mode !== 'area') return;
        
        // 移除事件监听器
        map.removeEventListener('click', handleAreaMapClick);
        map.removeEventListener('mousemove', handleAreaMouseMove);
        map.removeEventListener('dblclick', finishAreaMeasure);
        
        // 移除临时线
        if (measureState.tempLine) {
            map.removeOverLay(measureState.tempLine);
            measureState.tempLine = null;
        }
        
        // 如果点数大于等于3，创建最终多边形
        if (measureState.points.length >= 3) {
            // 移除之前的多边形
            if (measureState.polygon) {
                map.removeOverLay(measureState.polygon);
            }
            
            const polygon = new T.Polygon(measureState.points, {
                color: currentOutlineColor,
                weight: 3,
                opacity: 0.8,
                fillColor: currentFillColor,
                fillOpacity: currentFillOpacity
            });
            map.addOverLay(polygon);
            measureState.polygon = polygon;
            
            // 计算并显示总面积
            const area = calculatePolygonArea(measureState.points);
            showTotalAreaLabel(getPolygonCenter(measureState.points), area);
        } else {
            // 点数不足3个，移除所有标记
            clearMeasureResult();
        }
        
        // 重置测量状态
        measureState.isActive = false;
        measureState.mode = '';
        
        // 恢复其他按钮
        disableButtons(false);
        
        console.log('测面功能已完成');
    }

    // 计算两点间距离（米）
    function calculateDistance(point1, point2) {
        // 使用天地图提供的距离计算方法
        if (T.CRS && T.CRS.EPSG4326 && T.CRS.EPSG4326.distance) {
            return T.CRS.EPSG4326.distance(point1, point2);
        }
        
        // 如果没有提供，则使用球面距离公式
        const R = 6371000; // 地球半径（米）
        const dLat = (point2.lat - point1.lat) * Math.PI / 180;
        const dLon = (point2.lng - point1.lng) * Math.PI / 180;
        const a = 
            Math.sin(dLat/2) * Math.sin(dLat/2) +
            Math.cos(point1.lat * Math.PI / 180) * Math.cos(point2.lat * Math.PI / 180) * 
            Math.sin(dLon/2) * Math.sin(dLon/2);
        const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
        return R * c;
    }

    // 计算多边形面积（平方米）
    function calculatePolygonArea(points) {
        // 使用天地图提供的面积计算方法（如果可用）
        if (T.GeometryUtils && T.GeometryUtils.computeArea) {
            return T.GeometryUtils.computeArea(points);
        }
        
        // 如果没有提供，则使用球面多边形面积计算公式
        // 这里使用简单的平面近似计算，对于小面积比较准确
        if (points.length < 3) return 0;
        
        let area = 0;
        const n = points.length;
        
        for (let i = 0; i < n; i++) {
            const j = (i + 1) % n;
            area += points[i].lng * points[j].lat;
            area -= points[j].lng * points[i].lat;
        }
        
        area = Math.abs(area) / 2.0;
        
        // 转换为平方米（这是一个简化的近似值）
        // 更精确的计算需要考虑地球曲率
        const earthRadius = 6371000; // 地球半径（米）
        const degreeToMeter = (2 * Math.PI * earthRadius) / 360; // 每度对应的米数
        
        // 这个转换只是一个粗略的近似
        return area * degreeToMeter * degreeToMeter;
    }

    // 获取多边形中心点
    function getPolygonCenter(points) {
        if (points.length === 0) return null;
        
        let x = 0, y = 0;
        for (let i = 0; i < points.length; i++) {
            x += points[i].lng;
            y += points[i].lat;
        }
        
        return new T.LngLat(x / points.length, y / points.length);
    }

    // 计算总距离
    function calculateTotalDistance() {
        let total = 0;
        for (let i = 1; i < measureState.points.length; i++) {
            const distance = calculateDistance(measureState.points[i-1], measureState.points[i]);
            total += distance;
        }
        return total;
    }

    // 显示两点间距离标签
    function showDistanceLabel(point, distance) {
        const label = document.createElement('div');
        label.className = 'distance-label';
        label.innerHTML = distance.toFixed(2) + ' 米';
        label.style.position = 'absolute';
        label.style.backgroundColor = 'rgba(255, 255, 255, 0.9)';
        label.style.padding = '2px 6px';
        label.style.borderRadius = '3px';
        label.style.fontSize = '12px';
        label.style.boxShadow = '0 1px 2px rgba(0,0,0,0.3)';
        label.style.zIndex = '1000';
        label.style.transform = 'translate(-50%, -50%)';
        
        // 添加删除按钮
        const closeBtn = document.createElement('span');
        closeBtn.innerHTML = '×';
        closeBtn.style.marginLeft = '5px';
        closeBtn.style.cursor = 'pointer';
        closeBtn.style.fontWeight = 'bold';
        closeBtn.onclick = function() {
            if (label.parentNode) {
                label.parentNode.removeChild(label);
            }
        };
        label.appendChild(closeBtn);
        
        document.getElementById('mapContainer').appendChild(label);
        
        // 定位标签（向上偏移20像素）
        const pixel = map.lngLatToContainerPoint(point);
        label.style.left = pixel.x + 'px';
        label.style.top = (pixel.y - 20) + 'px';
        
        measureState.labels.push(label);
    }

    // 显示面积标签
    function showAreaLabel(point, area) {
        // 如果已存在面积标签，先移除它
        if (measureState.areaLabel) {
            if (measureState.areaLabel.parentNode) {
                measureState.areaLabel.parentNode.removeChild(measureState.areaLabel);
            }
        }
        
        const label = document.createElement('div');
        label.className = 'area-label';
        label.innerHTML = area.toFixed(2) + ' 平方米';
        label.style.position = 'absolute';
        label.style.backgroundColor = 'rgba(255, 255, 255, 0.9)';
        label.style.padding = '2px 6px';
        label.style.borderRadius = '3px';
        label.style.fontSize = '12px';
        label.style.boxShadow = '0 1px 2px rgba(0,0,0,0.3)';
        label.style.zIndex = '1000';
        label.style.transform = 'translate(-50%, -50%)';
        
        // 添加删除按钮
        const closeBtn = document.createElement('span');
        closeBtn.innerHTML = '×';
        closeBtn.style.marginLeft = '5px';
        closeBtn.style.cursor = 'pointer';
        closeBtn.style.fontWeight = 'bold';
        closeBtn.onclick = function() {
            if (label.parentNode) {
                label.parentNode.removeChild(label);
            }
        };
        label.appendChild(closeBtn);
        
        document.getElementById('mapContainer').appendChild(label);
        
        // 定位标签
        const pixel = map.lngLatToContainerPoint(point);
        label.style.left = pixel.x + 'px';
        label.style.top = (pixel.y - 20) + 'px';
        
        measureState.areaLabel = label;
        measureState.labels.push(label);
    }

    // 显示总面积标签
    function showTotalAreaLabel(point, area) {
        // 如果已存在面积标签，先移除它
        if (measureState.areaLabel) {
            if (measureState.areaLabel.parentNode) {
                measureState.areaLabel.parentNode.removeChild(measureState.areaLabel);
            }
        }
        
        // 计算亩数（1亩 ≈ 666.6667平方米）
        const areaInMu = area / 666.6667;
        
        const label = document.createElement('div');
        label.className = 'total-area-label';
        label.innerHTML = '总面积: ' + area.toFixed(2) + ' 平方米<br>' + areaInMu.toFixed(2) + ' 亩';
        label.style.position = 'absolute';
        label.style.backgroundColor = 'rgba(0, 0, 0, 0.7)';
        label.style.color = 'white';
        label.style.padding = '4px 8px';
        label.style.borderRadius = '4px';
        label.style.fontSize = '14px';
        label.style.fontWeight = 'bold';
        label.style.boxShadow = '0 2px 4px rgba(0,0,0,0.3)';
        label.style.zIndex = '1000';
        label.style.transform = 'translate(-50%, -50%)';
        label.style.lineHeight = '1.4';
        
        // 添加删除按钮
        const closeBtn = document.createElement('span');
        closeBtn.innerHTML = ' ×';
        closeBtn.style.cursor = 'pointer';
        closeBtn.style.fontWeight = 'bold';
        closeBtn.onclick = function() {
            if (label.parentNode) {
                label.parentNode.removeChild(label);
            }
        };
        label.appendChild(closeBtn);
        
        document.getElementById('mapContainer').appendChild(label);
        
        // 定位标签
        const pixel = map.lngLatToContainerPoint(point);
        label.style.left = pixel.x + 'px';
        label.style.top = (pixel.y - 40) + 'px';
        
        measureState.areaLabel = label;
        measureState.labels.push(label);
    }

    // 显示总距离标签
    function showTotalDistanceLabel(totalDistance) {
        const lastPoint = measureState.points[measureState.points.length - 1];
        const label = document.createElement('div');
        label.className = 'total-distance-label';
        label.innerHTML = '总距离: ' + totalDistance.toFixed(2) + ' 米';
        label.style.position = 'absolute';
        label.style.backgroundColor = 'rgba(0, 0, 0, 0.7)';
        label.style.color = 'white';
        label.style.padding = '4px 8px';
        label.style.borderRadius = '4px';
        label.style.fontSize = '14px';
        label.style.fontWeight = 'bold';
        label.style.boxShadow = '0 2px 4px rgba(0,0,0,0.3)';
        label.style.zIndex = '1000';
        label.style.transform = 'translate(-50%, -50%)';
        
        // 添加删除按钮
        const closeBtn = document.createElement('span');
        closeBtn.innerHTML = ' ×';
        closeBtn.style.cursor = 'pointer';
        closeBtn.style.fontWeight = 'bold';
        closeBtn.onclick = function() {
            if (label.parentNode) {
                label.parentNode.removeChild(label);
            }
        };
        label.appendChild(closeBtn);
        
        document.getElementById('mapContainer').appendChild(label);
        
        // 定位标签（向上偏移40像素，比段距离标签更高）
        const pixel = map.lngLatToContainerPoint(lastPoint);
        label.style.left = pixel.x + 'px';
        label.style.top = (pixel.y - 60) + 'px';  // 从-40改为-60，增加间距
        
        measureState.labels.push(label);
    }

    // 清除测量结果
    function clearMeasureResult() {
        // 移除所有线条
        measureState.lines.forEach(line => {
            if (map && map.removeOverLay) {
                try { map.removeOverLay(line); } catch(e) {}
            }
        });
        
        // 移除所有标记
        measureState.markers.forEach(marker => {
            if (map && map.removeOverLay) {
                try { map.removeOverLay(marker); } catch(e) {}
            }
        });
        
        // 移除所有标签
        measureState.labels.forEach(label => {
            if (label.parentNode) {
                try { label.parentNode.removeChild(label); } catch(e) {}
            }
        });
        
        // 移除临时线
        if (measureState.tempLine) {
            if (map && map.removeOverLay) {
                try { map.removeOverLay(measureState.tempLine); } catch(e) {}
            }
            measureState.tempLine = null;
        }
        
        // 移除多边形
        if (measureState.polygon) {
            if (map && map.removeOverLay) {
                try { map.removeOverLay(measureState.polygon); } catch(e) {}
            }
            measureState.polygon = null;
        }
        
        // 移除面积标签
        if (measureState.areaLabel) {
            if (measureState.areaLabel.parentNode) {
                try { measureState.areaLabel.parentNode.removeChild(measureState.areaLabel); } catch(e) {}
            }
            measureState.areaLabel = null;
        }
        
        // 重置状态
        measureState.points = [];
        measureState.lines = [];
        measureState.markers = [];
        measureState.labels = [];
        measureState.isActive = false;
        measureState.mode = '';
    }

    // 添加CSS样式用于距离标签
    const style = document.createElement('style');
    style.innerHTML = `
        .distance-label, .total-distance-label {
            font-family: Arial, sans-serif;
            pointer-events: auto;
        }
    `;
    document.head.appendChild(style);

    // 颜色选择器相关变量和函数 - 轮廓颜色设置已移除，使用固定颜色
    let currentOutlineColor = "#FFD700"; // 默认边框颜色（固定）
    let currentFillColor = "#FFFF00";   // 默认填充颜色（固定）
    let currentFillOpacity = 0.35;       // 默认透明度（固定）
    
    // 多行WKT颜色方案 - 用于为每个多边形分配不同颜色
    const polygonColors = [
        { outline: "#FFD700", fill: "#FFFF00", opacity: 0.35 }, // 黄色
        { outline: "#FF0000", fill: "#FF6666", opacity: 0.35 }, // 红色
        { outline: "#00FF00", fill: "#66FF66", opacity: 0.35 }, // 绿色
        { outline: "#0000FF", fill: "#6666FF", opacity: 0.35 }, // 蓝色
        { outline: "#FF00FF", fill: "#FF66FF", opacity: 0.35 }, // 紫色
        { outline: "#00FFFF", fill: "#66FFFF", opacity: 0.35 }, // 青色
        { outline: "#FFA500", fill: "#FFCC66", opacity: 0.35 }, // 橙色
        { outline: "#800080", fill: "#CC66CC", opacity: 0.35 }, // 深紫色
        { outline: "#008000", fill: "#66CC66", opacity: 0.35 }, // 深绿色
        { outline: "#800000", fill: "#CC6666", opacity: 0.35 }  // 深红色
    ];
    
    // 轨迹颜色相关变量
    let currentTrackLineColor = "#FF0000"; // 默认轨迹线颜色
    let currentTrackPointColor = "#68EAF3"; // 默认轨迹点颜色

    // 初始化颜色选择器
    function initColorPickers() {
        // 边框颜色选择器 - 已移除
        // const outlineColorPicker = document.getElementById('outlineColorPicker');
        // const outlineColorInput = document.getElementById('outlineColorInput');
        // 
        // outlineColorPicker.addEventListener('click', function() {
        //     outlineColorInput.click();
        // });
        // 
        // outlineColorInput.addEventListener('change', function() {
        //     currentOutlineColor = this.value;
        //     outlineColorPicker.style.backgroundColor = currentOutlineColor;
        // });
        
        // 填充颜色选择器 - 已移除
        // const fillColorPicker = document.getElementById('fillColorPicker');
        // const fillColorInput = document.getElementById('fillColorInput');
        // 
        // fillColorPicker.addEventListener('click', function() {
        //     fillColorInput.click();
        // });
        // 
        // fillColorInput.addEventListener('change', function() {
        //     currentFillColor = this.value;
        //     fillColorPicker.style.backgroundColor = currentFillColor;
        // });
        
        // 透明度滑块 - 已移除
        // const fillOpacitySlider = document.getElementById('fillOpacitySlider');
        // const fillOpacityValue = document.getElementById('fillOpacityValue');
        // 
        // fillOpacitySlider.addEventListener('input', function() {
        //     currentFillOpacity = this.value / 100;
        //     fillOpacityValue.textContent = this.value + '%';
        // });
        
        // 轨迹线颜色选择器
        const trackLineColorPicker = document.getElementById('trackLineColorPicker');
        const trackLineColorInput = document.getElementById('trackLineColorInput');
        
        if (trackLineColorPicker && trackLineColorInput) {
            trackLineColorPicker.addEventListener('click', function() {
                trackLineColorInput.click();
            });
            
            trackLineColorInput.addEventListener('change', function() {
                currentTrackLineColor = this.value;
                trackLineColorPicker.style.backgroundColor = currentTrackLineColor;
            });
        }
        
        // 轨迹点颜色选择器
        const trackPointColorPicker = document.getElementById('trackPointColorPicker');
        const trackPointColorInput = document.getElementById('trackPointColorInput');
        
        if (trackPointColorPicker && trackPointColorInput) {
            // 设置初始背景色
            trackPointColorPicker.style.backgroundColor = currentTrackPointColor;
            
            trackPointColorPicker.addEventListener('click', function() {
                trackPointColorInput.click();
            });
            
            trackPointColorInput.addEventListener('change', function() {
                currentTrackPointColor = this.value;
                trackPointColorPicker.style.backgroundColor = currentTrackPointColor;
            });
        }
    }

</script>
</body>

</html>