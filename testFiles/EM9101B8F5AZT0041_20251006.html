<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>展示轮廓</title>
    <style>
        body {
            margin: 0;
            padding: 0;
        }

        #mapContainer {
            width: 100vw;
            height: 100vh;
            position: relative;
        }

        #mapLoading {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 999;
            transition: opacity 0.3s;
        }

        .loading-text {
            font-size: 16px;
            color: #333;
            padding: 10px 20px;
            background: white;
            border-radius: 4px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        .wkt-input-container {
            position: absolute;
            top: 20px;
            right: 10px;
            z-index: 1000;
            background: white;
            padding: 12px;
            border-radius: 6px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
            width: min(320px, 90vw);
            box-sizing: border-box;
            transition: all 0.3s;
        }

        .minimize-btn {
            position: absolute;
            top: -5px;
            right: -4px;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #f0f0f0;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            color: #666;
            z-index: 1001;
            transition: background 0.2s;
        }

        .minimize-btn:hover {
            background: #e0e0e0;
        }

        .content-wrapper {
            transition: all 0.3s;
        }

        .wkt-input-container.minimized {
            width: 40px;
            height: 40px;
            padding: 0;
        }

        .wkt-input-container.minimized .content-wrapper {
            display: none;
        }

        .wkt-input-container.minimized .min-icon {
            display: none;
        }

        .wkt-input-container.minimized .restore-icon {
            display: inline;
        }

        #wktTextarea {
            width: 100%;
            height: 120px;
            margin-bottom: 10px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-family: monospace;
            resize: vertical;
            box-sizing: border-box;
        }

        .button-group {
            display: flex;
            gap: 10px;
        }

        /* 页签样式 */
        .tabs-header {
            display: flex;
            gap: 8px;
            margin-bottom: 8px;
        }
        .tab-btn {
            flex: 1;
            padding: 6px 0;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 13px;
            background: #f5f5f5;
            color: #333;
            transition: background 0.2s;
        }
        .tab-btn.active { background: #337AFF; color: #fff; }
        .tab-pane { display: none; }
        .tab-pane.active { display: block; }

        /* Multi → Polygons 分割器样式 */
        .split-section {
            margin-top: 10px;
            padding: 10px;
            background: #fafafa;
            border: 1px solid #eee;
            border-radius: 6px;
        }
        .split-section .title {
            font-size: 13px;
            font-weight: 600;
            color: #333;
            margin-bottom: 6px;
        }
        .split-section .desc {
            font-size: 12px;
            color: #666;
            margin-bottom: 8px;
        }
        #multiInput, #polyOutput {
            width: 100%;
            height: 90px;
            margin-bottom: 8px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-family: monospace;
            resize: vertical;
            box-sizing: border-box;
        }
        .split-actions {
            display: flex;
            gap: 8px;
            margin-bottom: 8px;
        }
        .split-actions button {
            flex: 1;
            padding: 6px 0;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 13px;
            transition: background 0.2s;
        }
        #splitMultiBtn { background: #337AFF; color: #fff; }
        #splitMultiBtn:hover { background: #2860E0; }
        #copyPolysBtn { background: #f5f5f5; color: #333; }
        #copyPolysBtn:hover { background: #e0e0e0; }
        #drawButton,
        #clearButton,
        #drawTrackButton,
        #clearTrackButton {
            width: 50%;
            padding: 8px 0;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.2s;
        }

        #drawButton,
        #drawTrackButton {
            background: #337AFF;
            color: white;
        }

        #drawButton:hover,
        #drawTrackButton:hover {
            background: #2860E0;
        }

        #clearButton,
        #clearTrackButton {
            background: #f5f5f5;
            color: #333;
        }

        #clearButton:hover,
        #clearTrackButton:hover {
            background: #e0e0e0;
        }

        #drawButton:disabled,
        #clearButton:disabled,
        #drawTrackButton:disabled,
        #clearTrackButton:disabled {
            background: #e0e0e0;
            color: #999;
            cursor: not-allowed;
        }

        .tip {
            font-size: 12px;
            color: #666;
            margin-bottom: 8px;
            line-height: 1.4;
        }

        .area-label {
             position: absolute;
             background: rgba(255, 0, 0, 0.85);
             border: 1px solid #000;
             border-radius: 3px;
             padding: 4px 6px;
             font-size: 12px;
             color: #fff;
             font-weight: 600;
             box-shadow: 0 2px 6px rgba(0, 0, 0, 0.25);
             white-space: nowrap;
             z-index: 9999;
             pointer-events: none;
         }
         /* 默认隐藏标签容器下的标签 */
          .labels-hidden .area-label { display: none; }

          /* Batch → Generator 样式 */
          .batch-section { margin-top: 10px; padding: 10px; background: #fafafa; border: 1px solid #eee; border-radius: 6px; }
          .batch-section .title { font-size: 13px; font-weight: 600; color: #333; margin-bottom: 6px; }
          .batch-section .desc { font-size: 12px; color: #666; margin-bottom: 8px; }
          #batchInput, #multiOutput { width: 100%; height: 90px; margin-bottom: 8px; padding: 8px; border: 1px solid #ddd; border-radius: 4px; font-family: monospace; resize: vertical; box-sizing: border-box; }
          .batch-actions { display: flex; gap: 8px; margin-bottom: 8px; }
          .batch-actions button { flex: 1; padding: 6px 0; border: none; border-radius: 4px; cursor: pointer; font-size: 13px; transition: background 0.2s; }
          #generateMultiBtn { background: #337AFF; color: #fff; }
          #generateMultiBtn:hover { background: #2860E0; }
          #copyMultiBtn { background: #f5f5f5; color: #333; }
          #copyMultiBtn:hover { background: #e0e0e0; }
      </style>
    <script src="https://api.tianditu.gov.cn/api?v=4.0&tk=648f621977051d0199ff0f965d3fd322"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/Turf.js/6.5.0/turf.min.js"></script>
    <script src="https://lib.baomitu.com/terraformer/1.0.12/terraformer.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://unpkg.com/terraformer-wkt-parser@1.2.1/terraformer-wkt-parser.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <!-- 已移除动态备用加载器 ensureTerraformer：改为仅使用静态脚本标签加载 Terraformer 核心库与 WKT 解析器 -->
    <script>
        // 检查Turf.js是否加载成功
        window.addEventListener('load', function () {
            if (typeof turf === 'undefined') {
                console.warn('Turf.js加载失败，已启用备用面积算法');
            } else {
                console.log('Turf.js加载成功');
            }
        });
    </script>
</head>

<body>
<div id="mapContainer">
    <div id="mapLoading">
        <div class="loading-text">地图正在加载中...</div>
    </div>
</div>

<div class="wkt-input-container">
    <div class="minimize-btn" id="minimizeBtn">
        <span class="min-icon">−</span>
        <span class="restore-icon" style="display:none;">+</span>
    </div>

    <div class="content-wrapper">
        <div class="tabs-header">
            <button class="tab-btn active" id="tabDrawBtn">轮廓</button>
            <button class="tab-btn" id="tabTrackBtn">轨迹</button>
            <button class="tab-btn" id="tabSplitBtn">分割器</button>
            <button class="tab-btn" id="tabBatchBtn">合并器</button>
        </div>
        <div class="tab-pane active" id="tabDraw">
            <div class="tip">请输入WKT字符串（支持POLYGON/MULTIPOLYGON）：</div>
            <textarea id="wktTextarea">POLYGON ((124.4711405316146 45.33690998095808, 124.47114020567108 45.3369101263015, 124.47113794999183 45.336911635699465, 124.47113615256859 45.336913425158336, 124.47113488175668 45.33691542662581, 124.47113418588442 45.336917563987036, 124.47113409141558 45.33691975595918, 124.47113460194291 45.33692191918254, 124.47113569805121 45.33692397139075, 124.4711373380563 45.336925834539265, 124.47113945958928 45.3369274377734, 124.4711419819695 45.33692872012286, 124.47114480927178 45.33692963282049, 124.47114783397517 45.3369301411568, 124.47115094105166 45.33693022579999, 124.47115401234032 45.336929883531106, 124.47115693104148 45.33692912736648, 124.47117644814922 45.336922483247776, 124.4711755856339 45.33692412394476, 124.47117508982663 45.33692626083989, 124.47117518390493 45.33692842514015, 124.47117586438104 45.3369305366019, 124.47117710602544 45.33693251694057, 124.47117820565197 45.336933628469154, 124.47116748989845 45.33694726669993, 124.4711628884876 45.33694861345328, 124.47116006869125 45.336949684361166, 124.47115760922334 45.33695113110315, 124.47115560930968 45.336952895311256, 124.47115414963574 45.336954905809556, 124.47115328909125 45.33695708148566, 124.47115306239444 45.336959334563126, 124.47115347869143 45.33696157414284, 124.4711545211869 45.336963709870226, 124.47115454648231 45.33696374012749, 124.47114605351842 45.33697454934109, 124.47114485086892 45.33697649226315, 124.47114418662356 45.33697855985113, 124.47114408438985 45.336980678622396, 124.4711445478013 45.336982773275246, 124.47114556038811 45.336984769365145, 124.47114708616282 45.336986595950506, 124.47114907089885 45.336988188113985, 124.47115144405838 45.336989489269634, 124.47115412129847 45.336990453173996, 124.4711570074694 45.336991045569654, 124.47115999999572 45.336991245402714, 124.47118278924933 45.33699124540556, 124.4711994785337 45.33700727590795, 124.47119899835593 45.337007596502694, 124.47119724541619 45.337009311947426, 124.47119597879616 45.33701122850421, 124.47119524327964 45.337013278409486, 124.47119506487242 45.337015389184934, 124.47119544988232 45.3370174862, 124.47120444987516 45.3370454862013, 124.47120540299342 45.33704752479651, 124.47120688797702 45.33704939852357, 124.47120885071821 45.33705103911019, 124.47121121970153 45.337052386778986, 124.47121390860912 45.33705339242547, 124.4712168194664 45.33705401940728, 124.47121984621151 45.33705424487935, 124.4712228785603 45.33705406062622, 124.47122580602398 45.337053473361465, 124.47122852193591 45.33705250448301, 124.47123092733749 45.33705118929353, 124.47123293458394 45.33704957571403, 124.47123447053812 45.33704772253791, 124.47123547923505 45.33704569728857, 124.47123592392144 45.337043573759246, 124.47123578839438 45.337041429324096, 124.471235723847 45.3370411065876, 124.4712362539081 45.33704140264924, 124.4712387588427 45.33704234812903, 124.47125875884578 45.33704834813008, 124.4712617327171 45.33704900677556, 124.47126483145452 45.337049244774036, 124.471265426641 45.33704920802141, 124.47126451824789 45.33705029458973, 124.47126347386688 45.33705244029243, 124.47126306136275 45.33705469016917, 124.47126329752324 45.337056952655296, 124.47126429752227 45.33706095265545, 124.4712645706867 45.337061633900035, 124.47126421160121 45.33706342932465, 124.4712640764284 45.33706557862804, 124.47126452408239 45.3370677067528, 124.47126553817844 45.33706973580631, 124.47126708159914 45.33707159152214, 124.47126909785305 45.337073205978264, 124.47127151314221 45.337074520083156, 124.47127423906328 45.33707548573855, 124.47127717584357 45.337076067599966, 124.47128021599227 45.33707624437042, 124.47128324823532 45.33707600957984, 124.47128616158811 45.33707537182189, 124.47128884941728 45.337074354439515, 124.47129121334437 45.33707299467047, 124.47132677477441 45.33704818438996, 124.47140009962854 45.33701768641833, 124.47140171200284 45.337016918601044, 124.47161755311242 45.336900004655696, 124.47172418830625 45.336845192168035, 124.47203579753317 45.33669538002756, 124.47272077879659 45.33638538742707, 124.47343870345524 45.33605142244926, 124.474055627551 45.335771456874205, 124.47431287714444 45.33565234125073, 124.47469797857578 45.3354702928879, 124.47508488211454 45.33528433923443, 124.47560868082033 45.33504043294812, 124.47588869151163 45.33491442763109, 124.47659216663867 45.3345918028397, 124.47659404325502 45.334591406309386, 124.47668404326853 45.334565406304485, 124.47668670089006 45.33456442330031, 124.47668905028159 45.334563106474754, 124.47669100821582 45.33456150247648, 124.47669244226701 45.334559745398685, 124.47678012058824 45.334716041585715, 124.47730799467706 45.335709805036664, 124.47737200799415 45.33584082819792, 124.47744900796032 45.33599082820838, 124.47744937383742 45.335991477239105, 124.47751350002402 45.3360956769944, 124.47759620168586 45.3362232169573, 124.47760315784804 45.33623712928946, 124.4776065395517 45.33630053657789, 124.47755726221159 45.336342513562045, 124.47670928961551 45.33673258091301, 124.47637405953367 45.336892688751526, 124.47615203340014 45.337000700953695, 124.47565527428542 45.33723558703603, 124.47531081002315 45.33739043369397, 124.47527245932648 45.33740045538436, 124.47526972159014 45.33740138904323, 124.47526728497749 45.33740267229665, 124.47522881777901 45.33742729130572, 124.47429843001072 45.33784551698814, 124.47400413613539 45.33798065230808, 124.47361620974826 45.338163617574494, 124.47341392524069 45.338256753485325, 124.47321592115117 45.338353409524025, 124.47321503041738 45.338352518790295, 124.47321304395751 45.338350888730616, 124.4732106540388 45.338349554992625, 124.47320794797002 45.33834856630051, 124.47320502460965 45.338347958773255, 124.47320199075389 45.338347754605124, 124.47319895723606 45.338347961254776, 124.47319603487668 45.33834857117289, 124.47319333043569 45.338349562077866, 124.4731627558108 45.338363531538405, 124.47311883559209 45.33835793385145, 124.47311563770583 45.33835775750623, 124.47311245448118 45.338358036132135, 124.47310941473972 45.3383587584535, 124.47310664149634 45.33835989523881, 124.47310424698114 45.33836140048365, 124.4731023280973 45.33836321327242, 124.47310096250015 45.33836526024362, 124.47309152428839 45.33838413665728, 124.47307240743322 45.33840612103425, 124.47307106342532 45.338408064187156, 124.4730702715186 45.33841015281963, 124.4730700609844 45.33841230972952, 124.47307043960477 45.338414455190865, 124.47307139338471 45.338416509900895, 124.4730728870698 45.33841839791125, 124.47307486544894 45.33842004943531, 124.47307725539505 45.33842140342769, 124.47307996856857 45.3384224098407, 124.47308290468243 45.33842303147423, 124.4730859552086 45.33842324535079, 124.47308900739051 45.33842304356485, 124.47309194841 45.338422433575055, 124.47309466955812 45.3384214379285, 124.47316950341362 45.33838724662006, 124.47321516442784 45.33839306614896, 124.47321829487444 45.338393243471785, 124.473221413882 45.33839298462696, 124.4732244004549 45.33839229965589, 124.47333440047073 45.33835829964958, 124.47333676880687 45.33835739220662, 124.47371576884092 45.33818139217735, 124.47392083446896 45.33808336201537, 124.474226665151 45.33794244002361, 124.47481450332877 45.33767651320958, 124.4749175879744 45.33763147489769, 124.47550758803033 45.337365474852994, 124.47551001039109 45.337364133796974, 124.47551202204451 45.33736248933579, 124.47551232222048 45.337362118219374, 124.47563986260113 45.33730534823252, 124.47593868329251 45.33716443277886, 124.47604701899999 45.33711627351494, 124.47666291342189 45.336818324566316, 124.47676976491945 45.33676839395604, 124.47742264992175 45.33646744694156, 124.47754242911995 45.33641354629852, 124.47758453997932 45.336395498810525, 124.47792182585442 45.33675726492129, 124.47802723955537 45.33693925280307, 124.47802896384822 45.336941475122785, 124.47803134970887 45.33694336883844, 124.47803427605818 45.336944837846424, 124.4782032760791 45.337010837857505, 124.47820587771302 45.33701164930053, 124.47820864238984 45.337012121775444, 124.47821148210953 45.33701224024334, 124.47821430648384 45.337012000933335, 124.47821702561234 45.337011411462726, 124.47841212882986 45.33695524538608, 124.47851462529894 45.33695524538729, 124.47865600763423 45.33705014586245, 124.47865852146205 45.33705152374657, 124.47866137332814 45.33705252192033, 124.47866444952878 45.33705310058668, 124.47869944953553 45.33705710058736, 124.47870221696664 45.337057244342496, 124.4787049778264 45.3370570475275, 124.47870764849321 45.33705651610351, 124.47883396007445 45.33702276873661, 124.47894412228717 45.337042373875036, 124.47895659563774 45.337048755592654, 124.47896165914116 45.33705312068046, 124.4789637219388 45.33705459724123, 124.47896613396325 45.3370557816861, 124.47898613396575 45.33706378168743, 124.47898907641117 45.33706469581535, 124.47899221906626 45.3370651750157, 124.47899543414007 45.337065199802616, 124.478998590897 45.33706476916816, 124.47900156097266 45.337063900623384, 124.47900422359393 45.3370626294862, 124.47900647048968 45.337061007445335, 124.47900821029371 45.33705910045838, 124.47900937225977 45.3370569860698, 124.47900990913851 45.33705475025768, 124.47900979909878 45.33705248393758, 124.4790090466152 45.33705027926564, 124.47900768228631 45.33704822589113, 124.47900576159036 45.33704640731108, 124.47900336262921 45.337044897474954, 124.47897866294979 45.33703226043473, 124.47896958596596 45.337024435450815, 124.47911077909674 45.33697081620476, 124.47935158438887 45.33687589295151, 124.47954917785508 45.33680304283128, 124.47972996588814 45.3367411154355, 124.47989879866147 45.33667918158289, 124.48005246575424 45.33663327927121, 124.48021522017315 45.33658235610754, 124.48038058792196 45.33653524060885, 124.48055450952508 45.33647958569457, 124.48074737068544 45.336440814634415, 124.48093548371298 45.3363990162176, 124.48105012467593 45.336388145090794, 124.48105247676729 45.33638779302663, 124.48105472704971 45.33638719551142, 124.48124919700648 45.33632336947204, 124.48146539236723 45.33626558453455, 124.48161113120167 45.33623064714142, 124.48161257550736 45.33623024456287, 124.48177890543803 45.33617713600344, 124.48195711363778 45.33611674322381, 124.48215816530124 45.33608802155507, 124.48216210958834 45.33608706554701, 124.482383623903 45.33600923619001, 124.48268216189838 45.335921665042065, 124.48299615714099 45.3358618564213, 124.48324934412912 45.33580902940627, 124.48350112539333 45.33578514501551, 124.48350195659044 45.3357850503455, 124.48377995664225 45.33574805033772, 124.48378214511234 45.33574764378621, 124.48404097470781 45.33568540613782, 124.484316442245 45.33570207143157, 124.4845054885955 45.33575228686789, 124.48473364311796 45.33583597673825, 124.48473480110154 45.3358363606822, 124.48498680114011 45.335911360695256, 124.48499101109718 45.335912157536804, 124.48519401113654 45.335930157539806, 124.48519726774421 45.335930209766794, 124.48520047143741 45.3359297941081, 124.48520348849677 45.33592892791294, 124.48520619299293 45.33592764733555, 124.48520847204246 45.335926005826096, 124.48521023052017 45.33592407189973, 124.48534909164671 45.33573026565553, 124.485536860888 45.335491558937974, 124.48564943973078 45.335355279250095, 124.48569933173823 45.33532483666845, 124.48580967748418 45.33535334264825, 124.48587987822981 45.33537806122116, 124.48588081437791 45.33537836461141, 124.48594481438772 45.3353973646147, 124.4860070637475 45.3354134425557, 124.4861903487473 45.33546991415255, 124.48631119472454 45.33552637498043, 124.48631349255075 45.33552726611928, 124.4864243181205 45.33556221111976, 124.48651866324386 45.33559389420834, 124.48651890386988 45.33559461872644, 124.48652018469642 45.33559661387906, 124.48652198955176 45.33559839609149, 124.48652424997579 45.335599897762584, 124.48652688022844 45.3356010619324, 124.48652978054143 45.33560184444276, 124.48656078054695 45.33560784444382, 124.48656388228125 45.335608217701214, 124.48656538446289 45.335608187311934, 124.48660309669367 45.33561490318199, 124.48660594074309 45.33561522052259, 124.48660881933925 45.33561517191779, 124.48661163859947 45.33561475895281, 124.48661430657671 45.33561399509607, 124.48661466515246 45.33561386470496, 124.48661226716777 45.33561705243547, 124.48661081389659 45.33561652888852, 124.48660778007637 45.33561592689334, 124.48660463763558 45.33561575753624, 124.48660150935292 45.335616027434185, 124.4865985174535 45.33561672604201, 124.48659577883402 45.33561782606432, 124.48656777883619 45.33563182606206, 124.48656549973092 45.335633210974294, 124.4865636300281 45.335634873171145, 124.48656223628826 45.335636753479434, 124.48656136812774 45.3356387849613, 124.48656105645237 45.33564089529721, 124.48656131235784 45.33564300936049, 124.48656212673417 45.335645051891746, 124.48656347059003 45.33564695017805, 124.48656529608493 45.33564863664154, 124.48656753823245 45.335650051245096, 124.48657634338097 45.33565462992403, 124.48657166873261 45.33565743471198, 124.48656949216753 45.33565902604138, 124.4865677991586 45.335660886985885, 124.48649179913865 45.33576588697676, 124.48649065769416 45.33576793919828, 124.48649010584579 45.3357701090447, 124.48649016480087 45.335772313130036, 124.48649083229391 45.335774466752525, 124.48649208267346 45.33577648714964, 124.48649386788831 45.33577829667866, 124.48649611933352 45.335779825800344, 124.48649875048748 45.33578101575141, 124.48650166023636 45.33578182080267, 124.48650473675998 45.33578221001643, 124.48650786182928 45.335782168435415, 124.48651091534944 45.335781697657595, 124.48651377997543 45.33578081577469, 124.4865163456213 45.33577955667696, 124.48651851369048 45.335777968750875, 124.48652020086546 45.335776113019556, 124.4865932766842 45.33567515297971, 124.48659608248657 45.33567521941977, 124.48659926751222 45.335674835086174, 124.48660227726161 45.33567400573173, 124.48660498811788 45.33567276541989, 124.48660728874019 45.33567116509299, 124.48660908463678 45.33566927047997, 124.48677608459624 45.33544727046006, 124.48677726884414 45.33544523817621, 124.48677787017164 45.335443082268135, 124.48677786562175 45.335440885042196, 124.48677725536832 45.33543873038213, 124.4867760627092 45.335436700546616, 124.48677433317657 45.3354348730289, 124.4867721327991 45.33543331759832, 124.48676954558087 45.335432093636676, 124.48676667029432 45.3354312478713, 124.48676361670948 45.33543081259103, 124.48676050140354 45.33543080441359, 124.48675744330954 45.33543122365119, 124.48675455917689 45.33543205429857, 124.48675195911314 45.33543326464401, 124.48674974238138 45.33543480848005, 124.48674799360997 45.335436626867505, 124.48665737955247 45.335554126377694, 124.48662910981754 45.33558330803376, 124.48660505481779 45.33559205530621, 124.48656739189805 45.33558534821532, 124.48643785440754 45.33554184681687, 124.48632770848899 45.33550711258571, 124.48620680528599 45.33545062502621, 124.48620438273387 45.33544969500591, 124.48601938276161 45.33539269501581, 124.48601847866483 45.33539243935521, 124.48595683545497 45.33537653143044, 124.48589366064763 45.335357776409985, 124.4858231217791 45.3353329387808, 124.48582148368035 45.33533244065106, 124.48570148369991 45.33530144065653, 124.48569819708868 45.335300861907186, 124.48569481130222 45.33530078592479, 124.48569147917284 45.33530121613914, 124.485688351111 45.33530213313063, 124.48568556831539 45.335303495506814, 124.48562656831734 45.33533949550143, 124.48562472926123 45.335340819631476, 124.48562322358805 45.33534233884453, 124.4855090577371 45.335480544514326, 124.48532105769533 45.335719544492115, 124.48518683824226 45.33590685374283, 124.4849971718309 45.33589003602331, 124.48474778882012 45.33581581488859, 124.48451935691119 45.335732023273664, 124.48451761953532 45.33573147622832, 124.48432561956632 45.33568047623728, 124.48432136262689 45.33567979576785, 124.48404036268211 45.33566279577047, 124.48403706748059 45.33566283753152, 124.48403385484856 45.33566335622389, 124.48377292861987 45.33572609802656, 124.48349645723818 45.33576289457553, 124.48324387465773 45.33578685497728, 124.48324147664195 45.335787216653465, 124.48298765915553 45.33584017856874, 124.48267284291758 45.335900143564594, 124.48267087709773 45.33590061685303, 124.48237087714232 45.335988616836524, 124.48236989038709 45.3359889344647, 124.48214977314962 45.336066272952365, 124.48194883473926 45.33609497843691, 124.48194509454194 45.33609586400534, 124.48176525864096 45.33615680839127, 124.48160013273349 45.33620952931179, 124.48145434967515 45.336244484411836, 124.481237349709 45.33630248440076, 124.48123627292765 45.33630280449803, 124.48104347174623 45.33636608283426, 124.48092987534888 45.33637685490488, 124.48092720838856 45.336377274426475, 124.48073841799906 45.336419227845354, 124.48054462935143 45.33645818535575, 124.48054241205752 45.3364587593992, 124.48036771772952 45.336514661582015, 124.48020253422665 45.33656172073599, 124.48003965758507 45.33661268213713, 124.47988578185014 45.33665864501703, 124.47988464205835 45.336659023596674, 124.47971583674072 45.33672095217167, 124.47953461329556 45.33678303416825, 124.47933622087973 45.33685618380945, 124.47909533043192 45.3369511406195, 124.47893744092711 45.337011098655815, 124.47893485356337 45.33701232533804, 124.47893265410993 45.33701388366298, 124.47893092665464 45.33701571405402, 124.47893033532361 45.337016724524375, 124.47883690112916 45.337000096393574, 124.4788337025732 45.33699976553689, 124.47883047513628 45.33699989650055, 124.47882735149012 45.33700048390102, 124.47870034014416 45.33703441823177, 124.47867441941935 45.33703145586326, 124.47853199236697 45.3369358541486, 124.47852961100007 45.336934535557916, 124.47852691916279 45.33693355820861, 124.47852401390965 45.336932957339116, 124.47852099998978 45.33693275461385, 124.478409000012 45.336932754613564, 124.47840592972796 45.33693296506514, 124.47840297436188 45.33693358854583, 124.47821204389801 45.33698855338208, 124.47805463670387 45.336927080750776, 124.47795076040508 45.33674774720726, 124.47794932242577 45.33674582154621, 124.47761180935184 45.336383811937296, 124.47766127997019 45.33636261021628, 124.47766372935804 45.3363613183828, 124.4776657839513 45.33635972046833, 124.4776673681496 45.33635787526928, 124.47766842366136 45.33635585068118, 124.47766891164815 45.33635372120016, 124.47766881415434 45.33635156518209, 124.47766813476738 45.33634946195919, 124.47766689848571 45.33634748892104, 124.47766515079937 45.33634571866704, 124.4776629560157 45.33634421633492, 124.47766039489349 45.33634303720406, 124.47765756167088 45.33634222466144, 124.47765456059844 45.33634180860512, 124.47765150210276 45.336341804344165, 124.4776484987232 45.33634221203542, 124.47764566097139 45.33634301667755, 124.47759205169191 45.33636262009861, 124.4775845299604 45.33635455237086, 124.47762369648854 45.33632118828937, 124.47762601386812 45.33632104266366, 124.47762910273853 45.33632038907476, 124.47763194195744 45.336319310488484, 124.47763441537774 45.33631785102774, 124.47763642181644 45.33631607039635, 124.47763787919405 45.33631404143655, 124.47763872789207 45.336311847149275, 124.47763893319193 45.33630957729864, 124.47763493317093 45.33623457729947, 124.47763466256525 45.33623289484446, 124.47763403685718 45.336231260117636, 124.47762603685358 45.33621526011872, 124.47762550000053 45.336214322991204, 124.47754256445742 45.33608642244474, 124.47747882339621 45.335982843263466, 124.47740203417541 45.33583325394789, 124.47733793082388 45.33570205471322, 124.47680993060278 45.33470805478445, 124.47671782569181 45.33454386272573, 124.47671661144466 45.334542143881414, 124.47665395655136 45.33446969918317, 124.4766471046584 45.33445539956589, 124.47664582247796 45.33445339519739, 124.47664401177836 45.33445160513534, 124.4766417417941 45.3344500978249, 124.47663909932052 45.33444893089992, 124.47663865851928 45.33444881261557, 124.47663528420321 45.334440798618346, 124.47663411278057 45.33443876745543, 124.47663240475832 45.334436935245655, 124.47663022507935 45.33443537165374, 124.47662765662004 45.33443413613095, 124.4766247970389 45.334433275654625, 124.47662175506365 45.33443282294201, 124.47661864635708 45.33443279520626, 124.47661558911894 45.33443319350193, 124.47661269959242 45.33443400268494, 124.47661008764385 45.33443519198834, 124.47660785258512 45.33443671619215, 124.4766060793985 45.33443851734274, 124.47660483550442 45.33444052695631, 124.47660416819868 45.33444266862283, 124.47660413090139 45.33444391992581, 124.47659833375667 45.33444141305113, 124.47659546641829 45.33444043619553, 124.4765923810361 45.33443988070771, 124.47658920067953 45.33443976874489, 124.47658605220613 45.33444010477303, 124.4765830612019 45.3344408753887, 124.47658034697153 45.33444204985367, 124.47657801777993 45.33444358132104, 124.47657616653377 45.33444540870381, 124.47657301710457 45.33444928492411, 124.47651827696681 45.33446125932627, 124.47651531666557 45.334462146468866, 124.47651266905004 45.33446343461689, 124.47649843257418 45.33447197650158, 124.4759293644536 45.334734546505786, 124.47571034273665 45.3348325567096, 124.47534634277048 45.33499855668183, 124.47500279863846 45.33515934236069, 124.4749625346401 45.33517461493153, 124.4749085285926 45.33518953375192, 124.47510748925508 45.335094810767586, 124.47536400868944 45.334974889818334, 124.47571236148735 45.33481581580288, 124.47600279615212 45.33468537921225, 124.47611373522672 45.33463362255827, 124.47616475696962 45.334610397427994, 124.47645322628074 45.334476675619776, 124.47657559862014 45.334429886152925, 124.47657916870446 45.334428025317294, 124.47660516870454 45.33441002531476, 124.47660713698065 45.3344083723631, 124.47660862121543 45.334406484617254, 124.47660956672122 45.334404431632514, 124.47660993866026 45.33440228905259, 124.47660972332818 45.33440013582233, 124.47660892865922 45.33439805127899, 124.47660758393351 45.33439611222902, 124.47660573869848 45.33439439011808, 124.47660346094317 45.33439294839849, 124.4766008345929 45.33439184019141, 124.4765979564174 45.33439110632949, 124.4765949324651 45.334390773852355, 124.47659187415559 45.334390855010376, 124.47658981714757 45.33439119448981, 124.47658989195254 45.334390907243424, 124.47658982732824 45.33438864250113, 124.47658488397799 45.3343599711161, 124.47658191312125 45.33432630151253, 124.47658142986819 45.33432416755574, 124.47658103654538 45.33432340957782, 124.47655269751685 45.334211030788644, 124.4765524305236 45.334210169416096, 124.47649365736166 45.33405078468896, 124.47645410963639 45.33385497551008, 124.47667332710874 45.33373812388013, 124.47696992586006 45.33359431841263, 124.47730070002119 45.333439424156055, 124.4776025799561 45.33330347821485, 124.47784683776742 45.33318336274425, 124.47809599650833 45.333071739620735, 124.47829123727448 45.33299935768557, 124.47844610490486 45.33308581752348, 124.47844873392982 45.33308700968412, 124.47845164218587 45.333087817178125, 124.47845471791051 45.33308820897391, 124.47845784290513 45.33308817001501, 124.47846089707791 45.33308770179856, 124.47846376305873 45.33308682231791, 124.47846633070935 45.33308556537099, 124.47846850135645 45.33308397926161, 124.47847019158336 45.33308212494307, 124.47847133643556 45.33308007367583, 124.47847189191704 45.33307790428894, 124.47847183668114 45.33307570015076, 124.4784711728505 45.333073545965036, 124.47846992593583 45.33307152451595, 124.47846814385544 45.333069713486616, 124.47846589509379 45.33306818247386, 124.47830289510397 45.33297718248772, 124.47830032424243 45.3329760114314, 124.47829748351673 45.33297520840728, 124.47829447759442 45.33297480300306, 124.47829141722977 45.33297481015599, 124.47828841518273 45.33297522960252, 124.47828558206487 45.33297604588798, 124.47808058209012 45.33305204587446, 124.47807945173751 45.3330525075657, 124.47782888089004 45.33316477562124, 124.47758514681999 45.3332846448265, 124.47728318127895 45.33342063142841, 124.47695218130814 45.33357563140272, 124.47665496817082 45.33371973295449, 124.47642738705086 45.33384102847319, 124.47642491512998 45.333842664721516, 124.47642298955073 45.33384463258851, 124.476421697366 45.33384684310941, 124.47642109699419 45.333849196349355, 124.47642121557726 45.333851585921344, 124.47646221552225 45.33405458592766, 124.47646256951653 45.33405583057163, 124.47652141202268 45.33421540358766, 124.47655027904834 45.334329876399835, 124.4765508543514 45.334336396524904, 124.47654935399412 45.33433704609733, 124.47654704039977 45.334338563203524, 124.47648721835674 45.33438642084377, 124.47648535831408 45.334385423695196, 124.47648255092815 45.33438445814191, 124.47647953051973 45.33438389714315, 124.47647641300017 45.334383762227766, 124.47647331800738 45.33438405857328, 124.47647036431479 45.33438477480716, 124.47567736442525 45.33464077476011, 124.47567466803063 45.33464188201554, 124.47567232900724 45.33464333844759, 124.47567043692885 45.33464508828167, 124.47566906425334 45.33464706450726, 124.47566826354793 45.334649191444036, 124.47566806547589 45.33465138764014, 124.47566847762259 45.33465356899146, 124.47566948420481 45.33465565196224, 124.47572367119488 45.33473976317738, 124.47569540241476 45.33475252963152, 124.47555123590392 45.33482060542584, 124.47530113935193 45.334934651014464, 124.47489807722523 45.33512468043909, 124.47424518274227 45.33543563016103, 124.47368239394545 45.33569453298048, 124.47353824817911 45.33575860009664, 124.47267024825742 45.33616060002973, 124.47266788206333 45.33616193944602, 124.47266591844966 45.33616357073489, 124.47266547056594 45.33616413109416, 124.47245886146477 45.33625890693879, 124.47245767735319 45.33625900147813, 124.47245472729804 45.33625966138854, 124.47245201357498 45.336260710819516, 124.4724496384271 45.3362621102324, 124.47244769134109 45.3362638069025, 124.47244743574377 45.33626414813203, 124.47181430673896 45.336554573044914, 124.47146293793891 45.336725747403754, 124.47114059085031 45.3368919213559, 124.47113826152055 45.33689338953803, 124.47113638279987 45.336895149865605, 124.47113502680723 45.336897134764364, 124.47113424559598 45.33689926803928, 124.47113406915459 45.33690146779961, 124.47113450425624 45.33690364960236, 124.47113553419864 45.336905729693875, 124.47113711944507 45.336907628224914, 124.4711391991423 45.33690927231589, 124.4711405316146 45.33690998095808), (124.47122861499979 45.33687851588993, 124.47122830065581 45.33687844425986, 124.47122769139614 45.336878149459345, 124.47122482589249 45.33687728204005, 124.47122361237463 45.33687710002417, 124.47124548478209 45.336865865022496, 124.47123273983222 45.33687705223755, 124.47122861499979 45.33687851588993), (124.47134505237834 45.3368143745898, 124.47148123726897 45.336744167238805, 124.47158728842658 45.33669250150643, 124.47149533005171 45.33673905872131, 124.47132878878939 45.33682865043056, 124.47134505237834 45.3368143745898), (124.47175539308385 45.33661060431669, 124.47183187940132 45.33657334157052, 124.47246928062489 45.336280956864876, 124.47247423640754 45.33627986491701, 124.47241923289897 45.33630460714079, 124.47211134557045 45.33644755481833, 124.47195945946534 45.33651550386032, 124.47181010573846 45.336584666775295, 124.47175539308385 45.33661060431669), (124.47265389893123 45.33623200429695, 124.47269231124825 45.33622032693223, 124.47269475947814 45.336219396387825, 124.47357669091362 45.3358104281517, 124.47404862185526 45.33559645944603, 124.47434172014525 45.33546141451108, 124.47454991890542 45.335362321419964, 124.47464944815776 45.33531302410053, 124.47474510791005 45.3352673360502, 124.47479357663619 45.33524426081481, 124.47481791546815 45.33523869765167, 124.47481881471185 45.33523847090599, 124.4748333549475 45.33523445427995, 124.47485114630601 45.33523159130484, 124.47460000619914 45.33535371431915, 124.47435719594486 45.3354696237319, 124.47340533070484 45.33590456212214, 124.47327710489296 45.33596366722572, 124.47302619253101 45.33608262566697, 124.47241633565078 45.3363635597166, 124.47206939065133 45.336520534819904, 124.47185097331688 45.33662173022702, 124.47159451909928 45.33674595857655, 124.47129420552596 45.336902600527615, 124.47124949355029 45.336921068516304, 124.47121541801 45.33693266870223, 124.47121794647602 45.3369294506502, 124.47121921470487 45.33692736357313, 124.47122036945773 45.33692476537918, 124.47123799643737 45.33691476087278, 124.47124008954218 45.33691333199808, 124.47124177912632 45.336911658398485, 124.47124300879562 45.33690979593483, 124.47124373750644 45.33690780677178, 124.47124394093632 45.336905757302944, 124.47124361229527 45.336903715934795, 124.47124336900417 45.336902888746046, 124.4712464837249 45.33690121317697, 124.47125989617042 45.33689744827649, 124.47126153792779 45.33689690937408, 124.47129853793233 45.336882909371596, 124.47130036819584 45.336882099683486, 124.47154828122484 45.33675514420993, 124.47176698844191 45.33664628992391, 124.47206329835274 45.336508449589864, 124.47206501391942 45.336507690781275, 124.4720654201166 45.3365075494787, 124.47206891270898 45.336506017454575, 124.47206963982981 45.33650594847057, 124.47207255253292 45.33650525191853, 124.4720752214315 45.33650417391651, 124.47209027892619 45.336496645168594, 124.47212270934824 45.33648241955844, 124.47264670939613 45.33624141951823, 124.47264908762702 45.336240081303224, 124.47265106216686 45.33623844885493, 124.47265256112433 45.33623658160935, 124.4726535299239 45.33623454755135, 124.47265393329221 45.3362324207392, 124.47265389893123 45.33623200429695), (124.47500839206225 45.33518275772575, 124.47501855193536 45.33517890397319, 124.47501904656508 45.33517869502321, 124.47500719293623 45.33518430989839, 124.47500721872221 45.335184287905776, 124.47500839206225 45.33518275772575), (124.47517615482023 45.33510520000625, 124.47532742567157 45.335034401576, 124.47524819445151 45.335072623642326, 124.47517615482023 45.33510520000625), (124.47642380164955 45.33455944272367, 124.47642429203131 45.33455933270066, 124.47642701634243 45.33455827460683, 124.47654901635246 45.334499274597164, 124.47655054210146 45.33449843642886, 124.47658754210254 45.33447543642546, 124.47658935355132 45.33447410925379, 124.47659083347318 45.3344725912942, 124.47659215581406 45.33447096379769, 124.47661205605286 45.33447544135146, 124.4766120560481 45.33449230365091, 124.47655979731633 45.33451096748145, 124.4765582696511 45.334511590265045, 124.47610331273813 45.3347215703629, 124.4753913560311 45.335045550637915, 124.47528112528093 45.335098657090775, 124.47498124580763 45.33523760123586, 124.47490966963232 45.33527297287629, 124.47488643963156 45.335283786837834, 124.47481176301544 45.33531444355378, 124.47480068401713 45.335318920682944, 124.47475615527645 45.33533059030756, 124.47492290011961 45.33525133034285, 124.47515074837175 45.335143402215145, 124.47526600188212 45.33509128163507, 124.47537982294371 45.335036367960775, 124.47605464079504 45.33472945078093, 124.47642380164955 45.33455944272367), (124.4757508029558 45.33472751020022, 124.4757050933473 45.33465655798201, 124.47633797419884 45.33445224890467, 124.4762118698817 45.334516778696816, 124.47609904468193 45.33457023968577, 124.4757508029558 45.33472751020022), (124.47569585705465 45.334779378263555, 124.47569664222236 45.33478088987337, 124.47569828047429 45.334782780682, 124.47570041261126 45.33478440820431, 124.47570295584494 45.334785709245416, 124.47570581142432 45.33478663328732, 124.4757088684704 45.33478714445051, 124.47571200828142 45.334787222887066, 124.47571510894203 45.33478686555138, 124.47571846938703 45.33478623339009, 124.47569509736753 45.334796906204126, 124.47565143637442 45.33481651433331, 124.47535819114957 45.33495062669559, 124.4753465362489 45.33495607532456, 124.47533233472303 45.3349625603566, 124.47509907953112 45.335071679345546, 124.47508969565281 45.335076146922404, 124.47503505992195 45.3351016886938, 124.47478426088327 45.33522147375598, 124.47477319223027 45.33522452717625, 124.47477043098175 45.33522551672649, 124.47476799308875 45.335226864132125, 124.47476597054624 45.33522851854825, 124.47476497054622 45.33522951854814, 124.47476345513518 45.33523139318721, 124.47476344417497 45.33523141605437, 124.4747272473853 45.33524870403861, 124.47463907957042 45.335290679309445, 124.47463147625645 45.33529444527612, 124.4745782635389 45.33531986012971, 124.47457647860429 45.33532049539741, 124.47421547863912 45.33548149537026, 124.474086327433 45.33554156322566, 124.47353443378712 45.33578951542489, 124.47339703682432 45.335852699685894, 124.47313013781873 45.33598065125905, 124.4729922796725 45.33604458546681, 124.47270837276955 45.336174542842265, 124.47259584484497 45.336225161634054, 124.47258122309664 45.336229606640366, 124.47270369334562 45.33617342688579, 124.47270607096517 45.336172092648894, 124.472708046557 45.336170464538114, 124.47270864305352 45.33616972464359, 124.47355562688429 45.33577745776622, 124.47369971062555 45.33571341891317, 124.47426292272364 45.33545431960964, 124.47491589174403 45.33514333433951, 124.47531875916162 45.334953396832695, 124.4755686566644 45.33483944356275, 124.47569585705465 45.334779378263555), (124.4761165357053 45.334589046783655, 124.47614659763087 45.33457547033308, 124.47640169109432 45.33445642822224, 124.47649258317863 45.3344154768405, 124.47649595960819 45.33441343680111, 124.476550670367 45.33436966820377, 124.47655849790283 45.33439262898479, 124.47655955941606 45.3343947668789, 124.47656120686351 45.33439671135444, 124.4765633733994 45.334398383513275, 124.47656597111519 45.334399715506656, 124.4765668174945 45.33439998700356, 124.47649410233076 45.33442923113363, 124.47649320380724 45.334429620824565, 124.4764512498237 45.33444919400238, 124.47638976054832 45.33447537258475, 124.47638729004288 45.334476669408666, 124.47638521910568 45.33447827703127, 124.47638362499949 45.334480135475175, 124.47638320904208 45.33448093763303, 124.47609625930124 45.334614809846805, 124.47586923713243 45.33471814958854, 124.47581120247985 45.334737494482816, 124.47588620563668 45.33469818553378, 124.4761165357053 45.334589046783655), (124.47664292880079 45.334516931201925, 124.47665810165442 45.334548596278246, 124.47662616398661 45.3345578227209, 124.47662590596182 45.3345576724883, 124.4766231765739 45.33455663270184, 124.47662021337696 45.33455598536088, 124.47661712854028 45.33455575496997, 124.47661403883798 45.33455595025038, 124.47661106122794 45.33455656380993, 124.47660830842517 45.334557572422845, 124.47587136614551 45.334895545926315, 124.4755912152859 45.33502161542992, 124.47506721533269 45.335265615389375, 124.4746800719967 45.33545168280573, 124.47429518602335 45.335633628887976, 124.47403831084554 45.33575257108186, 124.47342122114372 45.33603261262594, 124.47270330484416 45.336366573664954, 124.4720183892291 45.33667653545286, 124.47170601914597 45.33682670809553, 124.47159828798885 45.33688208141467, 124.47141071868597 45.336983681494395, 124.4714524329006 45.336947040599114, 124.47145343253455 45.33694596698891, 124.47156942327739 45.33688507175415, 124.47174612775555 45.336795222011766, 124.47202277092086 45.336663392045104, 124.47261478399734 45.33639538500777, 124.47347170693126 45.33599642085789, 124.4742209465276 45.33565630826583, 124.47511186941612 45.33523034510041, 124.47565865708522 45.334975444065286, 124.47588069808909 45.33487642461042, 124.47657769815301 45.334556424557, 124.47658001081659 45.334555133143894, 124.47662901081696 45.33452213313921, 124.47663131931941 45.33452018122986, 124.47663294731517 45.334517913510986, 124.47663440840748 45.334515137435005, 124.47664292880079 45.334516931201925), (124.47655925772531 45.334538012533145, 124.47655906046889 45.334538145379156, 124.47654182357228 45.33454605911215, 124.47655925772531 45.334538012533145), (124.47586824786435 45.33485530467782, 124.47586339020796 45.33485753485156, 124.47586122935333 45.33485849850607, 124.47586824786435 45.33485530467782), (124.47546137548993 45.33504045383243, 124.47537136301825 45.33508241599065, 124.47540882040747 45.33506436907315, 124.47546137548993 45.33504045383243), (124.47505674174991 45.335229531307064, 124.47495728568539 45.335277083282676, 124.47495777067662 45.33527666118628, 124.47499895418923 45.33525630609899, 124.47505674174991 45.335229531307064), (124.47429019359257 45.335527038151206, 124.4742362366294 45.33555260483666, 124.47389472941497 45.33570773993433, 124.47429019359257 45.335527038151206), (124.47350141412491 45.33588745733149, 124.47313006701711 45.33606047770675, 124.47329480928356 45.33598237346339, 124.47342269603911 45.33592342565745, 124.47350141412491 45.33588745733149), (124.47137979920748 45.336913560652, 124.4716392518214 45.33677816097424, 124.47187891216423 45.336662325132124, 124.47203270771145 45.336590420714906, 124.47236670903669 45.33643941969803, 124.47297778854958 45.33615838286984, 124.47360871137427 45.3358644188057, 124.47425363361373 45.33557145410739, 124.47459789152347 45.33540833442685, 124.47466018418484 45.33537804591939, 124.4746629756123 45.33537824538385, 124.47466612619044 45.33537802712146, 124.474701410389 45.33537305115173, 124.47434512262127 45.33554365862618, 124.47413527771505 45.335641586241515, 124.47341024177169 45.33597160305049, 124.47255830086797 45.3363665756228, 124.47199536028371 45.33662254858685, 124.47181698888336 45.33670672269009, 124.4716384385577 45.33679300086015, 124.47144552402519 45.336894955681444, 124.47130220013291 45.336968608231324, 124.47126460098946 45.336984439458995, 124.47127888270374 45.33695766120582, 124.47128146369805 45.336958545755856, 124.47128447303956 45.33695910327938, 124.47128757860645 45.33695923799578, 124.47129066214045 45.33695894477516, 124.47129360622185 45.33695823478321, 124.47129629874188 45.33695713505606, 124.47137529874769 45.33691713504961, 124.47137760745362 45.336915709779596, 124.47137948634426 45.33691399902224, 124.47137979920748 45.336913560652), (124.47427006749756 45.33560565182154, 124.47420321085147 45.33563761648979, 124.47405398149795 45.33570535833687, 124.47415264584356 45.335660448552495, 124.47427006749756 45.33560565182154), (124.47319148363047 45.33609993859023, 124.47259730123609 45.336376575309636, 124.47211149619295 45.33659650095811, 124.47257575815618 45.336385397012734, 124.47319148363047 45.33609993859023), (124.47193175556376 45.33667962349533, 124.47176757339705 45.33675785964408, 124.47183493925574 45.33672531202897, 124.47193175556376 45.33667962349533), (124.47171772749566 45.33678194249444, 124.47158102428449 45.33685144891529, 124.47165729046529 45.33681114235075, 124.47171772749566 45.33678194249444), (124.47135429446935 45.33699732048413, 124.47135413818638 45.336997457759495, 124.47130716388777 45.337030230544094, 124.47128007402945 45.33704149799305, 124.47128059194912 45.33704035230057, 124.47128094290983 45.33703816789448, 124.47128068457903 45.33703597707196, 124.4712798268294 45.33703386355986, 124.47127840244161 45.33703190813045, 124.4712605286014 45.33701234810012, 124.4713061657204 45.33699313246831, 124.47130277844548 45.33699482610196, 124.47130043165525 45.33699626102288, 124.47129852382407 45.33699798959815, 124.47129712734447 45.3369999462373, 124.47129629520558 45.33700205669587, 124.47129605898299 45.33700424089287, 124.47129642764006 45.33700641594923, 124.4712973871883 45.33700849933273, 124.4712989012179 45.33701041198966, 124.47130091227909 45.337012081344476, 124.47130334406259 45.337013444053746, 124.47130610429456 45.337014448409626, 124.47130908823846 45.33701505630194, 124.47131218266878 45.337015244664286, 124.47131527016779 45.337015006349276, 124.47131823358075 45.33701435039977, 124.47132096046121 45.33701330170568, 124.47135429446935 45.33699732048413), (124.47125134492603 45.33694541200465, 124.47123218712457 45.336981332898745, 124.47122540243393 45.3369739081367, 124.47122342301203 45.33697215437723, 124.4712209897197 45.336970712347906, 124.47121819923893 45.33696963934486, 124.47121516244394 45.33696897800173, 124.47121199999566 45.33696875459562, 124.47119893673073 45.33696875459782, 124.47119387669738 45.33696389429869, 124.47121611152238 45.33695738654233, 124.47121693104758 45.33695712736535, 124.47125134492603 45.33694541200465), (124.47744610628833 45.33642049770214, 124.47744778626559 45.336422228776485, 124.47745001498126 45.33642376727844, 124.47745262568237 45.33642497038085, 124.47745551849412 45.33642579205802, 124.4774558368033 45.33642583452527, 124.47740527692892 45.336448586776505, 124.4767522769884 45.33674958672632, 124.47664498095381 45.33679972653136, 124.47602923679383 45.337097602741615, 124.47592113737731 45.33714565178827, 124.47562231237262 45.33728656925476, 124.47548597091668 45.33734725305854, 124.47544342887882 45.337357488753554, 124.47567257012318 45.33725448290681, 124.47616987901972 45.33701934045742, 124.47639199711561 45.336911284191864, 124.47672682610605 45.33675136585546, 124.47744610628833 45.33642049770214), (124.47754164130502 45.336381053738585, 124.47756055827917 45.33636977629893, 124.47756358974962 45.3363730278229, 124.47754164130502 45.336381053738585), (124.4752824661961 45.337440277590986, 124.4749005071935 45.337612482196114, 124.47479739118604 45.337657534509965, 124.47420939124147 45.337923534465325, 124.47390327879124 45.33806458579599, 124.4736981419682 45.33816264924104, 124.47332036079675 45.33833808323122, 124.47327398938552 45.33835241622935, 124.47343189707638 45.33827533325084, 124.47363386383542 45.338182347719645, 124.47402178223057 45.3379993861945, 124.47431563517704 45.33786445370885, 124.47522827957538 45.33745420405058, 124.47523068346028 45.33745408499115, 124.47523372251848 45.33745349619684, 124.4752824661961 45.337440277590986))</textarea>
            <div class="coord-settings" style="margin-bottom:8px;font-size:12px;color:#333;">
                <label>WKT坐标系：
                    <select id="coordSysSelect" style="margin-left:6px;">
                        <option value="wgs84" selected>WGS84</option>
                        <option value="gcj02">GCJ-02（国测局）</option>
                        <option value="bd09">BD-09（百度）</option>
                        <option value="cgcs2000">CGCS2000</option>
                    </select>
                </label>
                <!-- 已移除“不进行绘制坐标转换”选项，统一使用WGS84绘制 -->
            </div>

            <div class="button-group">
                <button id="drawButton" disabled>绘制轮廓</button>
                <button id="clearButton" disabled>清空轮廓</button>
            </div>
            <!-- 显示开关：仅保留显示亩数 -->
            <div class="display-toggles" style="margin-top:8px;font-size:12px;color:#333;">
                <label><input type="checkbox" id="toggleLabelsCheckbox"> 显示亩数</label>
            </div>
        </div>

        <div class="tab-pane" id="tabSplit">
            <!-- MultiPolygon → 多个 Polygon 分割器 -->
            <div class="split-section">
                <div class="title">MultiPolygon → 多个 Polygon 分割器</div>
                <div class="desc">输入一个 MULTIPOLYGON WKT，分割为多行 POLYGON WKT。</div>
                <textarea id="multiInput"></textarea>
                <div class="split-actions">
                    <button id="splitMultiBtn">分割为多个 POLYGON</button>
                    <button id="copyPolysBtn">复制结果</button>
                </div>
                <textarea id="polyOutput" readonly></textarea>
            </div>
        </div>

        <div class="tab-pane" id="tabBatch">
            <!-- 批量POLYGON → MULTIPOLYGON 生成器 -->
            <div class="batch-section">
                <div class="title">批量POLYGON → MULTIPOLYGON 合并器</div>
                <div class="desc">每行一个 POLYGON WKT（或用分号分隔）。生成后可一键填充到上方并绘制。</div>
                <textarea id="batchInput"></textarea>
                <div class="batch-actions">
                    <button id="generateMultiBtn">生成 MULTIPOLYGON</button>
                    <button id="copyMultiBtn">复制结果</button>
                </div>
                <textarea id="multiOutput" readonly></textarea>
            </div>
        </div>
        <div class="tab-pane" id="tabTrack">
            <div class="tip">请粘贴轨迹文本（支持两种格式：1）每行一条：定位时间yyyyMMddHHmmss, 经度, 纬度；2）单行#分隔：经度,纬度,定位时间yyyyMMddHHmmss#经度,纬度,定位时间yyyyMMddHHmmss#…）。</div>
            <div class="coord-settings" style="margin-bottom:8px;font-size:12px;color:#333;">
                <label>轨迹坐标系：
                    <select id="trackCoordSysSelect" style="margin-left:6px;">
                        <option value="wgs84" selected>WGS84</option>
                        <option value="gcj02">GCJ-02（国测局）</option>
                        <option value="bd09">BD-09（百度）</option>
                        <option value="cgcs2000">CGCS2000</option>
                    </select>
                </label>
            </div>
            <textarea id="trackTextarea" style="width:100%;height:120px;margin-bottom:10px;padding:8px;border:1px solid #ddd;border-radius:4px;font-family:monospace;resize:vertical;box-sizing:border-box;">20251006153811,124.504473,45.342184
20251006153821,124.504463,45.342162
20251006153831,124.504459,45.342142
20251006153841,124.504451,45.342118
20251006153851,124.504453,45.342096
20251006153901,124.504456,45.342035
20251006154001,124.503752,45.341887
20251006154011,124.503277,45.341737
20251006154021,124.502925,45.341630
20251006154031,124.502514,45.341465
20251006154041,124.502035,45.341246
20251006154051,124.501582,45.341046
20251006154101,124.501140,45.340827
20251006154111,124.500660,45.340593
20251006154121,124.500221,45.340362
20251006154131,124.499995,45.340261
20251006154141,124.499874,45.340199
20251006154151,124.499526,45.340041
20251006154201,124.498885,45.339735
20251006154211,124.498509,45.339552
20251006154221,124.498186,45.339393
20251006154231,124.497849,45.339241
20251006154241,124.497551,45.339100
20251006154251,124.497262,45.338966
20251006154301,124.496812,45.338672
20251006154311,124.496032,45.338241
20251006154321,124.495355,45.337942
20251006154331,124.494736,45.337675
20251006154341,124.494470,45.337566
20251006154351,124.494469,45.337567
20251006154401,124.494469,45.337567
20251006154411,124.494469,45.337567
20251006154421,124.494469,45.337567
20251006154431,124.494469,45.337567
20251006154441,124.494402,45.337539
20251006154451,124.494402,45.337539
20251006154501,124.494389,45.337535
20251006154511,124.494171,45.337458
20251006154521,124.493804,45.337357
20251006154531,124.493192,45.337195
20251006154541,124.492457,45.336954
20251006154552,124.491722,45.336690
20251006154602,124.491003,45.336439
20251006154612,124.490381,45.336187
20251006154622,124.490016,45.335956
20251006154632,124.489379,45.335479
20251006154642,124.489042,45.334893
20251006154652,124.488858,45.334497
20251006154702,124.488441,45.334261
20251006154712,124.488003,45.334044
20251006154722,124.487797,45.334048
20251006154732,124.487688,45.334185
20251006154742,124.487513,45.334419
20251006154752,124.487253,45.334772
20251006154802,124.487098,45.335006
20251006154812,124.487087,45.335017
20251006154822,124.487087,45.335017
20251006154832,124.487052,45.335053
20251006154842,124.486861,45.335203
20251006154852,124.486764,45.335162
20251006154902,124.486636,45.335099
20251006154912,124.486520,45.335035
20251006154922,124.486472,45.335010
20251006154932,124.486369,45.334960
20251006154942,124.485961,45.334776
20251006154952,124.485534,45.334609
20251006155002,124.485309,45.334517
20251006155012,124.485142,45.334447
20251006155022,124.484941,45.334377
20251006155032,124.484432,45.334217
20251006155042,124.484088,45.334198
20251006155052,124.483535,45.334123
20251006155102,124.483003,45.333982
20251006155112,124.482571,45.334033
20251006155122,124.482347,45.334005
20251006155132,124.481838,45.334000
20251006155142,124.481084,45.333960
20251006155152,124.480567,45.333860
20251006155202,124.480099,45.333781
20251006155212,124.479640,45.333689
20251006155222,124.479183,45.333514
20251006155232,124.478809,45.333288
20251006155242,124.478456,45.333077
20251006155252,124.478293,45.332986
20251006155302,124.478088,45.333062
20251006155312,124.477838,45.333174
20251006155322,124.477594,45.333294
20251006155332,124.477292,45.333430
20251006155342,124.476961,45.333585
20251006155352,124.476664,45.333729
20251006155402,124.476437,45.333850
20251006155412,124.476478,45.334053
20251006155422,124.476537,45.334213
20251006155432,124.476566,45.334328
20251006155442,124.476566,45.334327
20251006155452,124.476566,45.334329
20251006155502,124.476569,45.334360
20251006155512,124.476569,45.334360
20251006155522,124.476569,45.334361
20251006155532,124.476574,45.334390
20251006155542,124.476559,45.334346
20251006155552,124.476484,45.334406
20251006155602,124.476393,45.334447
20251006155612,124.476274,45.334503
20251006155622,124.476138,45.334566
20251006155632,124.475994,45.334630
20251006155642,124.475850,45.334697
20251006155652,124.475704,45.334762
20251006155702,124.475560,45.334830
20251006155712,124.475411,45.334898
20251006155722,124.475384,45.334911
20251006155732,124.475381,45.334912
20251006155742,124.475381,45.334912
20251006155752,124.475381,45.334912
20251006155802,124.475381,45.334912
20251006155812,124.475381,45.334912
20251006155822,124.475381,45.334912
20251006155832,124.475381,45.334912
20251006155842,124.475381,45.334912
20251006155852,124.475381,45.334912
20251006155902,124.475381,45.334912
20251006155912,124.475381,45.334912
20251006155922,124.475381,45.334912
20251006155932,124.475310,45.334944
20251006155942,124.475206,45.334993
20251006155952,124.475095,45.335045
20251006160002,124.474965,45.335107
20251006160012,124.474907,45.335134
20251006160022,124.474786,45.335192
20251006160032,124.474660,45.335252
20251006160042,124.474531,45.335314
20251006160052,124.474392,45.335380
20251006160102,124.474254,45.335445
20251006160112,124.474110,45.335511
20251006160122,124.473970,45.335576
20251006160132,124.473831,45.335639
20251006160142,124.473691,45.335704
20251006160152,124.473547,45.335768
20251006160202,124.473409,45.335832
20251006160212,124.473273,45.335895
20251006160222,124.473137,45.335958
20251006160232,124.473212,45.335923
20251006160242,124.473211,45.335924
20251006160252,124.473211,45.335924
20251006160302,124.473211,45.335924
20251006160312,124.473211,45.335924
20251006160322,124.473206,45.335926
20251006160332,124.473071,45.335989
20251006160342,124.472946,45.336047
20251006160352,124.472810,45.336110
20251006160402,124.472685,45.336168
20251006160412,124.472699,45.336161
20251006160422,124.472679,45.336170
20251006160432,124.472695,45.336164
20251006160442,124.472695,45.336164
20251006160452,124.472695,45.336164
20251006160502,124.472695,45.336164
20251006160512,124.472695,45.336164
20251006160522,124.472695,45.336164
20251006160531,124.472658,45.336181
20251006160541,124.472545,45.336232
20251006160551,124.472425,45.336287
20251006160601,124.472420,45.336290
20251006160611,124.472441,45.336280
20251006160621,124.472434,45.336283
20251006160631,124.472389,45.336304
20251006160641,124.472304,45.336343
20251006160651,124.472185,45.336398
20251006160701,124.472071,45.336450
20251006160711,124.471941,45.336509
20251006160721,124.471823,45.336564
20251006160731,124.471707,45.336620
20251006160741,124.471591,45.336676
20251006160751,124.471472,45.336735
20251006160801,124.471354,45.336796
20251006160811,124.471229,45.336860
20251006160821,124.471150,45.336901
20251006160831,124.471333,45.336807
20251006160841,124.471243,45.336886
20251006160851,124.471223,45.336893
20251006160901,124.471150,45.336919
20251006160911,124.471197,45.336903
20251006160921,124.471254,45.336887
20251006160931,124.471284,45.336876
20251006160941,124.471287,45.336874
20251006160951,124.471291,45.336873
20251006161001,124.471323,45.336857
20251006161011,124.471422,45.336807
20251006161021,124.471539,45.336746
20251006161031,124.471673,45.336679
20251006161041,124.471758,45.336637
20251006161051,124.471878,45.336581
20251006161101,124.471991,45.336529
20251006161111,124.472074,45.336490
20251006161121,124.472023,45.336513
20251006161131,124.472075,45.336490
20251006161141,124.472066,45.336495
20251006161151,124.472082,45.336487
20251006161201,124.472057,45.336498
20251006161211,124.472057,45.336498
20251006161221,124.472057,45.336498
20251006161231,124.472057,45.336498
20251006161241,124.472057,45.336498
20251006161251,124.472057,45.336498
20251006161301,124.472057,45.336498
20251006161311,124.472057,45.336498
20251006161321,124.472057,45.336498
20251006161331,124.472057,45.336498
20251006161341,124.472057,45.336498
20251006161351,124.472114,45.336473
20251006161401,124.472216,45.336426
20251006161411,124.472322,45.336377
20251006161421,124.472428,45.336329
20251006161431,124.472541,45.336277
20251006161441,124.472638,45.336232
20251006161451,124.472463,45.336270
20251006161501,124.472461,45.336271
20251006161511,124.472461,45.336270
20251006161521,124.472462,45.336271
20251006161531,124.472462,45.336270
20251006161541,124.472462,45.336270
20251006161551,124.472561,45.336248
20251006161601,124.472686,45.336210
20251006161611,124.472802,45.336157
20251006161621,124.472920,45.336102
20251006161631,124.472978,45.336075
20251006161641,124.473095,45.336021
20251006161651,124.473215,45.335964
20251006161701,124.473336,45.335908
20251006161711,124.473455,45.335854
20251006161721,124.473568,45.335801
20251006161731,124.473681,45.335750
20251006161741,124.473795,45.335698
20251006161751,124.473914,45.335644
20251006161801,124.474026,45.335593
20251006161811,124.474032,45.335590
20251006161821,124.474040,45.335587
20251006161831,124.474129,45.335546
20251006161841,124.474231,45.335499
20251006161851,124.474333,45.335452
20251006161901,124.474437,45.335402
20251006161911,124.474541,45.335353
20251006161921,124.474648,45.335300
20251006161931,124.474762,45.335246
20251006161941,124.474878,45.335191
20251006161951,124.474990,45.335138
20251006162001,124.475108,45.335081
20251006162011,124.475226,45.335026
20251006162021,124.475341,45.334972
20251006162031,124.475435,45.334929
20251006162041,124.475530,45.334886
20251006162051,124.475610,45.334849
20251006162101,124.475685,45.334815
20251006162111,124.475774,45.334775
20251006162121,124.475860,45.334735
20251006162131,124.475812,45.334757
20251006162141,124.475711,45.334776
20251006162151,124.475711,45.334776
20251006162201,124.475711,45.334776
20251006162211,124.475711,45.334776
20251006162221,124.475711,45.334776
20251006162231,124.475711,45.334776
20251006162241,124.475877,45.334689
20251006162251,124.476221,45.334526
20251006162301,124.476477,45.334395
20251006163205,124.475684,45.334651
20251006163215,124.475751,45.334755
20251006163226,124.475786,45.334758
20251006163235,124.475787,45.334758
20251006163245,124.475877,45.334728
20251006163255,124.476000,45.334672
20251006163305,124.476131,45.334612
20251006163315,124.476095,45.334628
20251006163325,124.476109,45.334622
20251006163335,124.476091,45.334630
20251006163345,124.476091,45.334630
20251006163355,124.476091,45.334630
20251006163405,124.476091,45.334630
20251006163415,124.476091,45.334630
20251006163425,124.476091,45.334630
20251006163435,124.476091,45.334630
20251006163445,124.476091,45.334630
20251006163455,124.476091,45.334630
20251006163505,124.476156,45.334601
20251006163515,124.476264,45.334551
20251006163525,124.476379,45.334497
20251006163535,124.476494,45.334444
20251006163545,124.476499,45.334442
20251006163555,124.476398,45.334485
20251006163605,124.476568,45.334420
20251006163615,124.476594,45.334402
20251006163625,124.476502,45.334439
20251006163635,124.476364,45.334504
20251006163645,124.476179,45.334590
20251006163655,124.475994,45.334676
20251006163705,124.475806,45.334761
20251006163715,124.475660,45.334826
20251006163726,124.475510,45.334895
20251006163736,124.475367,45.334960
20251006163746,124.475239,45.335020
20251006163756,124.475044,45.335111
20251006163806,124.474857,45.335200
20251006163816,124.474670,45.335289
20251006163826,124.474596,45.335324
20251006163836,124.474575,45.335335
20251006163846,124.474585,45.335330
20251006163856,124.474585,45.335330
20251006163906,124.474585,45.335330
20251006163916,124.474585,45.335330
20251006163926,124.474585,45.335330
20251006163936,124.474585,45.335330
20251006164348,124.474224,45.335491
20251006164358,124.474095,45.335551
20251006164408,124.473964,45.335609
20251006164418,124.473822,45.335674
20251006164428,124.473680,45.335738
20251006164438,124.473543,45.335799
20251006164448,124.473406,45.335862
20251006164458,124.473272,45.335926
20251006164508,124.473139,45.335990
20251006164518,124.473001,45.336054
20251006164528,124.472860,45.336118
20251006164538,124.472717,45.336184
20251006164548,124.472573,45.336248
20251006164558,124.472428,45.336314
20251006164608,124.472272,45.336386
20251006164618,124.472120,45.336457
20251006164628,124.471968,45.336525
20251006164638,124.471819,45.336594
20251006164648,124.471665,45.336667
20251006164658,124.471505,45.336748
20251006164708,124.471358,45.336827
20251006164718,124.471202,45.336911
20251006164728,124.471191,45.336927
20251006164738,124.471228,45.336906
20251006164748,124.471228,45.336906
20251006165049,124.471223,45.336889
20251006165059,124.471204,45.336917
20251006165109,124.471208,45.336916
20251006165119,124.471210,45.336915
20251006165129,124.471211,45.336909
20251006165139,124.471211,45.336905
20251006165149,124.471212,45.336903
20251006165159,124.471211,45.336890
20251006165209,124.471209,45.336892
20251006165219,124.471209,45.336892
20251006165229,124.471220,45.336888
20251006165239,124.471204,45.336924
20251006165249,124.471160,45.336980
20251006165259,124.471212,45.336980
20251006165309,124.471265,45.337038
20251006165319,124.471245,45.337032
20251006165329,124.471169,45.336959
20251006165339,124.471210,45.336947
20251006165349,124.471257,45.336931
20251006165359,124.471301,45.336912
20251006165409,124.471302,45.336912
20251006165419,124.471302,45.336912
20251006165429,124.471302,45.336912
20251006165439,124.471302,45.336912
20251006165449,124.471303,45.336912
20251006165459,124.471303,45.336912
20251006165509,124.471358,45.336883
20251006165519,124.471463,45.336828
20251006165529,124.471567,45.336775
20251006165539,124.471498,45.336810
20251006165549,124.471604,45.336755
20251006165559,124.471624,45.336745
20251006165609,124.471669,45.336723
20251006165619,124.471761,45.336678
20251006165629,124.471860,45.336631
20251006165639,124.471973,45.336578
20251006165649,124.472078,45.336530
20251006165659,124.472187,45.336481
20251006165709,124.472303,45.336428
20251006165719,124.472425,45.336373
20251006165729,124.472547,45.336316
20251006165739,124.472671,45.336259
20251006165749,124.472795,45.336202
20251006165759,124.472913,45.336148
20251006165809,124.473035,45.336092
20251006165819,124.473161,45.336032
20251006165829,124.473286,45.335973
20251006165839,124.473414,45.335914
20251006165849,124.473543,45.335855
20251006165859,124.473672,45.335796
20251006165909,124.473801,45.335737
20251006165919,124.473895,45.335695
20251006165929,124.474028,45.335634
20251006165939,124.474164,45.335572
20251006165949,124.474296,45.335511
20251006165959,124.474366,45.335479
20251006170009,124.474486,45.335422
20251006170019,124.474609,45.335363
20251006170029,124.474735,45.335301
20251006170039,124.474864,45.335239
20251006170049,124.474994,45.335178
20251006170059,124.474813,45.335228
20251006170109,124.474779,45.335236
20251006170119,124.474778,45.335236
20251006170129,124.474778,45.335236
20251006170139,124.474778,45.335236
20251006170149,124.474779,45.335235
20251006170159,124.474779,45.335235
20251006170209,124.474783,45.335234
20251006170219,124.474808,45.335227
20251006170229,124.474895,45.335213
20251006170239,124.475011,45.335169
20251006170249,124.475121,45.335118
20251006170259,124.475236,45.335064
20251006170309,124.475355,45.335008
20251006170319,124.475475,45.334953
20251006170329,124.475597,45.334898
20251006170339,124.475719,45.334842
20251006170349,124.475843,45.334786
20251006170359,124.475938,45.334744
20251006170409,124.476058,45.334688
20251006170419,124.476187,45.334629
20251006170429,124.476325,45.334565
20251006170439,124.476302,45.334576
20251006170449,124.476301,45.334576
20251006170459,124.476302,45.334576
20251006170509,124.476302,45.334576
20251006170519,124.476302,45.334576
20251006170529,124.476302,45.334576
20251006170539,124.476302,45.334576
20251006170549,124.476302,45.334576
20251006170559,124.476302,45.334576
20251006170609,124.476302,45.334576
20251006170619,124.476302,45.334576
20251006170629,124.476308,45.334573
20251006170639,124.476403,45.334529
20251006170649,124.476508,45.334481
20251006170659,124.476523,45.334472
20251006170709,124.476587,45.334458
20251006170719,124.476627,45.334467
20251006170729,124.476590,45.334451
20251006170739,124.476587,45.334456
20251006170749,124.476587,45.334456
20251006170759,124.476587,45.334456
20251006170809,124.476587,45.334456
20251006170819,124.476587,45.334456
20251006170829,124.476587,45.334456
20251006170839,124.476587,45.334456
20251006170849,124.476587,45.334456
20251006170859,124.476587,45.334456
20251006170909,124.476587,45.334456
20251006170919,124.476587,45.334456
20251006170929,124.476587,45.334456
20251006170939,124.476587,45.334456
20251006170949,124.476587,45.334456
20251006170959,124.476577,45.334467
20251006171009,124.476540,45.334490
20251006171019,124.476453,45.334532
20251006171029,124.476418,45.334549
20251006171039,124.476417,45.334549
20251006171049,124.476417,45.334549
20251006171059,124.476426,45.334545
20251006171109,124.476424,45.334546
20251006171119,124.476422,45.334546
20251006171129,124.476422,45.334547
20251006171139,124.476359,45.334576
20251006171149,124.476260,45.334622
20251006171159,124.476156,45.334669
20251006171209,124.476046,45.334720
20251006171219,124.475938,45.334769
20251006171229,124.475828,45.334819
20251006171239,124.475720,45.334868
20251006171249,124.475603,45.334921
20251006171259,124.475487,45.334974
20251006171309,124.475371,45.335027
20251006171319,124.475257,45.335082
20251006171329,124.475142,45.335134
20251006171339,124.475028,45.335188
20251006171349,124.474914,45.335242
20251006171359,124.474802,45.335296
20251006171409,124.474691,45.335348
20251006171419,124.474582,45.335402
20251006171429,124.474698,45.335346
20251006171439,124.474698,45.335346
20251006171449,124.474698,45.335346
20251006171459,124.474698,45.335346
20251006171509,124.474698,45.335346
20251006171519,124.474698,45.335346
20251006171529,124.474698,45.335346
20251006171539,124.474698,45.335346
20251006171549,124.474671,45.335359
20251006171559,124.474593,45.335397
20251006171609,124.474589,45.335399
20251006171619,124.474512,45.335435
20251006171629,124.474409,45.335485
20251006171639,124.474353,45.335511
20251006171649,124.474245,45.335562
20251006171659,124.474141,45.335609
20251006171709,124.474035,45.335658
20251006171719,124.473924,45.335708
20251006171729,124.473817,45.335757
20251006171739,124.473708,45.335806
20251006171749,124.473600,45.335855
20251006171759,124.473496,45.335904
20251006171809,124.473390,45.335952
20251006171819,124.473287,45.336000
20251006171829,124.473182,45.336049
20251006171839,124.473077,45.336098
20251006171849,124.472969,45.336149
20251006171859,124.472856,45.336201
20251006171909,124.472745,45.336251
20251006171919,124.472637,45.336301
20251006171929,124.472529,45.336351
20251006171939,124.472420,45.336401
20251006171949,124.472461,45.336382
20251006171959,124.472419,45.336402
20251006172009,124.472358,45.336430
20251006172019,124.472261,45.336474
20251006172029,124.472227,45.336489
20251006172039,124.472212,45.336496
20251006172049,124.472227,45.336489
20251006172059,124.472227,45.336489
20251006172109,124.472227,45.336489
20251006172119,124.472227,45.336489
20251006172129,124.472209,45.336498
20251006172139,124.472130,45.336533
20251006172149,124.472024,45.336581
20251006172159,124.471958,45.336612
20251006172209,124.471870,45.336653
20251006172219,124.471801,45.336686
20251006172229,124.471732,45.336719
20251006172239,124.471658,45.336755
20251006172249,124.471630,45.336769
20251006172259,124.471547,45.336812
20251006172309,124.471452,45.336862
20251006172319,124.471508,45.336832
20251006172329,124.471384,45.336897
20251006172339,124.471298,45.336942
20251006172349,124.471287,45.336948
20251006172359,124.471366,45.336908
20251006172409,124.471366,45.336908
20251006172419,124.471366,45.336908
20251006172429,124.471366,45.336908
20251006172439,124.471366,45.336908
20251006172449,124.471366,45.336908
20251006172459,124.471366,45.336908
20251006172509,124.471366,45.336908
20251006172519,124.471365,45.336908
20251006172529,124.471319,45.336929
20251006172539,124.471286,45.336941
20251006172549,124.471286,45.336941
20251006172559,124.471267,45.336948
20251006172610,124.471219,45.337038
20251006172620,124.471220,45.337043
20251006172630,124.471211,45.337015
20251006172640,124.471235,45.337010
20251006172650,124.471311,45.336978
20251006172700,124.471378,45.336944
20251006172710,124.471455,45.336904
20251006172720,124.471551,45.336853
20251006172730,124.471648,45.336802
20251006172740,124.471739,45.336758
20251006172750,124.471826,45.336716
20251006172800,124.471915,45.336674
20251006172810,124.472004,45.336632
20251006172820,124.472092,45.336592
20251006172830,124.472184,45.336551
20251006172840,124.472287,45.336504
20251006172850,124.472393,45.336455
20251006172900,124.472372,45.336464
20251006172910,124.472470,45.336420
20251006172920,124.472567,45.336376
20251006172930,124.472650,45.336337
20251006172940,124.472733,45.336299
20251006172950,124.472812,45.336262
20251006173000,124.472904,45.336220
20251006173010,124.473009,45.336172
20251006173020,124.473113,45.336123
20251006173030,124.473215,45.336075
20251006173040,124.473317,45.336028
20251006173050,124.473419,45.335981
20251006173100,124.473523,45.335934
20251006173110,124.473626,45.335887
20251006173120,124.473729,45.335839
20251006173130,124.473835,45.335792
20251006173140,124.473936,45.335745
20251006173150,124.474040,45.335699
20251006173200,124.474144,45.335651
20251006173210,124.474251,45.335601
20251006173220,124.474354,45.335553
20251006173230,124.474460,45.335502
20251006173240,124.474569,45.335449
20251006173250,124.474680,45.335396
20251006173300,124.474781,45.335348
20251006173310,124.474887,45.335297
20251006173320,124.474945,45.335270
20251006173330,124.474930,45.335276
20251006173340,124.474887,45.335297
20251006173350,124.474741,45.335356
20251006173400,124.474663,45.335367
20251006173410,124.474663,45.335367
20251006173420,124.474663,45.335367
20251006173430,124.474663,45.335367
20251006173440,124.474663,45.335367
20251006173450,124.474663,45.335367
20251006173500,124.474663,45.335367
20251006173510,124.474679,45.335363
20251006173520,124.474808,45.335329
20251006173530,124.474903,45.335290
20251006173540,124.474990,45.335247
20251006173550,124.475084,45.335204
20251006173600,124.475180,45.335159
20251006173610,124.475290,45.335108
20251006173620,124.475400,45.335055
20251006173630,124.475450,45.335033
20251006173640,124.475543,45.334989
20251006173650,124.475640,45.334945
20251006173700,124.475738,45.334901
20251006173710,124.475836,45.334856
20251006173720,124.475937,45.334811
20251006173730,124.476007,45.334779
20251006173740,124.476112,45.334731
20251006173750,124.476212,45.334684
20251006173800,124.476324,45.334633
20251006173810,124.476433,45.334583
20251006173820,124.476546,45.334531
20251006173830,124.476552,45.334528
20251006173840,124.476567,45.334521
20251006173850,124.476623,45.334501
20251006173900,124.476661,45.334509
20251006173910,124.476637,45.334487
20251006173920,124.476620,45.334444
20251006173930,124.476619,45.334444
20251006173940,124.476619,45.334444
20251006173950,124.476619,45.334444
20251006174000,124.476619,45.334444
20251006174010,124.476619,45.334444
20251006174020,124.476619,45.334444
20251006174030,124.476619,45.334444
20251006174040,124.476619,45.334444
20251006174050,124.476619,45.334444
20251006174100,124.476619,45.334444
20251006174110,124.476619,45.334444
20251006174120,124.476619,45.334444
20251006174130,124.476628,45.334463
20251006174140,124.476628,45.334495
20251006174150,124.476618,45.334514
20251006174200,124.476569,45.334547
20251006174210,124.476495,45.334581
20251006174220,124.476397,45.334626
20251006174230,124.476293,45.334674
20251006174240,124.476188,45.334722
20251006174250,124.476083,45.334770
20251006174300,124.475977,45.334819
20251006174310,124.475872,45.334867
20251006174320,124.475759,45.334917
20251006174330,124.475650,45.334966
20251006174340,124.475541,45.335017
20251006174350,124.475433,45.335068
20251006174400,124.475323,45.335119
20251006174410,124.475213,45.335170
20251006174420,124.475103,45.335221
20251006174430,124.474993,45.335273
20251006174440,124.474886,45.335325
20251006174450,124.474777,45.335377
20251006174500,124.474664,45.335430
20251006174510,124.474550,45.335485
20251006174520,124.474442,45.335538
20251006174530,124.474335,45.335589
20251006174540,124.474224,45.335641
20251006174550,124.474337,45.335588
20251006174600,124.474337,45.335588
20251006174610,124.474337,45.335588
20251006174620,124.474337,45.335588
20251006174630,124.474337,45.335588
20251006174640,124.474336,45.335588
20251006174650,124.474326,45.335593
20251006174700,124.474212,45.335647
20251006174710,124.474128,45.335685
20251006174720,124.474025,45.335732
20251006174730,124.473921,45.335779
20251006174740,124.473826,45.335823
20251006174750,124.473726,45.335868
20251006174800,124.473759,45.335853
20251006174810,124.473735,45.335864
20251006174820,124.473735,45.335864
20251006174830,124.473735,45.335864
20251006174840,124.473735,45.335864
20251006174850,124.473735,45.335864
20251006174900,124.473735,45.335864
20251006174910,124.473680,45.335889
20251006174920,124.473572,45.335938
20251006174930,124.473463,45.335987
20251006174940,124.473355,45.336037
20251006174950,124.473300,45.336063
20251006175000,124.473260,45.336081
20251006175010,124.473189,45.336114
20251006175020,124.473104,45.336154
20251006175030,124.473030,45.336188
20251006175040,124.472954,45.336224
20251006175050,124.472864,45.336266
20251006175100,124.472778,45.336306
20251006175110,124.472695,45.336344
20251006175120,124.472606,45.336386
20251006175130,124.472515,45.336427
20251006175140,124.472419,45.336470
20251006175150,124.472325,45.336513
20251006175200,124.472250,45.336547
20251006175210,124.472250,45.336547
20251006175220,124.472250,45.336547
20251006175230,124.472250,45.336547
20251006175240,124.472192,45.336574
20251006175250,124.472100,45.336615
20251006175300,124.472014,45.336654
20251006175310,124.471922,45.336697
20251006175320,124.471827,45.336743
20251006175330,124.471737,45.336786
20251006175340,124.471650,45.336830
20251006175350,124.471560,45.336876
20251006175400,124.471461,45.336928
20251006175410,124.471360,45.336981
20251006175420,124.471312,45.337004
20251006175430,124.471440,45.336940
20251006175440,124.471440,45.336940
20251006175450,124.471440,45.336940
20251006175500,124.471440,45.336940
20251006175510,124.471440,45.336940
20251006175520,124.471440,45.336940
20251006175530,124.471440,45.336940
20251006175540,124.471440,45.336940
20251006175550,124.471440,45.336940
20251006175600,124.471440,45.336940
20251006175610,124.471440,45.336940
20251006175620,124.471366,45.337005
20251006175630,124.471280,45.337065
20251006175640,124.471282,45.337055
20251006175650,124.471280,45.337059
20251006175700,124.471279,45.337055
20251006175710,124.471392,45.337008
20251006175720,124.471494,45.336952
20251006175730,124.471608,45.336891
20251006175740,124.471715,45.336836
20251006175750,124.471818,45.336786
20251006175800,124.471921,45.336736
20251006175810,124.472027,45.336686
20251006175820,124.472137,45.336636
20251006175830,124.472252,45.336585
20251006175840,124.472365,45.336534
20251006175850,124.472473,45.336484
20251006175900,124.472596,45.336429
20251006175910,124.472712,45.336376
20251006175920,124.472826,45.336322
20251006175930,124.472944,45.336268
20251006175940,124.473068,45.336211
20251006175950,124.473186,45.336155
20251006180000,124.473307,45.336100
20251006180010,124.473430,45.336042
20251006180020,124.473556,45.335984
20251006180030,124.473681,45.335928
20251006180040,124.473802,45.335873
20251006180050,124.473924,45.335817
20251006180100,124.474047,45.335762
20251006180110,124.474169,45.335705
20251006180120,124.474304,45.335643
20251006180130,124.474434,45.335581
20251006180140,124.474563,45.335521
20251006180150,124.474689,45.335461
20251006180200,124.474814,45.335400
20251006180210,124.474945,45.335338
20251006180220,124.475076,45.335275
20251006180230,124.475203,45.335216
20251006180240,124.475331,45.335156
20251006180250,124.475462,45.335095
20251006180300,124.475600,45.335031
20251006180310,124.475741,45.334967
20251006180320,124.475880,45.334905
20251006180330,124.476023,45.334839
20251006180340,124.476166,45.334773
20251006180350,124.476320,45.334703
20251006180400,124.476469,45.334634
20251006180410,124.476617,45.334567
20251006180420,124.476588,45.334581
20251006180430,124.476589,45.334581
20251006180440,124.476589,45.334581
20251006180450,124.476589,45.334581
20251006180500,124.476589,45.334581
20251006180510,124.476589,45.334580
20251006180520,124.476589,45.334580
20251006180530,124.476589,45.334580
20251006180540,124.476589,45.334580
20251006180550,124.476589,45.334580
20251006180600,124.476664,45.334559
20251006180610,124.476678,45.334555
20251006180620,124.476647,45.334491
20251006180630,124.476632,45.334459
20251006180640,124.476632,45.334459
20251006180650,124.476632,45.334459
20251006180700,124.476632,45.334459
20251006180710,124.476632,45.334459
20251006180720,124.476632,45.334459
20251006180730,124.476632,45.334459
20251006180740,124.476632,45.334459
20251006180750,124.476632,45.334460
20251006180800,124.476632,45.334459
20251006180810,124.476632,45.334459
20251006180820,124.476632,45.334459
20251006180830,124.476632,45.334459
20251006180840,124.476632,45.334459
20251006180850,124.476632,45.334459
20251006180900,124.476632,45.334459
20251006180910,124.476632,45.334459
20251006180920,124.476632,45.334460
20251006180930,124.476632,45.334460
20251006180940,124.476639,45.334474
20251006180950,124.476703,45.334548
20251006181000,124.476749,45.334630
20251006181010,124.476795,45.334712
20251006181020,124.476841,45.334800
20251006181030,124.476926,45.334960
20251006181040,124.477017,45.335131
20251006181050,124.477101,45.335288
20251006181100,124.477175,45.335426
20251006181110,124.477249,45.335567
20251006181120,124.477323,45.335706
20251006181131,124.477387,45.335837
20251006181141,124.477464,45.335987
20251006181151,124.477528,45.336091
20251006181201,124.477593,45.336190
20251006181211,124.477610,45.336219
20251006181220,124.477611,45.336219
20251006181230,124.477611,45.336219
20251006181240,124.477611,45.336219
20251006181250,124.477611,45.336219
20251006181300,124.477611,45.336219
20251006181310,124.477611,45.336219
20251006181320,124.477611,45.336219
20251006181330,124.477611,45.336219
20251006181340,124.477611,45.336219
20251006181350,124.477611,45.336219
20251006181400,124.477611,45.336219
20251006181411,124.477611,45.336219
20251006181421,124.477610,45.336219
20251006181431,124.477611,45.336219
20251006181441,124.477611,45.336219
20251006181451,124.477619,45.336235
20251006181501,124.477623,45.336310
20251006181511,124.477622,45.336305
20251006181521,124.477568,45.336351
20251006181531,124.477473,45.336394
20251006181541,124.477375,45.336440
20251006181551,124.477262,45.336491
20251006181601,124.477157,45.336540
20251006181611,124.477049,45.336590
20251006181621,124.476941,45.336640
20251006181631,124.476829,45.336691
20251006181641,124.476718,45.336742
20251006181651,124.476608,45.336795
20251006181701,124.476496,45.336848
20251006181711,124.476383,45.336902
20251006181721,124.476274,45.336955
20251006181731,124.476161,45.337010
20251006181741,124.476080,45.337048
20251006181751,124.475981,45.337095
20251006181801,124.475876,45.337144
20251006181811,124.475770,45.337195
20251006181821,124.475664,45.337245
20251006181831,124.475552,45.337296
20251006181841,124.475443,45.337345
20251006181851,124.475336,45.337393
20251006181901,124.475226,45.337442
20251006181911,124.475115,45.337492
20251006181921,124.475004,45.337541
20251006181931,124.474896,45.337590
20251006181941,124.474788,45.337639
20251006181951,124.474771,45.337646
20251006182001,124.474800,45.337633
20251006182011,124.474807,45.337630
20251006182021,124.474807,45.337631
20251006182031,124.474806,45.337631
20251006182041,124.474806,45.337631
20251006182051,124.474806,45.337631
20251006182101,124.474806,45.337631
20251006182111,124.474806,45.337631
20251006182121,124.474806,45.337631
20251006182131,124.474806,45.337631
20251006182141,124.474806,45.337631
20251006182151,124.474806,45.337631
20251006182201,124.474806,45.337631
20251006182211,124.474807,45.337631
20251006182221,124.474750,45.337656
20251006182231,124.474663,45.337695
20251006182241,124.474572,45.337736
20251006182251,124.474485,45.337776
20251006182301,124.474385,45.337821
20251006182311,124.474307,45.337855
20251006182321,124.474212,45.337899
20251006182331,124.474115,45.337944
20251006182341,124.474013,45.337990
20251006182351,124.473911,45.338038
20251006182401,124.473821,45.338080
20251006182411,124.473725,45.338125
20251006182421,124.473625,45.338173
20251006182431,124.473519,45.338221
20251006182441,124.473423,45.338266
20251006182451,124.473317,45.338318
20251006182501,124.473212,45.338369
20251006182511,124.473202,45.338359
20251006182521,124.473086,45.338412
20251006182531,124.473106,45.338389
20251006182541,124.473116,45.338369
20251006182551,124.473218,45.338382
20251006182601,124.473328,45.338348
20251006182611,124.473363,45.338332
20251006182621,124.473363,45.338332
20251006182631,124.473363,45.338332
20251006182641,124.473410,45.338310
20251006182651,124.473505,45.338265
20251006182701,124.473604,45.338220
20251006182711,124.473707,45.338172
20251006182721,124.473808,45.338124
20251006182731,124.473912,45.338074
20251006182741,124.474013,45.338028
20251006182751,124.474114,45.337981
20251006182801,124.474218,45.337933
20251006182811,124.474304,45.337894
20251006182821,124.474330,45.337883
20251006182831,124.474418,45.337843
20251006182841,124.474521,45.337796
20251006182851,124.474614,45.337754
20251006182901,124.474704,45.337713
20251006182911,124.474806,45.337667
20251006182921,124.474909,45.337622
20251006182931,124.475009,45.337576
20251006182941,124.475110,45.337531
20251006182951,124.475204,45.337489
20251006183001,124.475303,45.337445
20251006183011,124.475418,45.337393
20251006183021,124.475499,45.337356
20251006183031,124.475366,45.337388
20251006183041,124.475278,45.337411
20251006183051,124.475228,45.337443
20251006183101,124.475229,45.337443
20251006183111,124.475229,45.337443
20251006183121,124.475230,45.337443
20251006183132,124.475230,45.337442
20251006183141,124.475346,45.337411
20251006183151,124.475449,45.337376
20251006183201,124.475449,45.337376
20251006183211,124.475449,45.337376
20251006183221,124.475458,45.337373
20251006183231,124.475539,45.337337
20251006183241,124.475631,45.337296
20251006183251,124.475730,45.337250
20251006183301,124.475827,45.337204
20251006183311,124.475930,45.337155
20251006183321,124.476038,45.337107
20251006183331,124.476147,45.337054
20251006183341,124.476252,45.337003
20251006183351,124.476358,45.336952
20251006183401,124.476451,45.336907
20251006183411,124.476544,45.336862
20251006183421,124.476654,45.336809
20251006183432,124.476761,45.336759
20251006183441,124.476867,45.336710
20251006183451,124.476886,45.336701
20251006183501,124.476910,45.336690
20251006183511,124.476933,45.336680
20251006183521,124.476998,45.336649
20251006183531,124.477089,45.336608
20251006183541,124.477185,45.336563
20251006183551,124.477298,45.336511
20251006183601,124.477414,45.336458
20251006183611,124.477534,45.336404
20251006183621,124.477653,45.336353
20251006183631,124.477519,45.336402
20251006183641,124.477460,45.336415
20251006183651,124.477564,45.336353
20251006183701,124.477564,45.336353
20251006183711,124.477564,45.336353
20251006183721,124.477564,45.336353
20251006183732,124.477564,45.336353
20251006183742,124.477564,45.336353
20251006183752,124.477564,45.336353
20251006184047,124.477936,45.336752
20251006184057,124.478042,45.336935
20251006184107,124.478211,45.337001
20251006184117,124.478409,45.336944
20251006184127,124.478521,45.336944
20251006184137,124.478591,45.336991
20251006184147,124.478667,45.337042
20251006184157,124.478700,45.337046
20251006184207,124.478701,45.337046
20251006184217,124.478701,45.337046
20251006184227,124.478702,45.337046
20251006184237,124.478833,45.337011
20251006184247,124.478951,45.337032
20251006184257,124.478994,45.337054
20251006184307,124.478994,45.337054
20251006184317,124.478994,45.337054
20251006184327,124.478994,45.337054
20251006184337,124.478974,45.337046
20251006184347,124.478945,45.337021
20251006184357,124.479103,45.336961
20251006184407,124.479344,45.336866
20251006184417,124.479542,45.336793
20251006184427,124.479723,45.336731
20251006184437,124.479892,45.336669
20251006184447,124.480046,45.336623
20251006184457,124.480209,45.336572
20251006184507,124.480374,45.336525
20251006184517,124.480549,45.336469
20251006184527,124.480743,45.336430
20251006184537,124.480932,45.336388
20251006184547,124.481048,45.336377
20251006184557,124.481143,45.336345
20251006184607,124.481243,45.336313
20251006184617,124.481335,45.336289
20251006184627,124.481460,45.336255
20251006184637,124.481606,45.336220
20251006184647,124.481772,45.336167
20251006184657,124.481952,45.336106
20251006184707,124.482155,45.336077
20251006184717,124.482377,45.335999
20251006184727,124.482677,45.335911
20251006184737,124.482992,45.335851
20251006184747,124.483246,45.335798
20251006184757,124.483499,45.335774
20251006184807,124.483777,45.335737
20251006184817,124.484039,45.335674
20251006184827,124.484320,45.335691
20251006184837,124.484512,45.335742
20251006184847,124.484741,45.335826
20251006184857,124.484993,45.335901
20251006184907,124.485196,45.335919
20251006184917,124.485335,45.335725
20251006184927,124.485523,45.335486
20251006184937,124.485637,45.335348
20251006184947,124.485696,45.335312
20251006184957,124.485816,45.335343
20251006185007,124.485887,45.335368
20251006185017,124.485937,45.335383
20251006185027,124.485951,45.335387
20251006185037,124.486013,45.335403
20251006185047,124.486198,45.335460
20251006185057,124.486320,45.335517
20251006185107,124.486363,45.335530
20251006185117,124.486431,45.335552
20251006185127,124.486565,45.335597
20251006185137,124.486534,45.335591
20251006185147,124.486607,45.335604
20251006185157,124.486640,45.335592
20251006185207,124.486671,45.335560
20251006185217,124.486762,45.335442
20251006185227,124.486675,45.335558
20251006185237,124.486595,45.335664
20251006185247,124.486605,45.335627
20251006185257,124.486577,45.335641
20251006185307,124.486602,45.335654
20251006185317,124.486582,45.335666
20251006185327,124.486506,45.335771
20251006185337,124.486197,45.336196
20251006185347,124.485815,45.336728
20251006185357,124.485484,45.337304
20251006185407,124.485148,45.337879
20251006185417,124.484941,45.338230
20251006185427,124.484655,45.338692
20251006185437,124.484326,45.339252
20251006185447,124.483972,45.339840
20251006185457,124.483639,45.340376
20251006185507,124.483260,45.340795
20251006185517,124.483284,45.340877
20251006185527,124.483648,45.340922
20251006185537,124.484427,45.340928
20251006185547,124.485032,45.340822
20251006185557,124.485546,45.340834
20251006185607,124.486183,45.341115
20251006185617,124.486709,45.341428
20251006185627,124.487502,45.341837
20251006185637,124.488189,45.342170
20251006185647,124.488888,45.342466
20251006185657,124.489615,45.342780
20251006185707,124.490027,45.343062
20251006185717,124.490513,45.343413
20251006185727,124.491008,45.343782
20251006185737,124.491506,45.344233
20251006185747,124.492097,45.344728
20251006185757,124.492885,45.345081
20251006185807,124.493711,45.345442
20251006185817,124.494432,45.345757
20251006185827,124.495233,45.346105
20251006185837,124.496006,45.346452
20251006185847,124.496673,45.346747
20251006185857,124.497146,45.346919
20251006185907,124.497539,45.346609
20251006185917,124.497959,45.346318
20251006185927,124.498394,45.345820
20251006185937,124.498955,45.345141
20251006185947,124.499496,45.344519
20251006185957,124.499890,45.344095
20251006190007,124.500414,45.343550
20251006190017,124.500910,45.343031
20251006190027,124.501221,45.342695
20251006190037,124.501677,45.342733
20251006190047,124.502073,45.342452
20251006190057,124.502375,45.342328
20251006190107,124.502656,45.341907
20251006190117,124.502908,45.341642
20251006190127,124.503385,45.341783
20251006190137,124.504077,45.341963
20251006190147,124.504520,45.342067
20251006190157,124.504491,45.342019
20251006190207,124.504457,45.342084
20251006190217,124.504443,45.342147
20251006190227,124.504510,45.342243
20251006190323,124.504509,45.342242
20251006190333,124.504509,45.342242
20251006190343,124.504509,45.342242
20251006190353,124.504509,45.342242
20251006190403,124.504509,45.342242
20251006190413,124.504509,45.342242
20251006190423,124.504509,45.342242
20251006190433,124.504509,45.342242
20251006190443,124.504509,45.342242
20251006190453,124.504509,45.342242
20251006190503,124.504509,45.342242
20251006190513,124.504509,45.342242
20251006190523,124.504509,45.342242
20251006190533,124.504509,45.342242
20251006190543,124.504509,45.342242
20251006190553,124.504509,45.342242
20251006190603,124.504509,45.342242
20251006190613,124.504509,45.342242
20251006190623,124.504509,45.342242
20251006190633,124.504509,45.342242
20251006190643,124.504509,45.342242
20251006190653,124.504509,45.342242
20251006190703,124.504509,45.342242</textarea>
            <div class="button-group">
                <button id="drawTrackButton" disabled style="flex: 1;">绘制轨迹</button>
                <button id="showTrackPointsButton" disabled style="flex: 1;" class="btn-warning">打点</button>
                <button id="clearTrackButton" disabled style="flex: 1;">清空轨迹</button>
            </div>
            <!-- 回放控制 -->
            <div class="split-section" style="margin-top:8px;">
                <div class="title">轨迹回放</div>
                <div class="playback-actions" style="display:flex;gap:8px;margin-bottom:8px;">
                    <button id="playbackStartBtn" disabled>开始</button>
                    <button id="playbackPauseBtn" disabled>继续</button>
                    <button id="playbackStopBtn" disabled>结束</button>
                </div>
                <div class="playback-speed" style="display:flex;align-items:center;gap:8px;margin-bottom:8px;">
                    <label>速度：
                        <select id="playbackSpeedSelect" disabled>
                            <option value="1" selected>1×</option>
                            <option value="2">2×</option>
                            <option value="4">4×</option>
                            <option value="8">8×</option>
                            <option value="16">16×</option>
                            <option value="32">32×</option>
                            <option value="64">64×</option>
                            <option value="128">128×</option>
                            <option value="256">256×</option>
                            <option value="512">512×</option>
                            <option value="1024">1024×</option>
                        </select>
                    </label>
                    <span id="playbackTimeLabel" style="font-size:12px;color:#666;">时间：—</span>
                </div>
                <div class="playback-time" style="display:flex;flex-direction:column;gap:4px;margin-bottom:8px;">
                    <label class="playback-time-label" style="display:flex;align-items:center;gap:8px;flex:1 1 auto;min-width:0;">
                        <span class="playback-time-text" style="white-space:nowrap;">起始时间：</span>
                        <input type="range" id="playbackTimeSlider" disabled min="0" max="0" step="1000" value="0" style="flex:1 1 auto;min-width:0;max-width:100%;vertical-align:middle;">
                    </label>
                    <span id="playbackTimeCursor" style="font-size:12px;color:#666;align-self:flex-end;">—</span>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    let map;
    let currentPolygons = []; // 存储多边形和其标签
    let currentTracks = []; // 存储轨迹折线及相关覆盖物
    let mapLoaded = false;
    let mapLabelHandlers = []; // 存储地图事件处理器
    let labelsEnabled = false; // 标签显示开关（默认关闭）
    let isDrawing = false; // 绘制进行中防止重复点击

    window.onload = function () {
        if (typeof T === 'undefined') {
            alert("天地图API加载失败，请检查网络或密钥！");
            return;
        }
        initMap();
        bindDrawEvent();
        bindMinimizeEvent();
        bindTabs();
        bindBatchGenerator();
        bindMultiSplitter();
        bindLabelsToggle(); // 绑定标签显示开关
        bindTrackEvents();  // 绑定轨迹绘制与清空
        bindPlaybackControls(); // 绑定轨迹回放
    };

    function initMap() {
        showLoading();
        disableButtons(true);

        try {
            map = new T.Map("mapContainer", {
                zoom: 12,
                center: new T.LngLat(116.40769, 39.90403)
            });

            // 已移除测试标签
            map.enableScrollWheelZoom();

            // 添加地图类型控件
            const mapTypeCtrl = new T.Control.MapType({
                mapTypes: [TMAP_NORMAL_MAP, TMAP_SATELLITE_MAP, TMAP_TERRAIN_MAP],
                position: T_ANCHOR_TOP_LEFT
            });
            map.addControl(mapTypeCtrl);

            // 加载影像底图（卫星）
            const tk = "648f621977051d0199ff0f965d3fd322";

            // 方案1：使用默认地图类型（作为备选）
            map.setMapType(TMAP_SATELLITE_MAP);

            // 方案2：手动添加影像图层（底图 + 标注）
            const vecLayer = new T.TileLayer(`https://t0.tianditu.gov.cn/img_w/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=img&STYLE=default&TILEMATRIXSET=w&FORMAT=tiles&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}&tk=${tk}`);
            const cvaLayer = new T.TileLayer(`https://t0.tianditu.gov.cn/cia_w/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=cia&STYLE=default&TILEMATRIXSET=w&FORMAT=tiles&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}&tk=${tk}`);

            // 添加图层并监听加载状态
            vecLayer.addEventListener("load", function () {
                console.log("影像底图加载完成");
            });

            vecLayer.addEventListener("error", function (e) {
                console.error("影像底图加载错误:", e);
                alert("影像底图加载错误，将使用默认地图类型");
            });

            map.addLayer(vecLayer);
            map.addLayer(cvaLayer);

            // 监听地图加载事件
            map.addEventListener("loaded", function () {
                console.log("地图加载完成");
                markMapLoaded();
            });
            map.addEventListener("load", function () {
                console.log("地图load事件触发");
                markMapLoaded();
            });
            map.addEventListener("tilesloaded", function () {
                console.log("地图瓦片加载完成");
                markMapLoaded();
            });
            // 监听地图加载失败事件
            map.addEventListener("error", function (e) {
                console.error("地图加载错误:", e);
                alert("地图加载错误: " + e.message);
                hideLoading();
            });

            // 监听地图移动事件，用于更新标签位置
            const moveHandler = function () {
                updateAllLabelsPosition();
            };
            map.addEventListener("move", moveHandler);
            map.addEventListener("zoom", moveHandler);

            // 存储事件处理器，用于清理
            mapLabelHandlers.push({ event: "move", handler: moveHandler });
            mapLabelHandlers.push({ event: "zoom", handler: moveHandler });

            // 超时容错
            setTimeout(() => {
                if (!mapLoaded) markMapLoaded();
            }, 8000);

        } catch (error) {
            alert("地图初始化失败：" + error.message);
            console.error(error);
            hideLoading();
        }
    }

    function markMapLoaded() {
        if (!mapLoaded) {
            mapLoaded = true;
            hideLoading();
            disableButtons(false);
            disableTrackButtons(false);
            // 仅开启速度选择，回放按钮按状态控制
            const speedSel = document.getElementById('playbackSpeedSelect');
            if (speedSel) speedSel.disabled = false;
            updatePlaybackButtonsState('idle');
        }
    }

    function showLoading() {
        const loading = document.getElementById("mapLoading");
        loading.style.display = "flex";
        loading.style.opacity = "1";
    }

    function hideLoading() {
        const loading = document.getElementById("mapLoading");
        loading.style.opacity = "0";
        setTimeout(() => loading.style.display = "none", 300);
    }

    function disableButtons(disabled) {
        document.getElementById("drawButton").disabled = disabled;
        document.getElementById("clearButton").disabled = disabled;
    }

    function disableTrackButtons(disabled) {
        const drawTrackBtn = document.getElementById("drawTrackButton");
        const showTrackPointsBtn = document.getElementById("showTrackPointsButton");
        const clearTrackBtn = document.getElementById("clearTrackButton");
        if (drawTrackBtn) drawTrackBtn.disabled = disabled;
        if (showTrackPointsBtn) showTrackPointsBtn.disabled = disabled;
        if (clearTrackBtn) clearTrackBtn.disabled = disabled;
    }
    // 回放控件的禁用/启用
    function disablePlaybackButtons(disabled) {
        ["playbackStartBtn","playbackPauseBtn","playbackStopBtn","playbackSpeedSelect","playbackTimeSlider"].forEach(id=>{
            const el = document.getElementById(id);
            if (el) el.disabled = disabled;
        });
    }

    // 回放按钮状态管理：空闲/播放/暂停
    function updatePlaybackButtonsState(state){
        try {
            const startBtn = document.getElementById('playbackStartBtn');
            const pauseBtn = document.getElementById('playbackPauseBtn');
            const stopBtn = document.getElementById('playbackStopBtn');
            if (!startBtn || !pauseBtn || !stopBtn) return;
            if (state === 'idle') {
                startBtn.disabled = false;
                pauseBtn.disabled = true;
                stopBtn.disabled = true;
                pauseBtn.textContent = '继续';
            } else if (state === 'playing') {
                startBtn.disabled = true;
                pauseBtn.disabled = false;
                stopBtn.disabled = false;
                pauseBtn.textContent = '暂停';
            } else if (state === 'paused') {
                startBtn.disabled = true;
                pauseBtn.disabled = false;
                stopBtn.disabled = false;
                pauseBtn.textContent = '继续';
            }
        } catch(e) { console.warn('更新按钮状态失败:', e); }
    }

    function bindDrawEvent() {
        document.getElementById("drawButton").addEventListener("click", function () {
            if (isDrawing) { console.log('绘制进行中，忽略重复点击'); return; }
            isDrawing = true;
            disableButtons(true);
            showLoading();
            try {
                const wktStr = document.getElementById("wktTextarea").value.trim();
                if (!wktStr) { alert("请输入WKT字符串！"); return; }
                clearOverlays();
                const geojson = parseWkt(wktStr);
    
                const polygonData = [];
                if (geojson.type === "Polygon") {
                    polygonData.push({ index: 1, coordinates: geojson.coordinates });
                } else if (geojson.type === "MultiPolygon") {
                    geojson.coordinates.forEach((polygon, index) => {
                        polygonData.push({ index: index + 1, coordinates: polygon });
                    });
                }
    
                // 重置并绘制
                polygonInfoList = [];
                polygonData.forEach(pd => processPolygon(pd.index, pd.coordinates));
    
                // 视图居中到所有已绘制轮廓
                try { fitViewportToPolygons(); } catch (e) { console.warn('视图居中失败', e); }
    
                // 在视图稳定后再创建/更新标签
                setTimeout(() => {
                    if (labelsEnabled) {
                        try {
                            createAllLabels();
                            updateAllLabelsPosition();
                        } catch (e) {
                            console.warn('创建或更新标签失败:', e);
                        }
                    }
                }, 150);
            } catch (e) {
                alert('绘制失败：' + (e && e.message ? e.message : e));
                console.error('绘制异常:', e);
            } finally {
                hideLoading();
                isDrawing = false;
                disableButtons(false);
            }
        });

        document.getElementById("clearButton").addEventListener("click", function () {
            if (isDrawing) { console.log('绘制进行中，暂不清空'); return; }
            clearOverlays();
            console.log("已清空所有轮廓");
        });
    }

    // 存储多边形数据，用于后续标签创建
    let polygonInfoList = [];

    // 处理单个多边形的绘制和面积计算
    function processPolygon(actualPolygonIndex, polygonCoords) {
        console.log('开始处理多边形', actualPolygonIndex);

        // 坐标系选择（绘制始终使用WGS84坐标）
        const coordSys = (document.getElementById('coordSysSelect') && document.getElementById('coordSysSelect').value) || 'wgs84';

        // 统一转换为WGS84用于绘制与面积计算
        function toWgs(point){
            const lng = point[0], lat = point[1];
            if (coordSys === 'wgs84' || coordSys === 'cgcs2000') {
                return [lng, lat];
            } else if (coordSys === 'gcj02') {
                const w = gcj02ToWgs84(lng, lat);
                return [w.lng, w.lat];
            } else if (coordSys === 'bd09') {
                const gcj = bd09ToGcj02(lng, lat);
                const w = gcj02ToWgs84(gcj.lng, gcj.lat);
                return [w.lng, w.lat];
            }
            return [lng, lat];
        }
        const coordsWGS84 = polygonCoords.map(ring => ring.map(toWgs));
        let outerRingWGS = coordsWGS84[0] || [];

        // 生成用于绘制的坐标（直接使用WGS84坐标）
        const rings = coordsWGS84.map(ring => ring.map(([lng, lat]) => new T.LngLat(lng, lat)));


         // 创建半透明填充的多边形（无边框）
          const polygon = new T.Polygon(rings, {
              color: "#FFD700",
              weight: 1,
              opacity: 1,
              fillColor: "#FFFF00",
              fillOpacity: 0.35
          });
 
          // 使用WGS84坐标计算面积（更准确的面积计算）
         let areaSqm;
         let areaMu;



         try {
             // 检查Turf.js是否可用
             if (typeof turf !== 'undefined' && turf.area) {
                 // 使用Turf.js计算多边形面积
                // 构造GeoJSON格式的多边形
                const geoJsonPolygon = {
                    type: "Polygon",
                    coordinates: coordsWGS84
                };


                 // 使用Turf.js计算面积（平方米）
                 areaSqm = turf.area(geoJsonPolygon);
                 areaMu = (areaSqm / 666.6667).toFixed(4); // 转换为亩
                 console.log(`多边形${actualPolygonIndex}面积计算结果(Turf.js): ${areaSqm}平方米 = ${areaMu}亩`);
             } else {
                 // 如果Turf.js不可用，回退到之前的计算方法
                 console.warn('Turf.js不可用，使用备用计算方法');
                 // 计算带孔洞的多边形面积
                 areaSqm = 0;
                 // 计算外环面积
                 outerRingWGS = coordsWGS84[0] || [];
                 areaSqm += calculatePolygonArea(outerRingWGS);

                 // 减去内环（孔洞）面积
                 for (let i = 1; i < coordsWGS84.length; i++) {
                     const innerRingArea = calculatePolygonArea(coordsWGS84[i]);
                     areaSqm -= innerRingArea;
                 }

                  areaMu = (areaSqm / 666.6667).toFixed(4); // 使用更精确的转换系数
                  console.log(`多边形${actualPolygonIndex}面积计算结果(备用): ${areaSqm}平方米 = ${areaMu}亩`);
              }
          } catch (error) {
              console.error(`面积计算失败:`, error);
              areaSqm = 0;
              areaMu = '0.0000';
          }

          // 计算多边形的中心点和底部中心点（WGS84）
          const centerPoint = calculatePolygonCenter(outerRingWGS);
          const bottomCenterPoint = calculatePolygonBottomCenter(outerRingWGS);

          // 添加多边形到地图
          if (map) {
              map.addOverLay(polygon);
              console.log(`多边形${actualPolygonIndex}已添加到地图`);
          } else {
              console.error('地图对象不存在');
          }

          // 存储多边形信息，用于后续标签创建
          polygonInfoList.push({
              index: actualPolygonIndex,
              polygon: polygon,
              area: areaMu,
              bottomCenter: { lng: bottomCenterPoint.lng, lat: bottomCenterPoint.lat },
              ringPoints: rings
          });
      }

    // 视图居中：根据已绘制的GCJ-02点
    function fitViewportToPolygons() {
        const points = [];
        try {
            if (!map || !map.setViewport) return;
            polygonInfoList.forEach(info => {
                if (!info || !info.ringPoints) return;
                info.ringPoints.forEach(ring => {
                    ring.forEach(ll => points.push(ll));
                });
            });
            if (!points.length) return;
            map.setViewport(points);
        } catch (e) {
            try {
                const lngs = points.map(p => p.lng);
                const lats = points.map(p => p.lat);
                const center = new T.LngLat(
                    (Math.min(...lngs) + Math.max(...lngs)) / 2,
                    (Math.min(...lats) + Math.max(...lats)) / 2
                );
                if (map && map.panTo) map.panTo(center);
            } catch (e2) {
                console.warn('视图居中失败:', e2);
            }
        }
    }

    // 统一创建所有多边形的标签
    function createAllLabels() {
        const mapContainer = document.getElementById('mapContainer');
        if (!mapContainer || !map) return;

        polygonInfoList.forEach(info => {
            if (!info) return;
            // 防止重复创建
            if (info.labelRef) return;
            // 创建标签元素
            const labelDiv = document.createElement('div');
            labelDiv.className = 'area-label';
            labelDiv.innerHTML = `多边形${info.index}：${info.area}亩`;

            // 添加到地图容器并根据屏幕边界定位到轮廓下方
            mapContainer.appendChild(labelDiv);
            positionLabelForPolygon(labelDiv, info);

            // 记录引用，避免重复创建
            info.labelRef = labelDiv;

            // 存储到 currentPolygons 以复用现有定位/清理逻辑
            const labelObj = {
                domElement: labelDiv,
                isDomLabel: true,
                polygonInfo: info
            };
            currentPolygons.push({ polygon: info.polygon, label: labelObj });
        });

        // 不清空 polygonInfoList，便于开关随时创建/隐藏标签
    }

    // 根据多边形屏幕边界定位标签，保证始终在轮廓下方
    function positionLabelForPolygon(labelDiv, info) {
        if (!map || !info || !info.ringPoints) return;
        const points = [];
        info.ringPoints.forEach(ring => {
            ring.forEach(ll => {
                const p = map.lngLatToContainerPoint(ll);
                points.push(p);
            });
        });
        if (!points.length) return;
        const minX = Math.min(...points.map(p => p.x));
        const maxX = Math.max(...points.map(p => p.x));
        const maxY = Math.max(...points.map(p => p.y));
        const container = document.getElementById('mapContainer');
        const labelWidth = labelDiv.offsetWidth;
        const labelHeight = labelDiv.offsetHeight;
        const targetLeft = Math.round((minX + maxX) / 2 - labelWidth / 2);
        const targetTop = Math.round(maxY + 6);
        const clampedLeft = Math.max(0, Math.min(targetLeft, container.clientWidth - labelWidth));
        const clampedTop = Math.max(0, Math.min(targetTop, container.clientHeight - labelHeight));
        labelDiv.style.left = clampedLeft + 'px';
        labelDiv.style.top = clampedTop + 'px';
    }

    // 更新所有标签位置（地图move/zoom时调用）
    function updateAllLabelsPosition() {
        try {
            if (!map) return;
            const container = document.getElementById('mapContainer');
            if (!container) return;
            currentPolygons.forEach(item => {
                if (!item || !item.label) return;
                const labelObj = item.label;
                if (labelObj.isDomLabel && labelObj.domElement && labelObj.polygonInfo) {
                    // 确保标签在容器中
                    if (!labelObj.domElement.parentNode) {
                        container.appendChild(labelObj.domElement);
                    }
                    positionLabelForPolygon(labelObj.domElement, labelObj.polygonInfo);
                }
            });
        } catch (e) {
            console.warn('更新标签位置时出错:', e);
        }
    }
    // 确保在全局可用（处理第三方库事件回调作用域差异）
    window.updateAllLabelsPosition = updateAllLabelsPosition;

    // 绑定“显示亩数标签”开关（默认隐藏）
    function bindLabelsToggle() {
        const cb = document.getElementById('toggleLabelsCheckbox');
        const container = document.getElementById('mapContainer');
        if (!cb || !container) return;
        // 默认隐藏标签
        container.classList.add('labels-hidden');
        cb.addEventListener('change', () => {
            labelsEnabled = cb.checked;
            if (labelsEnabled) {
                container.classList.remove('labels-hidden');
                const hasAnyLabel = currentPolygons.some(item => item && item.label && item.label.domElement);
                if (!hasAnyLabel) {
                    try { createAllLabels(); } catch (e) { console.warn('创建标签失败:', e); }
                }
                updateAllLabelsPosition();
            } else {
                container.classList.add('labels-hidden');
            }
        });
    }

    /**
     * 计算多边形中心点（比底部中心更适合显示标签）
     */
    function calculatePolygonCenter(outerRing) {
        let sumLng = 0, sumLat = 0;
        const len = outerRing.length;

        for (let i = 0; i < len; i++) {
            sumLng += outerRing[i][0];
            sumLat += outerRing[i][1];
        }

        return {
            lng: sumLng / len,
            lat: sumLat / len
        };
    }

    /**
     * 计算多边形面积（球面多边形面积计算）
     * 使用更准确的球面坐标面积计算方法，确保面积与视觉大小一致
     */
    function calculatePolygonArea(coordinates) {
        // 地球半径（米）- 使用更精确的值
        const R = 6371000.8;
        const n = coordinates.length;

        // 将所有坐标转换为弧度
        const coordsRad = coordinates.map(point => [
            point[0] * Math.PI / 180,
            point[1] * Math.PI / 180
        ]);

        let areaRad = 0;

        // 使用更准确的球面多边形面积公式（Girard定理）
        for (let i = 0; i < n; i++) {
            const j = (i + 1) % n;
            const lon1 = coordsRad[i][0];
            const lat1 = coordsRad[i][1];
            const lon2 = coordsRad[j][0];
            const lat2 = coordsRad[j][1];

            // 计算球面多边形面积增量
            const dlon = lon2 - lon1;
            const sinLat1 = Math.sin(lat1);
            const sinLat2 = Math.sin(lat2);
            const cosLat1 = Math.cos(lat1);
            const cosLat2 = Math.cos(lat2);

            // 使用更精确的公式
            areaRad += dlon * (sinLat1 * cosLat2 * Math.cos(dlon / 2) + sinLat2 * cosLat1);
        }

        // 计算总面积（平方米）
        const areaSqm = Math.abs(areaRad) * R * R * 0.5;

        return areaSqm;
    }

    /**
     * 清空所有多边形和标签（同时处理 polygonInfoList 与 currentPolygons）
     */
    function clearOverlays() {
        try {
            // 先移除 polygonInfoList 中记录的多边形与其DOM标签
            polygonInfoList.forEach(info => {
                if (info && info.polygon && map && map.removeOverLay) {
                    try { map.removeOverLay(info.polygon); } catch (e) { console.warn('移除多边形失败:', e); }
                }
                if (info && info.labelRef && info.labelRef.parentNode) {
                    try { info.labelRef.parentNode.removeChild(info.labelRef); } catch (e) { console.warn('移除DOM标签失败:', e); }
                    info.labelRef = null;
                }
            });

            // 再处理 currentPolygons（兼容旧路径与标签对象）
            currentPolygons.forEach(item => {
                if (item.polygon && map && map.removeOverLay) {
                    try { map.removeOverLay(item.polygon); } catch (e) { console.warn('移除多边形失败:', e); }
                }
                if (item.label) {
                    if (item.label.domElement && item.label.domElement.parentNode) {
                        try { item.label.domElement.parentNode.removeChild(item.label.domElement); } catch (e) { console.warn('移除DOM标签失败:', e); }
                    } else if (map && map.removeOverLay && !item.label.isDomLabel) {
                        try { map.removeOverLay(item.label); } catch (e) { console.warn('移除地图覆盖物标签失败:', e); }
                    }
                }
            });

            // 清空记录数组
            currentPolygons = [];
            polygonInfoList = [];

            console.log('已清空所有多边形和标签（保留事件监听器）');
        } catch (error) {
            console.error('清空覆盖物时出错:', error);
        }
    }

    // 其他辅助函数（保持不变）
    function bindMinimizeEvent() {
        const container = document.querySelector(".wkt-input-container");
        const btn = document.getElementById("minimizeBtn");
        const minIcon = btn?.querySelector(".min-icon");
        const restoreIcon = btn?.querySelector(".restore-icon");

        btn?.addEventListener("click", () => {
            const minimized = container.classList.toggle("minimized");
            if (minIcon && restoreIcon) {
                if (minimized) {
                    minIcon.style.display = "none";
                    restoreIcon.style.display = "";
                } else {
                    minIcon.style.display = "";
                    restoreIcon.style.display = "none";
                }
            }
        });
    }

    // 在脚本内部补充：页签切换（3个页签）
     function bindTabs() {
         const tabs = [
             { btn: document.getElementById('tabDrawBtn'), pane: document.getElementById('tabDraw'), key: 'draw' },
             { btn: document.getElementById('tabTrackBtn'), pane: document.getElementById('tabTrack'), key: 'track' },
             { btn: document.getElementById('tabSplitBtn'), pane: document.getElementById('tabSplit'), key: 'split' },
             { btn: document.getElementById('tabBatchBtn'), pane: document.getElementById('tabBatch'), key: 'batch' },
         ];
         if (tabs.some(t => !t.btn || !t.pane)) return;
         function activate(key) {
             tabs.forEach(t => {
                 const active = t.key === key;
                 t.btn.classList.toggle('active', active);
                 t.pane.classList.toggle('active', active);
             });
         }
         tabs.forEach(t => t.btn.addEventListener('click', () => activate(t.key)));
         activate('draw');
     }
    function updateParserStatus() {
        const el = document.getElementById('parserStatus');
        if (!el) return;
        const ok = (typeof Terraformer !== 'undefined' && Terraformer.WKT && typeof Terraformer.WKT.parse === 'function');
        if (ok) {
            el.textContent = 'Terraformer WKT Parser';
            el.style.color = '#2f8f2f';
        } else {
            el.textContent = '本地回退解析（仅支持POLYGON/MULTIPOLYGON）';
            el.style.color = '#c77d1e';
        }
    }
     function parseWkt(wkt) {
         wkt = wkt.trim();
         // 优先使用成熟库（Terraformer WKT Parser）
         if (typeof Terraformer !== 'undefined' && Terraformer.WKT && Terraformer.WKT.parse) {
             try {
                 return Terraformer.WKT.parse(wkt);
             } catch (e) {
                 console.warn('Terraformer解析失败，尝试本地回退解析:', e);
             }
         } else {
             // 不再提示“未加载”，由状态栏展示回退信息
         }
         // 回退解析：仅支持 POLYGON / MULTIPOLYGON
         const typeMatch = wkt.match(/^\s*(POLYGON|MULTIPOLYGON)\s*\(/i);
         if (!typeMatch) throw new Error('仅支持POLYGON/MULTIPOLYGON');
         const type = typeMatch[1].toUpperCase();
         const inner = wkt.substring(wkt.indexOf('('));
         if (type === 'POLYGON') {
             const coords = parsePolygonCoords(inner.replace(/^\(/, '').replace(/\)$/, ''));
             return { type: 'Polygon', coordinates: coords };
         } else {
             const trimmed = inner.replace(/^\(\(/, '').replace(/\)\)$/, '');
             const coords = parseMultiPolygonCoords(trimmed);
             return { type: 'MultiPolygon', coordinates: coords };
         }
     }

     function bindMultiSplitter() {
         const input = document.getElementById('multiInput');
         const output = document.getElementById('polyOutput');
         const splitBtn = document.getElementById('splitMultiBtn');
         const copyBtn = document.getElementById('copyPolysBtn');
         if (!input || !output || !splitBtn || !copyBtn) return;

         // 本地WKT序列化辅助
         function ringToText(ring) {
             if (!ring || !ring.length) return '()';
             const first = ring[0];
             const last = ring[ring.length - 1];
             const closed = (first[0] === last[0] && first[1] === last[1]) ? ring : ring.concat([[first[0], first[1]]]);
             return '(' + closed.map(pt => pt[0] + ' ' + pt[1]).join(', ') + ')';
         }
         function toWktPolygonCoords(coords) {
             return 'POLYGON(' + coords.map(ringToText).join(', ') + ')';
         }
         function toWktMulti(coords) {
             return 'MULTIPOLYGON(' + coords.map(poly => '(' + poly.map(ringToText).join(', ') + ')').join(', ') + ')';
         }

         function polygonsFromMulti(text) {
             const geo = parseWkt(text.trim());
             if (geo.type !== 'MultiPolygon') throw new Error('请输入有效的 MULTIPOLYGON WKT');
             const polys = geo.coordinates.map(rings => toWktPolygonCoords(rings));
             return polys;
         }
         splitBtn.addEventListener('click', () => {
             try {
                 const list = polygonsFromMulti(input.value.trim());
                 output.value = list.join('\n');
             } catch (e) {
                 alert('分割失败：' + e.message);
             }
         });
         copyBtn.addEventListener('click', async () => {
             const val = output.value.trim();
             if (!val) { alert('没有可复制的结果'); return; }
             try { await navigator.clipboard.writeText(val); alert('已复制到剪贴板'); } catch (e) { console.warn('复制失败', e); }
         });
     }

     function bindBatchGenerator() {
         const batchInput = document.getElementById('batchInput');
         const output = document.getElementById('multiOutput');
         const genBtn = document.getElementById('generateMultiBtn');
         const copyBtn = document.getElementById('copyMultiBtn');

         // 本地WKT序列化辅助（与分割器保持一致）
         function ringToText(ring) {
             if (!ring || !ring.length) return '()';
             const first = ring[0];
             const last = ring[ring.length - 1];
             const closed = (first[0] === last[0] && first[1] === last[1]) ? ring : ring.concat([[first[0], first[1]]]);
             return '(' + closed.map(pt => pt[0] + ' ' + pt[1]).join(', ') + ')';
         }
         function toWktMulti(coords) {
             return 'MULTIPOLYGON(' + coords.map(poly => '(' + poly.map(ringToText).join(', ') + ')').join(', ') + ')';
         }

         genBtn.addEventListener('click', () => {
             try {
                 const lines = batchInput.value.trim().split(/\n|;/).map(s => s.trim()).filter(Boolean);
                 if (lines.length === 0) throw new Error('请按每行或分号输入至少一个POLYGON');
                 const polygons = lines.map((line, idx) => {
                     const g = parseWkt(line);
                     if (g.type !== 'Polygon') throw new Error(`第${idx + 1}行不是有效的POLYGON WKT`);
                     return g;
                 });
                 const multiGeo = { type: 'MultiPolygon', coordinates: polygons.map(p => p.coordinates) };
                 output.value = toWktMulti(multiGeo.coordinates);
             } catch (e) {
                 alert('生成失败：' + e.message);
             }
         });

         copyBtn.addEventListener('click', async () => {
             const val = output.value.trim();
             if (!val) { alert('没有可复制的结果'); return; }
             try { await navigator.clipboard.writeText(val); alert('已复制到剪贴板'); } catch (e) { console.warn('复制失败', e); }
         });

     }

     function setExampleWkt() {
         const exampleWkt = "MULTIPOLYGON(" +
             "(" +
             "(116.35 39.93, 116.39 39.93, 116.39 39.90, 116.35 39.90, 116.35 39.93)," + // 外环
             "(116.36 39.92, 116.38 39.92, 116.38 39.91, 116.36 39.91, 116.36 39.92)" +  // 内环
             ")," +
             "(" +
             "(116.40 39.95, 116.43 39.97, 116.46 39.96, 116.49 39.98, 116.52 39.95, 116.55 39.93, 116.58 39.94, 116.61 39.92, 116.64 39.95, 116.40 39.95)" +
             ")" +
             ")";
         document.getElementById("wktTextarea").value = exampleWkt;
     }

     function parsePolygonCoords(coordStr) {
         const ringStrs = coordStr.split(/\)\s*,\s*\(/).map(s => s.replace(/[()]/g, '').trim());
         const rings = [];
         ringStrs.forEach(ringStr => {
             const pts = ringStr.split(/,\s*/).map(pointStr => {
                 const [lng, lat] = pointStr.split(/\s+/).map(Number);
                 if (isNaN(lng) || isNaN(lat)) throw new Error("坐标格式错误：" + pointStr);
                 return [lng, lat];
             });
             // 自动拆分：如果一个ring中包含多次回到起点（闭合），则拆分为多个环
             // 兼容用户将外环与内环错误地写在同一对括号中的情况
             let start = 0;
             while (start < pts.length) {
                 const startPt = pts[start];
                 let closeIdx = -1;
                 for (let i = start + 1; i < pts.length; i++) {
                     if (pts[i][0] === startPt[0] && pts[i][1] === startPt[1]) {
                         closeIdx = i;
                         break;
                     }
                 }
                 if (closeIdx === -1) {
                     // 未找到闭合：将剩余点视为一个环，并强制闭合
                     const ring = pts.slice(start);
                     if (ring.length && (ring[0][0] !== ring[ring.length - 1][0] || ring[0][1] !== ring[ring.length - 1][1])) {
                         ring.push([ring[0][0], ring[0][1]]);
                     }
                     rings.push(ring);
                     break;
                 } else {
                     const ring = pts.slice(start, closeIdx + 1);
                     rings.push(ring);
                     start = closeIdx + 1;
                 }
             }
         });
         return rings;
     }

     function parseMultiPolygonCoords(coordStr) {
         const polygonStrs = coordStr.split(/\)\s*\)\s*,\s*\(\s*\(/).map(s => s.replace(/[()]/g, '').trim());
         return polygonStrs.map(polygonStr => parsePolygonCoords(polygonStr));
     }

     function wgs84ToGcj02(lng, lat) {
         const x_PI = 3.14159265358979324 * 3000.0 / 180.0;
         const PI = 3.1415926535897932384626;
         const a = 6378245.0;
         const ee = 0.00669342162296594323;

         if (outOfChina(lng, lat)) return { lng, lat };

         let dlat = transformLat(lng - 105.0, lat - 35.0);
         let dlng = transformLng(lng - 105.0, lat - 35.0);
         const radlat = lat / 180.0 * PI;
         let magic = Math.sin(radlat);
         magic = 1 - ee * magic * magic;
         const sqrtmagic = Math.sqrt(magic);
         dlat = (dlat * 180.0) / ((a * (1 - ee)) / (magic * sqrtmagic) * PI);
         dlng = (dlng * 180.0) / (a / sqrtmagic * Math.cos(radlat) * PI);

         return { lng: lng + dlng, lat: lat + dlat };

         function outOfChina(lng, lat) {
             return (lng < 72.004 || lng > 137.8347) || (lat < 0.8293 || lat > 55.8271);
         }

         function transformLat(x, y) {
             let ret = -100.0 + 2.0 * x + 3.0 * y + 0.2 * y * y + 0.1 * x * y + 0.2 * Math.sqrt(Math.abs(x));
             ret += (20.0 * Math.sin(6.0 * x * PI) + 20.0 * Math.sin(2.0 * x * PI)) * 2.0 / 3.0;
             ret += (20.0 * Math.sin(y * PI) + 40.0 * Math.sin(y / 3.0 * PI)) * 2.0 / 3.0;
             ret += (160.0 * Math.sin(y / 12.0 * PI) + 320 * Math.sin(y * PI / 30.0)) * 2.0 / 3.0;
             return ret;
         }

         function transformLng(x, y) {
             let ret = 300.0 + x + 2.0 * y + 0.1 * x * x + 0.1 * x * y + 0.1 * Math.sqrt(Math.abs(x));
             ret += (20.0 * Math.sin(6.0 * x * PI) + 20.0 * Math.sin(2.0 * x * PI)) * 2.0 / 3.0;
             ret += (20.0 * Math.sin(x * PI) + 40.0 * Math.sin(x / 3.0 * PI)) * 2.0 / 3.0;
             ret += (150.0 * Math.sin(x / 12.0 * PI) + 300.0 * Math.sin(x / 30.0 * PI)) * 2.0 / 3.0;
             return ret;
         }
     }

     function gcj02ToWgs84(lng, lat) {
         const g = wgs84ToGcj02(lng, lat);
         return { lng: lng * 2 - g.lng, lat: lat * 2 - g.lat };
     }

     function bd09ToGcj02(bdLng, bdLat) {
         const x_PI = 3.14159265358979324 * 3000.0 / 180.0;
         const x = bdLng - 0.0065;
         const y = bdLat - 0.006;
         const z = Math.sqrt(x * x + y * y) - 0.00002 * Math.sin(y * x_PI);
         const theta = Math.atan2(y, x) - 0.000003 * Math.cos(x * x_PI);
         const ggLng = z * Math.cos(theta);
         const ggLat = z * Math.sin(theta);
         return { lng: ggLng, lat: ggLat };
     }

     function calculatePolygonBottomCenter(outerRing) {
         let minLat = Infinity;
         let bottomPoints = [];
         outerRing.forEach(point => {
             const lat = point[1];
             if (lat < minLat) {
                 minLat = lat;
                 bottomPoints = [point];
             } else if (lat === minLat) {
                 bottomPoints.push(point);
             }
         });

         const sumLng = bottomPoints.reduce((sum, point) => sum + point[0], 0);
         const centerLng = sumLng / bottomPoints.length;

         return { lng: centerLng, lat: minLat };
     }

     function fitBounds(geojson) {
         try {
             const allPoints = [];
             function collectPoints(coords) {
                 if (typeof coords[0] === 'number') {
                     allPoints.push(coords);
                 } else {
                     coords.forEach(coord => collectPoints(coord));
                 }
             }
             collectPoints(geojson.coordinates);

             if (allPoints.length === 0) return;

             const lats = allPoints.map(p => p[1]);
             const lngs = allPoints.map(p => p[0]);
             const minLng = Math.min(...lngs);
             const maxLng = Math.max(...lngs);
             const minLat = Math.min(...lats);
             const maxLat = Math.max(...lats);

             const sw = wgs84ToGcj02(minLng, minLat);
             const ne = wgs84ToGcj02(maxLng, maxLat);

             // 修复setViewport方法的使用，确保参数格式正确
             if (map && map.setViewport) {
                 map.setViewport([
                     new T.LngLat(sw.lng, sw.lat),
                     new T.LngLat(ne.lng, ne.lat)
                 ], { padding: [50, 50] });
             } else {
                 console.warn('地图对象或setViewport方法不可用');
             }
         } catch (error) {
             console.error('调整视图范围时出错:', error);
         }
     }
// 轨迹绘制与解析
    function bindTrackEvents() {
        const drawBtn = document.getElementById('drawTrackButton');
        const showPointsBtn = document.getElementById('showTrackPointsButton');
        const clearBtn = document.getElementById('clearTrackButton');
        const ta = document.getElementById('trackTextarea');
        if (!drawBtn || !showPointsBtn || !clearBtn || !ta) return;

        drawBtn.addEventListener('click', function(){
            try {
                const text = ta.value.trim();
                if (!text) { alert('请粘贴轨迹文本（时间戳,经度,纬度）'); return; }
                const points = parseTrackText(text);
                if (points.length < 2) { alert('有效轨迹点不足，至少需要两点'); return; }
                drawTrackFromPoints(points);
                fitViewportToTrack(points);
            } catch (e) {
                alert('绘制轨迹失败：' + (e && e.message ? e.message : e));
                console.error('绘制轨迹异常:', e);
            }
        });

        showPointsBtn.addEventListener('click', function(){
            try {
                const text = ta.value.trim();
                if (!text) { alert('请粘贴轨迹文本（时间戳,经度,纬度）'); return; }
                const points = parseTrackText(text);
                if (points.length === 0) { alert('未找到有效轨迹点'); return; }
                showTrackPoints(points);
                fitViewportToTrack(points);
            } catch (e) {
                alert('显示轨迹点失败：' + (e && e.message ? e.message : e));
                console.error('显示轨迹点异常:', e);
            }
        });

        clearBtn.addEventListener('click', function(){
            clearTrackOverlays();
            console.log('已清空轨迹');
        });
    }

    function showTrackPoints(points) {
        // 先移除旧轨迹（不影响轮廓）
        clearTrackOverlays(false);
        
        if (!map || !points || points.length === 0) {
            console.log('无轨迹点可显示');
            return;
        }
        
        console.log(`准备显示${points.length}个轨迹点`);
        
        // 使用批量处理和更小的图标来提高性能
        // 创建一个更小的红点SVG图标
        const smallRedDotIcon = new T.Icon({
            iconUrl: 'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="1" height="1"><circle cx="0.5" cy="0.5" r="0.3" fill="%23FF0000"/></svg>',
            iconSize: new T.Point(1, 1),
            iconAnchor: new T.Point(0.5, 0.5)
        });
        
        // 优化批量添加点的速度
        const batchSize = 2000; // 增加每批处理的点数
        const concurrentBatches = 4; // 并发批次数量
        
        // 预创建点击事件处理函数，避免重复创建
        function createClickHandler(point, index) {
            return function() {
                const infoWindow = new T.InfoWindow({
                    content: `点${index + 1}<br/>经度: ${point.lng.toFixed(6)}<br/>纬度: ${point.lat.toFixed(6)}`,
                    offset: new T.Point(0, -20)
                });
                infoWindow.open(map, point);
            };
        }
        
        // 使用setTimeout实现更高效的批量添加，避免阻塞UI
        let currentIndex = 0;
        
        function addBatch() {
            if (currentIndex >= points.length) {
                console.log(`已显示${points.length}个轨迹点`);
                return;
            }
            
            // 添加当前批次的点
            const endIndex = Math.min(currentIndex + batchSize, points.length);
            const markersToAdd = [];
            
            // 先创建所有标记
            for (let i = currentIndex; i < endIndex; i++) {
                const point = points[i];
                const index = i;
                
                const marker = new T.Marker(point, {
                    icon: smallRedDotIcon
                });
                
                // 添加点击事件
                marker.addEventListener('click', createClickHandler(point, index));
                
                markersToAdd.push(marker);
            }
            
            // 批量添加到地图和数组
            markersToAdd.forEach(marker => {
                map.addOverLay(marker);
                currentTracks.push(marker);
            });
            
            currentIndex = endIndex;
            
            // 使用setTimeout而不是requestAnimationFrame，减少对渲染周期的依赖
            // 设置为0，将任务放入微任务队列，但允许UI有短暂的呼吸空间
            setTimeout(addBatch, 0);
        }
        
        // 启动批量添加
        addBatch();
    }
    
    // 恢复原始的clearTrackOverlays函数
    function clearTrackOverlays(resetArray = true){        
        try {
            currentTracks.forEach(pl => {
                if (pl && map && map.removeOverLay) {
                    try { map.removeOverLay(pl); } catch (e) { console.warn('移除轨迹失败:', e); }
                }
            });
            if (resetArray) currentTracks = [];
        } catch (e) {
            console.warn('清空轨迹时出错:', e);
        }
    }

    function parseTrackText(text){
        // 选择输入坐标系（优先使用轨迹页签专属选择器，若未设置则回退到绘制页签选择器）
        const coordSysEl = document.getElementById('trackCoordSysSelect') || document.getElementById('coordSysSelect');
        const coordSys = (coordSysEl && coordSysEl.value) || 'wgs84';
        const isHash = text.indexOf('#') !== -1;
        const items = isHash ? text.split('#') : text.split(/\r?\n/);
        const pts = [];
        for (let i=0;i<items.length;i++){
            const raw = items[i];
            if (!raw) continue;
            const line = raw.trim();
            if (!line) continue;
            const parts = line.split(',');
            if (parts.length < 3) continue;
            let lng = parseFloat((parts[isHash ? 0 : 1] || '').trim());
            let lat = parseFloat((parts[isHash ? 1 : 2] || '').trim());
            // 初步过滤：数值合法性与正常范围
            if (!isFinite(lng) || !isFinite(lat)) continue;
            if (lng === 0 || lat === 0) continue; // 丢弃0.0异常点
            if (lng < -180 || lng > 180 || lat < -90 || lat > 90) continue; // 超出经纬度范围丢弃

            // 将输入坐标转换为WGS84
            let w;
            if (coordSys === 'wgs84' || coordSys === 'cgcs2000') {
                w = { lng, lat };
            } else if (coordSys === 'gcj02') {
                w = gcj02ToWgs84(lng, lat);
            } else if (coordSys === 'bd09') {
                const g = bd09ToGcj02(lng, lat);
                w = gcj02ToWgs84(g.lng, g.lat);
            } else {
                w = { lng, lat };
            }
            // 转换结果兜底检查
            if (!isFinite(w.lng) || !isFinite(w.lat)) continue;
            if (w.lng < -180 || w.lng > 180 || w.lat < -90 || w.lat > 90) continue;

            // 使用WGS84坐标绘制到地图
            pts.push(new T.LngLat(w.lng, w.lat));
        }
        return pts;
    }

    function drawTrackFromPoints(points){
        // 先移除旧轨迹（不影响轮廓）
        clearTrackOverlays(false);
        const polyline = new T.Polyline(points, {
            color: '#FF3B30',
            weight: 1,
            opacity: 0.9
        });
        if (map) {
            map.addOverLay(polyline);
        }
        currentTracks.push(polyline);
    }

    function clearTrackOverlays(resetArray = true){
        try {
            currentTracks.forEach(pl => {
                if (pl && map && map.removeOverLay) {
                    try { map.removeOverLay(pl); } catch (e) { console.warn('移除轨迹失败:', e); }
                }
            });
            if (resetArray) currentTracks = [];
        } catch (e) {
            console.warn('清空轨迹时出错:', e);
        }
    }


    function fitViewportToTrack(points){
        try {
            if (!map || !map.setViewport || !points || !points.length) return;
            map.setViewport(points);
        } catch (e) {
            console.warn('轨迹视图居中失败:', e);
        }
    }

    // ========= 轨迹回放功能 =========
    let playbackState = { points: [], idx: 0, speed: 1, timer: null, running: false, marker: null, line: null, path: [] };

    function bindPlaybackControls(){
        const startBtn = document.getElementById('playbackStartBtn');
        const pauseBtn = document.getElementById('playbackPauseBtn');
        const stopBtn = document.getElementById('playbackStopBtn');
        const speedSel = document.getElementById('playbackSpeedSelect');
        const timeSlider = document.getElementById('playbackTimeSlider');
        const timeCursor = document.getElementById('playbackTimeCursor');
        const ta = document.getElementById('trackTextarea');
        if (!startBtn || !pauseBtn || !stopBtn || !speedSel) return;

        // 初始按钮状态
        updatePlaybackButtonsState('idle');

        startBtn.addEventListener('click', function(){
            try {
                const text = (ta && ta.value || '').trim();
                if (!text) { alert('请粘贴轨迹文本（时间戳,经度,纬度）'); return; }
                const pts = parseTrackTextWithTime(text);
                if (pts.length < 2) { alert('有效轨迹点不足，至少需要两点'); return; }
                startPlayback(pts);
                // 状态在startPlayback中已设置为playing
            } catch (e) {
                alert('开始回放失败：' + (e && e.message ? e.message : e));
                console.error('开始回放异常:', e);
            }
        });

        pauseBtn.addEventListener('click', function(){
            if (!playbackState.running) {
                // 继续
                playbackState.running = true;
                scheduleNext();
                updatePlaybackButtonsState('playing');
            } else {
                // 暂停
                if (playbackState.timer) { clearTimeout(playbackState.timer); playbackState.timer = null; }
                playbackState.running = false;
                updatePlaybackButtonsState('paused');
            }
        });

        stopBtn.addEventListener('click', function(){ 
            stopPlayback(); 
            updatePlaybackButtonsState('idle');
        });

        speedSel.addEventListener('change', function(){
            const v = parseFloat(speedSel.value);
            playbackState.speed = (isFinite(v) && v > 0) ? v : 1;
        });

        if (timeSlider) {
            timeSlider.addEventListener('input', function(){
                const ms = parseInt(timeSlider.value, 10);
                const txt = formatTimeForLabel(ms);
                if (timeCursor) timeCursor.textContent = txt;
            });
            timeSlider.addEventListener('change', function(){
                jumpToSliderTime();
            });
        }
    }

    function parseTrackTextWithTime(text){
        const coordSysEl = document.getElementById('trackCoordSysSelect') || document.getElementById('coordSysSelect');
        const coordSys = (coordSysEl && coordSysEl.value) || 'wgs84';
        const isHash = text.indexOf('#') !== -1;
        const items = isHash ? text.split('#') : text.split(/\r?\n/);
        const out = [];
        for (let i=0;i<items.length;i++){
            const raw = items[i];
            if (!raw) continue;
            const line = raw.trim();
            if (!line) continue;
            const parts = line.split(',');
            if (parts.length < 3) continue;
            const tsRaw = (parts[isHash ? 2 : 0] || '').trim();
            const ts = (tsRaw || '').replace(/\D/g,'');
            let lng = parseFloat((parts[isHash ? 0 : 1] || '').trim());
            let lat = parseFloat((parts[isHash ? 1 : 2] || '').trim());
            if (!isFinite(lng) || !isFinite(lat)) continue;
            if (lng === 0 || lat === 0) continue;
            if (lng < -180 || lng > 180 || lat < -90 || lat > 90) continue;
            const t = parseTimestamp(ts);
            if (!t) continue;
            let w;
            if (coordSys === 'wgs84' || coordSys === 'cgcs2000') {
                w = { lng, lat };
            } else if (coordSys === 'gcj02') {
                w = gcj02ToWgs84(lng, lat);
            } else if (coordSys === 'bd09') {
                const g = bd09ToGcj02(lng, lat);
                w = gcj02ToWgs84(g.lng, g.lat);
            } else { w = { lng, lat }; }
            if (!isFinite(w.lng) || !isFinite(w.lat)) continue;
            if (w.lng < -180 || w.lng > 180 || w.lat < -90 || w.lat > 90) continue;
            out.push({ ll: new T.LngLat(w.lng, w.lat), time: t, ts });
        }
        out.sort((a,b)=>a.time - b.time);
        return out;
    }

    function parseTimestamp(ts){
        const tstr = (ts || '').replace(/\D/g,'');
        const m = tstr && tstr.match(/^\d{14}$/);
        if (!m) return null;
        const y = parseInt(tstr.slice(0,4),10);
        const M = parseInt(tstr.slice(4,6),10) - 1;
        const d = parseInt(tstr.slice(6,8),10);
        const h = parseInt(tstr.slice(8,10),10);
        const m2 = parseInt(tstr.slice(10,12),10);
        const s = parseInt(tstr.slice(12,14),10);
        const dt = new Date(y,M,d,h,m2,s);
        return isNaN(dt.getTime()) ? null : dt;
    }

    function startPlayback(points){
        console.log('[Playback] startPlayback: 点数=', points && points.length);
        stopPlayback();
        playbackState.points = points;
        playbackState.idx = 0;
        playbackState.speed = playbackState.speed || 1;
        playbackState.running = true;
        // 配置时间滑动条，并尊重现有滑块位置作为起始
        configureTimeSlider(points);
        // 启用滑块
        const slider = document.getElementById('playbackTimeSlider');
        if (slider) slider.disabled = false;
        let initIdx = 0;
        if (slider && slider.min && slider.max) {
            const ms = parseInt(slider.value, 10);
            if (isFinite(ms)) initIdx = findIndexByTime(points, ms);
        }
        playbackState.idx = initIdx;
        const first = points[initIdx];
        console.log('[Playback] 首点:', first && first.ts, first && first.ll, 'initIdx=', initIdx);
        playbackState.path = points.slice(0, initIdx+1).map(p=>p.ll);
        playbackState.line = new T.Polyline(playbackState.path, { color: '#00FFFF', weight: 1, opacity: 0.9 });
        if (map) {
            map.addOverLay(playbackState.line);
        }
        currentTracks.push(playbackState.line);
        // 创建并定位DOM标记以保证可见移动
        ensurePlaybackDom(first.ll);
        updatePlaybackDom(first.ll);
        updatePlaybackTimeLabel(first.ts);
        try { fitViewportToTrack(points.map(p=>p.ll)); } catch(e){}
        // 更新按钮状态
        updatePlaybackButtonsState('playing');
        scheduleNext();
    }

    function scheduleNext(){
        if (!playbackState.running) return;
        if (!playbackState.points || playbackState.idx >= playbackState.points.length - 1) {
            playbackState.running = false;
            console.log('[Playback] 回放结束：idx=', playbackState.idx, '点数=', playbackState.points ? playbackState.points.length : 0);
            updatePlaybackButtonsState('idle'); // 播放结束后按钮回到初始状态：开始可点，继续/结束灰化
            return;
        }
        const next = playbackState.points[playbackState.idx+1];
        const speed = playbackState.speed || 1;
        const delay = Math.max(4, Math.round(1000 / speed)); // 1x=1000ms/点，2x=500ms/点...
        console.log('[Playback] scheduleNext: idx=', playbackState.idx, '->', playbackState.idx+1, 'delay=', delay, 'speed=', speed);
        playbackState.timer = setTimeout(()=>{
            playbackState.idx++;
            const nextLL = next.ll;
            console.log('[Playback] 下一点:', next && next.ts, nextLL);
            try {
                // 维护路径数组
                playbackState.path = playbackState.path || [];
                playbackState.path.push(nextLL);
                console.log('[Playback] 路径长度=', playbackState.path.length);
                // 使用DOM标记进行移动（容器/图层坐标）
                if (!playbackDom.el) console.log('[Playback] DOM标记不存在，将尝试创建');
                updatePlaybackDom(nextLL);
                // 折线更新：优先setLngLats，兜底重建
                if (playbackState.line && typeof playbackState.line.setLngLats === 'function') {
                    try { playbackState.line.setLngLats(playbackState.path); }
                    catch(e){
                        console.warn('[Playback] setLngLats失败，重建折线', e);
                        if (map) { try { map.removeOverLay(playbackState.line); } catch(e){} }
                        playbackState.line = new T.Polyline(playbackState.path, { color: '#00FFFF', weight: 1, opacity: 0.9 });
                        if (map) map.addOverLay(playbackState.line);
                    }
                } else {
                    console.log('[Playback] 折线不支持setLngLats，重建');
                    if (playbackState.line && map) { try { map.removeOverLay(playbackState.line); } catch(e){} }
                    playbackState.line = new T.Polyline(playbackState.path, { color: '#00FFFF', weight: 1, opacity: 0.9 });
                    if (map) map.addOverLay(playbackState.line);
                }
            } catch(e) { console.warn('更新回放覆盖物失败:', e); }
            updatePlaybackTimeLabel(next.ts);
            scheduleNext();
        }, delay);
    }

    function stopPlayback(){
        if (playbackState.timer) { clearTimeout(playbackState.timer); playbackState.timer = null; }
        playbackState.running = false;
        playbackState.idx = 0;
        try {
            // 移除DOM标记
            removePlaybackDom();
            if (playbackState.marker && map) map.removeOverLay(playbackState.marker);
            if (playbackState.line && map) map.removeOverLay(playbackState.line);
        } catch(e){}
        playbackState.marker = null;
        playbackState.line = null;
        updatePlaybackTimeLabel('—');
        // 按钮回到初始状态
        updatePlaybackButtonsState('idle');
    }

    function updatePlaybackTimeLabel(text){
        const el = document.getElementById('playbackTimeLabel');
        if (el) el.textContent = '时间：' + (text || '—');
    }

    // 时间滑动条：配置与跳转
    function configureTimeSlider(points){
        try {
            const slider = document.getElementById('playbackTimeSlider');
            const cursor = document.getElementById('playbackTimeCursor');
            if (!slider || !points || !points.length) return;
            const minMs = points[0].time.getTime();
            const maxMs = points[points.length - 1].time.getTime();
            const prev = parseInt(slider.value, 10);
            slider.min = String(minMs);
            slider.max = String(maxMs);
            slider.step = '1000'; // 以秒为步进
            let val = (isFinite(prev) && prev >= minMs && prev <= maxMs) ? prev : minMs;
            slider.value = String(val);
            if (cursor) cursor.textContent = formatTimeForLabel(val);
        } catch(e) { console.warn('配置时间滑动条失败:', e); }
    }
    function formatTimeForLabel(ms){
        if (!isFinite(ms)) return '—';
        const d = new Date(ms);
        const pad = n => String(n).padStart(2,'0');
        const y = d.getFullYear();
        const M = pad(d.getMonth()+1);
        const da = pad(d.getDate());
        const h = pad(d.getHours());
        const m = pad(d.getMinutes());
        const s = pad(d.getSeconds());
        return `${y}-${M}-${da} ${h}:${m}:${s}`;
    }
    function findIndexByTime(points, ms){
        try {
            if (!points || !points.length) return 0;
            const n = points.length;
            const minMs = points[0].time.getTime();
            const maxMs = points[n-1].time.getTime();
            if (!isFinite(ms)) return 0;
            if (ms <= minMs) return 0;
            if (ms >= maxMs) return n-1;
            let lo = 0, hi = n - 1, ans = 0;
            while (lo <= hi) {
                const mid = (lo + hi) >> 1;
                const t = points[mid].time.getTime();
                if (t < ms) { lo = mid + 1; ans = lo; }
                else { hi = mid - 1; ans = mid; }
            }
            return Math.max(0, Math.min(n-1, ans));
        } catch(e){ console.warn('findIndexByTime失败:', e); return 0; }
    }
    function jumpToSliderTime(){
        try {
            const slider = document.getElementById('playbackTimeSlider');
            if (!slider || !playbackState.points || !playbackState.points.length) return;
            const ms = parseInt(slider.value, 10);
            if (!isFinite(ms)) return;
            const idx = findIndexByTime(playbackState.points, ms);
            playbackState.idx = idx;
            const pts = playbackState.points;
            const ll = pts[idx].ll;
            playbackState.path = pts.slice(0, idx+1).map(p=>p.ll);
            // 更新折线
            try {
                if (playbackState.line && typeof playbackState.line.setLngLats === 'function') {
                    playbackState.line.setLngLats(playbackState.path);
                } else {
                    if (playbackState.line && map) { try { map.removeOverLay(playbackState.line); } catch(e){} }
                    playbackState.line = new T.Polyline(playbackState.path, { color: '#00FFFF', weight: 1, opacity: 0.9 });
                    if (map) map.addOverLay(playbackState.line);
                }
            } catch(e){ console.warn('滑块更新折线失败:', e); }
            // 更新标记与时间
            ensurePlaybackDom(ll);
            updatePlaybackDom(ll);
            updatePlaybackTimeLabel(pts[idx].ts);
            // 若正在播放，立即按新位置继续
            if (playbackState.running) {
                if (playbackState.timer) { clearTimeout(playbackState.timer); playbackState.timer = null; }
                scheduleNext();
            }
        } catch(e) { console.warn('滑块跳转失败:', e); }
    }

    // DOM标记：使用容器坐标实现可见移动
    let playbackDom = { el: null, lastLL: null, bound: false };

    function ensurePlaybackDom(ll){
        try {
            playbackDom.lastLL = ll;
            const pane = (map && map.getPanes && map.getPanes().overlayPane) || document.getElementById('mapContainer');
            if (!pane) { console.warn('未找到overlayPane或mapContainer'); return; }
            if (!playbackDom.el) {
                const el = document.createElement('div');
                el.id = 'playbackDomMarker';
                el.style.position = 'absolute';
                el.style.width = '0';
                el.style.height = '0';
                el.style.borderLeft = '3px solid transparent';
                el.style.borderRight = '3px solid transparent';
                el.style.borderBottom = '4px solid #2C64A7';
                el.style.borderTop = '0';
                el.style.transform = 'translate(-50%, -50%)';
                el.style.zIndex = '9999';
                // 添加伪元素来增强箭头效果
                el.style.clipPath = 'polygon(50% 0, 100% 100%, 0 100%)';
                pane.appendChild(el);
                playbackDom.el = el;
                console.log('[Playback] 创建DOM标记，父节点=', pane === document.getElementById('mapContainer') ? '#mapContainer' : 'overlayPane');
                bindPlaybackDomEvents();
            }
            updatePlaybackDom(ll);
        } catch(e) { console.warn('创建DOM标记失败:', e); }
    }

    function updatePlaybackDom(ll){
        try {
            playbackDom.lastLL = ll;
            if (!map || !playbackDom.el || !ll) { console.log('[Playback] update取消：map/el/ll缺失'); return; }
            let p;
            if (typeof map.lngLatToLayerPoint === 'function') {
                p = map.lngLatToLayerPoint(ll);
                console.log('[Playback] 使用layerPoint定位:', ll && ll.lng, ll && ll.lat, '=>', p && p.x, p && p.y);
            } else if (typeof map.lngLatToContainerPoint === 'function') {
                p = map.lngLatToContainerPoint(ll);
                console.log('[Playback] 使用containerPoint定位:', ll && ll.lng, ll && ll.lat, '=>', p && p.x, p && p.y);
            } else {
                console.warn('地图对象不支持lngLat到像素坐标转换');
                return;
            }
            playbackDom.el.style.left = p.x + 'px';
            playbackDom.el.style.top = p.y + 'px';
        } catch(e) { console.warn('更新DOM标记位置失败:', e); }
    }

    function bindPlaybackDomEvents(){
        if (playbackDom.bound) return;
        const updater = function(){
            try {
                if (!map || !playbackDom.el || !playbackDom.lastLL) return;
                let p;
                if (typeof map.lngLatToLayerPoint === 'function') {
                    p = map.lngLatToLayerPoint(playbackDom.lastLL);
                } else if (typeof map.lngLatToContainerPoint === 'function') {
                    p = map.lngLatToContainerPoint(playbackDom.lastLL);
                }
                if (!p) return;
                playbackDom.el.style.left = p.x + 'px';
                playbackDom.el.style.top = p.y + 'px';
            } catch(e){}
        };
        try {
            map.addEventListener('move', updater);
            map.addEventListener('zoom', updater);
            playbackDom.bound = true;
        } catch(e){}
    }

    function removePlaybackDom(){
        try {
            const el = playbackDom.el;
            playbackDom.lastLL = null;
            if (el && el.parentNode) el.parentNode.removeChild(el);
        } catch(e){}
        playbackDom.el = null;
        playbackDom.bound = false;
    }

</script>
</body>

</html>
