<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>展示轮廓</title>
    <style>
        body {
            margin: 0;
            padding: 0;
        }

        #mapContainer {
            width: 100vw;
            height: 100vh;
            position: relative;
        }

        #mapLoading {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 999;
            transition: opacity 0.3s;
        }

        .loading-text {
            font-size: 16px;
            color: #333;
            padding: 10px 20px;
            background: white;
            border-radius: 4px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        .wkt-input-container {
            position: absolute;
            top: 20px;
            right: 10px;
            z-index: 1000;
            background: white;
            padding: 12px;
            border-radius: 6px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
            width: min(320px, 90vw);
            box-sizing: border-box;
            transition: all 0.3s;
        }

        .minimize-btn {
            position: absolute;
            top: -5px;
            right: -4px;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #f0f0f0;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            color: #666;
            z-index: 1001;
            transition: background 0.2s;
        }

        .minimize-btn:hover {
            background: #e0e0e0;
        }

        .content-wrapper {
            transition: all 0.3s;
        }

        .wkt-input-container.minimized {
            width: 40px;
            height: 40px;
            padding: 0;
        }

        .wkt-input-container.minimized .content-wrapper {
            display: none;
        }

        .wkt-input-container.minimized .min-icon {
            display: none;
        }

        .wkt-input-container.minimized .restore-icon {
            display: inline;
        }

        #wktTextarea {
            width: 100%;
            height: 120px;
            margin-bottom: 10px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-family: monospace;
            resize: vertical;
            box-sizing: border-box;
        }

        .button-group {
            display: flex;
            gap: 10px;
        }

        /* 页签样式 */
        .tabs-header {
            display: flex;
            gap: 8px;
            margin-bottom: 8px;
        }
        .tab-btn {
            flex: 1;
            padding: 6px 0;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 13px;
            background: #f5f5f5;
            color: #333;
            transition: background 0.2s;
        }
        .tab-btn.active { background: #337AFF; color: #fff; }
        .tab-pane { display: none; }
        .tab-pane.active { display: block; }

        /* Multi → Polygons 分割器样式 */
        .split-section {
            margin-top: 10px;
            padding: 10px;
            background: #fafafa;
            border: 1px solid #eee;
            border-radius: 6px;
        }
        .split-section .title {
            font-size: 13px;
            font-weight: 600;
            color: #333;
            margin-bottom: 6px;
        }
        .split-section .desc {
            font-size: 12px;
            color: #666;
            margin-bottom: 8px;
        }
        #multiInput, #polyOutput {
            width: 100%;
            height: 90px;
            margin-bottom: 8px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-family: monospace;
            resize: vertical;
            box-sizing: border-box;
        }
        .split-actions {
            display: flex;
            gap: 8px;
            margin-bottom: 8px;
        }
        .split-actions button {
            flex: 1;
            padding: 6px 0;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 13px;
            transition: background 0.2s;
        }
        #splitMultiBtn { background: #337AFF; color: #fff; }
        #splitMultiBtn:hover { background: #2860E0; }
        #copyPolysBtn { background: #f5f5f5; color: #333; }
        #copyPolysBtn:hover { background: #e0e0e0; }
        #drawButton,
        #clearButton,
        #drawTrackButton,
        #clearTrackButton {
            width: 50%;
            padding: 8px 0;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.2s;
        }

        #drawButton,
        #drawTrackButton {
            background: #337AFF;
            color: white;
        }

        #drawButton:hover,
        #drawTrackButton:hover {
            background: #2860E0;
        }

        #clearButton,
        #clearTrackButton {
            background: #f5f5f5;
            color: #333;
        }

        #clearButton:hover,
        #clearTrackButton:hover {
            background: #e0e0e0;
        }

        #drawButton:disabled,
        #clearButton:disabled,
        #drawTrackButton:disabled,
        #clearTrackButton:disabled {
            background: #e0e0e0;
            color: #999;
            cursor: not-allowed;
        }

        .tip {
            font-size: 12px;
            color: #666;
            margin-bottom: 8px;
            line-height: 1.4;
        }

        .area-label {
             position: absolute;
             background: rgba(255, 0, 0, 0.85);
             border: 1px solid #000;
             border-radius: 3px;
             padding: 4px 6px;
             font-size: 12px;
             color: #fff;
             font-weight: 600;
             box-shadow: 0 2px 6px rgba(0, 0, 0, 0.25);
             white-space: nowrap;
             z-index: 9999;
             pointer-events: none;
         }
         /* 默认隐藏标签容器下的标签 */
          .labels-hidden .area-label { display: none; }

          /* Batch → Generator 样式 */
          .batch-section { margin-top: 10px; padding: 10px; background: #fafafa; border: 1px solid #eee; border-radius: 6px; }
          .batch-section .title { font-size: 13px; font-weight: 600; color: #333; margin-bottom: 6px; }
          .batch-section .desc { font-size: 12px; color: #666; margin-bottom: 8px; }
          #batchInput, #multiOutput { width: 100%; height: 90px; margin-bottom: 8px; padding: 8px; border: 1px solid #ddd; border-radius: 4px; font-family: monospace; resize: vertical; box-sizing: border-box; }
          .batch-actions { display: flex; gap: 8px; margin-bottom: 8px; }
          .batch-actions button { flex: 1; padding: 6px 0; border: none; border-radius: 4px; cursor: pointer; font-size: 13px; transition: background 0.2s; }
          #generateMultiBtn { background: #337AFF; color: #fff; }
          #generateMultiBtn:hover { background: #2860E0; }
          #copyMultiBtn { background: #f5f5f5; color: #333; }
          #copyMultiBtn:hover { background: #e0e0e0; }
      </style>
    <script src="https://api.tianditu.gov.cn/api?v=4.0&tk=648f621977051d0199ff0f965d3fd322"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/Turf.js/6.5.0/turf.min.js"></script>
    <script src="https://lib.baomitu.com/terraformer/1.0.12/terraformer.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://unpkg.com/terraformer-wkt-parser@1.2.1/terraformer-wkt-parser.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <!-- 已移除动态备用加载器 ensureTerraformer：改为仅使用静态脚本标签加载 Terraformer 核心库与 WKT 解析器 -->
    <script>
        // 检查Turf.js是否加载成功
        window.addEventListener('load', function () {
            if (typeof turf === 'undefined') {
                console.warn('Turf.js加载失败，已启用备用面积算法');
            } else {
                console.log('Turf.js加载成功');
            }
        });
    </script>
</head>

<body>
<div id="mapContainer">
    <div id="mapLoading">
        <div class="loading-text">地图正在加载中...</div>
    </div>
</div>

<div class="wkt-input-container">
    <div class="minimize-btn" id="minimizeBtn">
        <span class="min-icon">−</span>
        <span class="restore-icon" style="display:none;">+</span>
    </div>

    <div class="content-wrapper">
        <div class="tabs-header">
            <button class="tab-btn active" id="tabDrawBtn">轮廓</button>
            <button class="tab-btn" id="tabTrackBtn">轨迹</button>
            <button class="tab-btn" id="tabSplitBtn">分割器</button>
            <button class="tab-btn" id="tabBatchBtn">合并器</button>
        </div>
        <div class="tab-pane active" id="tabDraw">
            <div class="tip">请输入WKT字符串（支持POLYGON/MULTIPOLYGON）：</div>
            <textarea id="wktTextarea">MULTIPOLYGON (((122.8073024285674 43.08132075415024, 122.8072907518405 43.081394706378234, 122.80729070053242 43.081396911769836, 122.80729123717431 43.08139908212267, 122.8072923411434 43.081401134031296, 122.80729397001485 43.08140298864198, 122.80729606119203 43.08140457468307, 122.80729853431215 43.081405831203874, 122.80730129433468 43.08140670991697, 122.80730423519339 43.08140717705391, 122.80730724387253 43.08140721466283, 122.80731020475045 43.08140682129849, 122.80731300404209 43.08140601207765, 122.80731495679686 43.08140509056414, 122.80732374023484 43.08146421798815, 122.80732435761415 43.08146637677713, 122.80732553769218 43.08146840579845, 122.8073272351193 43.08147022707801, 122.80732938466433 43.08147177062499, 122.80733190372156 43.081472977121734, 122.80733469548491 43.08147380020324, 122.80733765266837 43.08147420823892, 122.80734066162904 43.081474185548196, 122.80734360673434 43.08147373300304, 122.8073463748052 43.081472867994535, 122.8073488594664 43.081471623764465, 122.80735096523357 43.08147004812797, 122.80735261118352 43.08146820163583, 122.80735373406307 43.08146615524776, 122.80735429072078 43.081463987605325, 122.80735425976467 43.081461782009804, 122.80733332126998 43.08132083073687, 122.80735832920847 43.08116244680765, 122.80748207644673 43.08108107874496, 122.80771067868181 43.081007460901205, 122.8077200182031 43.08100501245053, 122.80786002591219 43.08097063144584, 122.80823402596923 43.0808756314297, 122.80823531043349 43.080875256869554, 122.80859823400671 43.080755282131065, 122.80868122587057 43.080728642887685, 122.8087767361804 43.08070043648935, 122.8087775666636 43.080700170073165, 122.80887202711949 43.080667398002504, 122.80892215720345 43.08065130678079, 122.80903804646333 43.08060979904717, 122.80907170313445 43.08059812211766, 122.8092158744627 43.08054682205758, 122.80938698288365 43.08049036493603, 122.80969936595945 43.080399544295176, 122.80993306819599 43.08033962064332, 122.80993399045833 43.08033935943647, 122.81021377643826 43.08025242593356, 122.81054355977581 43.08015848764699, 122.81085744969602 43.080061526507066, 122.81114618097918 43.07998984149802, 122.81139641605357 43.079947969492366, 122.81139865648578 43.07994745981767, 122.81189765655759 43.07980245979339, 122.81214760535131 43.07972148562714, 122.81244062675746 43.079647731938174, 122.8125912630045 43.07961580902427, 122.81259312939777 43.07961531565242, 122.81275912942046 43.079562315643656, 122.8127613094393 43.079561460379516, 122.81276327383569 43.079560359627145, 122.81281627383703 43.07952535962244, 122.8128182402293 43.07952378929943, 122.81288224022408 43.07946178929266, 122.81288293071391 43.079461062624205, 122.81297134706065 43.07935973150725, 122.81300435383066 43.07933157866921, 122.81305404790672 43.07929381116615, 122.8130546652853 43.0792933129597, 122.81318189578333 43.079184258256326, 122.81324213195397 43.079137746760345, 122.81324349056469 43.079136539640004, 122.81326376575544 43.07911573091177, 122.81330852501772 43.079078431471935, 122.81330941621985 43.07907761526482, 122.81342641620869 43.07895961525224, 122.81352117962312 43.07885376726678, 122.81371407644409 43.0786168939071, 122.81382792881627 43.07848506481231, 122.81394759314574 43.07834944520775, 122.81406526654511 43.078234763482065, 122.81406636331681 43.0782335352915, 122.81414012715555 43.078137841636654, 122.81421924029463 43.07804869188705, 122.81431910363345 43.077923862680535, 122.8145444644211 43.0776636008251, 122.81469788024859 43.07752612427928, 122.81469835207784 43.07752567916911, 122.81485965109621 43.077365371282546, 122.81503865107555 43.077174371262934, 122.8150390904212 43.07717387499424, 122.81519061654859 43.07699244235033, 122.81537508720766 43.07682086477232, 122.81558045303817 43.076693972135175, 122.8156472578241 43.076661104130075, 122.81586893563951 43.07658837974358, 122.81598302201881 43.07655564191238, 122.81608643311152 43.07653277215089, 122.8161831379524 43.076507602544616, 122.81618626860063 43.07650647940093, 122.81625026860652 43.076476479396376, 122.81625250997931 43.07647520001721, 122.81625387366506 43.07647406908186, 122.81627824899711 43.07646594394986, 122.81627838492997 43.07646619461954, 122.81628009330036 43.07646810032782, 122.8162822907394 43.07646971438968, 122.81628488698703 43.07647097050736, 122.81628777540232 43.07647181708573, 122.81629083734339 43.07647221935153, 122.81629394704058 43.076472160781655, 122.81632594704635 43.07646916078113, 122.81632879528989 43.07646868845552, 122.81633146995367 43.07646782922979, 122.81633387422052 43.076466614206176, 122.81633592106063 43.07646508736606, 122.81633753638293 43.07646330397788, 122.81633866171586 43.07646132859665, 122.816339256325 43.076459232727125, 122.81633929868642 43.07645709223545, 122.81633878726709 43.076454984603004, 122.81633774057924 43.076452986121744, 122.81632404973575 43.07643282327223, 122.81632587622487 43.07643314344732, 122.8163288130095 43.07643323588324, 122.81633171997495 43.07643291621463, 122.81633449050084 43.07643219616616, 122.81633702297106 43.076431102147396, 122.81633769855048 43.07643066398166, 122.81633953775052 43.076430179930966, 122.8163420507397 43.076429087319525, 122.81634423576614 43.07642766541993, 122.81634601365315 43.076425965756115, 122.81634731997721 43.076424049917165, 122.81634810740248 43.07642198732542, 122.81634834739577 43.076419852720974, 122.81634735000016 43.07636399934646, 122.81634934837237 43.076250930099334, 122.81634734831353 43.07601493009948, 122.81634334858316 43.07590884439915, 122.81634334850388 43.075590999998894, 122.8163403494188 43.075475928596255, 122.81634334807248 43.07513407235176, 122.81634034774594 43.07503285668454, 122.81633934907246 43.07483512911808, 122.81634334819509 43.0747249609067, 122.81634234875405 43.074514089937765, 122.81635434521621 43.074062218944924, 122.81635134809181 43.07393989859001, 122.81635134804223 43.073741311030425, 122.81635532459087 43.073688621586776, 122.81635533661684 43.07368756618205, 122.81635033659323 43.073592566182676, 122.81634993885571 43.073590419323196, 122.81634652159944 43.073579787875474, 122.81635529946628 43.07356861604133, 122.81635651705638 43.07356665201692, 122.81635720096125 43.07356455373481, 122.81635732603893 43.073562398333344, 122.8163568876911 43.073560265050766, 122.81635590203267 43.07355823231213, 122.8163544052992 43.073556374846234, 122.81635245251456 43.07355476093839, 122.81635011546804 43.073553449920084, 122.81634748007586 43.07355248998772, 122.81634464322181 43.07355191643096, 122.81634170919597 43.07355175033522, 122.81633878586089 43.07355199780664, 122.81633767225807 43.07355225661517, 122.81633193884284 43.07353441932548, 122.81633107467626 43.073532512805606, 122.81632976179228 43.07353074934283, 122.81632804204745 43.07352918515845, 122.81632597026903 43.07352787012049, 122.81632361250792 43.07352684615392, 122.81630887636526 43.07352168850656, 122.8163093441977 43.07350624989665, 122.81630910239552 43.07350399522391, 122.81630825041904 43.07350182154917, 122.81630682269005 43.0734998166943, 122.81630487689267 43.07349806166041, 122.8163024916417 43.073496627355226, 122.81629976330744 43.07349557172825, 122.81629680212129 43.07349493742941, 122.81629446043468 43.07349479473496, 122.81629444908822 43.07349478982118, 122.81629155603696 43.0734940544883, 122.81628852144766 43.07349375481104, 122.81628546610355 43.07349390271722, 122.81628251161408 43.073494492319846, 122.81627977557447 43.073495500151445, 122.81627736688519 43.07349688609809, 122.81627538141731 43.07349859499603, 122.81625838141544 43.07351659499419, 122.81625695528301 43.07351846264122, 122.81625603737514 43.07352049447795, 122.81625566090759 43.07352261697998, 122.81625583950307 43.0735247533421, 122.8162583437483 43.073536390743364, 122.81625801284856 43.073537824640916, 122.81625670328214 43.073537875008064, 122.8162537979346 43.07353841432957, 122.81625109094875 43.073539357296845, 122.81624868554547 43.073540667953296, 122.81624667344595 43.07354229632187, 122.8162451313745 43.07354418031067, 122.81624411813215 43.07354624808072, 122.81624367235537 43.073548420785194, 122.81623467232357 43.07367642078395, 122.81623482084082 43.07367866448932, 122.81623557437257 43.073680841851115, 122.8162369028845 43.07368286608354, 122.81623875342447 43.073684656504255, 122.81623944105478 43.07368510077792, 122.81623565285027 43.07393587540453, 122.81624164901532 43.07414402043448, 122.81623465642959 43.0744367070337, 122.81622965215807 43.07454291873514, 122.8162276521074 43.074745918734784, 122.81622964998232 43.07484300254893, 122.81622765176863 43.07494304273674, 122.8162286510836 43.075135919793034, 122.81622365406054 43.07533879686841, 122.81622964999303 43.075524086877024, 122.81622865348265 43.07561218125826, 122.81623064936048 43.075702994729326, 122.81622665288226 43.07587515502768, 122.81623165281589 43.07614115502822, 122.81623464677095 43.076188191406345, 122.8162326525658 43.07630285656192, 122.81623664448912 43.07638804934775, 122.81623470290552 43.07644338408961, 122.81622959060468 43.07645744290904, 122.81608838599959 43.07650451106612, 122.81588815660284 43.07655332320602, 122.81588701074301 43.07655364029548, 122.81568101077151 43.07661764028485, 122.81567844647743 43.07661865743697, 122.81563232660646 43.076641348490405, 122.81560373032242 43.076650729840374, 122.81560010797935 43.07665239675683, 122.81556195236018 43.07667597266855, 122.81542844649842 43.07674165741852, 122.81542547070126 43.07674357245687, 122.8152204706941 43.07691457243644, 122.81521899422188 43.07691602490071, 122.81505424551997 43.0771087309118, 122.81492711050595 43.07723889091545, 122.8147855481614 43.077399394664184, 122.81461105432642 43.07755793474777, 122.81448580087948 43.077678171406134, 122.81448489590043 43.07767914128522, 122.8143810361562 43.07780397267718, 122.81427418439851 43.077922807781796, 122.81427372811693 43.07792334781607, 122.81408312231184 43.078163850365996, 122.81396758368253 43.07828038499332, 122.81386902251627 43.07838499157432, 122.81367580820921 43.07860924776391, 122.81347793279619 43.07885309416908, 122.81339041365709 43.07895354224832, 122.8132948083187 43.07904516401297, 122.81323969974554 43.079101715263384, 122.81317133472345 43.07915868705324, 122.81315906399993 43.07916920484028, 122.81314069890418 43.07918338596466, 122.81297769890051 43.07931338594874, 122.81297640916065 43.079314564476434, 122.81285970155781 43.079437257059176, 122.81276797439979 43.07952117763845, 122.81262503697634 43.07957757471316, 122.81234446033413 43.079641251678694, 122.8123436276189 43.0796414600143, 122.8120296276653 43.07972745999982, 122.81175214705063 43.079814597296895, 122.81149500408839 43.07988934815697, 122.81095968822119 43.08000420137154, 122.8109587796554 43.080004419035326, 122.81066077970014 43.08008341902196, 122.81065985054603 43.08008369074978, 122.8103481109442 43.08018360728641, 122.80938537547448 43.08046153091355, 122.80938429682655 43.080461877900746, 122.8092025979291 43.08052653166285, 122.80917726059141 43.08053489083478, 122.80902524385708 43.08058934470249, 122.808859303612 43.08064691587096, 122.80866933685692 43.08070789332063, 122.80842305533137 43.08078062638812, 122.8080694389961 43.08088950825195, 122.80770994991555 43.08098375270406, 122.80751212411235 43.0810323310803, 122.80750927709602 43.08103327615851, 122.80750675024086 43.08103462434909, 122.80746523239168 43.081061923838284, 122.80734482595128 43.081100698621775, 122.80734205287624 43.08110185735913, 122.8073396667003 43.08110341145055, 122.80733777060874 43.08110529369265, 122.8073364465939 43.08110742269191, 122.8073357519102 43.0811097063843, 122.80732917042432 43.08115138923168, 122.80728775024679 43.08117862432969, 122.80728578027914 43.081180190565014, 122.80728424835472 43.08118200089981, 122.80728320938876 43.081183990438596, 122.80728270062542 43.08118608786191, 122.8072827403025 43.081188217982884, 122.8073024285674 43.08132075415024), (122.80731834005796 43.08121998159623, 122.80731411221258 43.081191520917265, 122.80732384423585 43.08118512180004, 122.80731834005796 43.08121998159623), (122.81627029055107 43.07367506744992, 122.81627215458676 43.07367304132398, 122.81626820118392 43.073813385971924, 122.81627029055107 43.07367506744992), (122.81630207185593 43.073595187602265, 122.81630599502837 43.07357866894923, 122.81630820134546 43.07357969856342, 122.8163072612074 43.07358072416791, 122.8163058543345 43.07358263440647, 122.8163049740412 43.07358470715649, 122.81630465309682 43.07358686525885, 122.8163049034488 43.07358902837702, 122.81630967284434 43.073608105978266, 122.81631265015109 43.07375399578977, 122.81630965381312 43.07389382326433, 122.81630966207447 43.07389440923278, 122.81631664548757 43.07403507583274, 122.8163046519909 43.07441894225131, 122.8162986518156 43.075276063022365, 122.81630665155424 43.07632306302294, 122.81630727035913 43.07634474150559, 122.81629589305633 43.0763112788369, 122.81629489821029 43.07630922535643, 122.8162937684567 43.076307828666486, 122.81629334714606 43.076290835945976, 122.81628634960975 43.07582400808254, 122.81628834819163 43.07570592501505, 122.81628434896217 43.075266021850105, 122.81628834835335 43.07498799999904, 122.81628834826132 43.074619127977215, 122.81629734421828 43.074329255921086, 122.81629934767524 43.07414108774684, 122.81629921359125 43.074139513402564, 122.81628333241157 43.07405216703359, 122.81628261785642 43.074018226096634, 122.81628532188927 43.074017984981964, 122.81628815184719 43.074017308301116, 122.81629075040563 43.07401624387748, 122.81629301982079 43.074014831748954, 122.81629487472959 43.074013125032224, 122.8162962453602 43.0740111879248, 122.81629708015711 43.074009093290236, 122.81629734771978 43.07400691991741, 122.81629634921069 43.073904076125295, 122.8163043447405 43.07362023230468, 122.81630433529828 43.073619542120014, 122.81630333529378 43.07360154212014, 122.81630316051512 43.073600246653704, 122.81630207185593 43.073595187602265), (122.81626626997908 43.07641888853769, 122.8162676885568 43.07643378364089, 122.81626817693225 43.076435919394136, 122.81626921439411 43.07643794700519, 122.81627076251222 43.07643979136585, 122.81627276393982 43.07644138415602, 122.81627396836622 43.07644203287411, 122.8162736262334 43.076442764329514, 122.81626529402287 43.076445541741805, 122.8162653436421 43.07644528931635, 122.81626626997908 43.07641888853769), (122.80736365537604 43.08112871423751, 122.80736523573152 43.08111870526026, 122.80739197133357 43.081110095540375, 122.80736365537604 43.08112871423751)), ((122.82515301613155 43.10401903588625, 122.82511116154984 43.103907960289455, 122.82508734939654 43.10372242428661, 122.82508535624368 43.10355101681564, 122.82508834690138 43.10336060857807, 122.82511328377394 43.10317208546499, 122.8251133470755 43.10317062965471, 122.82510534703114 43.102992629655695, 122.82510509523814 43.1029909377824, 122.82506213363736 43.10282208886385, 122.82502713360266 43.102660095074874, 122.8249631335374 43.10238709508313, 122.8249623355825 43.102384968288916, 122.82496098671945 43.10238299643111, 122.82495913878412 43.10238125528711, 122.82495686279178 43.102379811768046, 122.82495424620743 43.10237872134757, 122.82495138958498 43.102378025929866, 122.82494840270277 43.10237775223946, 122.82494540034487 43.10237791079409, 122.82494249789022 43.10237849550062, 122.82493980687846 43.10237948388911, 122.8249374307237 43.10238083797636, 122.82493546074 43.10238250572557, 122.82493397263299 43.102384423046104, 122.82493302358961 43.10238651625643, 122.82493265008131 43.10238870491566, 122.82493286646171 43.102390904914856, 122.82499684935048 43.10266383221198, 122.82503190480101 43.10282606221005, 122.8250746913025 43.10299422327604, 122.82508262014186 43.103170640933754, 122.82505771618005 43.10335891452959, 122.82505764557389 43.103359870512, 122.82505464552618 43.103550870511526, 122.82505664502357 43.10372309586232, 122.82505671191929 43.103724053468966, 122.82508071187317 43.103911053472075, 122.82508119825064 43.10391299456922, 122.82513319821987 43.10405099457582, 122.82513351678506 43.1040517384965, 122.82518363075093 43.10415596764106, 122.8252376307298 43.10426096764773, 122.82528941554364 43.10435260228117, 122.82529857078619 43.104378065343276, 122.8252981528897 43.10439603470326, 122.82526428197367 43.104416165537785, 122.82526328578005 43.10441629172395, 122.82526015356018 43.10441703206769, 122.82525910341191 43.104416442614685, 122.82525641429574 43.10441547098365, 122.82525351876129 43.1044149007683, 122.82525052719978 43.10441475370792, 122.82524755366363 43.10441503540914, 122.82524471151807 43.10441573513221, 122.8251976758387 43.10443120584845, 122.8251976501273 43.104431209250734, 122.82519458042219 43.10443214896608, 122.82519417777843 43.104432356410044, 122.82517803501011 43.10443766599338, 122.82511468700794 43.10445674321154, 122.82474040280205 43.104580426961995, 122.82451062036805 43.10465387333506, 122.8244730437715 43.10466562910976, 122.82411111765394 43.104775606656275, 122.82391565581341 43.10483875353866, 122.82355179849375 43.104959706105724, 122.823338942447 43.10502666082259, 122.82316690006762 43.105083672578246, 122.82280413141517 43.10519360246956, 122.82267731762907 43.10523351273617, 122.82258904641763 43.10526092098642, 122.82217753400847 43.10538195439527, 122.82207122883736 43.10541157322862, 122.82193327425894 43.10545256768211, 122.82181156038125 43.105486477961016, 122.82159467498482 43.105546446272186, 122.82139884736895 43.105598400536635, 122.82121883710398 43.10564460638592, 122.8212161385048 43.10564398588704, 122.82121314349628 43.10564374886831, 122.82121014296551 43.10564394483395, 122.82120725238379 43.105644566242475, 122.82120458299109 43.105645589179844, 122.82120223751534 43.105646974279736, 122.82120046128992 43.105648532224194, 122.82119989564583 43.10564789116082, 122.82119797101473 43.10564612732461, 122.82119560443628 43.10564468062499, 122.82119289124358 43.1056436093396, 122.82118994073288 43.10564295662325, 122.82118687176016 43.10564274876939, 122.82118380795332 43.10564299415108, 122.82118087273221 43.10564368288356, 122.82117818433706 43.10564478722245, 122.82117585106481 43.105646262681496, 122.82117396690727 43.10564804982452, 122.82117260776425 43.10565007665966, 122.82117182838655 43.10565226153955, 122.82117166016997 43.10565451645023, 122.82117210989078 43.10565675055667, 122.8211731594331 43.105658873861934, 122.82123415941692 43.1057518738692, 122.82123577915424 43.10575381303641, 122.82123789785398 43.10575547403567, 122.82124042901205 43.10575678905035, 122.82124326928455 43.10575770439003, 122.82124630270647 43.105758182682465, 122.8212494054268 43.10575820439954, 122.82125245076524 43.105757768654605, 122.82125531438433 43.10575689323857, 122.82125787936587 43.10575561389363, 122.82126004098481 43.10575398285389, 122.82126171098481 43.10575206671275, 122.82129313351527 43.10570641512367, 122.82136497904861 43.10568764465335, 122.82147679921499 43.10566068800558, 122.82158665884259 43.105630459776414, 122.82182765887725 43.10556045976466, 122.82182840293478 43.105560226845924, 122.82194710272421 43.10552032775598, 122.82202263225142 43.10549776698795, 122.82211140592531 43.105482971375025, 122.82211365010716 43.105482462307926, 122.82262065018013 43.105335462283286, 122.82273392535559 43.10529838381199, 122.82278999529895 43.10528235864744, 122.82314415533592 43.105172308128715, 122.82361515539992 43.10502130810376, 122.82375732150417 43.104974253989155, 122.8237584507745 43.10497383840877, 122.82384827886601 43.10493731489811, 122.82393001202104 43.10491663542422, 122.82393119632003 43.104916294929744, 122.82416000375827 43.10484235715301, 122.82451415552407 43.104736308055614, 122.82490670929323 43.10461045111938, 122.82498125154049 43.10459057318621, 122.82498352282411 43.10458980890987, 122.82503410945507 43.104568979119804, 122.82512955221236 43.104535176475196, 122.82529753883102 43.10447851826546, 122.82530500783963 43.10447679464872, 122.82530556571956 43.10447725499685, 122.82530794853088 43.10447858092885, 122.82531063702537 43.104479543110024, 122.82531352913144 43.10448010501006, 122.82531651504685 43.10448024529578, 122.8253194814079 43.104479958641065, 122.82532231559334 43.1044792559291, 122.82532490999998 43.104478163839154, 122.82532716612828 43.10447672383367, 122.82532899832174 43.1044749905841, 122.82533033701908 43.10447302989525, 122.82533113139529 43.104470916206886, 122.82533135129084 43.10446872976762, 122.825331313867 43.10446758835022, 122.8253313907184 43.1044675070439, 122.82533256215336 43.10446557027724, 122.82533321737273 43.10446350694743, 122.82533333314976 43.1044613901977, 122.82533240704394 43.104448887819984, 122.82533287795903 43.10444897803666, 122.82544047117818 43.104557506854924, 122.8254523245052 43.104570067878825, 122.82574691050715 43.10512002295539, 122.82563716897042 43.105153590914995, 122.82529191419451 43.10525566972659, 122.82454891429641 43.1054906696877, 122.82436866282195 43.105553748636424, 122.82421294967921 43.1056026585322, 122.82421222843159 43.105602901432846, 122.82408722844717 43.10564790142557, 122.82397011516704 43.10569094262986, 122.82396811711291 43.105691821950295, 122.82393646244078 43.10570826998458, 122.82393590874096 43.105708118982754, 122.8239329131364 43.105707768286806, 122.82392988189534 43.105707855924365, 122.82383188191285 43.1057178559226, 122.82382894595929 43.105718375241715, 122.82382620552 43.10571930557682, 122.82369520591534 43.105775852173565, 122.82369477293179 43.10577586733492, 122.82369186274505 43.1057763966887, 122.82368914843659 43.105777330335954, 122.82368673350007 43.10577863267769, 122.82368471001469 43.105780254056924, 122.82368373030556 43.105781437734166, 122.82368272216839 43.10578224218546, 122.82368115392423 43.10578413449933, 122.82368012172519 43.105786215179144, 122.82367966553271 43.105788403672236, 122.82367980300802 43.10579061525195, 122.82368052882887 43.105792764297874, 122.8236818148955 43.105794767610504, 122.82368361141843 43.105796547632394, 122.82368584884595 43.10579803545066, 122.8236884405569 43.10579917346498, 122.82371018297704 43.10580669968819, 122.82372878477265 43.105829730487585, 122.823730625355 43.10583155891204, 122.82373292972464 43.1058330791311, 122.82373560392388 43.10583422915966, 122.82373853891555 43.10583496210668, 122.82374161502868 43.10583524808711, 122.82374470683848 43.105835075440474, 122.82374768828026 43.10583445120621, 122.82375043778926 43.10583340083673, 122.82375284325757 43.10583196715959, 122.82375480660512 43.10583020863124, 122.82375624777887 43.10582819695352, 122.82375710801674 43.1058260141502, 122.82375735224365 43.1058237492224, 122.82375697050156 43.10582149451978, 122.82375666184835 43.105820824870534, 122.82378827180199 43.105832114126564, 122.82379119693094 43.105832901104066, 122.82379427866037 43.105833239202774, 122.82379739009262 43.105833114500676, 122.82380040310704 43.105832532132695, 122.8238031936358 43.105831516079206, 122.82382892092062 43.105819623293286, 122.82386440006356 43.10582408918176, 122.82386759946226 43.1058242430469, 122.82387077272698 43.105823906762886, 122.82387378151681 43.105823094990285, 122.82397975944734 43.10578487345119, 122.82398035370446 43.10578478993723, 122.82398313712872 43.10578396250341, 122.8239961371302 43.10577896250261, 122.82399863316712 43.10577776232495, 122.82400076508468 43.10577623094457, 122.8240024522996 43.105774426245404, 122.82400363103783 43.105772416442356, 122.82400379154159 43.10577186777032, 122.82401003140527 43.10576812385067, 122.8240141891602 43.10576617607697, 122.82410835127538 43.1057457904628, 122.82411050294346 43.10574519291802, 122.82412880154575 43.105738925313474, 122.82411973048211 43.10575033728766, 122.82411848222917 43.10575233331782, 122.82411778678619 43.105754468968485, 122.82411767063424 43.10575666291807, 122.82411813819624 43.105758831624975, 122.82411917166849 43.105760892508876, 122.82412073169813 43.10576276709506, 122.82412275888224 43.10576438400273, 122.82412517602947 43.10576568166302, 122.82412789109917 43.10576661066338, 122.8241308007065 43.1057671356292, 122.8241337940589 43.1057672365707, 122.824136757175 43.105766909644224, 122.82413957722474 43.105766167298555, 122.82417192898176 43.10575493142058, 122.82417519753129 43.105759894776284, 122.82415851814288 43.10576189630226, 122.82415553011207 43.1057624863914, 122.8241527642306 43.10576350347122, 122.82415033282942 43.10576490623495, 122.8241483346555 43.105766637711945, 122.82414685086101 43.10576862758149, 122.82414594170743 43.10577079502874, 122.82414564411853 43.10577305202686, 122.82414597018027 43.105775306912044, 122.8241469066504 43.10577746810631, 122.82414841549605 43.10577944783671, 122.82415043543818 43.10578116570016, 122.82415288444055 43.10578255192878, 122.82420988444589 43.10580855193278, 122.8242126108955 43.10580953598324, 122.82421554845031 43.10581010731196, 122.82421858203872 43.105810243538514, 122.82422159282706 43.105809939326576, 122.82422446287512 43.105809206592895, 122.82422707975557 43.105808074040546, 122.82422934095831 43.10580658603458, 122.82423115790633 43.10580480086403, 122.82423245942502 43.105802788458675, 122.82423319453063 43.10580062764964, 122.82423333442725 43.10579840308139, 122.8242328736347 43.105796201896034, 122.82423183020354 43.10579411031966, 122.82423181245649 43.105794083370455, 122.82423376911571 43.105794250351806, 122.82423685168945 43.10579405590856, 122.82423981849828 43.1057934126485, 122.82425413899952 43.10578911649851, 122.82429742121728 43.10580148284535, 122.8243003045845 43.1058020769361, 122.82430329049751 43.10580224961019, 122.82430626535867 43.1058019942983, 122.82430911599079 43.105801320713624, 122.82431173394296 43.10580025448242, 122.82431401961634 43.10579883616893, 122.82431588605378 43.10579711973221, 122.82431726224738 43.10579517047329, 122.82431797649522 43.10579336434199, 122.82432848186333 43.10579210369711, 122.82433227149593 43.105791270488616, 122.82481702703836 43.10563235062624, 122.82490112713435 43.10560731715889, 122.8251770725213 43.10551933456931, 122.82549088304353 43.10542139370312, 122.82581874733512 43.105324433833765, 122.82582146400173 43.105323388145166, 122.8258238426542 43.10532196753638, 122.82582578829974 43.105320228740155, 122.8258272232383 43.10531824119616, 122.8258280901647 43.10531608427795, 122.82582835445805 43.105313844123145, 122.82582833717582 43.105313733467185, 122.82583819609603 43.10530908455257, 122.82592809801743 43.105290843561, 122.82592976637592 43.105290428191054, 122.82605776639409 43.1052524281847, 122.82606017754827 43.10525152347191, 122.82606233421733 43.10525032238897, 122.82606833421754 43.10524632238841, 122.82607032997159 43.10524470654919, 122.82607186316729 43.10524283911414, 122.82607287628693 43.10524079014, 122.82607333132336 43.10523863649393, 122.826073211206 43.10523645896987, 122.82607252044117 43.10523433925751, 122.8260712849429 43.10523235687772, 122.8260695510609 43.10523058619937, 122.82606738384152 43.105229093649314, 122.82606486458805 43.1052279352205, 122.82606208781007 43.10522715437128, 122.82605915767823 43.10522678039516, 122.8260561841161 43.105226827321815, 122.82605327867681 43.105227293390804, 122.82603666375483 43.10523122698224, 122.82612695891235 43.10520336991249, 122.82612967936386 43.10520228196822, 122.82613204626111 43.105200815922636, 122.82613396318827 43.10519903149514, 122.82613535205937 43.105197001374485, 122.82613615629873 43.10519480825774, 122.82613815629648 43.105185808257474, 122.8261383416727 43.105183515781356, 122.82613788794166 43.10518124347699, 122.82613681400498 43.10517908600458, 122.82613516460108 43.10517713324066, 122.82613300844137 43.105175466533936, 122.82613043534762 43.105174155316476, 122.8261275525105 43.10517325421128, 122.82612448002368 43.105172800756804, 122.82612134588186 43.105172813843154, 122.82611828064756 43.10517329292518, 122.82609007642928 43.105179967221076, 122.82609035458941 43.10517814687979, 122.82609009714062 43.10517594315578, 122.82608925631506 43.105173818911446, 122.8260878646035 43.105171856230854, 122.82608597578383 43.105170130955, 122.82608366284323 43.10516870975122, 122.826081015157 43.10516764753698, 122.8260781350359 43.10516698535786, 122.82607513377222 43.10516674880149, 122.82607212733947 43.10516694700876, 122.82603230229654 43.10517250400814, 122.82605201692886 43.10516635190985, 122.82605464749302 43.10516529792257, 122.826056948408 43.10516388949134, 122.82605883196109 43.105162180306586, 122.82606022634987 43.10516023552381, 122.82606107841904 43.105158129279644, 122.8260613556873 43.10515594186573, 122.82606104758493 43.105153756667995, 122.82606016585719 43.105151656987815, 122.82605874411617 43.105149722866614, 122.82605683655987 43.10514802803456, 122.8260545159057 43.10514663709995, 122.82605187061877 43.10514560308622, 122.82604900153946 43.10514496541077, 122.82604601803924 43.105144748382266, 122.82604303385129 43.105144960273996, 122.82604016273528 43.10514559300849, 122.82594821798135 43.10517328096191, 122.82598142137911 43.10515985033951, 122.82598393918042 43.105158576814844, 122.82598606244618 43.1051569628338, 122.8259877068934 43.105155072463326, 122.82598880724584 43.10515298074161, 122.8259893198252 43.10515077069949, 122.82598922428453 43.10514853006452, 122.82598852441645 43.10514634777862, 122.82598724800238 43.10514431046755, 122.8259854457094 43.105142499002284, 122.82598318907961 43.10514098528881, 122.82598056768983 43.10513982941395, 122.82597768559589 43.10513907726008, 122.8259746572025 43.105138758683886, 122.82597160272147 43.105138886331254, 122.82596864340026 43.10513945513522, 122.8259466434035 43.10514545513421, 122.82594475978448 43.10514607753923, 122.82584775979566 43.10518407753318, 122.82584494514968 43.10518549587402, 122.8258295676393 43.105195257266004, 122.82582814626403 43.10519446214718, 122.82582560225586 43.10519352389154, 122.82582327175214 43.105193031791345, 122.82581820722122 43.10518111525797, 122.82592874595446 43.10514843423749, 122.82602835869552 43.1051152416411, 122.82603094237318 43.105114146941034, 122.82603318825238 43.10511270671504, 122.82603501149495 43.105110975367694, 122.82603634322783 43.105109018300716, 122.82603713314482 43.10510690944236, 122.82603735140691 43.10510472845481, 122.82603698976929 43.10510255772491, 122.82603606189285 43.10510047925205, 122.8260346028282 43.10509857155056, 122.82603266769163 43.105096906683904, 122.82603032958284 43.10509554754241, 122.82602767682411 43.10509454546767, 122.82602480962328 43.10509393831307, 122.82602183628896 43.105093749013854, 122.82601886913876 43.10509398472082, 122.8260160202569 43.105094636530126, 122.82586910969674 43.10514014689785, 122.82587011300862 43.1051393518197, 122.82603419974832 43.10508629382753, 122.82603680762567 43.10508521686475, 122.82603908078164 43.1050837896281, 122.82604093282805 43.105082066357646, 122.8260422933805 43.10508011254393, 122.82604311073332 43.10507800243883, 122.82604335382413 43.105075816233935, 122.82604301341469 43.10507363701284, 122.8260421024418 43.105071547593745, 122.82604065552573 43.10506962738205, 122.8260387276546 43.10506794935264, 122.82603639209432 43.10506657727662, 122.82603373760458 43.105065563297764, 122.8260308650655 43.105064945950886, 122.82602788364365 43.10506474869735, 122.82602490664384 43.10506497903352, 122.8260220472025 43.10506562820578, 122.82599211950173 43.10507485013852, 122.82599624763571 43.105069689969206, 122.825996864405 43.10506866222641, 122.82605295494184 43.105051371132625, 122.82605564628209 43.1050502985193, 122.82605799345309 43.10504885577436, 122.82605990302488 43.10504710032695, 122.82606129898613 43.10504510205339, 122.8260621257699 43.105042940495856, 122.8260623504658 43.1050407016961, 122.82606196412988 43.10503847477049, 122.82606098214043 43.10503634836275, 122.82605944358593 43.10503440711546, 122.8260574097094 43.10503272830076, 122.82605496146999 43.10503137874459, 122.82605219632104 43.105030412166585, 122.82604922433035 43.10502986704176, 122.82604616379938 43.10502976506903, 122.82604313655362 43.105030110307496, 122.82598013656403 43.105042110305384, 122.82597714631929 43.10504293123772, 122.82597445244836 43.10504418757393, 122.82597217144252 43.10504582498628, 122.82597040193934 43.105047772668044, 122.82596922045761 43.105049946395596, 122.82596867808813 43.10505225217034, 122.82596861398822 43.10505295726803, 122.82590804507858 43.105071628860244, 122.82590565987806 43.105072552534445, 122.82590353210405 43.10507376781446, 122.82584864749373 43.10511123714386, 122.82584441610611 43.10511251639747, 122.82582640769898 43.105117375819574, 122.82582721651451 43.1051162531984, 122.82582807521975 43.10511414136652, 122.82582835571347 43.10511194740236, 122.82582804723744 43.10510975545562, 122.82582716162331 43.10510764959863, 122.82582573283894 43.105105710601684, 122.82582381568554 43.10510401283519, 122.8258214836957 43.10510262141712, 122.82581882631303 43.10510158971539, 122.82581594546177 43.10510095730102, 122.82581295163716 43.105100748430296, 122.8258099596674 43.10510097111446, 122.82580708430989 43.10510161681248, 122.82579645898603 43.10510486692146, 122.82579514324657 43.10509913405769, 122.82579451710302 43.10509733222555, 122.82577870497686 43.10506373147457, 122.82574572393426 43.104971805467876, 122.8256867239023 43.10482580547532, 122.82568596142151 43.10482431514749, 122.82560096139703 43.104688315157695, 122.82559963046178 43.10468660082394, 122.82547961138005 43.104559416489735, 122.82547129417749 43.10454388917477, 122.82547066818226 43.104542871954486, 122.82529707895077 43.104294459860164, 122.82516039301612 43.104025078942364, 122.82515907248182 43.104023096803566, 122.82515724957953 43.10402134152127, 122.82515499436235 43.104019880550034, 122.82515301613155 43.10401903588625), (122.8212494323998 43.10566059709971, 122.82128662567791 43.105651050052, 122.8212680779145 43.105660932053496, 122.8212494323998 43.10566059709971), (122.82194457159211 43.10547349402861, 122.82202372026218 43.10545144182013, 122.82218885321485 43.10540287371445, 122.8222836860939 43.1053764518329, 122.82248599152086 43.10531735982187, 122.82260074237374 43.105281729490294, 122.82261872034724 43.105276441790856, 122.82268885356244 43.105254370712586, 122.82270492566839 43.10524938026746, 122.823147859594 43.1051154002502, 122.82335919832379 43.10504529486171, 122.8235753219657 43.10497725383642, 122.8240071376561 43.10483431484234, 122.82444213977426 43.10470031309636, 122.8245229446217 43.10467448523667, 122.82466431293243 43.104630256813245, 122.82475285603748 43.10460099763205, 122.82488013983391 43.10456031307322, 122.8251902388272 43.1044583183411, 122.82520591147518 43.10445359968971, 122.82520746337806 43.1044532063762, 122.82520818505387 43.104452961006636, 122.82520826045454 43.10445295712576, 122.82520178514008 43.10446159087557, 122.82518491659636 43.104468016986736, 122.82518246289347 43.104469181555004, 122.82518035487054 43.10447066575491, 122.82518023107 43.10447079426243, 122.8251519607849 43.10447965507992, 122.82503920226956 43.104517569667436, 122.82495583154949 43.10453940485534, 122.82495322289692 43.10454029814902, 122.8248751676942 43.10457389152623, 122.82478618171746 43.104600587318025, 122.82478541489955 43.10460083547948, 122.82472204359654 43.10462287772892, 122.8246398691199 43.10465068109657, 122.8243299395376 43.104743661745914, 122.82388193959923 43.10488466172256, 122.82378253740995 43.104919791905616, 122.82354081324279 43.10499870185837, 122.8231549523441 43.10512165752986, 122.82256015197476 43.10530559579052, 122.82231234834327 43.1053785379866, 122.82187149606978 43.10550449577617, 122.82154672642663 43.10559443198328, 122.8213490187665 43.10564563123451, 122.8213634028088 43.105637967591264, 122.82163007382991 43.10556262558887, 122.8216556129801 43.10555673193867, 122.82165857754475 43.10555578631641, 122.82166063110822 43.10555470861722, 122.82169413981767 43.1055478350348, 122.82169577110963 43.10554742679028, 122.82194457159211 43.10547349402861), (122.82534210716426 43.10440829157429, 122.82534211083426 43.10440827756169, 122.82536987365673 43.10444800713134, 122.82535042379014 43.10442838722523, 122.82534906820209 43.10442727620011, 122.82534210716426 43.10440829157429), (122.82552863029517 43.10465092931438, 122.8255736011421 43.104698584909016, 122.82565758522756 43.10483295949403, 122.82571620877766 43.10497802802462, 122.82574127507681 43.1050479099011, 122.82552863029517 43.10465092931438), (122.82373892140104 43.10578310009926, 122.82383915372787 43.10573983431947, 122.82388465065841 43.10573519178513, 122.82386736567376 43.10574417318554, 122.82374460058915 43.1057841432145, 122.82373892140104 43.10578310009926), (122.82397903311507 43.10571373725163, 122.82398492953162 43.10571067342223, 122.82398845634847 43.1057093772442, 122.82397903311507 43.10571373725163), (122.82576025317447 43.105159205642906, 122.82576731512874 43.1051572995413, 122.82576875723684 43.10515863180281, 122.82577252588842 43.10516407541256, 122.8257722672848 43.1051671786484, 122.82576025317447 43.105159205642906), (122.82587695514748 43.10525372194518, 122.82588907482328 43.10524394115194, 122.82591569761978 43.10523623140339, 122.82587695514748 43.10525372194518), (122.82574149610767 43.1051771189359, 122.82573270984 43.10517990217134, 122.82569543901384 43.10519051209314, 122.82569436489814 43.105190852930754, 122.82565949571726 43.10520309425167, 122.82558207585075 43.105227618517766, 122.82525079876318 43.10532570664642, 122.82491389363632 43.10543467595743, 122.82460598906202 43.10553064621153, 122.82437184155286 43.10560969059381, 122.82420111374215 43.10566160782115, 122.82420010169595 43.10566194758792, 122.82410510170756 43.105696947582295, 122.82410372815929 43.105697520321684, 122.82401843638378 43.10573747684422, 122.82399974028276 43.10573077064024, 122.82403847801491 43.10571284718221, 122.82422845287837 43.10564521214924, 122.82441741406298 43.10558422310314, 122.8246072203399 43.10552028835539, 122.82478318106024 43.10546529987067, 122.82511209685408 43.105359326997984, 122.82528185751525 43.10530640161401, 122.82543892173807 43.10526038134044, 122.82559892176036 43.10521138133229, 122.82572787134175 43.10516807703469, 122.82574149610767 43.1051771189359), (122.82391562085917 43.10576969155067, 122.82396923678753 43.1057448842045, 122.8239886705174 43.10575185499724, 122.82396893717781 43.10576369499992, 122.82388236749871 43.10579491685526, 122.82390919364576 43.105782516071706, 122.82391154003591 43.10578118269815, 122.82391349232344 43.10577954336537, 122.82391497751046 43.10577765936964, 122.82391594006427 43.10577560115547, 122.82391634399418 43.105773445681535, 122.82391617419698 43.10577127354317, 122.82391562085917 43.10576969155067), (122.82411608965629 43.105718438904084, 122.82411960520741 43.105716791976164, 122.82421340069234 43.10568223574342, 122.82428828157339 43.10565946106376, 122.82411608965629 43.105718438904084), (122.82521791687202 43.10536094030644, 122.8252629786053 43.105346365362756, 122.82529822952648 43.10533592859432, 122.82521791687202 43.10536094030644), (122.82577074424029 43.10521314819633, 122.82571405249271 43.10523891715341, 122.82556809740943 43.105281612805875, 122.8252728602594 43.10537168687206, 122.82495691181451 43.105472670391165, 122.82462496353368 43.10557665418699, 122.82446042273449 43.10562983271996, 122.82418633495594 43.105725024983556, 122.82418321522594 43.105720287612094, 122.8243643842497 43.10565823357027, 122.82464515841536 43.10556630750607, 122.82490605153716 43.1054843410822, 122.82503512149542 43.105442319355845, 122.8253849333696 43.10533337794051, 122.82566585973521 43.105248400211934, 122.82566674857927 43.105248106812574, 122.82571939666643 43.105229232969435, 122.82577074424029 43.10521314819633), (122.82419968198205 43.10574529269623, 122.82447338826383 43.10565023292213, 122.82463711689026 43.105597320620426, 122.82496903651415 43.10549334579542, 122.82528502157064 43.10539235089801, 122.82557979832913 43.10530241900318, 122.82572669346007 43.10525944967802, 122.82572909494436 43.1052585612857, 122.8257317263491 43.105257365194575, 122.82572994515378 43.10525849586402, 122.82572791923629 43.105260054217254, 122.82572633533017 43.10526186670311, 122.82572525138745 43.105263867006265, 122.82572470706766 43.10526598193958, 122.82572472228627 43.10526813412176, 122.82572529648664 43.10527024480867, 122.82572547328824 43.10527056147052, 122.82551107040689 43.105334621064664, 122.82503507047336 43.105480621040385, 122.8247348612186 43.10558068503951, 122.8245646261384 43.105632763404735, 122.82421501897659 43.10574963208168, 122.82420451582979 43.10575263298212, 122.82419968198205 43.10574529269623), (122.82584050073396 43.10523623141431, 122.8258341611225 43.10523743896241, 122.82583375128843 43.10523587379418, 122.82583270862419 43.105233232382915, 122.82583281253511 43.10523323586286, 122.82583580154034 43.1052329013852, 122.82583864315313 43.10523214424181, 122.82584122719925 43.10523099378848, 122.82584345349058 43.1052294946303, 122.82584406460394 43.1052288809389, 122.82584050073396 43.10523623141431), (122.82422079603863 43.10577735476156, 122.82421790300396 43.105772961639836, 122.82422657878544 43.105770482843766, 122.82422737381735 43.1057702366141, 122.82426511048943 43.10575762185641, 122.82422659976399 43.105773141095554, 122.82422405275862 43.105774428142574, 122.82422190956322 43.10577606316581, 122.82422079603863 43.10577735476156), (122.82431577842102 43.10574068436055, 122.82447532520382 43.10568735016213, 122.82440448245586 43.105719717944346, 122.82431577842102 43.10574068436055), (122.82575979426443 43.105306524045126, 122.82576044717968 43.10530859108489, 122.8257616711851 43.105310587323885, 122.82576339942786 43.10531237219103, 122.82576556652754 43.10531387816368, 122.82576809050133 43.105315048269944, 122.8257682621689 43.105315096957625, 122.82547925271356 43.10540056614972, 122.82516498231625 43.1054986483162, 122.8248890461031 43.10558662760658, 122.82480472844114 43.1056117295372, 122.82442999977205 43.10573457897948, 122.82453418033431 43.105686979228985, 122.82466710366023 43.10564432472685, 122.82538689898247 43.10541838896697, 122.82565374981218 43.10533943310133, 122.82575979426443 43.105306524045126), (122.82439990517666 43.10574444498803, 122.82432154945823 43.10577013254453, 122.82429851814202 43.105772896302284, 122.82429553033779 43.10577348632805, 122.82429276463903 43.10577450328035, 122.82429103087505 43.105775503470284, 122.82428719035103 43.10577440617795, 122.82430711278154 43.1057663777292, 122.82439990517666 43.10574444498803), (122.82490616358461 43.10458664945073, 122.82496753018368 43.10456023850105, 122.82504694866788 43.10453943842227, 122.82502031746726 43.10454886967917, 122.8250194771727 43.104549191092936, 122.82496957023618 43.10456974100739, 122.82490616358461 43.10458664945073), (122.82149240909614 43.10563236360795, 122.82146689832034 43.105639384910354, 122.82144374002728 43.10564496772395, 122.82149240909614 43.10563236360795), (122.82126738844627 43.105689122807995, 122.82127252153627 43.105686387967886, 122.82127136990997 43.105688061085864, 122.82126738844627 43.105689122807995), (122.8212453066356 43.10571691867875, 122.82124824214654 43.10571723791205, 122.8212512426713 43.10571713098235, 122.82125137775468 43.105717106284004, 122.8212483320438 43.10572153118072, 122.8212453066356 43.10571691867875)))</textarea>
            <div class="coord-settings" style="margin-bottom:8px;font-size:12px;color:#333;">
                <label>WKT坐标系：
                    <select id="coordSysSelect" style="margin-left:6px;">
                        <option value="wgs84" selected>WGS84</option>
                        <option value="gcj02">GCJ-02（国测局）</option>
                        <option value="bd09">BD-09（百度）</option>
                        <option value="cgcs2000">CGCS2000</option>
                    </select>
                </label>
                <!-- 已移除“不进行绘制坐标转换”选项，统一使用WGS84绘制 -->
            </div>

            <div class="button-group">
                <button id="drawButton" disabled>绘制轮廓</button>
                <button id="clearButton" disabled>清空轮廓</button>
            </div>
            <!-- 显示开关：仅保留显示亩数 -->
            <div class="display-toggles" style="margin-top:8px;font-size:12px;color:#333;">
                <label><input type="checkbox" id="toggleLabelsCheckbox"> 显示亩数</label>
            </div>
        </div>

        <div class="tab-pane" id="tabSplit">
            <!-- MultiPolygon → 多个 Polygon 分割器 -->
            <div class="split-section">
                <div class="title">MultiPolygon → 多个 Polygon 分割器</div>
                <div class="desc">输入一个 MULTIPOLYGON WKT，分割为多行 POLYGON WKT。</div>
                <textarea id="multiInput"></textarea>
                <div class="split-actions">
                    <button id="splitMultiBtn">分割为多个 POLYGON</button>
                    <button id="copyPolysBtn">复制结果</button>
                </div>
                <textarea id="polyOutput" readonly></textarea>
            </div>
        </div>

        <div class="tab-pane" id="tabBatch">
            <!-- 批量POLYGON → MULTIPOLYGON 生成器 -->
            <div class="batch-section">
                <div class="title">批量POLYGON → MULTIPOLYGON 合并器</div>
                <div class="desc">每行一个 POLYGON WKT（或用分号分隔）。生成后可一键填充到上方并绘制。</div>
                <textarea id="batchInput"></textarea>
                <div class="batch-actions">
                    <button id="generateMultiBtn">生成 MULTIPOLYGON</button>
                    <button id="copyMultiBtn">复制结果</button>
                </div>
                <textarea id="multiOutput" readonly></textarea>
            </div>
        </div>
        <div class="tab-pane" id="tabTrack">
            <div class="tip">请粘贴轨迹文本（支持两种格式：1）每行一条：定位时间yyyyMMddHHmmss, 经度, 纬度；2）单行#分隔：经度,纬度,定位时间yyyyMMddHHmmss#经度,纬度,定位时间yyyyMMddHHmmss#…）。</div>
            <div class="coord-settings" style="margin-bottom:8px;font-size:12px;color:#333;">
                <label>轨迹坐标系：
                    <select id="trackCoordSysSelect" style="margin-left:6px;">
                        <option value="wgs84" selected>WGS84</option>
                        <option value="gcj02">GCJ-02（国测局）</option>
                        <option value="bd09">BD-09（百度）</option>
                        <option value="cgcs2000">CGCS2000</option>
                    </select>
                </label>
            </div>
            <textarea id="trackTextarea" style="width:100%;height:120px;margin-bottom:10px;padding:8px;border:1px solid #ddd;border-radius:4px;font-family:monospace;resize:vertical;box-sizing:border-box;">20250915075504,122.807561,43.088081
20250915075514,122.807579,43.087975
20250915075524,122.807604,43.087860
20250915075534,122.807620,43.087731
20250915075544,122.807581,43.087636
20250915075554,122.807574,43.087630
20250915075604,122.807574,43.087630
20250915075614,122.807574,43.087630
20250915075624,122.807574,43.087630
20250915075634,122.807574,43.087630
20250915075644,122.807632,43.087639
20250915075654,122.807657,43.087618
20250915075704,122.807709,43.087564
20250915075714,122.807715,43.087555
20250915075724,122.807715,43.087554
20250915075734,122.807960,43.087458
20250915075744,122.808843,43.087395
20250915075754,122.809200,43.087283
20250915075804,122.809166,43.087135
20250915075814,122.809093,43.086943
20250915075824,122.809023,43.086676
20250915075834,122.808938,43.086446
20250915075844,122.808880,43.086288
20250915075854,122.808813,43.086079
20250915075904,122.808750,43.085872
20250915075914,122.808689,43.085666
20250915075924,122.808619,43.085453
20250915075934,122.808533,43.085208
20250915075944,122.808448,43.084934
20250915075954,122.808350,43.084649
20250915080004,122.808265,43.084394
20250915080014,122.808185,43.084124
20250915080024,122.808090,43.083830
20250915080034,122.807998,43.083538
20250915080044,122.807902,43.083246
20250915080054,122.807814,43.082947
20250915080104,122.807719,43.082649
20250915080114,122.807620,43.082352
20250915080124,122.807531,43.082054
20250915080134,122.807435,43.081758
20250915080144,122.807339,43.081463
20250915080154,122.807298,43.081187
20250915080204,122.807517,43.081043
20250915080214,122.807855,43.080960
20250915080224,122.808229,43.080865
20250915080234,122.808592,43.080745
20250915080244,122.808916,43.080641
20250915080254,122.809184,43.080545
20250915080304,122.809381,43.080480
20250915080314,122.809694,43.080389
20250915080324,122.809928,43.080329
20250915080334,122.810208,43.080242
20250915080344,122.810538,43.080148
20250915080354,122.810852,43.080051
20250915080404,122.811142,43.079979
20250915080414,122.811393,43.079937
20250915080424,122.811658,43.079860
20250915080434,122.811892,43.079792
20250915080444,122.812142,43.079711
20250915080454,122.812436,43.079637
20250915080504,122.812587,43.079605
20250915080514,122.812753,43.079552
20250915080524,122.812806,43.079517
20250915080534,122.812870,43.079455
20250915080544,122.812959,43.079353
20250915080554,122.812993,43.079324
20250915080604,122.812994,43.079324
20250915080614,122.812994,43.079324
20250915080624,122.812994,43.079324
20250915080634,122.813043,43.079286
20250915080644,122.813183,43.079166
20250915080654,122.813297,43.079071
20250915080704,122.813414,43.078953
20250915080714,122.813508,43.078848
20250915080724,122.813603,43.078733
20250915080734,122.813701,43.078611
20250915080744,122.813815,43.078479
20250915080754,122.813935,43.078343
20250915080804,122.814053,43.078228
20250915080814,122.814127,43.078132
20250915080824,122.814206,43.078043
20250915080834,122.814306,43.077918
20250915080844,122.814404,43.077806
20250915080854,122.814532,43.077657
20250915080904,122.814686,43.077519
20250915080914,122.814847,43.077359
20250915080924,122.815026,43.077168
20250915080934,122.815178,43.076986
20250915080944,122.815364,43.076813
20250915080954,122.815610,43.076661
20250915081004,122.815863,43.076578
20250915081014,122.815976,43.076546
20250915081024,122.815978,43.076545
20250915081034,122.816020,43.076536
20250915081044,122.816082,43.076522
20250915081054,122.816082,43.076522
20250915081104,122.816082,43.076522
20250915081114,122.816082,43.076522
20250915081124,122.816082,43.076522
20250915081134,122.816178,43.076497
20250915081144,122.816178,43.076497
20250915081154,122.816178,43.076497
20250915081204,122.816178,43.076497
20250915081214,122.816178,43.076497
20250915081224,122.816178,43.076497
20250915081234,122.816178,43.076497
20250915081244,122.816178,43.076497
20250915081254,122.816178,43.076497
20250915081304,122.816181,43.076496
20250915081314,122.816242,43.076467
20250915081324,122.816250,43.076445
20250915081334,122.816252,43.076388
20250915081344,122.816248,43.076303
20250915081354,122.816248,43.076303
20250915081404,122.816248,43.076303
20250915081414,122.816248,43.076303
20250915081424,122.816248,43.076303
20250915081434,122.816248,43.076303
20250915081444,122.816248,43.076303
20250915081454,122.816249,43.076286
20250915081504,122.816249,43.076244
20250915081514,122.816250,43.076188
20250915081524,122.816247,43.076141
20250915081534,122.816247,43.076094
20250915081544,122.816246,43.076028
20250915081554,122.816244,43.075954
20250915081604,122.816242,43.075875
20250915081614,122.816243,43.075793
20250915081624,122.816246,43.075703
20250915081634,122.816244,43.075612
20250915081644,122.816245,43.075524
20250915081654,122.816241,43.075434
20250915081704,122.816239,43.075339
20250915081714,122.816241,43.075234
20250915081724,122.816244,43.075136
20250915081734,122.816244,43.075042
20250915081744,122.816243,43.074943
20250915081754,122.816245,43.074843
20250915081804,122.816243,43.074746
20250915081814,122.816244,43.074647
20250915081824,122.816245,43.074543
20250915081834,122.816250,43.074437
20250915081844,122.816252,43.074334
20250915081854,122.816254,43.074236
20250915081904,122.816257,43.074144
20250915081914,122.816255,43.074048
20250915081924,122.816251,43.073936
20250915081934,122.816253,43.073837
20250915081944,122.816255,43.073730
20250915081954,122.816256,43.073605
20250915082004,122.816259,43.073549
20250915082014,122.816250,43.073677
20250915082024,122.816273,43.073652
20250915082034,122.816292,43.073572
20250915082044,122.816294,43.073506
20250915082054,122.816269,43.073557
20250915082104,122.816288,43.073505
20250915082114,122.816271,43.073523
20250915082124,122.816288,43.073602
20250915082134,122.816288,43.073620
20250915082144,122.816289,43.073620
20250915082154,122.816288,43.073622
20250915082204,122.816287,43.073706
20250915082214,122.816284,43.073806
20250915082224,122.816281,43.073904
20250915082234,122.816282,43.074007
20250915082244,122.816266,43.073958
20250915082254,122.816268,43.074053
20250915082304,122.816284,43.074141
20250915082314,122.816283,43.074224
20250915082324,122.816282,43.074329
20250915082334,122.816278,43.074423
20250915082344,122.816276,43.074525
20250915082354,122.816273,43.074619
20250915082404,122.816273,43.074712
20250915082414,122.816273,43.074841
20250915082424,122.816273,43.074988
20250915082434,122.816271,43.075129
20250915082444,122.816269,43.075266
20250915082454,122.816269,43.075330
20250915082504,122.816270,43.075457
20250915082514,122.816272,43.075585
20250915082524,122.816273,43.075706
20250915082534,122.816271,43.075824
20250915082544,122.816273,43.075947
20250915082554,122.816274,43.076067
20250915082604,122.816276,43.076185
20250915082614,122.816278,43.076291
20250915082624,122.816281,43.076412
20250915082634,122.816283,43.076433
20250915082644,122.816283,43.076433
20250915082654,122.816283,43.076433
20250915082704,122.816283,43.076433
20250915082714,122.816283,43.076433
20250915082724,122.816283,43.076433
20250915082734,122.816283,43.076433
20250915082744,122.816283,43.076433
20250915082754,122.816283,43.076433
20250915082804,122.816283,43.076433
20250915082814,122.816283,43.076433
20250915082824,122.816283,43.076433
20250915082834,122.816283,43.076433
20250915082844,122.816283,43.076433
20250915082854,122.816283,43.076433
20250915082904,122.816283,43.076433
20250915082914,122.816283,43.076433
20250915082924,122.816283,43.076433
20250915082934,122.816283,43.076433
20250915082944,122.816283,43.076433
20250915082954,122.816283,43.076433
20250915083004,122.816283,43.076433
20250915083014,122.816283,43.076433
20250915083024,122.816283,43.076433
20250915083034,122.816283,43.076433
20250915083044,122.816283,43.076433
20250915083054,122.816283,43.076433
20250915083104,122.816283,43.076433
20250915083114,122.816283,43.076433
20250915083124,122.816283,43.076433
20250915083134,122.816283,43.076433
20250915083144,122.816283,43.076433
20250915083154,122.816283,43.076433
20250915083204,122.816282,43.076421
20250915083214,122.816281,43.076314
20250915083224,122.816315,43.076414
20250915083234,122.816269,43.076377
20250915083244,122.816324,43.076458
20250915083254,122.816292,43.076461
20250915083304,122.816324,43.076393
20250915083314,122.816323,43.076361
20250915083324,122.816323,43.076361
20250915083334,122.816323,43.076361
20250915083344,122.816322,43.076323
20250915083354,122.816322,43.076305
20250915083404,122.816321,43.076185
20250915083414,122.816320,43.076035
20250915083424,122.816319,43.075885
20250915083434,122.816317,43.075725
20250915083444,122.816316,43.075567
20250915083454,122.816314,43.075424
20250915083504,122.816314,43.075276
20250915083514,122.816315,43.075127
20250915083524,122.816317,43.074984
20250915083534,122.816316,43.074834
20250915083544,122.816317,43.074696
20250915083554,122.816318,43.074559
20250915083604,122.816320,43.074419
20250915083614,122.816324,43.074284
20250915083624,122.816329,43.074148
20250915083634,122.816332,43.074035
20250915083644,122.816325,43.073894
20250915083654,122.816328,43.073754
20250915083704,122.816325,43.073607
20250915083714,122.816320,43.073587
20250915083724,122.816342,43.073563
20250915083734,122.816331,43.073577
20250915083744,122.816271,43.073549
20250915083754,122.816277,43.073523
20250915083804,122.816317,43.073537
20250915083814,122.816335,43.073593
20250915083824,122.816339,43.073672
20250915083834,122.816340,43.073688
20250915083844,122.816340,43.073688
20250915083854,122.816340,43.073688
20250915083904,122.816340,43.073688
20250915083914,122.816336,43.073741
20250915083924,122.816336,43.073832
20250915083934,122.816336,43.073940
20250915083944,122.816339,43.074062
20250915083954,122.816337,43.074182
20250915084004,122.816334,43.074296
20250915084014,122.816331,43.074409
20250915084024,122.816327,43.074514
20250915084034,122.816327,43.074617
20250915084044,122.816328,43.074725
20250915084054,122.816324,43.074835
20250915084103,122.816324,43.074934
20250915084113,122.816325,43.075033
20250915084123,122.816328,43.075134
20250915084133,122.816327,43.075224
20250915084143,122.816327,43.075352
20250915084153,122.816325,43.075476
20250915084203,122.816328,43.075591
20250915084213,122.816328,43.075697
20250915084223,122.816328,43.075803
20250915084233,122.816328,43.075909
20250915084243,122.816332,43.076015
20250915084253,122.816333,43.076133
20250915084303,122.816334,43.076251
20250915084313,122.816332,43.076364
20250915084323,122.816333,43.076420
20250915084333,122.816327,43.076378
20250915084343,122.816328,43.076415
20250915084353,122.816328,43.076418
20250915084403,122.816328,43.076418
20250915084413,122.816328,43.076418
20250915084423,122.816328,43.076418
20250915084433,122.816328,43.076418
20250915084443,122.816328,43.076418
20250915084453,122.816328,43.076418
20250915084503,122.816328,43.076418
20250915084513,122.816328,43.076418
20250915084523,122.816328,43.076418
20250915084533,122.816328,43.076418
20250915084543,122.816328,43.076418
20250915084553,122.816328,43.076418
20250915084603,122.816328,43.076418
20250915084613,122.816328,43.076418
20250915084623,122.816328,43.076418
20250915084633,122.816328,43.076418
20250915084643,122.816328,43.076418
20250915084653,122.816328,43.076418
20250915084703,122.816328,43.076418
20250915084713,122.816328,43.076418
20250915084723,122.816328,43.076418
20250915084733,122.816328,43.076418
20250915084743,122.816328,43.076422
20250915085101,122.816315,43.076389
20250915085111,122.816286,43.076451
20250915085121,122.816094,43.076515
20250915085131,122.815893,43.076564
20250915085141,122.815774,43.076601
20250915085151,122.815771,43.076602
20250915085201,122.815771,43.076602
20250915085211,122.815771,43.076602
20250915085221,122.815771,43.076602
20250915085231,122.815771,43.076602
20250915085241,122.815771,43.076602
20250915085251,122.815771,43.076602
20250915085301,122.815771,43.076602
20250915085311,122.815771,43.076602
20250915085321,122.815771,43.076602
20250915085331,122.815771,43.076602
20250915085341,122.815771,43.076602
20250915085351,122.815771,43.076602
20250915085401,122.815771,43.076602
20250915085411,122.815771,43.076602
20250915085421,122.815771,43.076602
20250915085431,122.815771,43.076602
20250915085441,122.815771,43.076602
20250915085451,122.815771,43.076602
20250915085501,122.815771,43.076602
20250915085511,122.815687,43.076628
20250915085521,122.815437,43.076751
20250915085531,122.815232,43.076922
20250915085541,122.815067,43.077115
20250915085551,122.814940,43.077245
20250915085601,122.814798,43.077406
20250915085611,122.814623,43.077565
20250915085621,122.814498,43.077685
20250915085631,122.814394,43.077810
20250915085641,122.814287,43.077929
20250915085651,122.814186,43.078055
20250915085701,122.814096,43.078170
20250915085711,122.813980,43.078287
20250915085721,122.813882,43.078391
20250915085731,122.813796,43.078492
20250915085741,122.813689,43.078615
20250915085751,122.813583,43.078747
20250915085801,122.813491,43.078859
20250915085811,122.813403,43.078960
20250915085821,122.813307,43.079052
20250915085831,122.813233,43.079127
20250915085841,122.813231,43.079130
20250915085851,122.813152,43.079191
20250915085901,122.812989,43.079321
20250915085911,122.812872,43.079444
20250915085921,122.812778,43.079530
20250915085931,122.812631,43.079588
20250915085941,122.812349,43.079652
20250915085951,122.812035,43.079738
20250915090001,122.811758,43.079825
20250915090011,122.811500,43.079900
20250915090021,122.811240,43.079955
20250915090031,122.810964,43.080015
20250915090041,122.810666,43.080094
20250915090051,122.810354,43.080194
20250915090101,122.810032,43.080287
20250915090111,122.809744,43.080370
20250915090121,122.809391,43.080472
20250915090131,122.809065,43.080588
20250915090141,122.808771,43.080690
20250915090151,122.808429,43.080791
20250915090201,122.808075,43.080900
20250915090211,122.807705,43.080997
20250915090221,122.807351,43.081111
20250915090231,122.807306,43.081396
20250915090241,122.807404,43.081690
20250915090251,122.807503,43.081990
20250915090301,122.807599,43.082291
20250915090311,122.807692,43.082591
20250915090321,122.807791,43.082890
20250915090331,122.807880,43.083186
20250915090341,122.807972,43.083475
20250915090351,122.808069,43.083776
20250915090401,122.808165,43.084075
20250915090411,122.808253,43.084378
20250915090421,122.808344,43.084655
20250915090431,122.808432,43.084901
20250915090441,122.808525,43.085201
20250915090451,122.808628,43.085498
20250915090501,122.808717,43.085779
20250915090511,122.808787,43.086016
20250915090521,122.808873,43.086285
20250915090531,122.808959,43.086507
20250915090541,122.809055,43.086794
20250915090551,122.809116,43.087040
20250915090601,122.809196,43.087242
20250915090611,122.809235,43.087328
20250915090621,122.809235,43.087327
20250915090631,122.809254,43.087366
20250915090641,122.809323,43.087575
20250915090651,122.809386,43.087770
20250915090701,122.809465,43.088039
20250915090711,122.809605,43.088243
20250915090721,122.810014,43.088198
20250915090731,122.810433,43.088161
20250915090741,122.810854,43.088121
20250915090751,122.811277,43.088088
20250915090801,122.811668,43.088051
20250915090811,122.811875,43.088038
20250915090821,122.811930,43.088066
20250915090831,122.811930,43.088065
20250915090841,122.811932,43.088072
20250915090852,122.811910,43.088005
20250915090901,122.811954,43.088200
20250915090911,122.812052,43.088466
20250915090921,122.812157,43.088762
20250915090931,122.812254,43.089063
20250915090941,122.812367,43.089361
20250915090952,122.812459,43.089591
20250915091001,122.812494,43.089681
20250915091011,122.812532,43.089755
20250915091021,122.812599,43.089888
20250915091031,122.812696,43.090081
20250915091041,122.812890,43.090326
20250915091051,122.813202,43.090460
20250915091101,122.813366,43.090530
20250915091111,122.813604,43.090604
20250915091121,122.813838,43.090757
20250915091131,122.813965,43.090973
20250915091141,122.813995,43.091037
20250915091151,122.814043,43.091130
20250915091202,122.814067,43.091178
20250915091212,122.814091,43.091232
20250915091222,122.814143,43.091341
20250915091232,122.814242,43.091525
20250915091242,122.814258,43.091558
20250915091251,122.814313,43.091660
20250915091301,122.814459,43.091948
20250915091311,122.814598,43.092241
20250915091321,122.814753,43.092520
20250915091331,122.814787,43.092610
20250915091341,122.814910,43.092883
20250915091351,122.815066,43.093166
20250915091401,122.815317,43.093371
20250915091411,122.815402,43.093408
20250915091421,122.815611,43.093512
20250915091431,122.815967,43.093679
20250915091441,122.816303,43.093863
20250915091451,122.816571,43.094048
20250915091501,122.816753,43.094171
20250915091511,122.817370,43.094448
20250915091521,122.817903,43.094697
20250915091531,122.818501,43.094889
20250915091541,122.818799,43.095083
20250915091551,122.819108,43.095388
20250915091601,122.819461,43.095658
20250915091611,122.819659,43.095810
20250915091621,122.819970,43.096012
20250915091631,122.820191,43.096243
20250915091641,122.820483,43.096469
20250915091651,122.820700,43.096710
20250915091701,122.820903,43.096924
20250915091711,122.821120,43.097157
20250915091721,122.821336,43.097416
20250915091731,122.821580,43.097680
20250915091741,122.821903,43.097896
20250915091751,122.822167,43.098161
20250915091801,122.822312,43.098427
20250915091811,122.822422,43.098677
20250915091821,122.822548,43.098924
20250915091831,122.822811,43.099246
20250915091841,122.823070,43.099543
20250915091851,122.823231,43.099757
20250915091901,122.823392,43.099977
20250915091911,122.823581,43.100192
20250915091921,122.823781,43.100442
20250915091931,122.823979,43.100711
20250915091941,122.824186,43.100945
20250915091951,122.824403,43.101155
20250915092001,122.824587,43.101394
20250915092011,122.824627,43.101597
20250915092021,122.824698,43.101823
20250915092031,122.824841,43.102080
20250915092041,122.824948,43.102389
20250915092051,122.825012,43.102662
20250915092101,122.825047,43.102824
20250915092111,122.825090,43.102993
20250915092121,122.825098,43.103171
20250915092131,122.825073,43.103360
20250915092141,122.825070,43.103551
20250915092151,122.825072,43.103723
20250915092201,122.825096,43.103910
20250915092211,122.825148,43.104048
20250915092221,122.825198,43.104152
20250915092231,122.825252,43.104257
20250915092241,122.825304,43.104349
20250915092251,122.825305,43.104352
20250915092301,122.825305,43.104352
20250915092311,122.825305,43.104352
20250915092321,122.825305,43.104352
20250915092331,122.825305,43.104352
20250915092341,122.825305,43.104352
20250915092351,122.825305,43.104352
20250915092401,122.825305,43.104352
20250915092411,122.825305,43.104352
20250915092421,122.825316,43.104385
20250915092431,122.825336,43.104438
20250915092441,122.825336,43.104435
20250915092451,122.825314,43.104375
20250915092501,122.825313,43.104418
20250915092511,122.825316,43.104469
20250915092521,122.825314,43.104408
20250915092531,122.825318,43.104462
20250915092541,122.825292,43.104468
20250915092551,122.825216,43.104494
20250915092601,122.825210,43.104496
20250915092611,122.825210,43.104496
20250915092621,122.825210,43.104496
20250915092631,122.825210,43.104496
20250915092641,122.825210,43.104496
20250915092651,122.825210,43.104496
20250915092701,122.825210,43.104496
20250915092711,122.825210,43.104496
20250915092721,122.825210,43.104496
20250915092731,122.825210,43.104496
20250915092741,122.825210,43.104496
20250915092751,122.825210,43.104496
20250915092801,122.825210,43.104496
20250915092811,122.825210,43.104496
20250915092821,122.825210,43.104496
20250915092831,122.825191,43.104502
20250915092841,122.825123,43.104525
20250915092851,122.825027,43.104559
20250915092901,122.824976,43.104580
20250915092911,122.824901,43.104600
20250915092921,122.824809,43.104629
20250915092931,122.824709,43.104661
20250915092941,122.824614,43.104692
20250915092951,122.824508,43.104726
20250915093001,122.824382,43.104763
20250915093011,122.824266,43.104798
20250915093021,122.824154,43.104832
20250915093031,122.824040,43.104868
20250915093041,122.823925,43.104906
20250915093051,122.823842,43.104927
20250915093101,122.823771,43.104956
20250915093111,122.823751,43.104964
20250915093121,122.823751,43.104964
20250915093131,122.823716,43.104975
20250915093141,122.823609,43.105011
20250915093151,122.823487,43.105050
20250915093201,122.823361,43.105090
20250915093211,122.823241,43.105129
20250915093221,122.823138,43.105162
20250915093231,122.823030,43.105195
20250915093241,122.822915,43.105231
20250915093251,122.822784,43.105272
20250915093301,122.822728,43.105288
20250915093311,122.822615,43.105325
20250915093321,122.822482,43.105364
20250915093331,122.822357,43.105400
20250915093341,122.822234,43.105435
20250915093351,122.822108,43.105472
20250915093401,122.822018,43.105487
20250915093411,122.821941,43.105510
20250915093421,122.821822,43.105550
20250915093431,122.821674,43.105593
20250915093441,122.821581,43.105620
20250915093451,122.821472,43.105650
20250915093501,122.821360,43.105677
20250915093511,122.821249,43.105706
20250915093521,122.821369,43.105674
20250915093531,122.821317,43.105673
20250915093541,122.821202,43.105671
20250915093551,122.821187,43.105654
20250915093601,122.821248,43.105747
20250915093611,122.821301,43.105670
20250915093621,122.821347,43.105658
20250915093631,122.821348,43.105658
20250915093641,122.821349,43.105658
20250915093651,122.821353,43.105657
20250915093701,122.821439,43.105635
20250915093711,122.821523,43.105612
20250915093721,122.821507,43.105617
20250915093731,122.821507,43.105617
20250915093741,122.821507,43.105617
20250915093751,122.821507,43.105617
20250915093801,122.821507,43.105617
20250915093811,122.821507,43.105617
20250915093821,122.821507,43.105617
20250915093831,122.821552,43.105605
20250915093841,122.821652,43.105577
20250915093851,122.821766,43.105545
20250915093901,122.821877,43.105515
20250915093911,122.821993,43.105482
20250915093921,122.822103,43.105451
20250915093931,122.822212,43.105419
20250915093941,122.822318,43.105389
20250915093951,122.822445,43.105351
20250915094001,122.822566,43.105316
20250915094011,122.822671,43.105283
20250915094021,122.822771,43.105252
20250915094031,122.822901,43.105212
20250915094041,122.823034,43.105171
20250915094051,122.823161,43.105132
20250915094101,122.823284,43.105092
20250915094111,122.823412,43.105052
20250915094121,122.823547,43.105009
20250915094131,122.823677,43.104966
20250915094141,122.823789,43.104930
20250915094151,122.823888,43.104895
20250915094201,122.824016,43.104855
20250915094211,122.824155,43.104810
20250915094221,122.824336,43.104754
20250915094231,122.824488,43.104708
20250915094241,122.824646,43.104661
20250915094251,122.824779,43.104616
20250915094301,122.824761,43.104622
20250915094311,122.824626,43.104675
20250915094321,122.824569,43.104687
20250915094331,122.824569,43.104687
20250915094341,122.824569,43.104687
20250915094351,122.824569,43.104687
20250915094401,122.824569,43.104687
20250915094411,122.824569,43.104687
20250915094421,122.824569,43.104687
20250915094431,122.824569,43.104687
20250915094441,122.824569,43.104687
20250915094451,122.824569,43.104687
20250915094501,122.824569,43.104687
20250915094511,122.824569,43.104687
20250915094521,122.824569,43.104687
20250915094531,122.824570,43.104687
20250915094541,122.824585,43.104683
20250915094551,122.824646,43.104662
20250915094601,122.824695,43.104644
20250915094611,122.824792,43.104611
20250915094621,122.824882,43.104584
20250915094631,122.824961,43.104550
20250915094641,122.825045,43.104528
20250915094651,122.825158,43.104490
20250915094701,122.825292,43.104448
20250915094711,122.825192,43.104478
20250915094721,122.825213,43.104470
20250915094731,122.825225,43.104454
20250915094741,122.825331,43.104391
20250915094751,122.825320,43.104433
20250915094801,122.825313,43.104426
20250915094811,122.825268,43.104427
20250915094821,122.825226,43.104436
20250915094831,122.825227,43.104436
20250915094841,122.825226,43.104436
20250915094851,122.825227,43.104436
20250915094901,122.825213,43.104440
20250915094911,122.825214,43.104439
20250915094921,122.825121,43.104467
20250915094931,122.824956,43.104521
20250915094941,122.824821,43.104567
20250915094951,122.824658,43.104620
20250915095001,122.824479,43.104676
20250915095011,122.824292,43.104732
20250915095021,122.824117,43.104786
20250915095031,122.823922,43.104849
20250915095041,122.823737,43.104911
20250915095051,122.823558,43.104970
20250915095101,122.823515,43.104984
20250915095111,122.823515,43.104984
20250915095121,122.823512,43.104985
20250915095131,122.823345,43.105037
20250915095141,122.823173,43.105094
20250915095151,122.822997,43.105147
20250915095201,122.822810,43.105204
20250915095211,122.822613,43.105266
20250915095220,122.822416,43.105324
20250915095230,122.822220,43.105382
20250915095240,122.822018,43.105441
20250915095250,122.821817,43.105497
20250915095300,122.821600,43.105557
20250915095310,122.821404,43.105609
20250915095320,122.821217,43.105657
20250915095330,122.821213,43.105655
20250915095340,122.821234,43.105693
20250915095350,122.821356,43.105628
20250915095400,122.821625,43.105552
20250915095410,122.821651,43.105546
20250915095420,122.821651,43.105545
20250915095430,122.821690,43.105537
20250915095440,122.821886,43.105478
20250915095450,122.822077,43.105422
20250915095500,122.822278,43.105366
20250915095510,122.822480,43.105307
20250915095520,122.822699,43.105239
20250915095530,122.822921,43.105172
20250915095540,122.823142,43.105105
20250915095550,122.823353,43.105035
20250915095600,122.823569,43.104967
20250915095610,122.823786,43.104895
20250915095620,122.824001,43.104824
20250915095630,122.824219,43.104756
20250915095640,122.824436,43.104690
20250915095650,122.824665,43.104617
20250915095700,122.824874,43.104550
20250915095710,122.825064,43.104487
20250915095720,122.825251,43.104426
20250915095730,122.825201,43.104443
20250915095740,122.825201,43.104443
20250915095750,122.825201,43.104443
20250915095800,122.825201,43.104443
20250915095810,122.825201,43.104443
20250915095820,122.825201,43.104443
20250915095830,122.825201,43.104443
20250915095840,122.825202,43.104443
20250915095850,122.825202,43.104443
20250915095900,122.825202,43.104443
20250915095910,122.825202,43.104442
20250915095920,122.825202,43.104442
20250915095930,122.825338,43.104435
20250915095940,122.825453,43.104551
20250915095950,122.825587,43.104693
20250915100000,122.825672,43.104829
20250915100010,122.825731,43.104975
20250915100020,122.825764,43.105067
20250915100030,122.825775,43.105090
20250915100040,122.825775,43.105090
20250915100050,122.825775,43.105090
20250915100100,122.825775,43.105090
20250915100110,122.825775,43.105090
20250915100120,122.825775,43.105090
20250915100130,122.825775,43.105090
20250915100140,122.825780,43.105101
20250915100150,122.825794,43.105162
20250915100200,122.825811,43.105202
20250915100210,122.825788,43.105163
20250915100220,122.825785,43.105199
20250915100230,122.825790,43.105145
20250915100240,122.825800,43.105196
20250915100250,122.825796,43.105193
20250915100300,122.825713,43.105219
20250915100310,122.825683,43.105230
20250915100320,122.825683,43.105230
20250915100330,122.825683,43.105230
20250915100340,122.825683,43.105230
20250915100350,122.825683,43.105230
20250915100400,122.825683,43.105230
20250915100410,122.825660,43.105238
20250915100420,122.825597,43.105257
20250915100430,122.825495,43.105288
20250915100440,122.825379,43.105323
20250915100450,122.825259,43.105360
20250915100500,122.825153,43.105394
20250915100510,122.825029,43.105432
20250915100520,122.824900,43.105474
20250915100530,122.824764,43.105517
20250915100540,122.824639,43.105556
20250915100550,122.824499,43.105602
20250915100600,122.824358,43.105648
20250915100610,122.824232,43.105691
20250915100620,122.824104,43.105735
20250915100630,122.824007,43.105756
20250915100640,122.824008,43.105756
20250915100650,122.824008,43.105756
20250915100700,122.824008,43.105756
20250915100710,122.824008,43.105756
20250915100720,122.824008,43.105756
20250915100730,122.824009,43.105756
20250915100740,122.824024,43.105752
20250915100750,122.823932,43.105719
20250915100800,122.823834,43.105729
20250915100810,122.823695,43.105789
20250915100820,122.823721,43.105798
20250915100830,122.823742,43.105824
20250915100840,122.823724,43.105795
20250915100850,122.823867,43.105813
20250915100900,122.823989,43.105769
20250915100910,122.823976,43.105774
20250915100920,122.824001,43.105759
20250915100930,122.824112,43.105707
20250915100940,122.824207,43.105672
20250915100950,122.824295,43.105646
20250915101000,122.824378,43.105620
20250915101010,122.824499,43.105580
20250915101020,122.824612,43.105541
20250915101030,122.824758,43.105496
20250915101040,122.824920,43.105445
20250915101050,122.825089,43.105391
20250915101100,122.825257,43.105336
20250915101110,122.825425,43.105287
20250915101120,122.825588,43.105238
20250915101130,122.825749,43.105187
20250915101140,122.825712,43.105200
20250915101150,122.825607,43.105234
20250915101200,122.825701,43.105201
20250915101210,122.825838,43.105162
20250915101220,122.826000,43.105112
20250915101230,122.826022,43.105105
20250915101240,122.825923,43.105138
20250915101250,122.825808,43.105172
20250915101300,122.825861,43.105130
20250915101310,122.826028,43.105076
20250915101320,122.825949,43.105100
20250915101330,122.825856,43.105129
20250915101340,122.825810,43.105153
20250915101350,122.825914,43.105082
20250915101400,122.826047,43.105041
20250915101410,122.825984,43.105053
20250915101420,122.825983,43.105064
20250915101430,122.825975,43.105074
20250915101440,122.825979,43.105084
20250915101450,122.825850,43.105123
20250915101500,122.825766,43.105145
20250915101510,122.825762,43.105147
20250915101520,122.825761,43.105147
20250915101530,122.825762,43.105147
20250915101540,122.825762,43.105147
20250915101550,122.825762,43.105147
20250915101600,122.825761,43.105147
20250915101610,122.825761,43.105147
20250915101620,122.825761,43.105147
20250915101630,122.825761,43.105147
20250915101640,122.825761,43.105147
20250915101650,122.825761,43.105147
20250915101700,122.825761,43.105147
20250915101710,122.825761,43.105147
20250915101720,122.825761,43.105147
20250915101730,122.825760,43.105148
20250915101740,122.825760,43.105148
20250915101750,122.825724,43.105157
20250915101800,122.825593,43.105201
20250915101810,122.825433,43.105250
20250915101820,122.825276,43.105296
20250915101830,122.825106,43.105349
20250915101840,122.824932,43.105405
20250915101850,122.824777,43.105455
20250915101900,122.824601,43.105510
20250915101910,122.824411,43.105574
20250915101920,122.824222,43.105635
20250915101930,122.824031,43.105703
20250915101940,122.823897,43.105765
20250915101950,122.823780,43.105803
20250915102000,122.823901,43.105773
20250915102010,122.823795,43.105822
20250915102020,122.823697,43.105787
20250915102030,122.823746,43.105796
20250915102040,122.823874,43.105754
20250915102050,122.823875,43.105754
20250915102100,122.823977,43.105701
20250915102110,122.824094,43.105658
20250915102120,122.824219,43.105613
20250915102130,122.824375,43.105564
20250915102140,122.824555,43.105501
20250915102150,122.824743,43.105442
20250915102200,122.824923,43.105385
20250915102210,122.825111,43.105326
20250915102220,122.825298,43.105266
20250915102230,122.825475,43.105214
20250915102240,122.825643,43.105164
20250915102250,122.825813,43.105112
20250915102300,122.825719,43.105141
20250915102310,122.825719,43.105141
20250915102320,122.825719,43.105141
20250915102330,122.825719,43.105141
20250915102340,122.825719,43.105141
20250915102350,122.825719,43.105141
20250915102400,122.825719,43.105141
20250915102410,122.825719,43.105141
20250915102420,122.825719,43.105141
20250915102430,122.825719,43.105141
20250915102440,122.825719,43.105141
20250915102450,122.825719,43.105141
20250915102500,122.825719,43.105142
20250915102510,122.825676,43.105157
20250915102520,122.825722,43.105149
20250915102530,122.825832,43.105222
20250915102540,122.825820,43.105204
20250915102550,122.825721,43.105249
20250915102600,122.825574,43.105292
20250915102610,122.825429,43.105336
20250915102620,122.825279,43.105382
20250915102630,122.825118,43.105433
20250915102640,122.824963,43.105483
20250915102650,122.824796,43.105535
20250915102700,122.824631,43.105587
20250915102710,122.824467,43.105640
20250915102720,122.824307,43.105695
20250915102730,122.824133,43.105756
20250915102740,122.824164,43.105717
20250915102750,122.824218,43.105799
20250915102800,122.824161,43.105773
20250915102810,122.824186,43.105770
20250915102820,122.824221,43.105760
20250915102830,122.824328,43.105724
20250915102840,122.824432,43.105689
20250915102850,122.824571,43.105643
20250915102900,122.824741,43.105591
20250915102910,122.824896,43.105540
20250915102920,122.825041,43.105491
20250915102930,122.825189,43.105446
20250915102940,122.825349,43.105397
20250915102950,122.825517,43.105345
20250915103000,122.825693,43.105293
20250915103010,122.825845,43.105247
20250915103020,122.825740,43.105267
20250915103030,122.825855,43.105194
20250915103040,122.825952,43.105156
20250915103050,122.825974,43.105150
20250915103100,122.825796,43.105222
20250915103110,122.825905,43.105200
20250915103120,122.826046,43.105156
20250915103130,122.825870,43.105209
20250915103140,122.825854,43.105242
20250915103150,122.825976,43.105207
20250915103200,122.826075,43.105178
20250915103210,122.825946,43.105196
20250915103220,122.825898,43.105220
20250915103230,122.825841,43.105266
20250915103240,122.825780,43.105287
20250915103250,122.825780,43.105287
20250915103300,122.825780,43.105287
20250915103310,122.825780,43.105287
20250915103320,122.825780,43.105287
20250915103330,122.825780,43.105287
20250915103340,122.825780,43.105287
20250915103350,122.825780,43.105287
20250915103400,122.825780,43.105287
20250915103410,122.825780,43.105287
20250915103420,122.825781,43.105287
20250915103430,122.825781,43.105287
20250915103440,122.825780,43.105287
20250915103450,122.825793,43.105284
20250915103500,122.825793,43.105284
20250915103510,122.825792,43.105284
20250915103520,122.825792,43.105284
20250915103530,122.825792,43.105284
20250915103540,122.825773,43.105290
20250915103550,122.825648,43.105329
20250915103600,122.825517,43.105367
20250915103610,122.825381,43.105408
20250915103620,122.825229,43.105455
20250915103630,122.825070,43.105505
20250915103640,122.824925,43.105552
20250915103650,122.824780,43.105596
20250915103700,122.824661,43.105634
20250915103710,122.824527,43.105677
20250915103720,122.824411,43.105730
20250915103730,122.824301,43.105756
20250915103740,122.824234,43.105783
20250915103750,122.824254,43.105777
20250915103800,122.824303,43.105791
20250915103810,122.824301,43.105784
20250915103820,122.824326,43.105781
20250915103830,122.824326,43.105781
20250915103840,122.824429,43.105747
20250915103850,122.824568,43.105702
20250915103900,122.824725,43.105651
20250915103910,122.824811,43.105622
20250915103920,122.824895,43.105597
20250915103930,122.825031,43.105554
20250915103940,122.825171,43.105509
20250915103950,122.825327,43.105461
20250915104000,122.825485,43.105411
20250915104010,122.825635,43.105367
20250915104020,122.825813,43.105314
20250915104030,122.825810,43.105309
20250915104040,122.825933,43.105251
20250915104049,122.826091,43.105202
20250915104059,122.826121,43.105193
20250915104109,122.826123,43.105184
20250915104119,122.825992,43.105215
20250915104129,122.825786,43.105308
20250915104139,122.825924,43.105280
20250915104149,122.826052,43.105242
20250915104159,122.826058,43.105238
20250915104209,122.825775,43.105305
20250915104219,122.825819,43.105239
20250915104229,122.825789,43.105163
20250915104239,122.825780,43.105150
20250915104249,122.825780,43.105151
20250915104259,122.825780,43.105151
20250915104309,122.825780,43.105151
20250915104319,122.825780,43.105151
20250915104329,122.825780,43.105151
20250915104339,122.825780,43.105151
20250915104521,122.825457,43.104548
20250915104531,122.825283,43.104299
20250915104541,122.825146,43.104029
20250915104551,122.825081,43.103728
20250915104601,122.825077,43.103420
20250915104611,122.825108,43.103114
20250915104621,122.825047,43.102804
20250915104631,122.824978,43.102493
20250915104641,122.824895,43.102187
20250915104651,122.824747,43.101910
20250915104701,122.824642,43.101622
20250915104711,122.824562,43.101339
20250915104721,122.824362,43.101105
20250915104731,122.824114,43.100863
20250915104741,122.823912,43.100618
20250915104751,122.823734,43.100365
20250915104801,122.823561,43.100158
20250915104811,122.823373,43.099943
20250915104821,122.823215,43.099717
20250915104831,122.823041,43.099502
20250915104841,122.822840,43.099270
20250915104851,122.822688,43.099061
20250915104901,122.822524,43.098874
20250915104911,122.822433,43.098688
20250915104921,122.822343,43.098481
20250915104931,122.822253,43.098288
20250915104941,122.822133,43.098099
20250915104951,122.821919,43.097903
20250915105001,122.821618,43.097707
20250915105011,122.821383,43.097467
20250915105021,122.821187,43.097228
20250915105031,122.820966,43.096983
20250915105041,122.820735,43.096741
20250915105051,122.820539,43.096517
20250915105101,122.820273,43.096305
20250915105111,122.820035,43.096062
20250915105121,122.819722,43.095852
20250915105131,122.819465,43.095656
20250915105141,122.819175,43.095430
20250915105151,122.818905,43.095186
20250915105201,122.818633,43.094945
20250915105211,122.818247,43.094803
20250915105221,122.817861,43.094671
20250915105231,122.817508,43.094500
20250915105241,122.817138,43.094332
20250915105251,122.816767,43.094168
20250915105301,122.816446,43.093954
20250915105311,122.816115,43.093749
20250915105321,122.815754,43.093573
20250915105331,122.815390,43.093403
20250915105341,122.815099,43.093213
20250915105351,122.814936,43.092919
20250915105401,122.814806,43.092672
20250915105411,122.814676,43.092377
20250915105421,122.814530,43.092081
20250915105431,122.814389,43.091785
20250915105441,122.814258,43.091551
20250915105451,122.814206,43.091442
20250915105501,122.814127,43.091292
20250915105511,122.814079,43.091190
20250915105521,122.814042,43.091114
20250915105531,122.813989,43.091002
20250915105541,122.813948,43.090909
20250915105551,122.813915,43.090845
20250915105601,122.813663,43.090614
20250915105611,122.813383,43.090535
20250915105621,122.813249,43.090478
20250915105631,122.813131,43.090429
20250915105641,122.812816,43.090253
20250915105651,122.812670,43.090017
20250915105701,122.812570,43.089826
20250915105711,122.812519,43.089718
20250915105721,122.812465,43.089587
20250915105731,122.812363,43.089344
20250915105741,122.812324,43.089244
20250915105751,122.812189,43.088849
20250915105801,122.812055,43.088460
20250915105811,122.811933,43.088096
20250915105821,122.811904,43.088035
20250915105831,122.811873,43.087684
20250915105841,122.811835,43.087351
20250915105851,122.811816,43.087250
20250915105901,122.811579,43.087220
20250915105911,122.810664,43.087293
20250915105921,122.809541,43.087376
20250915105931,122.808507,43.087461
20250915105941,122.807739,43.087541
20250915105951,122.807677,43.087764
20250915141120,122.807562,43.087970
20250915141130,122.807590,43.087845
20250915141140,122.807586,43.087745
20250915141150,122.807607,43.087857
20250915141200,122.807630,43.087878
20250915141210,122.807588,43.087933
20250915141220,122.807557,43.087994
20250915141230,122.807525,43.088058
20250915141240,122.807507,43.088094
20250915141250,122.807494,43.088129</textarea>
            <div class="button-group">
                <button id="drawTrackButton" disabled style="flex: 1;">绘制轨迹</button>
                <button id="showTrackPointsButton" disabled style="flex: 1;" class="btn-warning">打点</button>
                <button id="clearTrackButton" disabled style="flex: 1;">清空轨迹</button>
            </div>
            <!-- 回放控制 -->
            <div class="split-section" style="margin-top:8px;">
                <div class="title">轨迹回放</div>
                <div class="playback-actions" style="display:flex;gap:8px;margin-bottom:8px;">
                    <button id="playbackStartBtn" disabled>开始</button>
                    <button id="playbackPauseBtn" disabled>继续</button>
                    <button id="playbackStopBtn" disabled>结束</button>
                </div>
                <div class="playback-speed" style="display:flex;align-items:center;gap:8px;margin-bottom:8px;">
                    <label>速度：
                        <select id="playbackSpeedSelect" disabled>
                            <option value="1" selected>1×</option>
                            <option value="2">2×</option>
                            <option value="4">4×</option>
                            <option value="8">8×</option>
                            <option value="16">16×</option>
                            <option value="32">32×</option>
                            <option value="64">64×</option>
                            <option value="128">128×</option>
                            <option value="256">256×</option>
                            <option value="512">512×</option>
                            <option value="1024">1024×</option>
                        </select>
                    </label>
                    <span id="playbackTimeLabel" style="font-size:12px;color:#666;">时间：—</span>
                </div>
                <div class="playback-time" style="display:flex;flex-direction:column;gap:4px;margin-bottom:8px;">
                    <label class="playback-time-label" style="display:flex;align-items:center;gap:8px;flex:1 1 auto;min-width:0;">
                        <span class="playback-time-text" style="white-space:nowrap;">起始时间：</span>
                        <input type="range" id="playbackTimeSlider" disabled min="0" max="0" step="1000" value="0" style="flex:1 1 auto;min-width:0;max-width:100%;vertical-align:middle;">
                    </label>
                    <span id="playbackTimeCursor" style="font-size:12px;color:#666;align-self:flex-end;">—</span>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    let map;
    let currentPolygons = []; // 存储多边形和其标签
    let currentTracks = []; // 存储轨迹折线及相关覆盖物
    let mapLoaded = false;
    let mapLabelHandlers = []; // 存储地图事件处理器
    let labelsEnabled = false; // 标签显示开关（默认关闭）
    let isDrawing = false; // 绘制进行中防止重复点击

    window.onload = function () {
        if (typeof T === 'undefined') {
            alert("天地图API加载失败，请检查网络或密钥！");
            return;
        }
        initMap();
        bindDrawEvent();
        bindMinimizeEvent();
        bindTabs();
        bindBatchGenerator();
        bindMultiSplitter();
        bindLabelsToggle(); // 绑定标签显示开关
        bindTrackEvents();  // 绑定轨迹绘制与清空
        bindPlaybackControls(); // 绑定轨迹回放
    };

    function initMap() {
        showLoading();
        disableButtons(true);

        try {
            map = new T.Map("mapContainer", {
                zoom: 12,
                center: new T.LngLat(116.40769, 39.90403)
            });

            // 已移除测试标签
            map.enableScrollWheelZoom();

            // 添加地图类型控件
            const mapTypeCtrl = new T.Control.MapType({
                mapTypes: [TMAP_NORMAL_MAP, TMAP_SATELLITE_MAP, TMAP_TERRAIN_MAP],
                position: T_ANCHOR_TOP_LEFT
            });
            map.addControl(mapTypeCtrl);

            // 加载影像底图（卫星）
            const tk = "648f621977051d0199ff0f965d3fd322";

            // 方案1：使用默认地图类型（作为备选）
            map.setMapType(TMAP_SATELLITE_MAP);

            // 方案2：手动添加影像图层（底图 + 标注）
            const vecLayer = new T.TileLayer(`https://t0.tianditu.gov.cn/img_w/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=img&STYLE=default&TILEMATRIXSET=w&FORMAT=tiles&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}&tk=${tk}`);
            const cvaLayer = new T.TileLayer(`https://t0.tianditu.gov.cn/cia_w/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=cia&STYLE=default&TILEMATRIXSET=w&FORMAT=tiles&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}&tk=${tk}`);

            // 添加图层并监听加载状态
            vecLayer.addEventListener("load", function () {
                console.log("影像底图加载完成");
            });

            vecLayer.addEventListener("error", function (e) {
                console.error("影像底图加载错误:", e);
                alert("影像底图加载错误，将使用默认地图类型");
            });

            map.addLayer(vecLayer);
            map.addLayer(cvaLayer);

            // 监听地图加载事件
            map.addEventListener("loaded", function () {
                console.log("地图加载完成");
                markMapLoaded();
            });
            map.addEventListener("load", function () {
                console.log("地图load事件触发");
                markMapLoaded();
            });
            map.addEventListener("tilesloaded", function () {
                console.log("地图瓦片加载完成");
                markMapLoaded();
            });
            // 监听地图加载失败事件
            map.addEventListener("error", function (e) {
                console.error("地图加载错误:", e);
                alert("地图加载错误: " + e.message);
                hideLoading();
            });

            // 监听地图移动事件，用于更新标签位置
            const moveHandler = function () {
                updateAllLabelsPosition();
            };
            map.addEventListener("move", moveHandler);
            map.addEventListener("zoom", moveHandler);

            // 存储事件处理器，用于清理
            mapLabelHandlers.push({ event: "move", handler: moveHandler });
            mapLabelHandlers.push({ event: "zoom", handler: moveHandler });

            // 超时容错
            setTimeout(() => {
                if (!mapLoaded) markMapLoaded();
            }, 8000);

        } catch (error) {
            alert("地图初始化失败：" + error.message);
            console.error(error);
            hideLoading();
        }
    }

    function markMapLoaded() {
        if (!mapLoaded) {
            mapLoaded = true;
            hideLoading();
            disableButtons(false);
            disableTrackButtons(false);
            // 仅开启速度选择，回放按钮按状态控制
            const speedSel = document.getElementById('playbackSpeedSelect');
            if (speedSel) speedSel.disabled = false;
            updatePlaybackButtonsState('idle');
        }
    }

    function showLoading() {
        const loading = document.getElementById("mapLoading");
        loading.style.display = "flex";
        loading.style.opacity = "1";
    }

    function hideLoading() {
        const loading = document.getElementById("mapLoading");
        loading.style.opacity = "0";
        setTimeout(() => loading.style.display = "none", 300);
    }

    function disableButtons(disabled) {
        document.getElementById("drawButton").disabled = disabled;
        document.getElementById("clearButton").disabled = disabled;
    }

    function disableTrackButtons(disabled) {
        const drawTrackBtn = document.getElementById("drawTrackButton");
        const showTrackPointsBtn = document.getElementById("showTrackPointsButton");
        const clearTrackBtn = document.getElementById("clearTrackButton");
        if (drawTrackBtn) drawTrackBtn.disabled = disabled;
        if (showTrackPointsBtn) showTrackPointsBtn.disabled = disabled;
        if (clearTrackBtn) clearTrackBtn.disabled = disabled;
    }
    // 回放控件的禁用/启用
    function disablePlaybackButtons(disabled) {
        ["playbackStartBtn","playbackPauseBtn","playbackStopBtn","playbackSpeedSelect","playbackTimeSlider"].forEach(id=>{
            const el = document.getElementById(id);
            if (el) el.disabled = disabled;
        });
    }

    // 回放按钮状态管理：空闲/播放/暂停
    function updatePlaybackButtonsState(state){
        try {
            const startBtn = document.getElementById('playbackStartBtn');
            const pauseBtn = document.getElementById('playbackPauseBtn');
            const stopBtn = document.getElementById('playbackStopBtn');
            if (!startBtn || !pauseBtn || !stopBtn) return;
            if (state === 'idle') {
                startBtn.disabled = false;
                pauseBtn.disabled = true;
                stopBtn.disabled = true;
                pauseBtn.textContent = '继续';
            } else if (state === 'playing') {
                startBtn.disabled = true;
                pauseBtn.disabled = false;
                stopBtn.disabled = false;
                pauseBtn.textContent = '暂停';
            } else if (state === 'paused') {
                startBtn.disabled = true;
                pauseBtn.disabled = false;
                stopBtn.disabled = false;
                pauseBtn.textContent = '继续';
            }
        } catch(e) { console.warn('更新按钮状态失败:', e); }
    }

    function bindDrawEvent() {
        document.getElementById("drawButton").addEventListener("click", function () {
            if (isDrawing) { console.log('绘制进行中，忽略重复点击'); return; }
            isDrawing = true;
            disableButtons(true);
            showLoading();
            try {
                const wktStr = document.getElementById("wktTextarea").value.trim();
                if (!wktStr) { alert("请输入WKT字符串！"); return; }
                clearOverlays();
                const geojson = parseWkt(wktStr);
    
                const polygonData = [];
                if (geojson.type === "Polygon") {
                    polygonData.push({ index: 1, coordinates: geojson.coordinates });
                } else if (geojson.type === "MultiPolygon") {
                    geojson.coordinates.forEach((polygon, index) => {
                        polygonData.push({ index: index + 1, coordinates: polygon });
                    });
                }
    
                // 重置并绘制
                polygonInfoList = [];
                polygonData.forEach(pd => processPolygon(pd.index, pd.coordinates));
    
                // 视图居中到所有已绘制轮廓
                try { fitViewportToPolygons(); } catch (e) { console.warn('视图居中失败', e); }
    
                // 在视图稳定后再创建/更新标签
                setTimeout(() => {
                    if (labelsEnabled) {
                        try {
                            createAllLabels();
                            updateAllLabelsPosition();
                        } catch (e) {
                            console.warn('创建或更新标签失败:', e);
                        }
                    }
                }, 150);
            } catch (e) {
                alert('绘制失败：' + (e && e.message ? e.message : e));
                console.error('绘制异常:', e);
            } finally {
                hideLoading();
                isDrawing = false;
                disableButtons(false);
            }
        });

        document.getElementById("clearButton").addEventListener("click", function () {
            if (isDrawing) { console.log('绘制进行中，暂不清空'); return; }
            clearOverlays();
            console.log("已清空所有轮廓");
        });
    }

    // 存储多边形数据，用于后续标签创建
    let polygonInfoList = [];

    // 处理单个多边形的绘制和面积计算
    function processPolygon(actualPolygonIndex, polygonCoords) {
        console.log('开始处理多边形', actualPolygonIndex);

        // 坐标系选择（绘制始终使用WGS84坐标）
        const coordSys = (document.getElementById('coordSysSelect') && document.getElementById('coordSysSelect').value) || 'wgs84';

        // 统一转换为WGS84用于绘制与面积计算
        function toWgs(point){
            const lng = point[0], lat = point[1];
            if (coordSys === 'wgs84' || coordSys === 'cgcs2000') {
                return [lng, lat];
            } else if (coordSys === 'gcj02') {
                const w = gcj02ToWgs84(lng, lat);
                return [w.lng, w.lat];
            } else if (coordSys === 'bd09') {
                const gcj = bd09ToGcj02(lng, lat);
                const w = gcj02ToWgs84(gcj.lng, gcj.lat);
                return [w.lng, w.lat];
            }
            return [lng, lat];
        }
        const coordsWGS84 = polygonCoords.map(ring => ring.map(toWgs));
        let outerRingWGS = coordsWGS84[0] || [];

        // 生成用于绘制的坐标（直接使用WGS84坐标）
        const rings = coordsWGS84.map(ring => ring.map(([lng, lat]) => new T.LngLat(lng, lat)));


         // 创建半透明填充的多边形（无边框）
          const polygon = new T.Polygon(rings, {
              color: "#FFD700",
              weight: 1,
              opacity: 1,
              fillColor: "#FFFF00",
              fillOpacity: 0.35
          });
 
          // 使用WGS84坐标计算面积（更准确的面积计算）
         let areaSqm;
         let areaMu;



         try {
             // 检查Turf.js是否可用
             if (typeof turf !== 'undefined' && turf.area) {
                 // 使用Turf.js计算多边形面积
                // 构造GeoJSON格式的多边形
                const geoJsonPolygon = {
                    type: "Polygon",
                    coordinates: coordsWGS84
                };


                 // 使用Turf.js计算面积（平方米）
                 areaSqm = turf.area(geoJsonPolygon);
                 areaMu = (areaSqm / 666.6667).toFixed(4); // 转换为亩
                 console.log(`多边形${actualPolygonIndex}面积计算结果(Turf.js): ${areaSqm}平方米 = ${areaMu}亩`);
             } else {
                 // 如果Turf.js不可用，回退到之前的计算方法
                 console.warn('Turf.js不可用，使用备用计算方法');
                 // 计算带孔洞的多边形面积
                 areaSqm = 0;
                 // 计算外环面积
                 outerRingWGS = coordsWGS84[0] || [];
                 areaSqm += calculatePolygonArea(outerRingWGS);

                 // 减去内环（孔洞）面积
                 for (let i = 1; i < coordsWGS84.length; i++) {
                     const innerRingArea = calculatePolygonArea(coordsWGS84[i]);
                     areaSqm -= innerRingArea;
                 }

                  areaMu = (areaSqm / 666.6667).toFixed(4); // 使用更精确的转换系数
                  console.log(`多边形${actualPolygonIndex}面积计算结果(备用): ${areaSqm}平方米 = ${areaMu}亩`);
              }
          } catch (error) {
              console.error(`面积计算失败:`, error);
              areaSqm = 0;
              areaMu = '0.0000';
          }

          // 计算多边形的中心点和底部中心点（WGS84）
          const centerPoint = calculatePolygonCenter(outerRingWGS);
          const bottomCenterPoint = calculatePolygonBottomCenter(outerRingWGS);

          // 添加多边形到地图
          if (map) {
              map.addOverLay(polygon);
              console.log(`多边形${actualPolygonIndex}已添加到地图`);
          } else {
              console.error('地图对象不存在');
          }

          // 存储多边形信息，用于后续标签创建
          polygonInfoList.push({
              index: actualPolygonIndex,
              polygon: polygon,
              area: areaMu,
              bottomCenter: { lng: bottomCenterPoint.lng, lat: bottomCenterPoint.lat },
              ringPoints: rings
          });
      }

    // 视图居中：根据已绘制的GCJ-02点
    function fitViewportToPolygons() {
        const points = [];
        try {
            if (!map || !map.setViewport) return;
            polygonInfoList.forEach(info => {
                if (!info || !info.ringPoints) return;
                info.ringPoints.forEach(ring => {
                    ring.forEach(ll => points.push(ll));
                });
            });
            if (!points.length) return;
            map.setViewport(points);
        } catch (e) {
            try {
                const lngs = points.map(p => p.lng);
                const lats = points.map(p => p.lat);
                const center = new T.LngLat(
                    (Math.min(...lngs) + Math.max(...lngs)) / 2,
                    (Math.min(...lats) + Math.max(...lats)) / 2
                );
                if (map && map.panTo) map.panTo(center);
            } catch (e2) {
                console.warn('视图居中失败:', e2);
            }
        }
    }

    // 统一创建所有多边形的标签
    function createAllLabels() {
        const mapContainer = document.getElementById('mapContainer');
        if (!mapContainer || !map) return;

        polygonInfoList.forEach(info => {
            if (!info) return;
            // 防止重复创建
            if (info.labelRef) return;
            // 创建标签元素
            const labelDiv = document.createElement('div');
            labelDiv.className = 'area-label';
            labelDiv.innerHTML = `多边形${info.index}：${info.area}亩`;

            // 添加到地图容器并根据屏幕边界定位到轮廓下方
            mapContainer.appendChild(labelDiv);
            positionLabelForPolygon(labelDiv, info);

            // 记录引用，避免重复创建
            info.labelRef = labelDiv;

            // 存储到 currentPolygons 以复用现有定位/清理逻辑
            const labelObj = {
                domElement: labelDiv,
                isDomLabel: true,
                polygonInfo: info
            };
            currentPolygons.push({ polygon: info.polygon, label: labelObj });
        });

        // 不清空 polygonInfoList，便于开关随时创建/隐藏标签
    }

    // 根据多边形屏幕边界定位标签，保证始终在轮廓下方
    function positionLabelForPolygon(labelDiv, info) {
        if (!map || !info || !info.ringPoints) return;
        const points = [];
        info.ringPoints.forEach(ring => {
            ring.forEach(ll => {
                const p = map.lngLatToContainerPoint(ll);
                points.push(p);
            });
        });
        if (!points.length) return;
        const minX = Math.min(...points.map(p => p.x));
        const maxX = Math.max(...points.map(p => p.x));
        const maxY = Math.max(...points.map(p => p.y));
        const container = document.getElementById('mapContainer');
        const labelWidth = labelDiv.offsetWidth;
        const labelHeight = labelDiv.offsetHeight;
        const targetLeft = Math.round((minX + maxX) / 2 - labelWidth / 2);
        const targetTop = Math.round(maxY + 6);
        const clampedLeft = Math.max(0, Math.min(targetLeft, container.clientWidth - labelWidth));
        const clampedTop = Math.max(0, Math.min(targetTop, container.clientHeight - labelHeight));
        labelDiv.style.left = clampedLeft + 'px';
        labelDiv.style.top = clampedTop + 'px';
    }

    // 更新所有标签位置（地图move/zoom时调用）
    function updateAllLabelsPosition() {
        try {
            if (!map) return;
            const container = document.getElementById('mapContainer');
            if (!container) return;
            currentPolygons.forEach(item => {
                if (!item || !item.label) return;
                const labelObj = item.label;
                if (labelObj.isDomLabel && labelObj.domElement && labelObj.polygonInfo) {
                    // 确保标签在容器中
                    if (!labelObj.domElement.parentNode) {
                        container.appendChild(labelObj.domElement);
                    }
                    positionLabelForPolygon(labelObj.domElement, labelObj.polygonInfo);
                }
            });
        } catch (e) {
            console.warn('更新标签位置时出错:', e);
        }
    }
    // 确保在全局可用（处理第三方库事件回调作用域差异）
    window.updateAllLabelsPosition = updateAllLabelsPosition;

    // 绑定“显示亩数标签”开关（默认隐藏）
    function bindLabelsToggle() {
        const cb = document.getElementById('toggleLabelsCheckbox');
        const container = document.getElementById('mapContainer');
        if (!cb || !container) return;
        // 默认隐藏标签
        container.classList.add('labels-hidden');
        cb.addEventListener('change', () => {
            labelsEnabled = cb.checked;
            if (labelsEnabled) {
                container.classList.remove('labels-hidden');
                const hasAnyLabel = currentPolygons.some(item => item && item.label && item.label.domElement);
                if (!hasAnyLabel) {
                    try { createAllLabels(); } catch (e) { console.warn('创建标签失败:', e); }
                }
                updateAllLabelsPosition();
            } else {
                container.classList.add('labels-hidden');
            }
        });
    }

    /**
     * 计算多边形中心点（比底部中心更适合显示标签）
     */
    function calculatePolygonCenter(outerRing) {
        let sumLng = 0, sumLat = 0;
        const len = outerRing.length;

        for (let i = 0; i < len; i++) {
            sumLng += outerRing[i][0];
            sumLat += outerRing[i][1];
        }

        return {
            lng: sumLng / len,
            lat: sumLat / len
        };
    }

    /**
     * 计算多边形面积（球面多边形面积计算）
     * 使用更准确的球面坐标面积计算方法，确保面积与视觉大小一致
     */
    function calculatePolygonArea(coordinates) {
        // 地球半径（米）- 使用更精确的值
        const R = 6371000.8;
        const n = coordinates.length;

        // 将所有坐标转换为弧度
        const coordsRad = coordinates.map(point => [
            point[0] * Math.PI / 180,
            point[1] * Math.PI / 180
        ]);

        let areaRad = 0;

        // 使用更准确的球面多边形面积公式（Girard定理）
        for (let i = 0; i < n; i++) {
            const j = (i + 1) % n;
            const lon1 = coordsRad[i][0];
            const lat1 = coordsRad[i][1];
            const lon2 = coordsRad[j][0];
            const lat2 = coordsRad[j][1];

            // 计算球面多边形面积增量
            const dlon = lon2 - lon1;
            const sinLat1 = Math.sin(lat1);
            const sinLat2 = Math.sin(lat2);
            const cosLat1 = Math.cos(lat1);
            const cosLat2 = Math.cos(lat2);

            // 使用更精确的公式
            areaRad += dlon * (sinLat1 * cosLat2 * Math.cos(dlon / 2) + sinLat2 * cosLat1);
        }

        // 计算总面积（平方米）
        const areaSqm = Math.abs(areaRad) * R * R * 0.5;

        return areaSqm;
    }

    /**
     * 清空所有多边形和标签（同时处理 polygonInfoList 与 currentPolygons）
     */
    function clearOverlays() {
        try {
            // 先移除 polygonInfoList 中记录的多边形与其DOM标签
            polygonInfoList.forEach(info => {
                if (info && info.polygon && map && map.removeOverLay) {
                    try { map.removeOverLay(info.polygon); } catch (e) { console.warn('移除多边形失败:', e); }
                }
                if (info && info.labelRef && info.labelRef.parentNode) {
                    try { info.labelRef.parentNode.removeChild(info.labelRef); } catch (e) { console.warn('移除DOM标签失败:', e); }
                    info.labelRef = null;
                }
            });

            // 再处理 currentPolygons（兼容旧路径与标签对象）
            currentPolygons.forEach(item => {
                if (item.polygon && map && map.removeOverLay) {
                    try { map.removeOverLay(item.polygon); } catch (e) { console.warn('移除多边形失败:', e); }
                }
                if (item.label) {
                    if (item.label.domElement && item.label.domElement.parentNode) {
                        try { item.label.domElement.parentNode.removeChild(item.label.domElement); } catch (e) { console.warn('移除DOM标签失败:', e); }
                    } else if (map && map.removeOverLay && !item.label.isDomLabel) {
                        try { map.removeOverLay(item.label); } catch (e) { console.warn('移除地图覆盖物标签失败:', e); }
                    }
                }
            });

            // 清空记录数组
            currentPolygons = [];
            polygonInfoList = [];

            console.log('已清空所有多边形和标签（保留事件监听器）');
        } catch (error) {
            console.error('清空覆盖物时出错:', error);
        }
    }

    // 其他辅助函数（保持不变）
    function bindMinimizeEvent() {
        const container = document.querySelector(".wkt-input-container");
        const btn = document.getElementById("minimizeBtn");
        const minIcon = btn?.querySelector(".min-icon");
        const restoreIcon = btn?.querySelector(".restore-icon");

        btn?.addEventListener("click", () => {
            const minimized = container.classList.toggle("minimized");
            if (minIcon && restoreIcon) {
                if (minimized) {
                    minIcon.style.display = "none";
                    restoreIcon.style.display = "";
                } else {
                    minIcon.style.display = "";
                    restoreIcon.style.display = "none";
                }
            }
        });
    }

    // 在脚本内部补充：页签切换（3个页签）
     function bindTabs() {
         const tabs = [
             { btn: document.getElementById('tabDrawBtn'), pane: document.getElementById('tabDraw'), key: 'draw' },
             { btn: document.getElementById('tabTrackBtn'), pane: document.getElementById('tabTrack'), key: 'track' },
             { btn: document.getElementById('tabSplitBtn'), pane: document.getElementById('tabSplit'), key: 'split' },
             { btn: document.getElementById('tabBatchBtn'), pane: document.getElementById('tabBatch'), key: 'batch' },
         ];
         if (tabs.some(t => !t.btn || !t.pane)) return;
         function activate(key) {
             tabs.forEach(t => {
                 const active = t.key === key;
                 t.btn.classList.toggle('active', active);
                 t.pane.classList.toggle('active', active);
             });
         }
         tabs.forEach(t => t.btn.addEventListener('click', () => activate(t.key)));
         activate('draw');
     }
    function updateParserStatus() {
        const el = document.getElementById('parserStatus');
        if (!el) return;
        const ok = (typeof Terraformer !== 'undefined' && Terraformer.WKT && typeof Terraformer.WKT.parse === 'function');
        if (ok) {
            el.textContent = 'Terraformer WKT Parser';
            el.style.color = '#2f8f2f';
        } else {
            el.textContent = '本地回退解析（仅支持POLYGON/MULTIPOLYGON）';
            el.style.color = '#c77d1e';
        }
    }
     function parseWkt(wkt) {
         wkt = wkt.trim();
         // 优先使用成熟库（Terraformer WKT Parser）
         if (typeof Terraformer !== 'undefined' && Terraformer.WKT && Terraformer.WKT.parse) {
             try {
                 return Terraformer.WKT.parse(wkt);
             } catch (e) {
                 console.warn('Terraformer解析失败，尝试本地回退解析:', e);
             }
         } else {
             // 不再提示“未加载”，由状态栏展示回退信息
         }
         // 回退解析：仅支持 POLYGON / MULTIPOLYGON
         const typeMatch = wkt.match(/^\s*(POLYGON|MULTIPOLYGON)\s*\(/i);
         if (!typeMatch) throw new Error('仅支持POLYGON/MULTIPOLYGON');
         const type = typeMatch[1].toUpperCase();
         const inner = wkt.substring(wkt.indexOf('('));
         if (type === 'POLYGON') {
             const coords = parsePolygonCoords(inner.replace(/^\(/, '').replace(/\)$/, ''));
             return { type: 'Polygon', coordinates: coords };
         } else {
             const trimmed = inner.replace(/^\(\(/, '').replace(/\)\)$/, '');
             const coords = parseMultiPolygonCoords(trimmed);
             return { type: 'MultiPolygon', coordinates: coords };
         }
     }

     function bindMultiSplitter() {
         const input = document.getElementById('multiInput');
         const output = document.getElementById('polyOutput');
         const splitBtn = document.getElementById('splitMultiBtn');
         const copyBtn = document.getElementById('copyPolysBtn');
         if (!input || !output || !splitBtn || !copyBtn) return;

         // 本地WKT序列化辅助
         function ringToText(ring) {
             if (!ring || !ring.length) return '()';
             const first = ring[0];
             const last = ring[ring.length - 1];
             const closed = (first[0] === last[0] && first[1] === last[1]) ? ring : ring.concat([[first[0], first[1]]]);
             return '(' + closed.map(pt => pt[0] + ' ' + pt[1]).join(', ') + ')';
         }
         function toWktPolygonCoords(coords) {
             return 'POLYGON(' + coords.map(ringToText).join(', ') + ')';
         }
         function toWktMulti(coords) {
             return 'MULTIPOLYGON(' + coords.map(poly => '(' + poly.map(ringToText).join(', ') + ')').join(', ') + ')';
         }

         function polygonsFromMulti(text) {
             const geo = parseWkt(text.trim());
             if (geo.type !== 'MultiPolygon') throw new Error('请输入有效的 MULTIPOLYGON WKT');
             const polys = geo.coordinates.map(rings => toWktPolygonCoords(rings));
             return polys;
         }
         splitBtn.addEventListener('click', () => {
             try {
                 const list = polygonsFromMulti(input.value.trim());
                 output.value = list.join('\n');
             } catch (e) {
                 alert('分割失败：' + e.message);
             }
         });
         copyBtn.addEventListener('click', async () => {
             const val = output.value.trim();
             if (!val) { alert('没有可复制的结果'); return; }
             try { await navigator.clipboard.writeText(val); alert('已复制到剪贴板'); } catch (e) { console.warn('复制失败', e); }
         });
     }

     function bindBatchGenerator() {
         const batchInput = document.getElementById('batchInput');
         const output = document.getElementById('multiOutput');
         const genBtn = document.getElementById('generateMultiBtn');
         const copyBtn = document.getElementById('copyMultiBtn');

         // 本地WKT序列化辅助（与分割器保持一致）
         function ringToText(ring) {
             if (!ring || !ring.length) return '()';
             const first = ring[0];
             const last = ring[ring.length - 1];
             const closed = (first[0] === last[0] && first[1] === last[1]) ? ring : ring.concat([[first[0], first[1]]]);
             return '(' + closed.map(pt => pt[0] + ' ' + pt[1]).join(', ') + ')';
         }
         function toWktMulti(coords) {
             return 'MULTIPOLYGON(' + coords.map(poly => '(' + poly.map(ringToText).join(', ') + ')').join(', ') + ')';
         }

         genBtn.addEventListener('click', () => {
             try {
                 const lines = batchInput.value.trim().split(/\n|;/).map(s => s.trim()).filter(Boolean);
                 if (lines.length === 0) throw new Error('请按每行或分号输入至少一个POLYGON');
                 const polygons = lines.map((line, idx) => {
                     const g = parseWkt(line);
                     if (g.type !== 'Polygon') throw new Error(`第${idx + 1}行不是有效的POLYGON WKT`);
                     return g;
                 });
                 const multiGeo = { type: 'MultiPolygon', coordinates: polygons.map(p => p.coordinates) };
                 output.value = toWktMulti(multiGeo.coordinates);
             } catch (e) {
                 alert('生成失败：' + e.message);
             }
         });

         copyBtn.addEventListener('click', async () => {
             const val = output.value.trim();
             if (!val) { alert('没有可复制的结果'); return; }
             try { await navigator.clipboard.writeText(val); alert('已复制到剪贴板'); } catch (e) { console.warn('复制失败', e); }
         });

     }

     function setExampleWkt() {
         const exampleWkt = "MULTIPOLYGON(" +
             "(" +
             "(116.35 39.93, 116.39 39.93, 116.39 39.90, 116.35 39.90, 116.35 39.93)," + // 外环
             "(116.36 39.92, 116.38 39.92, 116.38 39.91, 116.36 39.91, 116.36 39.92)" +  // 内环
             ")," +
             "(" +
             "(116.40 39.95, 116.43 39.97, 116.46 39.96, 116.49 39.98, 116.52 39.95, 116.55 39.93, 116.58 39.94, 116.61 39.92, 116.64 39.95, 116.40 39.95)" +
             ")" +
             ")";
         document.getElementById("wktTextarea").value = exampleWkt;
     }

     function parsePolygonCoords(coordStr) {
         const ringStrs = coordStr.split(/\)\s*,\s*\(/).map(s => s.replace(/[()]/g, '').trim());
         const rings = [];
         ringStrs.forEach(ringStr => {
             const pts = ringStr.split(/,\s*/).map(pointStr => {
                 const [lng, lat] = pointStr.split(/\s+/).map(Number);
                 if (isNaN(lng) || isNaN(lat)) throw new Error("坐标格式错误：" + pointStr);
                 return [lng, lat];
             });
             // 自动拆分：如果一个ring中包含多次回到起点（闭合），则拆分为多个环
             // 兼容用户将外环与内环错误地写在同一对括号中的情况
             let start = 0;
             while (start < pts.length) {
                 const startPt = pts[start];
                 let closeIdx = -1;
                 for (let i = start + 1; i < pts.length; i++) {
                     if (pts[i][0] === startPt[0] && pts[i][1] === startPt[1]) {
                         closeIdx = i;
                         break;
                     }
                 }
                 if (closeIdx === -1) {
                     // 未找到闭合：将剩余点视为一个环，并强制闭合
                     const ring = pts.slice(start);
                     if (ring.length && (ring[0][0] !== ring[ring.length - 1][0] || ring[0][1] !== ring[ring.length - 1][1])) {
                         ring.push([ring[0][0], ring[0][1]]);
                     }
                     rings.push(ring);
                     break;
                 } else {
                     const ring = pts.slice(start, closeIdx + 1);
                     rings.push(ring);
                     start = closeIdx + 1;
                 }
             }
         });
         return rings;
     }

     function parseMultiPolygonCoords(coordStr) {
         const polygonStrs = coordStr.split(/\)\s*\)\s*,\s*\(\s*\(/).map(s => s.replace(/[()]/g, '').trim());
         return polygonStrs.map(polygonStr => parsePolygonCoords(polygonStr));
     }

     function wgs84ToGcj02(lng, lat) {
         const x_PI = 3.14159265358979324 * 3000.0 / 180.0;
         const PI = 3.1415926535897932384626;
         const a = 6378245.0;
         const ee = 0.00669342162296594323;

         if (outOfChina(lng, lat)) return { lng, lat };

         let dlat = transformLat(lng - 105.0, lat - 35.0);
         let dlng = transformLng(lng - 105.0, lat - 35.0);
         const radlat = lat / 180.0 * PI;
         let magic = Math.sin(radlat);
         magic = 1 - ee * magic * magic;
         const sqrtmagic = Math.sqrt(magic);
         dlat = (dlat * 180.0) / ((a * (1 - ee)) / (magic * sqrtmagic) * PI);
         dlng = (dlng * 180.0) / (a / sqrtmagic * Math.cos(radlat) * PI);

         return { lng: lng + dlng, lat: lat + dlat };

         function outOfChina(lng, lat) {
             return (lng < 72.004 || lng > 137.8347) || (lat < 0.8293 || lat > 55.8271);
         }

         function transformLat(x, y) {
             let ret = -100.0 + 2.0 * x + 3.0 * y + 0.2 * y * y + 0.1 * x * y + 0.2 * Math.sqrt(Math.abs(x));
             ret += (20.0 * Math.sin(6.0 * x * PI) + 20.0 * Math.sin(2.0 * x * PI)) * 2.0 / 3.0;
             ret += (20.0 * Math.sin(y * PI) + 40.0 * Math.sin(y / 3.0 * PI)) * 2.0 / 3.0;
             ret += (160.0 * Math.sin(y / 12.0 * PI) + 320 * Math.sin(y * PI / 30.0)) * 2.0 / 3.0;
             return ret;
         }

         function transformLng(x, y) {
             let ret = 300.0 + x + 2.0 * y + 0.1 * x * x + 0.1 * x * y + 0.1 * Math.sqrt(Math.abs(x));
             ret += (20.0 * Math.sin(6.0 * x * PI) + 20.0 * Math.sin(2.0 * x * PI)) * 2.0 / 3.0;
             ret += (20.0 * Math.sin(x * PI) + 40.0 * Math.sin(x / 3.0 * PI)) * 2.0 / 3.0;
             ret += (150.0 * Math.sin(x / 12.0 * PI) + 300.0 * Math.sin(x / 30.0 * PI)) * 2.0 / 3.0;
             return ret;
         }
     }

     function gcj02ToWgs84(lng, lat) {
         const g = wgs84ToGcj02(lng, lat);
         return { lng: lng * 2 - g.lng, lat: lat * 2 - g.lat };
     }

     function bd09ToGcj02(bdLng, bdLat) {
         const x_PI = 3.14159265358979324 * 3000.0 / 180.0;
         const x = bdLng - 0.0065;
         const y = bdLat - 0.006;
         const z = Math.sqrt(x * x + y * y) - 0.00002 * Math.sin(y * x_PI);
         const theta = Math.atan2(y, x) - 0.000003 * Math.cos(x * x_PI);
         const ggLng = z * Math.cos(theta);
         const ggLat = z * Math.sin(theta);
         return { lng: ggLng, lat: ggLat };
     }

     function calculatePolygonBottomCenter(outerRing) {
         let minLat = Infinity;
         let bottomPoints = [];
         outerRing.forEach(point => {
             const lat = point[1];
             if (lat < minLat) {
                 minLat = lat;
                 bottomPoints = [point];
             } else if (lat === minLat) {
                 bottomPoints.push(point);
             }
         });

         const sumLng = bottomPoints.reduce((sum, point) => sum + point[0], 0);
         const centerLng = sumLng / bottomPoints.length;

         return { lng: centerLng, lat: minLat };
     }

     function fitBounds(geojson) {
         try {
             const allPoints = [];
             function collectPoints(coords) {
                 if (typeof coords[0] === 'number') {
                     allPoints.push(coords);
                 } else {
                     coords.forEach(coord => collectPoints(coord));
                 }
             }
             collectPoints(geojson.coordinates);

             if (allPoints.length === 0) return;

             const lats = allPoints.map(p => p[1]);
             const lngs = allPoints.map(p => p[0]);
             const minLng = Math.min(...lngs);
             const maxLng = Math.max(...lngs);
             const minLat = Math.min(...lats);
             const maxLat = Math.max(...lats);

             const sw = wgs84ToGcj02(minLng, minLat);
             const ne = wgs84ToGcj02(maxLng, maxLat);

             // 修复setViewport方法的使用，确保参数格式正确
             if (map && map.setViewport) {
                 map.setViewport([
                     new T.LngLat(sw.lng, sw.lat),
                     new T.LngLat(ne.lng, ne.lat)
                 ], { padding: [50, 50] });
             } else {
                 console.warn('地图对象或setViewport方法不可用');
             }
         } catch (error) {
             console.error('调整视图范围时出错:', error);
         }
     }
// 轨迹绘制与解析
    function bindTrackEvents() {
        const drawBtn = document.getElementById('drawTrackButton');
        const showPointsBtn = document.getElementById('showTrackPointsButton');
        const clearBtn = document.getElementById('clearTrackButton');
        const ta = document.getElementById('trackTextarea');
        if (!drawBtn || !showPointsBtn || !clearBtn || !ta) return;

        drawBtn.addEventListener('click', function(){
            try {
                const text = ta.value.trim();
                if (!text) { alert('请粘贴轨迹文本（时间戳,经度,纬度）'); return; }
                const points = parseTrackText(text);
                if (points.length < 2) { alert('有效轨迹点不足，至少需要两点'); return; }
                drawTrackFromPoints(points);
                fitViewportToTrack(points);
            } catch (e) {
                alert('绘制轨迹失败：' + (e && e.message ? e.message : e));
                console.error('绘制轨迹异常:', e);
            }
        });

        showPointsBtn.addEventListener('click', function(){
            try {
                const text = ta.value.trim();
                if (!text) { alert('请粘贴轨迹文本（时间戳,经度,纬度）'); return; }
                const points = parseTrackText(text);
                if (points.length === 0) { alert('未找到有效轨迹点'); return; }
                showTrackPoints(points);
                fitViewportToTrack(points);
            } catch (e) {
                alert('显示轨迹点失败：' + (e && e.message ? e.message : e));
                console.error('显示轨迹点异常:', e);
            }
        });

        clearBtn.addEventListener('click', function(){
            clearTrackOverlays();
            console.log('已清空轨迹');
        });
    }

    function showTrackPoints(points) {
        // 先移除旧轨迹（不影响轮廓）
        clearTrackOverlays(false);
        
        if (!map || !points || points.length === 0) {
            console.log('无轨迹点可显示');
            return;
        }
        
        console.log(`准备显示${points.length}个轨迹点`);
        
        // 使用批量处理和更小的图标来提高性能
        // 创建一个更小的红点SVG图标
        const smallRedDotIcon = new T.Icon({
            iconUrl: 'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="1" height="1"><circle cx="0.5" cy="0.5" r="0.3" fill="%23FF0000"/></svg>',
            iconSize: new T.Point(1, 1),
            iconAnchor: new T.Point(0.5, 0.5)
        });
        
        // 优化批量添加点的速度
        const batchSize = 2000; // 增加每批处理的点数
        const concurrentBatches = 4; // 并发批次数量
        
        // 预创建点击事件处理函数，避免重复创建
        function createClickHandler(point, index) {
            return function() {
                const infoWindow = new T.InfoWindow({
                    content: `点${index + 1}<br/>经度: ${point.lng.toFixed(6)}<br/>纬度: ${point.lat.toFixed(6)}`,
                    offset: new T.Point(0, -20)
                });
                infoWindow.open(map, point);
            };
        }
        
        // 使用setTimeout实现更高效的批量添加，避免阻塞UI
        let currentIndex = 0;
        
        function addBatch() {
            if (currentIndex >= points.length) {
                console.log(`已显示${points.length}个轨迹点`);
                return;
            }
            
            // 添加当前批次的点
            const endIndex = Math.min(currentIndex + batchSize, points.length);
            const markersToAdd = [];
            
            // 先创建所有标记
            for (let i = currentIndex; i < endIndex; i++) {
                const point = points[i];
                const index = i;
                
                const marker = new T.Marker(point, {
                    icon: smallRedDotIcon
                });
                
                // 添加点击事件
                marker.addEventListener('click', createClickHandler(point, index));
                
                markersToAdd.push(marker);
            }
            
            // 批量添加到地图和数组
            markersToAdd.forEach(marker => {
                map.addOverLay(marker);
                currentTracks.push(marker);
            });
            
            currentIndex = endIndex;
            
            // 使用setTimeout而不是requestAnimationFrame，减少对渲染周期的依赖
            // 设置为0，将任务放入微任务队列，但允许UI有短暂的呼吸空间
            setTimeout(addBatch, 0);
        }
        
        // 启动批量添加
        addBatch();
    }
    
    // 恢复原始的clearTrackOverlays函数
    function clearTrackOverlays(resetArray = true){        
        try {
            currentTracks.forEach(pl => {
                if (pl && map && map.removeOverLay) {
                    try { map.removeOverLay(pl); } catch (e) { console.warn('移除轨迹失败:', e); }
                }
            });
            if (resetArray) currentTracks = [];
        } catch (e) {
            console.warn('清空轨迹时出错:', e);
        }
    }

    function parseTrackText(text){
        // 选择输入坐标系（优先使用轨迹页签专属选择器，若未设置则回退到绘制页签选择器）
        const coordSysEl = document.getElementById('trackCoordSysSelect') || document.getElementById('coordSysSelect');
        const coordSys = (coordSysEl && coordSysEl.value) || 'wgs84';
        const isHash = text.indexOf('#') !== -1;
        const items = isHash ? text.split('#') : text.split(/\r?\n/);
        const pts = [];
        for (let i=0;i<items.length;i++){
            const raw = items[i];
            if (!raw) continue;
            const line = raw.trim();
            if (!line) continue;
            const parts = line.split(',');
            if (parts.length < 3) continue;
            let lng = parseFloat((parts[isHash ? 0 : 1] || '').trim());
            let lat = parseFloat((parts[isHash ? 1 : 2] || '').trim());
            // 初步过滤：数值合法性与正常范围
            if (!isFinite(lng) || !isFinite(lat)) continue;
            if (lng === 0 || lat === 0) continue; // 丢弃0.0异常点
            if (lng < -180 || lng > 180 || lat < -90 || lat > 90) continue; // 超出经纬度范围丢弃

            // 将输入坐标转换为WGS84
            let w;
            if (coordSys === 'wgs84' || coordSys === 'cgcs2000') {
                w = { lng, lat };
            } else if (coordSys === 'gcj02') {
                w = gcj02ToWgs84(lng, lat);
            } else if (coordSys === 'bd09') {
                const g = bd09ToGcj02(lng, lat);
                w = gcj02ToWgs84(g.lng, g.lat);
            } else {
                w = { lng, lat };
            }
            // 转换结果兜底检查
            if (!isFinite(w.lng) || !isFinite(w.lat)) continue;
            if (w.lng < -180 || w.lng > 180 || w.lat < -90 || w.lat > 90) continue;

            // 使用WGS84坐标绘制到地图
            pts.push(new T.LngLat(w.lng, w.lat));
        }
        return pts;
    }

    function drawTrackFromPoints(points){
        // 先移除旧轨迹（不影响轮廓）
        clearTrackOverlays(false);
        const polyline = new T.Polyline(points, {
            color: '#FF3B30',
            weight: 1,
            opacity: 0.9
        });
        if (map) {
            map.addOverLay(polyline);
        }
        currentTracks.push(polyline);
    }

    function clearTrackOverlays(resetArray = true){
        try {
            currentTracks.forEach(pl => {
                if (pl && map && map.removeOverLay) {
                    try { map.removeOverLay(pl); } catch (e) { console.warn('移除轨迹失败:', e); }
                }
            });
            if (resetArray) currentTracks = [];
        } catch (e) {
            console.warn('清空轨迹时出错:', e);
        }
    }


    function fitViewportToTrack(points){
        try {
            if (!map || !map.setViewport || !points || !points.length) return;
            map.setViewport(points);
        } catch (e) {
            console.warn('轨迹视图居中失败:', e);
        }
    }

    // ========= 轨迹回放功能 =========
    let playbackState = { points: [], idx: 0, speed: 1, timer: null, running: false, marker: null, line: null, path: [] };

    function bindPlaybackControls(){
        const startBtn = document.getElementById('playbackStartBtn');
        const pauseBtn = document.getElementById('playbackPauseBtn');
        const stopBtn = document.getElementById('playbackStopBtn');
        const speedSel = document.getElementById('playbackSpeedSelect');
        const timeSlider = document.getElementById('playbackTimeSlider');
        const timeCursor = document.getElementById('playbackTimeCursor');
        const ta = document.getElementById('trackTextarea');
        if (!startBtn || !pauseBtn || !stopBtn || !speedSel) return;

        // 初始按钮状态
        updatePlaybackButtonsState('idle');

        startBtn.addEventListener('click', function(){
            try {
                const text = (ta && ta.value || '').trim();
                if (!text) { alert('请粘贴轨迹文本（时间戳,经度,纬度）'); return; }
                const pts = parseTrackTextWithTime(text);
                if (pts.length < 2) { alert('有效轨迹点不足，至少需要两点'); return; }
                startPlayback(pts);
                // 状态在startPlayback中已设置为playing
            } catch (e) {
                alert('开始回放失败：' + (e && e.message ? e.message : e));
                console.error('开始回放异常:', e);
            }
        });

        pauseBtn.addEventListener('click', function(){
            if (!playbackState.running) {
                // 继续
                playbackState.running = true;
                scheduleNext();
                updatePlaybackButtonsState('playing');
            } else {
                // 暂停
                if (playbackState.timer) { clearTimeout(playbackState.timer); playbackState.timer = null; }
                playbackState.running = false;
                updatePlaybackButtonsState('paused');
            }
        });

        stopBtn.addEventListener('click', function(){ 
            stopPlayback(); 
            updatePlaybackButtonsState('idle');
        });

        speedSel.addEventListener('change', function(){
            const v = parseFloat(speedSel.value);
            playbackState.speed = (isFinite(v) && v > 0) ? v : 1;
        });

        if (timeSlider) {
            timeSlider.addEventListener('input', function(){
                const ms = parseInt(timeSlider.value, 10);
                const txt = formatTimeForLabel(ms);
                if (timeCursor) timeCursor.textContent = txt;
            });
            timeSlider.addEventListener('change', function(){
                jumpToSliderTime();
            });
        }
    }

    function parseTrackTextWithTime(text){
        const coordSysEl = document.getElementById('trackCoordSysSelect') || document.getElementById('coordSysSelect');
        const coordSys = (coordSysEl && coordSysEl.value) || 'wgs84';
        const isHash = text.indexOf('#') !== -1;
        const items = isHash ? text.split('#') : text.split(/\r?\n/);
        const out = [];
        for (let i=0;i<items.length;i++){
            const raw = items[i];
            if (!raw) continue;
            const line = raw.trim();
            if (!line) continue;
            const parts = line.split(',');
            if (parts.length < 3) continue;
            const tsRaw = (parts[isHash ? 2 : 0] || '').trim();
            const ts = (tsRaw || '').replace(/\D/g,'');
            let lng = parseFloat((parts[isHash ? 0 : 1] || '').trim());
            let lat = parseFloat((parts[isHash ? 1 : 2] || '').trim());
            if (!isFinite(lng) || !isFinite(lat)) continue;
            if (lng === 0 || lat === 0) continue;
            if (lng < -180 || lng > 180 || lat < -90 || lat > 90) continue;
            const t = parseTimestamp(ts);
            if (!t) continue;
            let w;
            if (coordSys === 'wgs84' || coordSys === 'cgcs2000') {
                w = { lng, lat };
            } else if (coordSys === 'gcj02') {
                w = gcj02ToWgs84(lng, lat);
            } else if (coordSys === 'bd09') {
                const g = bd09ToGcj02(lng, lat);
                w = gcj02ToWgs84(g.lng, g.lat);
            } else { w = { lng, lat }; }
            if (!isFinite(w.lng) || !isFinite(w.lat)) continue;
            if (w.lng < -180 || w.lng > 180 || w.lat < -90 || w.lat > 90) continue;
            out.push({ ll: new T.LngLat(w.lng, w.lat), time: t, ts });
        }
        out.sort((a,b)=>a.time - b.time);
        return out;
    }

    function parseTimestamp(ts){
        const tstr = (ts || '').replace(/\D/g,'');
        const m = tstr && tstr.match(/^\d{14}$/);
        if (!m) return null;
        const y = parseInt(tstr.slice(0,4),10);
        const M = parseInt(tstr.slice(4,6),10) - 1;
        const d = parseInt(tstr.slice(6,8),10);
        const h = parseInt(tstr.slice(8,10),10);
        const m2 = parseInt(tstr.slice(10,12),10);
        const s = parseInt(tstr.slice(12,14),10);
        const dt = new Date(y,M,d,h,m2,s);
        return isNaN(dt.getTime()) ? null : dt;
    }

    function startPlayback(points){
        console.log('[Playback] startPlayback: 点数=', points && points.length);
        stopPlayback();
        playbackState.points = points;
        playbackState.idx = 0;
        playbackState.speed = playbackState.speed || 1;
        playbackState.running = true;
        // 配置时间滑动条，并尊重现有滑块位置作为起始
        configureTimeSlider(points);
        // 启用滑块
        const slider = document.getElementById('playbackTimeSlider');
        if (slider) slider.disabled = false;
        let initIdx = 0;
        if (slider && slider.min && slider.max) {
            const ms = parseInt(slider.value, 10);
            if (isFinite(ms)) initIdx = findIndexByTime(points, ms);
        }
        playbackState.idx = initIdx;
        const first = points[initIdx];
        console.log('[Playback] 首点:', first && first.ts, first && first.ll, 'initIdx=', initIdx);
        playbackState.path = points.slice(0, initIdx+1).map(p=>p.ll);
        playbackState.line = new T.Polyline(playbackState.path, { color: '#00FFFF', weight: 1, opacity: 0.9 });
        if (map) {
            map.addOverLay(playbackState.line);
        }
        currentTracks.push(playbackState.line);
        // 创建并定位DOM标记以保证可见移动
        ensurePlaybackDom(first.ll);
        updatePlaybackDom(first.ll);
        updatePlaybackTimeLabel(first.ts);
        try { fitViewportToTrack(points.map(p=>p.ll)); } catch(e){}
        // 更新按钮状态
        updatePlaybackButtonsState('playing');
        scheduleNext();
    }

    function scheduleNext(){
        if (!playbackState.running) return;
        if (!playbackState.points || playbackState.idx >= playbackState.points.length - 1) {
            playbackState.running = false;
            console.log('[Playback] 回放结束：idx=', playbackState.idx, '点数=', playbackState.points ? playbackState.points.length : 0);
            updatePlaybackButtonsState('idle'); // 播放结束后按钮回到初始状态：开始可点，继续/结束灰化
            return;
        }
        const next = playbackState.points[playbackState.idx+1];
        const speed = playbackState.speed || 1;
        const delay = Math.max(4, Math.round(1000 / speed)); // 1x=1000ms/点，2x=500ms/点...
        console.log('[Playback] scheduleNext: idx=', playbackState.idx, '->', playbackState.idx+1, 'delay=', delay, 'speed=', speed);
        playbackState.timer = setTimeout(()=>{
            playbackState.idx++;
            const nextLL = next.ll;
            console.log('[Playback] 下一点:', next && next.ts, nextLL);
            try {
                // 维护路径数组
                playbackState.path = playbackState.path || [];
                playbackState.path.push(nextLL);
                console.log('[Playback] 路径长度=', playbackState.path.length);
                // 使用DOM标记进行移动（容器/图层坐标）
                if (!playbackDom.el) console.log('[Playback] DOM标记不存在，将尝试创建');
                updatePlaybackDom(nextLL);
                // 折线更新：优先setLngLats，兜底重建
                if (playbackState.line && typeof playbackState.line.setLngLats === 'function') {
                    try { playbackState.line.setLngLats(playbackState.path); }
                    catch(e){
                        console.warn('[Playback] setLngLats失败，重建折线', e);
                        if (map) { try { map.removeOverLay(playbackState.line); } catch(e){} }
                        playbackState.line = new T.Polyline(playbackState.path, { color: '#00FFFF', weight: 1, opacity: 0.9 });
                        if (map) map.addOverLay(playbackState.line);
                    }
                } else {
                    console.log('[Playback] 折线不支持setLngLats，重建');
                    if (playbackState.line && map) { try { map.removeOverLay(playbackState.line); } catch(e){} }
                    playbackState.line = new T.Polyline(playbackState.path, { color: '#00FFFF', weight: 1, opacity: 0.9 });
                    if (map) map.addOverLay(playbackState.line);
                }
            } catch(e) { console.warn('更新回放覆盖物失败:', e); }
            updatePlaybackTimeLabel(next.ts);
            scheduleNext();
        }, delay);
    }

    function stopPlayback(){
        if (playbackState.timer) { clearTimeout(playbackState.timer); playbackState.timer = null; }
        playbackState.running = false;
        playbackState.idx = 0;
        try {
            // 移除DOM标记
            removePlaybackDom();
            if (playbackState.marker && map) map.removeOverLay(playbackState.marker);
            if (playbackState.line && map) map.removeOverLay(playbackState.line);
        } catch(e){}
        playbackState.marker = null;
        playbackState.line = null;
        updatePlaybackTimeLabel('—');
        // 按钮回到初始状态
        updatePlaybackButtonsState('idle');
    }

    function updatePlaybackTimeLabel(text){
        const el = document.getElementById('playbackTimeLabel');
        if (el) el.textContent = '时间：' + (text || '—');
    }

    // 时间滑动条：配置与跳转
    function configureTimeSlider(points){
        try {
            const slider = document.getElementById('playbackTimeSlider');
            const cursor = document.getElementById('playbackTimeCursor');
            if (!slider || !points || !points.length) return;
            const minMs = points[0].time.getTime();
            const maxMs = points[points.length - 1].time.getTime();
            const prev = parseInt(slider.value, 10);
            slider.min = String(minMs);
            slider.max = String(maxMs);
            slider.step = '1000'; // 以秒为步进
            let val = (isFinite(prev) && prev >= minMs && prev <= maxMs) ? prev : minMs;
            slider.value = String(val);
            if (cursor) cursor.textContent = formatTimeForLabel(val);
        } catch(e) { console.warn('配置时间滑动条失败:', e); }
    }
    function formatTimeForLabel(ms){
        if (!isFinite(ms)) return '—';
        const d = new Date(ms);
        const pad = n => String(n).padStart(2,'0');
        const y = d.getFullYear();
        const M = pad(d.getMonth()+1);
        const da = pad(d.getDate());
        const h = pad(d.getHours());
        const m = pad(d.getMinutes());
        const s = pad(d.getSeconds());
        return `${y}-${M}-${da} ${h}:${m}:${s}`;
    }
    function findIndexByTime(points, ms){
        try {
            if (!points || !points.length) return 0;
            const n = points.length;
            const minMs = points[0].time.getTime();
            const maxMs = points[n-1].time.getTime();
            if (!isFinite(ms)) return 0;
            if (ms <= minMs) return 0;
            if (ms >= maxMs) return n-1;
            let lo = 0, hi = n - 1, ans = 0;
            while (lo <= hi) {
                const mid = (lo + hi) >> 1;
                const t = points[mid].time.getTime();
                if (t < ms) { lo = mid + 1; ans = lo; }
                else { hi = mid - 1; ans = mid; }
            }
            return Math.max(0, Math.min(n-1, ans));
        } catch(e){ console.warn('findIndexByTime失败:', e); return 0; }
    }
    function jumpToSliderTime(){
        try {
            const slider = document.getElementById('playbackTimeSlider');
            if (!slider || !playbackState.points || !playbackState.points.length) return;
            const ms = parseInt(slider.value, 10);
            if (!isFinite(ms)) return;
            const idx = findIndexByTime(playbackState.points, ms);
            playbackState.idx = idx;
            const pts = playbackState.points;
            const ll = pts[idx].ll;
            playbackState.path = pts.slice(0, idx+1).map(p=>p.ll);
            // 更新折线
            try {
                if (playbackState.line && typeof playbackState.line.setLngLats === 'function') {
                    playbackState.line.setLngLats(playbackState.path);
                } else {
                    if (playbackState.line && map) { try { map.removeOverLay(playbackState.line); } catch(e){} }
                    playbackState.line = new T.Polyline(playbackState.path, { color: '#00FFFF', weight: 1, opacity: 0.9 });
                    if (map) map.addOverLay(playbackState.line);
                }
            } catch(e){ console.warn('滑块更新折线失败:', e); }
            // 更新标记与时间
            ensurePlaybackDom(ll);
            updatePlaybackDom(ll);
            updatePlaybackTimeLabel(pts[idx].ts);
            // 若正在播放，立即按新位置继续
            if (playbackState.running) {
                if (playbackState.timer) { clearTimeout(playbackState.timer); playbackState.timer = null; }
                scheduleNext();
            }
        } catch(e) { console.warn('滑块跳转失败:', e); }
    }

    // DOM标记：使用容器坐标实现可见移动
    let playbackDom = { el: null, lastLL: null, bound: false };

    function ensurePlaybackDom(ll){
        try {
            playbackDom.lastLL = ll;
            const pane = (map && map.getPanes && map.getPanes().overlayPane) || document.getElementById('mapContainer');
            if (!pane) { console.warn('未找到overlayPane或mapContainer'); return; }
            if (!playbackDom.el) {
                const el = document.createElement('div');
                el.id = 'playbackDomMarker';
                el.style.position = 'absolute';
                el.style.width = '0';
                el.style.height = '0';
                el.style.borderLeft = '3px solid transparent';
                el.style.borderRight = '3px solid transparent';
                el.style.borderBottom = '4px solid #2C64A7';
                el.style.borderTop = '0';
                el.style.transform = 'translate(-50%, -50%)';
                el.style.zIndex = '9999';
                // 添加伪元素来增强箭头效果
                el.style.clipPath = 'polygon(50% 0, 100% 100%, 0 100%)';
                pane.appendChild(el);
                playbackDom.el = el;
                console.log('[Playback] 创建DOM标记，父节点=', pane === document.getElementById('mapContainer') ? '#mapContainer' : 'overlayPane');
                bindPlaybackDomEvents();
            }
            updatePlaybackDom(ll);
        } catch(e) { console.warn('创建DOM标记失败:', e); }
    }

    function updatePlaybackDom(ll){
        try {
            playbackDom.lastLL = ll;
            if (!map || !playbackDom.el || !ll) { console.log('[Playback] update取消：map/el/ll缺失'); return; }
            let p;
            if (typeof map.lngLatToLayerPoint === 'function') {
                p = map.lngLatToLayerPoint(ll);
                console.log('[Playback] 使用layerPoint定位:', ll && ll.lng, ll && ll.lat, '=>', p && p.x, p && p.y);
            } else if (typeof map.lngLatToContainerPoint === 'function') {
                p = map.lngLatToContainerPoint(ll);
                console.log('[Playback] 使用containerPoint定位:', ll && ll.lng, ll && ll.lat, '=>', p && p.x, p && p.y);
            } else {
                console.warn('地图对象不支持lngLat到像素坐标转换');
                return;
            }
            playbackDom.el.style.left = p.x + 'px';
            playbackDom.el.style.top = p.y + 'px';
        } catch(e) { console.warn('更新DOM标记位置失败:', e); }
    }

    function bindPlaybackDomEvents(){
        if (playbackDom.bound) return;
        const updater = function(){
            try {
                if (!map || !playbackDom.el || !playbackDom.lastLL) return;
                let p;
                if (typeof map.lngLatToLayerPoint === 'function') {
                    p = map.lngLatToLayerPoint(playbackDom.lastLL);
                } else if (typeof map.lngLatToContainerPoint === 'function') {
                    p = map.lngLatToContainerPoint(playbackDom.lastLL);
                }
                if (!p) return;
                playbackDom.el.style.left = p.x + 'px';
                playbackDom.el.style.top = p.y + 'px';
            } catch(e){}
        };
        try {
            map.addEventListener('move', updater);
            map.addEventListener('zoom', updater);
            playbackDom.bound = true;
        } catch(e){}
    }

    function removePlaybackDom(){
        try {
            const el = playbackDom.el;
            playbackDom.lastLL = null;
            if (el && el.parentNode) el.parentNode.removeChild(el);
        } catch(e){}
        playbackDom.el = null;
        playbackDom.bound = false;
    }

</script>
</body>

</html>
