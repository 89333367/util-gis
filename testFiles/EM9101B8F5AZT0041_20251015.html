<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>展示轮廓</title>
    <style>
        body {
            margin: 0;
            padding: 0;
        }

        #mapContainer {
            width: 100vw;
            height: 100vh;
            position: relative;
        }

        #mapLoading {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 999;
            transition: opacity 0.3s;
        }

        .loading-text {
            font-size: 16px;
            color: #333;
            padding: 10px 20px;
            background: white;
            border-radius: 4px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        .wkt-input-container {
            position: absolute;
            top: 20px;
            right: 10px;
            z-index: 1000;
            background: white;
            padding: 12px;
            border-radius: 6px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
            width: min(320px, 90vw);
            box-sizing: border-box;
            transition: all 0.3s;
        }

        .minimize-btn {
            position: absolute;
            top: -5px;
            right: -4px;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #f0f0f0;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            color: #666;
            z-index: 1001;
            transition: background 0.2s;
        }

        .minimize-btn:hover {
            background: #e0e0e0;
        }

        .content-wrapper {
            transition: all 0.3s;
        }

        .wkt-input-container.minimized {
            width: 40px;
            height: 40px;
            padding: 0;
        }

        .wkt-input-container.minimized .content-wrapper {
            display: none;
        }

        .wkt-input-container.minimized .min-icon {
            display: none;
        }

        .wkt-input-container.minimized .restore-icon {
            display: inline;
        }

        #wktTextarea {
            width: 100%;
            height: 120px;
            margin-bottom: 10px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-family: monospace;
            resize: vertical;
            box-sizing: border-box;
        }

        .button-group {
            display: flex;
            gap: 10px;
        }

        /* 页签样式 */
        .tabs-header {
            display: flex;
            gap: 8px;
            margin-bottom: 8px;
        }
        .tab-btn {
            flex: 1;
            padding: 6px 0;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 13px;
            background: #f5f5f5;
            color: #333;
            transition: background 0.2s;
        }
        .tab-btn.active { background: #337AFF; color: #fff; }
        .tab-pane { display: none; }
        .tab-pane.active { display: block; }

        /* Multi → Polygons 分割器样式 */
        .split-section {
            margin-top: 10px;
            padding: 10px;
            background: #fafafa;
            border: 1px solid #eee;
            border-radius: 6px;
        }
        .split-section .title {
            font-size: 13px;
            font-weight: 600;
            color: #333;
            margin-bottom: 6px;
        }
        .split-section .desc {
            font-size: 12px;
            color: #666;
            margin-bottom: 8px;
        }
        #multiInput, #polyOutput {
            width: 100%;
            height: 90px;
            margin-bottom: 8px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-family: monospace;
            resize: vertical;
            box-sizing: border-box;
        }
        .split-actions {
            display: flex;
            gap: 8px;
            margin-bottom: 8px;
        }
        .split-actions button {
            flex: 1;
            padding: 6px 0;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 13px;
            transition: background 0.2s;
        }
        #splitMultiBtn { background: #337AFF; color: #fff; }
        #splitMultiBtn:hover { background: #2860E0; }
        #copyPolysBtn { background: #f5f5f5; color: #333; }
        #copyPolysBtn:hover { background: #e0e0e0; }
        #drawButton,
        #clearButton,
        #drawTrackButton,
        #clearTrackButton {
            width: 50%;
            padding: 8px 0;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.2s;
        }

        #drawButton,
        #drawTrackButton {
            background: #337AFF;
            color: white;
        }

        #drawButton:hover,
        #drawTrackButton:hover {
            background: #2860E0;
        }

        #clearButton,
        #clearTrackButton {
            background: #f5f5f5;
            color: #333;
        }

        #clearButton:hover,
        #clearTrackButton:hover {
            background: #e0e0e0;
        }

        #drawButton:disabled,
        #clearButton:disabled,
        #drawTrackButton:disabled,
        #clearTrackButton:disabled {
            background: #e0e0e0;
            color: #999;
            cursor: not-allowed;
        }

        .tip {
            font-size: 12px;
            color: #666;
            margin-bottom: 8px;
            line-height: 1.4;
        }

        .area-label {
             position: absolute;
             background: rgba(255, 0, 0, 0.85);
             border: 1px solid #000;
             border-radius: 3px;
             padding: 4px 6px;
             font-size: 12px;
             color: #fff;
             font-weight: 600;
             box-shadow: 0 2px 6px rgba(0, 0, 0, 0.25);
             white-space: nowrap;
             z-index: 9999;
             pointer-events: none;
         }
         /* 默认隐藏标签容器下的标签 */
          .labels-hidden .area-label { display: none; }

          /* Batch → Generator 样式 */
          .batch-section { margin-top: 10px; padding: 10px; background: #fafafa; border: 1px solid #eee; border-radius: 6px; }
          .batch-section .title { font-size: 13px; font-weight: 600; color: #333; margin-bottom: 6px; }
          .batch-section .desc { font-size: 12px; color: #666; margin-bottom: 8px; }
          #batchInput, #multiOutput { width: 100%; height: 90px; margin-bottom: 8px; padding: 8px; border: 1px solid #ddd; border-radius: 4px; font-family: monospace; resize: vertical; box-sizing: border-box; }
          .batch-actions { display: flex; gap: 8px; margin-bottom: 8px; }
          .batch-actions button { flex: 1; padding: 6px 0; border: none; border-radius: 4px; cursor: pointer; font-size: 13px; transition: background 0.2s; }
          #generateMultiBtn { background: #337AFF; color: #fff; }
          #generateMultiBtn:hover { background: #2860E0; }
          #copyMultiBtn { background: #f5f5f5; color: #333; }
          #copyMultiBtn:hover { background: #e0e0e0; }
      </style>
    <script src="https://api.tianditu.gov.cn/api?v=4.0&tk=648f621977051d0199ff0f965d3fd322"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/Turf.js/6.5.0/turf.min.js"></script>
    <script src="https://lib.baomitu.com/terraformer/1.0.12/terraformer.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://unpkg.com/terraformer-wkt-parser@1.2.1/terraformer-wkt-parser.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <!-- 已移除动态备用加载器 ensureTerraformer：改为仅使用静态脚本标签加载 Terraformer 核心库与 WKT 解析器 -->
    <script>
        // 检查Turf.js是否加载成功
        window.addEventListener('load', function () {
            if (typeof turf === 'undefined') {
                console.warn('Turf.js加载失败，已启用备用面积算法');
            } else {
                console.log('Turf.js加载成功');
            }
        });
    </script>
</head>

<body>
<div id="mapContainer">
    <div id="mapLoading">
        <div class="loading-text">地图正在加载中...</div>
    </div>
</div>

<div class="wkt-input-container">
    <div class="minimize-btn" id="minimizeBtn">
        <span class="min-icon">−</span>
        <span class="restore-icon" style="display:none;">+</span>
    </div>

    <div class="content-wrapper">
        <div class="tabs-header">
            <button class="tab-btn active" id="tabDrawBtn">轮廓</button>
            <button class="tab-btn" id="tabTrackBtn">轨迹</button>
            <button class="tab-btn" id="tabSplitBtn">分割器</button>
            <button class="tab-btn" id="tabBatchBtn">合并器</button>
        </div>
        <div class="tab-pane active" id="tabDraw">
            <div class="tip">请输入WKT字符串（支持POLYGON/MULTIPOLYGON）：</div>
            <textarea id="wktTextarea">MULTIPOLYGON (((124.48584619212814 45.331048890846176, 124.48587638439803 45.331083850303, 124.48587810051967 45.33108548404455, 124.48589765846815 45.3311009552745, 124.48589176365086 45.33109640986708, 124.48588926451265 45.331094848175795, 124.48588635905067 45.331093687866115, 124.48588317469284 45.331092979827, 124.48587985109924 45.33109275511165, 124.48587653403612 45.33109302357567, 124.48587336898355 45.33109377344477, 124.48587049475472 45.33109497183108, 124.48585471014076 45.33110323996217, 124.48585433152466 45.33110283277089, 124.48585244335993 45.33110117004543, 124.48585014451159 45.33109978832445, 124.48584751748152 45.3310987371957, 124.48584465654962 45.33109805438248, 124.48584166439007 45.33109776438985, 124.48583864838665 45.33109787762517, 124.48583571677896 45.33109839002461, 124.48583297477744 45.33109928319899, 124.48583052078827 45.33110052509372, 124.48582844288107 45.331102071139206, 124.4858268156286 45.3311038658504, 124.48582569743047 45.331105844817976, 124.485825128417 45.33110793701999, 124.48581812840254 45.33115993701923, 124.48581813583984 45.33116211685179, 124.48581873937543 45.33116425471851, 124.48581991633132 45.33116627028869, 124.48582162248329 45.33116808782697, 124.4858237937225 45.33116963903907, 124.48582634846426 45.33117086563794, 124.48582919071367 45.331171721533934, 124.48583221367299 45.33117217456663, 124.48583530375384 45.33117220771322, 124.48583834484589 45.33117181972824, 124.48584122267975 45.331171025190265, 124.48584144317363 45.33117092610866, 124.48584205836397 45.331204146873006, 124.48584306598359 45.33122537749542, 124.48584348784078 45.33122759662492, 124.48584452463191 45.33122971281887, 124.4858461352565 45.331231642186964, 124.48584825586624 45.33123330824509, 124.48585080239577 45.33123464494724, 124.48585367389529 45.33123559930379, 124.48586496747757 45.33123842269968, 124.48586636477346 45.33123979412141, 124.48586584870937 45.331239783980415, 124.48586270860818 45.33124016966074, 124.48585974002813 45.33124098821538, 124.48585706161955 45.33124220692779, 124.48585478043482 45.33124377708768, 124.48585298764993 45.331245635937826, 124.48585175492013 45.331247709182485, 124.48585113151597 45.331249913956775, 124.48585114235443 45.33125216213882, 124.48585178700212 45.33125436387167, 124.48585423526846 45.33125987247445, 124.48584489338467 45.33127940549203, 124.48584418485596 45.33128157858029, 124.4858440981441 45.33128380755566, 124.48584463665844 45.331286004779706, 124.48584577922584 45.331288083862404, 124.48584748092316 45.33128996305873, 124.4858496748433 45.33129156848279, 124.48585227472623 45.331292837012796, 124.48585508786614 45.3312936912951, 124.48585094976426 45.331315623205874, 124.48584738615658 45.33131829591062, 124.48584542447583 45.33132010347353, 124.4858440190713 45.33132215265498, 124.48584322753162 45.33132435948685, 124.4858430822912 45.331326633541096, 124.48584606350013 45.331363898812114, 124.48584478004898 45.33136477739069, 124.48584294535543 45.331366691234706, 124.48584170387144 45.331368829147785, 124.48583170386549 45.33139282914653, 124.48583111600159 45.33139503302386, 124.48583115981319 45.33139727535593, 124.48583183355825 45.3313994669696, 124.48583311044324 45.33140152070864, 124.48583493968891 45.33140335489987, 124.48583724854981 45.33140489660103, 124.48583994520703 45.331406084501666, 124.48584292241983 45.33140687136128, 124.48584606179011 45.33140722588795, 124.48584923847123 45.331407133982886, 124.48585078415333 45.331406866321316, 124.48585189641288 45.33142000423026, 124.48585261888503 45.331447458454825, 124.48585232860945 45.331447563420866, 124.48584981295832 45.33144898783264, 124.48584775532652 45.331450740278235, 124.48584623995748 45.33145274900913, 124.48584532889353 45.331454931783945, 124.48584505943549 45.33145719923558, 124.48584544261563 45.33145945853013, 124.48584646274578 45.33146161716761, 124.48584807805977 45.33146358676916, 124.48585022242376 45.33146528669539, 124.48585296750406 45.331467062924496, 124.48585254889687 45.3314819233387, 124.485843274141 45.331497690411304, 124.48584236357858 45.33149980501467, 124.48584205692161 45.33150200439216, 124.48584236601415 45.331504203600026, 124.48584327891825 45.331506317701034, 124.48584476037631 45.33150826504495, 124.48584675317171 45.33150997042193, 124.48584918033924 45.33151136796736, 124.48585169297618 45.3315123082216, 124.48585106005733 45.33153477660895, 124.48585306032176 45.33160323323816, 124.48585314197408 45.331604160221524, 124.48586314195535 45.331672160223135, 124.48586379704221 45.33167438662965, 124.48586507371785 45.33167647457031, 124.48586691978413 45.331678338677484, 124.4858692597627 45.33167990273518, 124.48587199798116 45.331681102795294, 124.48587502248454 45.33168188979207, 124.485878209613 45.33168223154833, 124.48588142905714 45.33168211409101, 124.48588454918686 45.33168154222247, 124.48588744243224 45.33168053932418, 124.48588999049991 45.331679146400674, 124.4858920892094 45.3316774204031, 124.48589365275303 45.33167543190068, 124.48589461720357 45.3316732621954, 124.48589494312849 45.331670999997954, 124.48589494312515 45.33165899999798, 124.48589492108383 45.33165840888624, 124.48588992106511 45.331591408887164, 124.48588395875142 45.33152581212771, 124.48588453696424 45.331512513157, 124.48592648966606 45.33154997092262, 124.48592702291057 45.33155042227439, 124.48599814911222 45.33160752239148, 124.4860722205879 45.33166557804721, 124.48614722058619 45.3317235780549, 124.48621322239768 45.33177358030298, 124.48628411575419 45.33182949619863, 124.48635010218052 45.331881485514955, 124.4864130491694 45.33193144345068, 124.48646407984472 45.33197246780206, 124.48653207984266 45.33202646780912, 124.48655418011062 45.332043546828864, 124.48661007224062 45.33208746208079, 124.48665132778989 45.33212066019661, 124.48677522763461 45.332214584286625, 124.48685012948255 45.33227350708294, 124.48691518673819 45.33232255395925, 124.48698113584047 45.33237551209763, 124.48712105020178 45.3324854448276, 124.48719029147487 45.33254163263838, 124.48726629147356 45.33259963264611, 124.48726751839561 45.332600473594546, 124.48728051839606 45.33260847359572, 124.48728309815392 45.33260976705349, 124.48728598933606 45.33261067557646, 124.48728907799624 45.33261116335837, 124.48729224240573 45.33261121117492, 124.48729535784997 45.33261081714164, 124.48729830154461 45.33260999678792, 124.48730095747395 45.33260878244528, 124.48730322096368 45.332607221972815, 124.48730500280627 45.33260537687117, 124.48730623277638 45.33260331985872, 124.48730686239927 45.332601132005486, 124.48730686686038 45.332598899538176, 124.48730624598412 45.33259671044177, 124.48730502424016 45.332594650991936, 124.48728712395324 45.332571302816675, 124.48730893850579 45.33258069135143, 124.4873562220982 45.33261128661857, 124.48735868159049 45.332612593429644, 124.48736022420117 45.332613258870175, 124.48732540495018 45.332639281645264, 124.48732351302964 45.33264100288213, 124.4873221269953 45.33264294906642, 124.48732129883628 45.33264504719824, 124.48731829883305 45.332657047197884, 124.48731806072911 45.332659255886, 124.48731844105914 45.332661454645915, 124.48731942506679 45.33266355816705, 124.48732097457298 45.332665484834074, 124.4873230294581 45.332667159893454, 124.48732550999368 45.33266851835389, 124.48732831993662 45.33266950750791, 124.48733135026262 45.33267008897693, 124.48733448339698 45.332670240200315, 124.48733759777572 45.33266995531065, 124.48734057256301 45.3326692453615, 124.48738644438069 45.33265460541937, 124.48742625090672 45.332646838291915, 124.48742891679433 45.33264613199528, 124.48753491680844 45.33261013198873, 124.48753761649823 45.332608969488284, 124.48753993769073 45.332607453956314, 124.48766293768566 45.332509453943636, 124.48766473816836 45.332507706369185, 124.4876660316637 45.33250574820944, 124.48766677043731 45.33250365172747, 124.48766815494389 45.33249707532215, 124.48772573904486 45.33244868019, 124.48780406995945 45.332401327517104, 124.48800025755854 45.33232684890993, 124.48801786754956 45.33232533947548, 124.48819379681426 45.33239165834659, 124.4883945269086 45.33248617689898, 124.48842379652976 45.332550291369515, 124.48835315597555 45.332676569121865, 124.48826795561504 45.33279067645967, 124.48807638291643 45.33303712667747, 124.48784904991176 45.33327343329462, 124.48758957470949 45.33351394679679, 124.48739300424135 45.333676932337404, 124.48728898145254 45.33371290283072, 124.48728624592502 45.3337141046197, 124.48728390893771 45.3337156698636, 124.48728206597704 45.33371753460838, 124.48728079234434 45.33371962266273, 124.4872801400789 45.333721848711185, 124.48728013583144 45.33372412179998, 124.48728077977579 45.33372634905332, 124.48728204560109 45.333728439468196, 124.48728388158726 45.333730307632656, 124.48728621271796 45.33373187721561, 124.48728894374605 45.33373308408568, 124.48741741903618 45.33377780652323, 124.48741822064068 45.33377857841907, 124.48742077931168 45.33378017402301, 124.48766343873928 45.333901503774506, 124.48777435670847 45.33396186726555, 124.48780219546606 45.33398970603022, 124.48780406231126 45.33403731091902, 124.48780443911944 45.33403944970798, 124.48780538750819 45.334041498514566, 124.48780687264131 45.33404338208222, 124.48780883996727 45.33404503122396, 124.4878112172225 45.33404638536368, 124.48781391708576 45.33404739476125, 124.48781684038605 45.33404802233959, 124.48781987974506 45.33404824504656, 124.48797594250708 45.33404907518906, 124.48810873898407 45.3341128490426, 124.48812170152515 45.334120584737846, 124.48812254945331 45.33412105694004, 124.48825384088461 45.33418920468512, 124.48845371120542 45.33428814050129, 124.48882358337687 45.33447907452853, 124.48882627435691 45.33448019588, 124.4888292237998 45.3344809254094, 124.48883231836002 45.33448123508134, 124.48883543911539 45.3344811129953, 124.48883846613685 45.334480563842945, 124.48884128309759 45.33447960872794, 124.4888437817435 45.33447828435482, 124.48884586605288 45.33447664161852, 124.48884745592699 45.33447474364852, 124.48884849026773 45.334472663382755, 124.48884892932615 45.334470480764665, 124.48884875622956 45.33446827967107, 124.48884797762997 45.334466144688754, 124.48884662344857 45.33446415786388, 124.48884474572596 45.33446239554898, 124.48884241662185 45.33446092546882, 124.48859582256719 45.33433362990836, 124.48859617903639 45.3343333289451, 124.48859767640566 45.33433139391227, 124.48859860976881 45.33432929002384, 124.48859894325727 45.33432709813108, 124.48859866405533 45.33432490246721, 124.48859778289264 45.334322787410336, 124.48859633363176 45.334320834240906, 124.48859437196718 45.334319118018115, 124.48859197328446 45.3343177046954, 124.48812806344563 45.334094920179865, 124.48801829847937 45.33402941527034, 124.48801604030021 45.334028289242, 124.48801354021518 45.33402745537819, 124.48801087344347 45.334026938767096, 124.48800812021949 45.334026754951815, 124.48798587645427 45.334026636650016, 124.48790897334722 45.33398970474781, 124.48769501551702 45.33388972338047, 124.48768234228677 45.333883386793175, 124.4876484484969 45.33386494201278, 124.48746344851119 45.33376894202778, 124.48746105623148 45.333767915902634, 124.48744238723462 45.33376141721854, 124.48741367274121 45.33369824537183, 124.48745048169046 45.333679040697824, 124.48745338883693 45.3336770784488, 124.48756958510927 45.33357590403423, 124.48773072393412 45.333429776236216, 124.48789813183957 45.33327337731465, 124.48806213181815 45.33310537729622, 124.48806294707458 45.33310444860872, 124.48819095897562 45.332941433374124, 124.48835995893766 45.33272543335414, 124.48836083070954 45.332724127386655, 124.48838218304742 45.33268595781903, 124.48846410666437 45.33257624005722, 124.48846529722314 45.33257416897985, 124.48846588361161 45.332571972742336, 124.48846584267038 45.33256973808594, 124.48846517601653 45.33256755326937, 124.48845764609452 45.33255105918801, 124.48847383066426 45.3325221273727, 124.48847464929086 45.332520149856414, 124.48847494272421 45.33251810019053, 124.48847470111652 45.33251604716224, 124.48847393257641 45.33251405967157, 124.4884726628962 45.332512204419075, 124.4884709346867 45.33251054366741, 124.48836293468345 45.332424543678634, 124.48836107603057 45.33242328510401, 124.48835895422683 45.332422254132254, 124.48806095426198 45.332301254152384, 124.48805783199357 45.332300283530756, 124.48805448841229 45.33229980374042, 124.48805107665943 45.33229983675652, 124.48802401674091 45.33230215619605, 124.48801851492368 45.33230008220563, 124.48801561868376 45.33229923683909, 124.48801254392644 45.33229880748092, 124.48800940949481 45.33229881072624, 124.48800633653799 45.332299246449644, 124.48800344382919 45.332300097809934, 124.48799044085447 45.33230503414228, 124.48787607669321 45.332314836753184, 124.48787300147372 45.33231532159817, 124.4878000014858 45.33233232159483, 124.48779767721122 45.33233301095788, 124.48771267722188 45.33236401095236, 124.48771128369452 45.332364583972655, 124.487662418767 45.33238708756665, 124.48766209465583 45.332386893099915, 124.48758377142924 45.33232641568028, 124.48758147779637 45.33232495738458, 124.48758103418668 45.332324769992326, 124.48751882636758 45.33227745700237, 124.4874684566147 45.332237179535035, 124.48740978191547 45.33219441662494, 124.48736008694931 45.33215366675932, 124.4873086140767 45.33211329596876, 124.48725276381379 45.33207140827786, 124.4871999091322 45.332029523442436, 124.48714683181609 45.33198946023843, 124.48709490909664 45.33194752342732, 124.48704190909504 45.33190552343282, 124.4869876797834 45.33186534436278, 124.48693383708444 45.331823466714404, 124.48687786397352 45.331779487848486, 124.48682181377636 45.331737445799, 124.48673900566982 45.33167060071172, 124.48668091333042 45.33162452683549, 124.48662476965157 45.33158041442268, 124.4865677329197 45.331536386171805, 124.48650778549117 45.33149042648367, 124.48645283751272 45.331447467161695, 124.48639777492689 45.331405418237665, 124.48634283748727 45.331362467155124, 124.48629082733589 45.331323456029615, 124.48623803178387 45.331280621909464, 124.48618471150377 45.3312383698307, 124.48612969924159 45.331196360483865, 124.48606669924048 45.33114836049028, 124.48600672487319 45.33110337921498, 124.48594286418795 45.331053488062366, 124.48588089464289 45.33100451213943, 124.48587831473814 45.331002873582975, 124.485875293154 45.33100166777636, 124.48584229315907 45.330991667778086, 124.48583942066375 45.33099101650826, 124.4858364256521 45.33099075862947, 124.4858334153951 45.33099090337806, 124.48583049770969 45.33099144556965, 124.48582777709755 45.33099236578477, 124.48582535100151 45.330993631064516, 124.48582330631608 45.33099519609089, 124.48582171627494 45.330997004809994, 124.48582063782798 45.33099899243974, 124.48582051059745 45.33099949713335, 124.4858191089134 45.33099985935227, 124.48581649753277 45.33100097038419, 124.48581423384894 45.331002411811326, 124.48581240069066 45.3310041308916, 124.48581106513338 45.33100606472362, 124.48581027604557 45.331008142548086, 124.48581006230002 45.331010288337076, 124.4858120622846 45.33106528833755, 124.48581246618056 45.331067531249666, 124.48581349799805 45.33106967184141, 124.48581511602829 45.331071623583924, 124.48581725486576 45.33107330758214, 124.4858198280525 45.33107465576402, 124.48582273157308 45.33107561363217, 124.4858258480587 45.33107614246677, 124.485829051532 45.331076220890814, 124.48583221249936 45.33107584573418, 124.48583520318539 45.33107503216177, 124.48583790269794 45.33107381306054, 124.4858402019148 45.33107223771009, 124.48584200789524 45.33107036979059, 124.48584324763628 45.331068284808765, 124.48584387102416 45.33106606704554, 124.48584619212814 45.331048890846176), (124.4858603485307 45.33102205101132, 124.48591916646534 45.331068535883645, 124.48598316646375 45.33111853589025, 124.4860433404184 45.33116366975855, 124.48616119200013 45.33125355657186, 124.48621402925127 45.33129542760767, 124.48626696821277 45.33133837809297, 124.48631927307278 45.33137761928078, 124.48637416250992 45.33142053284746, 124.48642922505904 45.33146258175606, 124.48648424913438 45.331505600037715, 124.4866011922807 45.33159555631798, 124.48665711131596 45.33163949270971, 124.48671504026613 45.33168543636722, 124.48679799432584 45.33175239929386, 124.48685425944822 45.331794609123854, 124.48691013602362 45.3318385121542, 124.48696418994015 45.331880554309336, 124.48701826911032 45.33192061778484, 124.48707104081373 45.33196243687703, 124.4871229912645 45.33200439686347, 124.48717621961295 45.33204457858022, 124.48722938592248 45.33208670402255, 124.48728526419202 45.332128612730955, 124.48733602775657 45.33216842729763, 124.48738591304728 45.33220933324282, 124.48738654338413 45.332209820456086, 124.48744528591138 45.332252632812704, 124.48749530993962 45.33229264666607, 124.48751060865432 45.33230428232262, 124.48750981240558 45.33230557888477, 124.4875091527865 45.33230776724844, 124.48750912042166 45.332310004406075, 124.48750971659244 45.332312201807966, 124.48751091770147 45.33231427247791, 124.48752533417513 45.332333428650934, 124.48748086413072 45.3322984878897, 124.48741279226502 45.332246431432104, 124.48734256463652 45.33219125904448, 124.48726870475409 45.33213636319406, 124.48712184105388 45.332021469840825, 124.48705392870349 45.331968538135634, 124.48698471348591 45.33191237124232, 124.48691271348464 45.331857371249654, 124.4868418648862 45.33180348636932, 124.48677303367111 45.33174762336327, 124.48670378701931 45.33169342783332, 124.48657078701632 45.33159042784697, 124.4865067736072 45.33154141731838, 124.48643858820186 45.33148827669981, 124.48636777693946 45.331435417596374, 124.48630282109006 45.331383454351695, 124.48623484251223 45.331330471056695, 124.48616486382421 45.33127548781052, 124.48610178687954 45.33122642779736, 124.4859688435067 45.33112347166749, 124.48590286267059 45.331071277880966, 124.4858603485307 45.33102205101132), (124.48760053363486 45.33238538203444, 124.48759701076254 45.332369985784794, 124.48763532075411 45.33239956690306, 124.48763528370138 45.3323995839668, 124.48763244133178 45.33240125458183, 124.48762897747558 45.332403826995105, 124.48762683242582 45.332403978804635, 124.48762379113147 45.33240464239948, 124.4876209973865 45.3324057189549, 124.4876185625783 45.332407165548354, 124.48761658378352 45.3324089245037, 124.48761513989717 45.33241092569093, 124.48761428848763 45.33241308932208, 124.4876137967815 45.33241510084779, 124.48760827244668 45.33241920346082, 124.4876073240337 45.33241505855313, 124.48760843193931 45.33241450401003, 124.48761054307776 45.33241294175213, 124.4876121922069 45.332411123803105, 124.487613318583 45.3324091171249, 124.48761388071755 45.33240699563119, 124.48761385790489 45.33240483746457, 124.4876132509854 45.33240272211856, 124.48761208231439 45.33240072750936, 124.48760053363486 45.33238538203444), (124.48738339491273 45.33370530348439, 124.48740260676983 45.33374756960998, 124.48733212144113 45.333723033565064, 124.48738339491273 45.33370530348439), (124.48791335698097 45.3323342975228, 124.48778744385518 45.33238209779544, 124.48778462472457 45.33238346157482, 124.48775003213358 45.33240437353054, 124.48774799670285 45.33240395505738, 124.48774499998947 45.33240375462838, 124.48768621523226 45.332403754642705, 124.48768588780581 45.33240313969098, 124.48772804012121 45.332383727427974, 124.48781119941867 45.332353398741624, 124.48788149505181 45.332337028525316, 124.48791335698097 45.3323342975228), (124.48748255000702 45.33233348038005, 124.48741978258127 45.33228542407591, 124.48739217334669 45.332263834948144, 124.48745720771625 45.33231356855952, 124.48748255000702 45.33233348038005), (124.48737522016825 45.33225057834534, 124.4873138417103 45.332202583151066, 124.48731928338424 45.332206627996165, 124.48737522016825 45.33225057834534), (124.48700533793685 45.33196338652047, 124.48695675824845 45.3319264052874, 124.4868888528634 45.331873479039665, 124.48684877212402 45.33184186608639, 124.4869611293493 45.331927508968775, 124.48700533793685 45.33196338652047), (124.48629906135935 45.331414449963276, 124.48625882933644 45.33138346041646, 124.48619186713594 45.331330490404554, 124.48613270239353 45.331283974762236, 124.48614117189265 45.33129054025089, 124.48621113617241 45.33134551219362, 124.48627910961396 45.33139849163628, 124.48629906135935 45.331414449963276), (124.48588947622105 45.331140629903736, 124.48588956257865 45.33114044184809, 124.48588993572142 45.33113833927273, 124.48588974304306 45.331136224651, 124.485888991385 45.33113417306564, 124.48588770743594 45.33113225736119, 124.48588593678437 45.33113054555755, 124.48588374229998 45.33112909843475, 124.4858812019011 45.331127967375046, 124.48587596232835 45.33112609609944, 124.48587222688762 45.3311220787384, 124.48587795056444 45.33111908062211, 124.48595121318158 45.331175572276706, 124.48602315576782 45.331231527630294, 124.48608914227358 45.33128351697501, 124.48616812130788 45.33134550053065, 124.4862352419256 45.33139859447267, 124.48630924192406 45.33145559448023, 124.4863812324528 45.33151058739602, 124.48644926876173 45.33156361511731, 124.48658621259025 45.33166857208229, 124.48665523377474 45.331722588239366, 124.48672509815795 45.33177648362913, 124.48679411573971 45.33183249618586, 124.48686511573776 45.331888496193194, 124.48693317874591 45.3319415456034, 124.48700019139336 45.33199255638617, 124.48706807983812 45.33204646780672, 124.48713025906581 45.33209261014221, 124.48719807980815 45.332146467798935, 124.48726320270454 45.332196564428536, 124.48733215689629 45.332250528587096, 124.48739616610972 45.332300535799114, 124.4874335133871 45.33232913031702, 124.48743230043834 45.33232957627378, 124.48742989565903 45.33233093068817, 124.48742790459288 45.33233258574004, 124.48742640142096 45.33233447976734, 124.48742544214676 45.33233654220448, 124.4874250625099 45.33233869621147, 124.4874252766545 45.332340861536686, 124.48742580257976 45.332342239530995, 124.48741083934692 45.33233046845676, 124.48733283934494 45.3322694684648, 124.48726381144088 45.332216446373465, 124.48719787864198 45.332164499327995, 124.4871386899974 45.332119353307114, 124.48706773954147 45.332065390996775, 124.48699684658658 45.3320104739275, 124.48692490388508 45.33195351929787, 124.48685584301624 45.33189947139504, 124.48678784993604 45.33184747559364, 124.48671688919491 45.331790507710195, 124.48664088919274 45.33173050771806, 124.48656881001477 45.33167444568282, 124.48649667009389 45.331620338053604, 124.48643279149266 45.331571431007035, 124.48636785648405 45.33152048200826, 124.48632768651002 45.331490350384875, 124.48625385943366 45.331433483591624, 124.48617895867645 45.33137356299542, 124.48610682638791 45.33131745847293, 124.48603784282574 45.33126347134586, 124.48597092942842 45.33121253569608, 124.48593307655085 45.33118108871255, 124.48589441746154 45.33114594406392, 124.48588947622105 45.331140629903736), (124.48754517645675 45.33241325789263, 124.48757991128684 45.33243641444537, 124.48758066451039 45.33243970631079, 124.48756598772877 45.332450605916236, 124.48756237090845 45.332453529103205, 124.48754517645675 45.33241325789263), (124.48598270106119 45.33125457874761, 124.48601423091317 45.33127858636107, 124.4860831900906 45.33133255434166, 124.48611982360367 45.33136104709829, 124.4860607751182 45.33131541868466, 124.48599281013516 45.331263445246144, 124.48598188072796 45.33125479960662, 124.48598270106119 45.33125457874761), (124.48590831494272 45.33119526732992, 124.48592330355588 45.33120889334001, 124.48592092088391 45.331207869444725, 124.48591798687544 45.331207111913926, 124.48591489974974 45.331206772543744, 124.48591177806897 45.331206864367765, 124.48590874172208 45.33120738385949, 124.48590590732117 45.33120831106768, 124.48590338372225 45.331209610382565, 124.48590126784497 45.331211231903566, 124.48589964095038 45.331213113355595, 124.48589856551997 45.33121518248089, 124.48589808285617 45.33121735981398, 124.48589821149562 45.33121956173363, 124.48589894649825 45.33122170367438, 124.48590025963591 45.331223703374214, 124.48590210047725 45.331225484033965, 124.48596910047533 45.33127848404091, 124.48603724614806 45.33133059780005, 124.48610821160777 45.33138557105192, 124.48614720905827 45.331415569196984, 124.48622015267372 45.33147252517961, 124.48636013610842 45.331582512181285, 124.48642823062455 45.3316335874833, 124.48649607994543 45.33168746783476, 124.48656429284398 45.331738634163266, 124.48663107357957 45.331790463995965, 124.4867011107751 45.33184749227104, 124.48677711077299 45.3319074922789, 124.48684822224187 45.331961579917554, 124.48691813597108 45.33201651214197, 124.48698617844188 45.33206754841025, 124.48704922464934 45.33211858125516, 124.4871152929588 45.332169633713015, 124.48725022443945 45.33227258145095, 124.48738815686433 45.33238052858287, 124.48741098096941 45.3323983179891, 124.48740953828103 45.332399183234315, 124.48740760714354 45.332400898917754, 124.48740618424183 45.33240284612674, 124.48740532357255 45.33240495096807, 124.48740505779669 45.332407133566626, 124.48740539700002 45.33240931109656, 124.48740632831053 45.33241140092436, 124.48740947823772 45.33241662520249, 124.48738579598857 45.33239843447609, 124.487325903835 45.33235151896316, 124.48727595895566 45.332311563066106, 124.48722861412615 45.33227529598092, 124.48717676117232 45.33223640627137, 124.48712877536397 45.33219841873828, 124.48706281618219 45.33214745028754, 124.48699785665696 45.33209648205261, 124.48693267078681 45.332047338674656, 124.48686985088203 45.3319994758974, 124.48680288428285 45.33194550380898, 124.48673191137198 45.33188952518409, 124.48666793831643 45.3318385466636, 124.48660385619431 45.33178848170111, 124.48653764019572 45.33173631566001, 124.48646876916546 45.33168441286235, 124.48640689481982 45.33163551217762, 124.48634489481806 45.33158651218406, 124.48630556701414 45.33155726090336, 124.48629069124125 45.33154635161447, 124.48621988416126 45.33149050378544, 124.48615084287783 45.331436471359055, 124.4860827813687 45.33138442322965, 124.48601373605939 45.33133038860994, 124.48594138608254 45.33127488726703, 124.485887946538 45.33122243735447, 124.48588581256769 45.33122073604011, 124.48588323739612 45.33121937193251, 124.48588032610179 45.331218400693395, 124.4858745692046 45.33121696146942, 124.48587393950157 45.33120373778282, 124.4858732062316 45.331164141815755, 124.4858806684668 45.33117216723195, 124.48588184660038 45.33117327822463, 124.48590831494272 45.33119526732992), (124.48745457090662 45.33243229251235, 124.48745617859839 45.3324335455656, 124.48745682348968 45.332434019600626, 124.48752662787591 45.33248241731945, 124.48750010816818 45.332503851038666, 124.48745457090662 45.33243229251235), (124.48742244433996 45.332459837093765, 124.4874176462893 45.3324563185201, 124.48739610045357 45.332439601941445, 124.48742244433996 45.332459837093765), (124.48733308279466 45.33239075350033, 124.48729789630073 45.33236351233376, 124.48725039842842 45.33232518264012, 124.48725215504837 45.33232652813527, 124.48730215193636 45.33236652472254, 124.48733308279466 45.33239075350033), (124.48703699815104 45.33216083433606, 124.48702175901354 45.33214940466494, 124.48696825791451 45.332107084510135, 124.48697424954622 45.33211160127414, 124.48703699815104 45.33216083433606), (124.48679941892956 45.331976860973036, 124.48678087447087 45.33196249553481, 124.48672650833491 45.331919003051006, 124.48677905869657 45.3319604512151, 124.48679941892956 45.331976860973036), (124.4866955447276 45.331894478724834, 124.48664990853051 45.331858522924435, 124.48661783604413 45.33183296531737, 124.48664411367513 45.33185349476534, 124.4866955447276 45.331894478724834), (124.48613525110308 45.33145786306752, 124.48611077368774 45.33143941630667, 124.48609534649637 45.3314272034654, 124.48612721861376 45.33145157676303, 124.48613525110308 45.33145786306752), (124.485885059729 45.33130532649082, 124.48588629991438 45.331298753496355, 124.48593923390335 45.331339588280535, 124.48594066997545 45.33134056556822, 124.4859430876479 45.33134201617186, 124.48601516856428 45.33139753796537, 124.48608709628208 45.331454480751034, 124.48615623927532 45.33150659346862, 124.48622235984566 45.33155868434082, 124.4862912685149 45.33161061551971, 124.48635911916708 45.331663499124396, 124.48642806024628 45.33171845216741, 124.48649620048685 45.331770562949806, 124.4865620914845 45.33182247707732, 124.48662612144787 45.33187350069287, 124.48669208112851 45.331925468934415, 124.48675721141548 45.33197757099498, 124.4868282114139 45.33203257100226, 124.4868932489802 45.332082600008604, 124.48693119497351 45.33211155892662, 124.48699838589674 45.3321647040159, 124.48707031327243 45.33221864955569, 124.48714420521178 45.332275566328455, 124.487217081456 45.33233246970622, 124.48727420886254 45.33237856907887, 124.48734637392118 45.33243449706046, 124.48734240343664 45.332438106590615, 124.48734073984794 45.33243997091174, 124.4873396234569 45.33244202821159, 124.4873390971025 45.332444199546416, 124.48733918098209 45.332446401596656, 124.48733987187715 45.332448549864125, 124.48734114327648 45.33245056191438, 124.48734251821509 45.33245226606718, 124.48729388077373 45.33241450050358, 124.48721395897071 45.33235056307145, 124.48713575110015 45.33229040001691, 124.48705878692996 45.332231427448534, 124.48698986626283 45.33217748954358, 124.48691388930932 45.33211750774766, 124.48684156945475 45.33206126264479, 124.48675979580901 45.332000431039404, 124.48668687042039 45.331941492889804, 124.48661190645514 45.33188252124652, 124.48653294221519 45.331819549774195, 124.48645486425967 45.33175848802871, 124.48637888918381 45.33169850771521, 124.48630574383229 45.33164439163242, 124.48623194102001 45.33158554885889, 124.48615990375825 45.33152851926453, 124.48609983806666 45.33148246679133, 124.48602594097137 45.33142354884632, 124.4859542214495 45.331369751607085, 124.485887753622 45.331307252020146, 124.48588567359808 45.3313056466325, 124.485885059729 45.33130532649082), (124.48742538517992 45.332494434928236, 124.48745450910792 45.33251579544226, 124.48745599353046 45.33251675468677, 124.4874725172642 45.33252615054206, 124.48746827820048 45.33252957663587, 124.48744317609241 45.332542127687056, 124.48744489918082 45.33252583660429, 124.48744485848637 45.33252384118724, 124.4874443183658 45.3325218822643, 124.4874432958289 45.332520021527245, 124.48742538517992 45.332494434928236), (124.48739241149322 45.33252394428296, 124.48738032451219 45.33251606942492, 124.48730990880193 45.33246152205188, 124.48727655660535 45.33243449793856, 124.48735519872817 45.33249556123568, 124.48739241149322 45.33252394428296), (124.48723660207281 45.332402684706835, 124.48717684011288 45.33235646878463, 124.48712690817213 45.33231697074484, 124.48719014892801 45.332365523245784, 124.48723660207281 45.332402684706835), (124.48693376485478 45.332166956091655, 124.48690981992159 45.33214845317636, 124.48683986407023 45.3320934878732, 124.48680659458483 45.33206793256403, 124.48681830876473 45.33207664676046, 124.48689015011777 45.332132523377076, 124.48693376485478 45.332166956091655), (124.48657153446263 45.33188427342177, 124.48656290126628 45.3318775169845, 124.48651173992104 45.33183658914631, 124.48657153446263 45.33188427342177), (124.48642814325741 45.33177114930723, 124.48642084977836 45.33176547659495, 124.48635356616015 45.33171235796657, 124.48635528309403 45.33171362829184, 124.48642814325741 45.33177114930723), (124.48617528167992 45.33157450256384, 124.48609388141082 45.33151150091597, 124.4860832159642 45.331502938526796, 124.48613618090943 45.33154354776226, 124.48617528167992 45.33157450256384), (124.48600766971765 45.331442924545605, 124.48598481922332 45.33142552891599, 124.48600221984874 45.331438579373305, 124.48600766971765 45.331442924545605), (124.48591976992134 45.33137483730193, 124.48591711757031 45.331374136138514, 124.48591405968213 45.33137377948931, 124.48591096174503 45.33137384690112, 124.48590794084046 45.33137433582621, 124.48590511113854 45.33137522778648, 124.48590257958337 45.331376489071715, 124.48590044185092 45.33137807201373, 124.48590036601797 45.33137815612963, 124.48588053844507 45.3313692448552, 124.48587897970579 45.33133755065114, 124.4858791509042 45.33133664329901, 124.48591976992134 45.33137483730193), (124.48593402556737 45.3314199524649, 124.48599916225217 45.331469534126526, 124.48607002293292 45.33152642228779, 124.48614121618719 45.331581574628935, 124.48628721618394 45.331694574643876, 124.48632119506912 45.33172055879967, 124.48639711081049 45.331780492289106, 124.48646911498749 45.331836496007625, 124.48653904118528 45.3318924369748, 124.48660813630126 45.33194651242273, 124.48667911570274 45.33200249618494, 124.48674725676189 45.33205560598639, 124.48681619596886 45.332108559298476, 124.48688622462832 45.33216358124673, 124.4870182015839 45.33226556345539, 124.48708613922585 45.33231851486106, 124.48715322037724 45.33237157799257, 124.48722809563836 45.33242948153686, 124.48728621126594 45.33247657095672, 124.48735721126441 45.332531570964, 124.48735818199205 45.3325322605687, 124.48739951391968 45.3325591889612, 124.48737805999929 45.332570403509926, 124.48735043035711 45.33253994002946, 124.48734846905138 45.3325381885649, 124.48734605596627 45.33253674480205, 124.48734328615583 45.33253566561246, 124.4873402687265 45.332534993506684, 124.48733712253821 45.332534754959745, 124.48733540761611 45.33253486620796, 124.48728583543885 45.332496465215456, 124.48714894938558 45.332388555059325, 124.48708101611925 45.33233360904408, 124.48701180033316 45.33228043783037, 124.48694663762647 45.332229313650245, 124.4868698009133 45.332171436654335, 124.48680471354893 45.33211937125744, 124.4867327620708 45.33206440833116, 124.48666081011565 45.33200844570801, 124.48658983307483 45.33195346346819, 124.48644402555223 45.33183861509556, 124.48637167779887 45.33177834408983, 124.4862307591338 45.331671405828246, 124.4861528391485 45.33161046841334, 124.48607781509533 45.33155344846442, 124.48600398752315 45.33149458595009, 124.48593574380307 45.33143919975238, 124.48590630076811 45.331407491892314, 124.48593402556737 45.3314199524649), (124.4858869204761 45.33145661136943, 124.48588691466162 45.33145632900156, 124.48588424137063 45.33142478428987, 124.48590966297759 45.33145216139477, 124.48591096641906 45.33145337665846, 124.48593620917273 45.33147386330939, 124.48593411146403 45.33147293531559, 124.48593120194795 45.331472152222965, 124.48592813211344 45.33147178300955, 124.48592501908504 45.33147184176209, 124.48592198163527 45.331472326238966, 124.48591913565299 45.331473217955754, 124.48591879477068 45.331473387321644, 124.4858869204761 45.33145661136943), (124.48594688112709 45.33151619007892, 124.48598298413438 45.33154539102693, 124.48605013987093 45.331596517109574, 124.48611330927032 45.33164764606208, 124.48623021787634 45.331736576553645, 124.48629121460901 45.331784573439144, 124.4863531271111 45.331832505706316, 124.48641801025322 45.33188441222827, 124.48648097952598 45.33193538736233, 124.48654421354587 45.33198357318508, 124.48660516617566 45.33203153581018, 124.48666916617408 45.332081535816776, 124.486728210691 45.332126570961464, 124.48685012803342 45.332222505934446, 124.4869712023887 45.3323155642365, 124.48703104766727 45.33236244304547, 124.48708511060869 45.33240649222985, 124.48714211060714 45.332451492235755, 124.48719610704666 45.33249249265604, 124.4872407618078 45.332529173366936, 124.48723795541116 45.332529911905155, 124.48723524038766 45.33253110775069, 124.48723291875169 45.332532662022444, 124.48723108408309 45.33253451207129, 124.48722981033336 45.33253658332601, 124.4872293052166 45.33253827011008, 124.4872138739839 45.33252649363095, 124.48714503388977 45.33247062341881, 124.4870788511182 45.33241847765717, 124.48700491534342 45.33236052800513, 124.48693897870578 45.332307578895566, 124.48687375756978 45.33225840406312, 124.48679887051395 45.332199492921724, 124.48673667220304 45.33215233978912, 124.48667483403476 45.33210546247513, 124.48663386405131 45.33207248786092, 124.48657786404976 45.332028487866715, 124.48655584828406 45.3320114751132, 124.48648795237104 45.33195755777913, 124.48643691703589 45.331916529726215, 124.48637388149861 45.33186650162489, 124.48623688149483 45.33175850163906, 124.48617072430994 45.33170837932966, 124.48609581528181 45.331650449690116, 124.48602191440858 45.33159252739327, 124.48595125207113 45.33153579848392, 124.48590414581662 45.33149373934352, 124.48594646541417 45.331516012796826, 124.48594688112709 45.33151619007892), (124.48732034752874 45.33255684599515, 124.48727586116243 45.33252348122084, 124.48724141647725 45.33249518738902, 124.48726221125531 45.33251157095413, 124.48732086249052 45.33255700502764, 124.48732034752874 45.33255684599515), (124.48719492039926 45.3324585534844, 124.48716578622103 45.33243642631092, 124.48710897259467 45.33239157345512, 124.4870548480491 45.33234747526379, 124.4870075431396 45.33231042021417, 124.48705711832903 45.332348499699094, 124.48712511556755 45.33240349614229, 124.48719492039926 45.3324585534844), (124.48697338380362 45.33228393669769, 124.4869337598749 45.33225340677728, 124.48687380305148 45.33220743983537, 124.48687130961625 45.33220547779058, 124.48692325162231 45.33224460292493, 124.48697338380362 45.33228393669769), (124.48678180193805 45.33213504554258, 124.4867808004987 45.33213425752479, 124.4867811622119 45.33213453383579, 124.48678180193805 45.33213504554258), (124.48650974134074 45.33192420197577, 124.48650486266526 45.33192048488607, 124.48649998409839 45.3319165355981, 124.48650974134074 45.33192420197577), (124.4863777702121 45.33181821215116, 124.48637695880963 45.33181756302849, 124.48631482880738 45.3317694601717, 124.48627531183718 45.331738366273676, 124.48627831011792 45.33174064672058, 124.48634807586991 45.331793469411146, 124.4863777702121 45.33181821215116), (124.48617765186835 45.33166345407462, 124.48613685349444 45.3316324775096, 124.48611461003186 45.3316144737369, 124.48612923690636 45.331625591063734, 124.48617765186835 45.33166345407462), (124.48753892210895 45.332506686216945, 124.48754864918823 45.33249882459539, 124.48754887643308 45.332499217334, 124.48755052697275 45.33250100428079, 124.48755262614614 45.332502539295426, 124.48755363238197 45.33250303904287, 124.48753892210895 45.332506686216945), (124.48757832725057 45.3324969163447, 124.48757865662637 45.33249612310728, 124.48757894335353 45.33249399999802, 124.48757894335324 45.33249299999802, 124.48757866040374 45.33249089079944, 124.48757782159969 45.332488856465424, 124.48757692546863 45.33248761736221, 124.48757322862589 45.33247895898503, 124.48758953579934 45.332465779179365, 124.48759150426449 45.332467033256115, 124.4875941398354 45.332468151123194, 124.48759703066379 45.33246889128073, 124.48760006918597 45.3324692261885, 124.4876005694296 45.33246921270988, 124.48759479549585 45.33249283330264, 124.48757832725057 45.3324969163447), (124.48763121898187 45.33247619840795, 124.48763486356451 45.33246128873816, 124.48763671514986 45.33246032698826, 124.48763888951679 45.332458618511524, 124.487640526628 45.332456634164686, 124.48764155824627 45.332454456658475, 124.48764194137195 45.33245217675484, 124.48764166003599 45.33244988948378, 124.48764072596495 45.33244769018239, 124.48763917809245 45.33244567052103, 124.48763876573798 45.33244532527832, 124.48764342970472 45.33242624537595, 124.48765083019974 45.33242624537854, 124.48764164001595 45.33246989870082, 124.48763121898187 45.33247619840795), (124.48767857722258 45.33244756946013, 124.48768306649289 45.33242624538426, 124.48771080528437 45.3324262453819, 124.48770299887123 45.33243280609506, 124.48767857722258 45.33244756946013), (124.48747251995749 45.33241274797151, 124.48727383597222 45.332257465829635, 124.48720571934902 45.33220537567849, 124.48713873509001 45.332154387624605, 124.48707289952719 45.332103514697565, 124.48704996603709 45.332084953985095, 124.48717421136932 45.332179571588284, 124.48724025670998 45.33223160597241, 124.48730920844044 45.332284568904015, 124.48738714503874 45.33234551933009, 124.48746210788653 45.332404490113014, 124.48747251995749 45.33241274797151), (124.48695933940985 45.33201458999529, 124.48694174061805 45.33200139089059, 124.48687186402563 45.3319464878622, 124.48680079060073 45.331892429856374, 124.486724970719 45.33183257206455, 124.4866550508036 45.33177563728574, 124.48658779864529 45.33172343684157, 124.48651976938984 45.33167241251791, 124.48647622718508 45.33163783490687, 124.48654528705787 45.33168962981634, 124.48661715022837 45.33174552340202, 124.48669306661249 45.33180545739898, 124.48676402283283 45.3318624222612, 124.48683221848059 45.331914576730995, 124.48690112644955 45.33196850471517, 124.48695933940985 45.33201458999529), (124.4864070465637 45.331584872698635, 124.48638374048966 45.33156739085821, 124.48632293074027 45.331519611785424, 124.48634426332427 45.331535611993395, 124.4864070465637 45.331584872698635), (124.4875279716684 45.33255133313538, 124.48746985439215 45.33258531693404, 124.48745813438036 45.33257198037297, 124.48748981094992 45.33254637880033, 124.4874907367216 45.332545915914274, 124.48749150245592 45.332546985242196, 124.48749331624813 45.332548651500964, 124.48749553777529 45.33255005074066, 124.48749808951172 45.33255113413118, 124.48750088240764 45.332551863864765, 124.48750381899781 45.332552214475456, 124.48750679680217 45.332552173727784, 124.48752918502879 45.33255038266986, 124.4875279716684 45.33255133313538), (124.48754576928046 45.33253739166976, 124.48754576413673 45.3325373185675, 124.48754497086244 45.332535132604235, 124.48754357482754 45.332533102351064, 124.48754163223946 45.332531309550575, 124.48753994592552 45.33253027215643, 124.4875616654258 45.332524887159025, 124.48755711313629 45.332528505642564, 124.48754576928046 45.33253739166976), (124.4874379345457 45.332591684277766, 124.4874434004095 45.3325979040541, 124.48743683918015 45.332602040482264, 124.4874379345457 45.332591684277766), (124.48738801942814 45.332625248973066, 124.48739119132033 45.33262661724012, 124.48739406295233 45.332629783394665, 124.48737767576378 45.3326329808929, 124.48738801942814 45.332625248973066), (124.48783198413422 45.33398070459144, 124.48789111003492 45.334008335293625, 124.48792858429728 45.33402633192599, 124.48783551210876 45.33402583683477, 124.48783393767596 45.33398568907733, 124.48783354828484 45.33398351086229, 124.4878325662597 45.33398142752255, 124.48783198413422 45.33398070459144)), ((124.48921791389078 45.33527463925907, 124.48926510073751 45.33536200394355, 124.48926659339794 45.33536408679583, 124.48938159338124 45.33549008680942, 124.48938226759694 45.33549076873923, 124.48952226758509 45.335621768754855, 124.48952344035456 45.33562274516509, 124.48972195428934 45.335770109683764, 124.49002895429423 45.33597810971311, 124.49002973598954 45.33597860543654, 124.49044773601003 45.33622660547353, 124.49044999409209 45.33622772499637, 124.49078699413157 45.33636572501928, 124.49104447688693 45.336462914894476, 124.49104736402819 45.33646375951735, 124.49105042932743 45.3364641906579, 124.49105355498665 45.33646419174763, 124.49105662088878 45.33646376274464, 124.4910595092125 45.33646292013532, 124.4910621089614 45.33646169630065, 124.49106432022835 45.33646013827197, 124.49106605803574 45.33645830592345, 124.4910672556006 45.336456269671245, 124.4910678669012 45.336454107767416, 124.49106786844571 45.336451903292684, 124.49106726017476 45.33644974096383, 124.49106606546405 45.33644770387788, 124.49106433022563 45.336445870318904, 124.49106212114371 45.336444310749535, 124.49105952311217 45.336443085103106, 124.49080276683868 45.33634617709765, 124.4904672039032 45.336208765578284, 124.49005066644821 45.335961633330186, 124.48974430858576 45.335754068419625, 124.48954718547715 45.335607719467276, 124.48940808739142 45.335477563427396, 124.4892943069831 45.33535289970895, 124.48924799713345 45.335267177260974, 124.4890870860321 45.33493536075913, 124.48908578952515 45.334933354883816, 124.48908396309466 45.33493156594711, 124.48908167692933 45.33493006269684, 124.48907901888528 45.33492890290205, 124.48907609110951 45.33492813113296, 124.48907300611481 45.334927777048236, 124.48906988245577 45.33492785425513, 124.48906684017277 45.334928359786616, 124.48906399617894 45.33492927421544, 124.48906145976736 45.334930562400636, 124.48905932841083 45.33493217483796, 124.48905768401623 45.334934049562406, 124.48905658977677 45.33493611452936, 124.48905608774344 45.33493829038334, 124.48905619720921 45.334940493507496, 124.48905691396753 45.334942639237, 124.48921791389078 45.33527463925907)), ((124.50057031979722 45.340532875418965, 124.50011611335204 45.340309772306426, 124.49983877913456 45.340182612251134, 124.49930703160551 45.3399317313849, 124.49887123931255 45.339714834777325, 124.49857628433946 45.339565857530765, 124.4985735768805 45.3395647558029, 124.49857061667579 45.33956404775369, 124.49856751748443 45.339563760593045, 124.49856439840656 45.33956390535637, 124.49856137930627 45.33956447648051, 124.49855857620614 45.339565452017524, 124.49855609682744 45.339566794478046, 124.4985540364515 45.339568452272125, 124.4985524742573 45.33957036169166, 124.4985514702791 45.339572449358776, 124.4985510630994 45.3395746350456, 124.4985512683658 45.33957683475742, 124.49855207819019 45.33957896396054, 124.49855346145151 45.339580940830864, 124.49855536499193 45.33958268939836, 124.4985577156593 45.339584142466535, 124.49885280591761 45.33973318773209, 124.49928913363637 45.339950346575655, 124.49982113368698 45.34020134661594, 124.50009809547183 45.340328330264356, 124.5003269756341 45.34044075423716, 124.50032642251323 45.34044144280348, 124.50032544194762 45.34044353600027, 124.5003250592691 45.34044572388719, 124.50032528918405 45.340447922384975, 124.50032612285695 45.34045004700658, 124.50032752825021 45.340452016103974, 124.50032945135551 45.34045375400584, 124.50033181826899 45.34045519392554, 124.50093581832074 45.34075519397301, 124.50122484151079 45.3408982054797, 124.50122577716016 45.340898634786384, 124.50136427354259 45.34095742102431, 124.50174279362648 45.34114618171155, 124.50174382383184 45.34114665453341, 124.50214951943462 45.341317526336496, 124.50260522341826 45.34152938872723, 124.50260682204073 45.341530041556936, 124.5027980547713 45.34159801981554, 124.50279836484953 45.34160020906792, 124.50279927638684 45.341602317726554, 124.50280075374447 45.341604260457366, 124.50280274014854 45.34160596260228, 124.50280515926251 45.341607358748774, 124.50280791812132 45.341608395243725, 124.50291441720017 45.34163938339188, 124.50304350341773 45.34168526970672, 124.50332911488505 45.34177512559694, 124.50334277155669 45.341780023539066, 124.5033437729553 45.34178035241602, 124.50338357302168 45.34179225849341, 124.50366650350988 45.34188126974066, 124.50366856069401 45.34188180073829, 124.50416703636753 45.34198369356283, 124.50445963156999 45.34205914800451, 124.50440927998832 45.342110189299476, 124.50434416866864 45.342146146292094, 124.50434190827885 45.34214766900815, 124.50434011256695 45.34214947345006, 124.50433885054123 45.34215149027417, 124.50433817070062 45.34215364197507, 124.50433809917114 45.3421558458641, 124.50433863422208 45.34215799921904, 124.50431348869226 45.342173543703026, 124.50431135130692 45.34217515233341, 124.50430970000356 45.34217702411573, 124.50430859824102 45.342179087118474, 124.50430808835931 45.342181262061615, 124.50430818995305 45.34218346536332, 124.50430889911817 45.34218561235194, 124.5043101886018 45.34218762051987, 124.50431200884995 45.34218941269437, 124.5043142899114 45.342190920003105, 124.50431694412644 45.34219208452106, 124.50431986949481 45.342192861496414, 124.5043229535963 45.342193221070445, 124.50432607791065 45.34219314942492, 124.50432912237197 45.342192649313105, 124.50433196998331 45.34219173995407, 124.50433451131259 45.34219045629396, 124.50444451131594 45.34212245628387, 124.5044474286219 45.342120064284885, 124.50449456356873 45.34206815620332, 124.50451552363542 45.34207356133974, 124.50451843169193 45.342074098491075, 124.50452143102682 45.34207424119968, 124.50452441504284 45.34207398439372, 124.50452727768759 45.34207333720009, 124.50452991722189 45.34207232262021, 124.50453223983631 45.34207097671247, 124.50453416298454 45.34206934731073, 124.5045356183175 45.34206749232425, 124.5045365541125 45.342065477679675, 124.50453693711123 45.34206337497786, 124.50453675370187 45.34206125894924, 124.50452875369213 45.342025258950464, 124.50452794150952 45.34202307194183, 124.50452652543014 45.342021043695084, 124.50452456268826 45.342019256186695, 124.5045221326127 45.34201778166305, 124.50451933342087 45.34201667972056, 124.50451627824873 45.34201599489684, 124.50451309057853 45.342015754870694, 124.50450989924735 45.34201596934332, 124.50450683324043 45.34201662964634, 124.5045040164779 45.34201770909199, 124.50450156280587 45.34201916405195, 124.50449957139531 45.34202093572051, 124.5044911351952 45.34203022623213, 124.50446643091213 45.3420210503542, 124.50446457488948 45.34202046432574, 124.50431257491412 45.341980464332764, 124.50431117707237 45.341980147364026, 124.50370622626102 45.34186434820186, 124.50339629767139 45.34177163459587, 124.5033428487492 45.34175481920607, 124.5031202284744 45.34167497647294, 124.503119081832 45.34167460473878, 124.50292754219093 45.34161887259148, 124.50262200412534 45.34151025214909, 124.50216677662513 45.341298611304275, 124.50176070419919 45.34112756786337, 124.50138220640453 45.34093881831561, 124.50138122282326 45.34093836520132, 124.50124270132339 45.34087956830931, 124.50120288866837 45.340859868710204, 124.50120273899482 45.34085819540248, 124.50120193736073 45.34085606465685, 124.5012005616925 45.34085408514422, 124.50119866485609 45.340852332936144, 124.50119631974614 45.34085087536897, 124.50057031979722 45.340532875418965)))</textarea>
            <div class="coord-settings" style="margin-bottom:8px;font-size:12px;color:#333;">
                <label>WKT坐标系：
                    <select id="coordSysSelect" style="margin-left:6px;">
                        <option value="wgs84" selected>WGS84</option>
                        <option value="gcj02">GCJ-02（国测局）</option>
                        <option value="bd09">BD-09（百度）</option>
                        <option value="cgcs2000">CGCS2000</option>
                    </select>
                </label>
                <!-- 已移除“不进行绘制坐标转换”选项，统一使用WGS84绘制 -->
            </div>

            <div class="button-group">
                <button id="drawButton" disabled>绘制轮廓</button>
                <button id="clearButton" disabled>清空轮廓</button>
            </div>
            <!-- 显示开关：仅保留显示亩数 -->
            <div class="display-toggles" style="margin-top:8px;font-size:12px;color:#333;">
                <label><input type="checkbox" id="toggleLabelsCheckbox"> 显示亩数</label>
            </div>
        </div>

        <div class="tab-pane" id="tabSplit">
            <!-- MultiPolygon → 多个 Polygon 分割器 -->
            <div class="split-section">
                <div class="title">MultiPolygon → 多个 Polygon 分割器</div>
                <div class="desc">输入一个 MULTIPOLYGON WKT，分割为多行 POLYGON WKT。</div>
                <textarea id="multiInput"></textarea>
                <div class="split-actions">
                    <button id="splitMultiBtn">分割为多个 POLYGON</button>
                    <button id="copyPolysBtn">复制结果</button>
                </div>
                <textarea id="polyOutput" readonly></textarea>
            </div>
        </div>

        <div class="tab-pane" id="tabBatch">
            <!-- 批量POLYGON → MULTIPOLYGON 生成器 -->
            <div class="batch-section">
                <div class="title">批量POLYGON → MULTIPOLYGON 合并器</div>
                <div class="desc">每行一个 POLYGON WKT（或用分号分隔）。生成后可一键填充到上方并绘制。</div>
                <textarea id="batchInput"></textarea>
                <div class="batch-actions">
                    <button id="generateMultiBtn">生成 MULTIPOLYGON</button>
                    <button id="copyMultiBtn">复制结果</button>
                </div>
                <textarea id="multiOutput" readonly></textarea>
            </div>
        </div>
        <div class="tab-pane" id="tabTrack">
            <div class="tip">请粘贴轨迹文本（支持两种格式：1）每行一条：定位时间yyyyMMddHHmmss, 经度, 纬度；2）单行#分隔：经度,纬度,定位时间yyyyMMddHHmmss#经度,纬度,定位时间yyyyMMddHHmmss#…）。</div>
            <div class="coord-settings" style="margin-bottom:8px;font-size:12px;color:#333;">
                <label>轨迹坐标系：
                    <select id="trackCoordSysSelect" style="margin-left:6px;">
                        <option value="wgs84" selected>WGS84</option>
                        <option value="gcj02">GCJ-02（国测局）</option>
                        <option value="bd09">BD-09（百度）</option>
                        <option value="cgcs2000">CGCS2000</option>
                    </select>
                </label>
            </div>
            <textarea id="trackTextarea" style="width:100%;height:120px;margin-bottom:10px;padding:8px;border:1px solid #ddd;border-radius:4px;font-family:monospace;resize:vertical;box-sizing:border-box;">20251015095653,124.504354,45.342155,2.9,0
20251015095703,124.504421,45.342118,2.8,0
20251015095713,124.504494,45.342044,5.6,0
20251015095723,124.504459,45.342031,3.9,0
20251015095733,124.504307,45.341991,14.0,0
20251015095743,124.503701,45.341875,19.3,0
20251015095753,124.503401,45.341786,0.0,0
20251015095803,124.503350,45.341770,2.3,0
20251015095813,124.503113,45.341685,5.3,0
20251015095823,124.502814,45.341598,14.1,0
20251015095833,124.502274,45.341354,22.4,0
20251015095843,124.501753,45.341134,19.7,0
20251015095853,124.501187,45.340860,22.1,0
20251015095903,124.500561,45.340542,19.0,0
20251015095913,124.500107,45.340319,13.2,0
20251015095923,124.499830,45.340192,9.5,0
20251015095933,124.499298,45.339941,18.3,0
20251015095943,124.498862,45.339724,10.0,0
20251015095953,124.498567,45.339575,10.0,0
20251015100003,124.497980,45.339306,23.7,0
20251015100013,124.497170,45.338902,26.5,0
20251015100023,124.496631,45.338580,4.4,0
20251015100033,124.496358,45.338409,22.5,0
20251015100043,124.495598,45.338059,24.5,0
20251015100053,124.494821,45.337716,26.8,0
20251015100103,124.493822,45.337369,33.1,0
20251015100113,124.492812,45.337082,27.2,0
20251015100123,124.492024,45.336793,18.1,0
20251015100133,124.491306,45.336556,16.8,0
20251015100143,124.491041,45.336470,8.9,0
20251015100153,124.490423,45.336204,27.3,0
20251015100203,124.489772,45.335783,22.2,0
20251015100213,124.489356,45.335433,24.9,0
20251015100223,124.488979,45.334728,27.4,0
20251015100233,124.488583,45.334327,24.6,0
20251015100243,124.487900,45.333999,14.7,0
20251015100253,124.487686,45.333899,8.1,0
20251015100303,124.487430,45.333771,9.0,0
20251015100313,124.487395,45.333694,0.1,0
20251015100323,124.487441,45.333670,5.3,0
20251015100333,124.487557,45.333569,6.5,0
20251015100343,124.487718,45.333423,7.5,0
20251015100353,124.487885,45.333267,8.8,0
20251015100403,124.488049,45.333099,8.5,0
20251015100413,124.488177,45.332936,4.3,0
20251015100423,124.488346,45.332720,12.2,0
20251015100433,124.488459,45.332518,4.4,0
20251015100443,124.488351,45.332432,8.8,0
20251015100453,124.488053,45.332311,8.1,0
20251015100503,124.487878,45.332326,3.0,0
20251015100513,124.487805,45.332343,0.6,0
20251015100523,124.487745,45.332363,0.0,0
20251015100533,124.487720,45.332374,1.7,0
20251015100543,124.487644,45.332409,2.5,0
20251015100553,124.487578,45.332458,2.9,0
20251015100603,124.487505,45.332517,3.1,0
20251015100613,124.487432,45.332576,3.2,0
20251015100623,124.487337,45.332647,1.5,0
20251015100633,124.487334,45.332659,4.3,0
20251015100643,124.487381,45.332644,0.3,0
20251015100653,124.487422,45.332636,2.9,0
20251015100703,124.487528,45.332600,3.5,0
20251015100713,124.487651,45.332502,5.6,0
20251015100723,124.487671,45.332407,2.1,0
20251015100733,124.487651,45.332395,3.4,0
20251015100743,124.487572,45.332334,3.2,0
20251015100753,124.487578,45.332339,0.5,0
20251015100803,124.487507,45.332285,2.7,0
20251015100813,124.487457,45.332245,2.3,0
20251015100823,124.487398,45.332202,2.5,0
20251015100833,124.487348,45.332161,2.3,0
20251015100843,124.487297,45.332121,2.2,0
20251015100853,124.487241,45.332079,2.2,0
20251015100903,124.487188,45.332037,2.2,0
20251015100913,124.487135,45.331997,2.1,0
20251015100923,124.487083,45.331955,2.2,0
20251015100933,124.487030,45.331913,2.3,0
20251015100943,124.486976,45.331873,2.1,0
20251015100953,124.486922,45.331831,2.1,0
20251015101003,124.486866,45.331787,2.6,0
20251015101013,124.486810,45.331745,2.5,0
20251015101023,124.486762,45.331705,0.0,0
20251015101033,124.486763,45.331705,0.0,0
20251015101043,124.486727,45.331678,2.0,0
20251015101053,124.486669,45.331632,2.5,0
20251015101103,124.486613,45.331588,2.2,0
20251015101113,124.486556,45.331544,2.2,0
20251015101123,124.486496,45.331498,2.2,0
20251015101133,124.486441,45.331455,2.3,0
20251015101143,124.486386,45.331413,2.2,0
20251015101153,124.486331,45.331370,2.4,0
20251015101203,124.486279,45.331331,2.2,0
20251015101213,124.486226,45.331288,2.2,0
20251015101223,124.486173,45.331246,2.0,0
20251015101233,124.486118,45.331204,2.4,0
20251015101243,124.486055,45.331156,2.9,0
20251015101253,124.485995,45.331111,2.3,0
20251015101303,124.485931,45.331061,2.7,0
20251015101313,124.485869,45.331012,2.0,0
20251015101323,124.485925,45.331057,0.0,0
20251015101333,124.485924,45.331056,0.0,0
20251015101343,124.485924,45.331056,0.0,0
20251015101353,124.485924,45.331056,0.0,0
20251015101403,124.485924,45.331056,0.0,0
20251015101413,124.485924,45.331056,0.0,0
20251015101423,124.485836,45.331002,0.3,0
20251015101433,124.485833,45.331028,3.1,0
20251015101443,124.485828,45.331065,3.5,0
20251015101453,124.485826,45.331010,2.1,0
20251015101503,124.485832,45.331024,3.0,0
20251015101513,124.485833,45.331012,4.3,0
20251015101523,124.485890,45.331078,2.4,0
20251015101533,124.485957,45.331131,2.6,0
20251015101543,124.486024,45.331183,3.0,0
20251015101553,124.486090,45.331234,2.5,0
20251015101603,124.486153,45.331283,2.8,0
20251015101613,124.486223,45.331338,2.8,0
20251015101623,124.486291,45.331391,2.8,0
20251015101633,124.486356,45.331443,2.5,0
20251015101643,124.486427,45.331496,2.9,0
20251015101653,124.486495,45.331549,2.5,0
20251015101703,124.486559,45.331598,2.9,0
20251015101713,124.486626,45.331650,2.5,0
20251015101723,124.486692,45.331701,2.8,0
20251015101733,124.486761,45.331755,2.8,0
20251015101743,124.486830,45.331811,2.7,0
20251015101753,124.486901,45.331865,3.1,0
20251015101803,124.486973,45.331920,2.9,0
20251015101813,124.487042,45.331976,2.9,0
20251015101823,124.487110,45.332029,2.9,0
20251015101833,124.487184,45.332087,3.1,0
20251015101843,124.487257,45.332144,2.9,0
20251015101853,124.487331,45.332199,3.1,0
20251015101903,124.487401,45.332254,2.8,0
20251015101913,124.487469,45.332306,2.8,0
20251015101923,124.487539,45.332361,2.8,0
20251015101933,124.487598,45.332406,3.2,0
20251015101943,124.487525,45.332309,4.2,0
20251015101953,124.487475,45.332267,0.0,0
20251015102003,124.487477,45.332268,0.0,0
20251015102013,124.487477,45.332268,0.0,0
20251015102023,124.487477,45.332268,0.0,0
20251015102033,124.487574,45.332340,8.8,0
20251015102043,124.487601,45.332458,4.0,0
20251015102053,124.487626,45.332452,2.6,0
20251015102103,124.487613,45.332441,0.0,0
20251015102113,124.487613,45.332441,0.0,0
20251015102123,124.487613,45.332441,0.0,0
20251015102133,124.487604,45.332437,1.8,0
20251015102143,124.487535,45.332391,2.3,0
20251015102153,124.487472,45.332342,2.2,0
20251015102203,124.487408,45.332293,2.7,0
20251015102213,124.487344,45.332243,2.8,0
20251015102223,124.487275,45.332189,2.8,0
20251015102233,124.487210,45.332139,2.9,0
20251015102243,124.487142,45.332085,3.0,0
20251015102253,124.487080,45.332039,2.6,0
20251015102303,124.487012,45.331985,2.9,0
20251015102313,124.486945,45.331934,2.5,0
20251015102323,124.486877,45.331881,2.8,0
20251015102333,124.486806,45.331825,2.8,0
20251015102343,124.486737,45.331769,2.9,0
20251015102353,124.486667,45.331715,3.0,0
20251015102403,124.486598,45.331661,2.8,0
20251015102413,124.486529,45.331608,2.8,0
20251015102423,124.486461,45.331556,3.0,0
20251015102433,124.486393,45.331503,3.2,0
20251015102443,124.486321,45.331448,3.1,0
20251015102453,124.486247,45.331391,2.9,0
20251015102503,124.486180,45.331338,2.8,0
20251015102513,124.486101,45.331276,2.8,0
20251015102523,124.486035,45.331224,2.5,0
20251015102533,124.485963,45.331168,3.3,0
20251015102543,124.485880,45.331104,3.1,0
20251015102553,124.485977,45.331180,0.0,0
20251015102603,124.485977,45.331180,0.0,0
20251015102613,124.485977,45.331179,0.0,0
20251015102623,124.485977,45.331179,0.0,0
20251015102633,124.485977,45.331179,0.0,0
20251015102643,124.485859,45.331115,4.6,0
20251015102653,124.485854,45.331119,5.1,0
20251015102703,124.485834,45.331161,2.3,0
20251015102713,124.485841,45.331109,1.1,0
20251015102723,124.485894,45.331166,2.9,0
20251015102733,124.485959,45.331220,2.5,0
20251015102743,124.486026,45.331271,2.7,0
20251015102753,124.486095,45.331325,2.8,0
20251015102803,124.486167,45.331381,3.0,0
20251015102813,124.486242,45.331441,3.0,0
20251015102823,124.486316,45.331498,3.1,0
20251015102833,124.486356,45.331528,2.7,0
20251015102843,124.486421,45.331579,2.6,0
20251015102853,124.486485,45.331628,2.5,0
20251015102903,124.486557,45.331682,3.2,0
20251015102913,124.486629,45.331738,3.1,0
20251015102923,124.486705,45.331798,3.1,0
20251015102933,124.486776,45.331855,2.6,0
20251015102943,124.486844,45.331907,2.6,0
20251015102953,124.486913,45.331961,2.8,0
20251015103003,124.486985,45.332018,3.1,0
20251015103013,124.487056,45.332073,2.9,0
20251015103023,124.487127,45.332127,2.7,0
20251015103033,124.487186,45.332172,2.9,0
20251015103043,124.487252,45.332224,2.8,0
20251015103053,124.487321,45.332277,2.8,0
20251015103103,124.487399,45.332338,3.2,0
20251015103113,124.487474,45.332397,3.1,0
20251015103123,124.487532,45.332443,5.4,0
20251015103133,124.487441,45.332339,2.6,0
20251015103143,124.487452,45.332346,0.0,0
20251015103153,124.487452,45.332346,0.0,0
20251015103203,124.487452,45.332346,0.0,0
20251015103213,124.487452,45.332346,0.0,0
20251015103223,124.487454,45.332348,0.1,0
20251015103233,124.487525,45.332405,3.1,0
20251015103243,124.487563,45.332494,5.0,0
20251015103253,124.487563,45.332493,2.8,0
20251015103303,124.487573,45.332488,0.0,0
20251015103313,124.487573,45.332488,0.0,0
20251015103323,124.487573,45.332488,0.0,0
20251015103333,124.487543,45.332478,1.9,0
20251015103343,124.487468,45.332426,3.1,0
20251015103353,124.487400,45.332373,2.8,0
20251015103403,124.487331,45.332319,3.0,0
20251015103413,124.487262,45.332265,2.8,0
20251015103423,124.487194,45.332213,2.8,0
20251015103433,124.487127,45.332162,2.8,0
20251015103443,124.487061,45.332111,2.6,0
20251015103453,124.486998,45.332060,2.4,0
20251015103503,124.486930,45.332009,2.4,0
20251015103513,124.486860,45.331954,3.0,0
20251015103523,124.486789,45.331900,3.0,0
20251015103533,124.486713,45.331840,3.1,0
20251015103543,124.486643,45.331783,2.9,0
20251015103553,124.486576,45.331731,2.9,0
20251015103603,124.486508,45.331680,2.6,0
20251015103613,124.486440,45.331626,2.7,0
20251015103623,124.486372,45.331575,2.7,0
20251015103633,124.486302,45.331520,3.0,0
20251015103643,124.486232,45.331465,2.9,0
20251015103653,124.486159,45.331408,3.0,0
20251015103703,124.486120,45.331378,3.1,0
20251015103713,124.486049,45.331323,2.9,0
20251015103723,124.485981,45.331271,2.8,0
20251015103733,124.485914,45.331218,3.2,0
20251015103743,124.485933,45.331233,5.7,0
20251015103753,124.485945,45.331242,0.0,0
20251015103803,124.485944,45.331242,0.0,0
20251015103813,124.485944,45.331241,0.0,0
20251015103823,124.485955,45.331250,5.4,0
20251015103833,124.485981,45.331243,5.7,0
20251015103843,124.485860,45.331133,4.2,0
20251015103853,124.485837,45.331130,0.0,0
20251015103903,124.485874,45.331138,0.5,0
20251015103913,124.485857,45.331150,2.9,0
20251015103923,124.485858,45.331204,2.4,0
20251015103933,124.485859,45.331225,3.3,0
20251015103943,124.485875,45.331229,2.7,0
20251015103953,124.485929,45.331282,2.8,0
20251015104003,124.486002,45.331338,2.8,0
20251015104013,124.486071,45.331392,2.9,0
20251015104023,124.486139,45.331444,2.8,0
20251015104033,124.486208,45.331498,3.0,0
20251015104043,124.486279,45.331554,2.9,0
20251015104053,124.486294,45.331565,3.6,0
20251015104103,124.486333,45.331594,2.3,0
20251015104113,124.486395,45.331643,2.6,0
20251015104123,124.486457,45.331692,3.0,0
20251015104133,124.486526,45.331744,2.9,0
20251015104143,124.486592,45.331796,2.8,0
20251015104153,124.486656,45.331846,2.6,0
20251015104203,124.486720,45.331897,2.7,0
20251015104213,124.486791,45.331953,3.0,0
20251015104223,124.486858,45.332007,2.8,0
20251015104233,124.486921,45.332055,2.2,0
20251015104243,124.486986,45.332104,2.7,0
20251015104253,124.487051,45.332155,2.8,0
20251015104303,124.487117,45.332206,2.3,0
20251015104313,124.487165,45.332244,1.9,0
20251015104323,124.487217,45.332283,2.3,0
20251015104333,124.487264,45.332319,1.9,0
20251015104343,124.487314,45.332359,2.3,0
20251015104353,124.487374,45.332406,2.9,0
20251015104403,124.487443,45.332459,2.8,0
20251015104413,124.487462,45.332475,4.8,0
20251015104423,124.487412,45.332399,0.0,0
20251015104433,124.487412,45.332399,0.0,0
20251015104443,124.487412,45.332399,0.0,0
20251015104453,124.487412,45.332399,0.0,0
20251015104503,124.487421,45.332407,3.8,0
20251015104513,124.487505,45.332539,5.1,0
20251015104523,124.487505,45.332541,2.4,0
20251015104533,124.487530,45.332539,0.1,0
20251015104543,124.487529,45.332539,0.0,0
20251015104553,124.487529,45.332539,0.0,0
20251015104603,124.487529,45.332539,0.0,0
20251015104613,124.487529,45.332539,0.0,0
20251015104623,124.487529,45.332539,0.0,0
20251015104633,124.487529,45.332539,0.0,0
20251015104643,124.487529,45.332539,0.0,0
20251015104653,124.487529,45.332539,0.0,0
20251015104703,124.487529,45.332539,0.0,0
20251015104713,124.487529,45.332539,0.0,0
20251015104723,124.487529,45.332539,0.0,0
20251015104733,124.487529,45.332539,0.0,0
20251015104743,124.487529,45.332539,0.0,0
20251015104753,124.487529,45.332539,0.0,0
20251015104803,124.487517,45.332537,2.3,0
20251015104813,124.487466,45.332508,2.0,0
20251015104823,124.487406,45.332464,2.1,0
20251015104833,124.487348,45.332419,2.5,0
20251015104843,124.487286,45.332371,2.1,0
20251015104853,124.487229,45.332325,3.1,0
20251015104902,124.487156,45.332268,3.0,0
20251015104912,124.487082,45.332211,2.7,0
20251015104922,124.487010,45.332157,2.8,0
20251015104932,124.486943,45.332104,2.8,0
20251015104942,124.486905,45.332075,2.6,0
20251015104952,124.486840,45.332025,2.8,0
20251015105002,124.486769,45.331970,2.8,0
20251015105012,124.486704,45.331918,2.9,0
20251015105022,124.486638,45.331866,2.5,0
20251015105032,124.486574,45.331815,2.4,0
20251015105042,124.486508,45.331763,2.5,0
20251015105052,124.486440,45.331711,3.1,0
20251015105102,124.486371,45.331656,2.9,0
20251015105112,124.486303,45.331603,2.9,0
20251015105122,124.486234,45.331551,2.9,0
20251015105132,124.486168,45.331499,2.7,0
20251015105142,124.486099,45.331447,2.7,0
20251015105152,124.486027,45.331390,3.3,0
20251015105202,124.485953,45.331333,3.0,0
20251015105212,124.485881,45.331278,3.3,0
20251015105222,124.485951,45.331332,5.6,0
20251015105232,124.485965,45.331343,0.0,0
20251015105242,124.485965,45.331343,0.0,0
20251015105252,124.485964,45.331342,0.0,0
20251015105302,124.485964,45.331342,0.0,0
20251015105312,124.485964,45.331342,0.0,0
20251015105322,124.485963,45.331341,0.0,0
20251015105332,124.485963,45.331341,0.0,0
20251015105342,124.485963,45.331341,0.0,0
20251015105352,124.485956,45.331335,0.1,0
20251015105402,124.485867,45.331251,3.3,0
20251015105412,124.485871,45.331260,3.4,0
20251015105422,124.485860,45.331283,2.7,0
20251015105432,124.485873,45.331284,2.7,0
20251015105442,124.485863,45.331337,2.4,0
20251015105452,124.485866,45.331398,2.6,0
20251015105502,124.485871,45.331457,2.9,0
20251015105512,124.485868,45.331526,2.4,0
20251015105522,124.485874,45.331592,3.1,0
20251015105532,124.485879,45.331659,2.3,0
20251015105542,124.485879,45.331671,1.5,0
20251015105552,124.485869,45.331603,3.1,0
20251015105602,124.485867,45.331535,5.3,0
20251015105612,124.485869,45.331464,3.8,0
20251015105622,124.485867,45.331388,3.3,0
20251015105632,124.485865,45.331401,1.3,0
20251015105642,124.485859,45.331326,3.9,0
20251015105652,124.485875,45.331314,3.0,0
20251015105702,124.485942,45.331377,2.4,0
20251015105712,124.486014,45.331431,3.1,0
20251015105722,124.486088,45.331490,2.6,0
20251015105732,124.486148,45.331536,2.5,0
20251015105742,124.486220,45.331593,3.2,0
20251015105752,124.486294,45.331652,3.0,0
20251015105802,124.486367,45.331706,3.0,0
20251015105812,124.486443,45.331766,3.3,0
20251015105822,124.486521,45.331827,3.5,0
20251015105832,124.486600,45.331890,3.4,0
20251015105842,124.486675,45.331949,3.4,0
20251015105852,124.486748,45.332008,2.9,0
20251015105902,124.486830,45.332069,3.1,0
20251015105912,124.486902,45.332125,2.7,0
20251015105922,124.486978,45.332185,3.3,0
20251015105932,124.487047,45.332239,2.9,0
20251015105942,124.487124,45.332298,3.5,0
20251015105952,124.487202,45.332358,3.6,0
20251015110002,124.487282,45.332422,3.4,0
20251015110012,124.487367,45.332488,3.5,0
20251015110022,124.487426,45.332533,4.0,0
20251015110032,124.487355,45.332445,0.1,0
20251015110042,124.487357,45.332446,0.0,0
20251015110052,124.487357,45.332446,0.0,0
20251015110102,124.487357,45.332446,0.0,0
20251015110112,124.487357,45.332446,0.0,0
20251015110122,124.487357,45.332446,0.0,0
20251015110132,124.487358,45.332446,0.0,0
20251015110142,124.487366,45.332435,4.1,0
20251015110152,124.487429,45.332525,6.1,0
20251015110202,124.487418,45.332629,2.8,0
20251015110212,124.487464,45.332600,3.0,0
20251015110222,124.487495,45.332587,0.0,0
20251015110232,124.487495,45.332586,0.0,0
20251015110242,124.487495,45.332586,0.0,0
20251015110252,124.487495,45.332586,0.0,0
20251015110302,124.487435,45.332567,1.9,0
20251015110312,124.487369,45.332524,3.0,0
20251015110322,124.487298,45.332469,3.2,0
20251015110332,124.487240,45.332422,2.7,0
20251015110342,124.487165,45.332364,3.0,0
20251015110352,124.487098,45.332311,2.6,0
20251015110402,124.487030,45.332258,2.8,0
20251015110412,124.486964,45.332207,2.9,0
20251015110422,124.486898,45.332156,3.0,0
20251015110432,124.486828,45.332101,2.8,0
20251015110442,124.486759,45.332048,2.9,0
20251015110452,124.486691,45.331995,3.0,0
20251015110502,124.486620,45.331939,2.9,0
20251015110512,124.486551,45.331885,2.7,0
20251015110522,124.486481,45.331829,3.1,0
20251015110532,124.486409,45.331773,3.1,0
20251015110542,124.486333,45.331713,3.0,0
20251015110552,124.486303,45.331689,0.0,0
20251015110602,124.486303,45.331689,0.0,0
20251015110612,124.486299,45.331687,1.1,0
20251015110622,124.486228,45.331632,3.5,0
20251015110632,124.486153,45.331574,3.0,0
20251015110642,124.486082,45.331519,3.1,0
20251015110652,124.486011,45.331462,3.2,0
20251015110702,124.485944,45.331411,1.2,0
20251015110712,124.485913,45.331385,5.8,0
20251015110722,124.485960,45.331423,0.0,0
20251015110732,124.485958,45.331421,0.0,0
20251015110742,124.485957,45.331420,0.0,0
20251015110752,124.485957,45.331420,0.1,0
20251015110802,124.485946,45.331412,2.0,0
20251015110812,124.485857,45.331372,1.7,0
20251015110822,124.485847,45.331396,0.2,0
20251015110832,124.485848,45.331395,0.0,0
20251015110842,124.485857,45.331406,0.0,0
20251015110852,124.485871,45.331390,1.5,0
20251015110902,124.485923,45.331446,3.0,0
20251015110912,124.485992,45.331502,3.4,0
20251015110922,124.486066,45.331561,3.6,0
20251015110932,124.486141,45.331618,3.2,0
20251015110942,124.486219,45.331679,3.2,0
20251015110952,124.486290,45.331733,2.5,0
20251015111002,124.486360,45.331786,2.6,0
20251015111012,124.486432,45.331846,3.2,0
20251015111022,124.486508,45.331906,3.2,0
20251015111032,124.486578,45.331961,2.9,0
20251015111042,124.486649,45.332016,2.8,0
20251015111052,124.486721,45.332072,2.7,0
20251015111102,124.486793,45.332127,2.8,0
20251015111112,124.486858,45.332179,2.7,0
20251015111122,124.486935,45.332237,3.0,0
20251015111132,124.487000,45.332288,3.0,0
20251015111142,124.487069,45.332341,2.7,0
20251015111152,124.487137,45.332396,2.8,0
20251015111202,124.487208,45.332452,2.9,0
20251015111212,124.487274,45.332504,2.6,0
20251015111222,124.487345,45.332559,3.4,0
20251015111232,124.487337,45.332546,3.9,0
20251015111242,124.487295,45.332481,0.0,0
20251015111252,124.487296,45.332481,0.0,0
20251015111302,124.487296,45.332481,0.0,0
20251015111312,124.487296,45.332481,0.0,0
20251015111322,124.487296,45.332481,0.0,0
20251015111332,124.487296,45.332481,0.0,0
20251015111342,124.487296,45.332481,0.0,0
20251015111352,124.487296,45.332481,0.0,0
20251015111402,124.487296,45.332481,0.0,0
20251015111412,124.487296,45.332481,0.0,0
20251015111422,124.487296,45.332481,0.0,0
20251015111432,124.487296,45.332482,0.0,0
20251015111442,124.487296,45.332482,0.0,0
20251015111452,124.487296,45.332482,0.0,0
20251015111502,124.487296,45.332482,0.0,0
20251015111512,124.487296,45.332482,0.0,0
20251015111522,124.487296,45.332482,0.0,0
20251015111532,124.487296,45.332482,0.0,0
20251015111542,124.487296,45.332482,0.0,0
20251015111552,124.487296,45.332482,0.0,0
20251015111602,124.487296,45.332482,0.0,0
20251015111701,124.487415,45.332632,1.7,0
20251015111935,124.487647,45.332496,0.0,0
20251015111945,124.487647,45.332496,0.0,0
20251015111955,124.487647,45.332496,0.0,0
20251015112005,124.487647,45.332496,0.0,0
20251015112015,124.487647,45.332496,0.0,0
20251015112025,124.487647,45.332496,0.0,0
20251015112035,124.487647,45.332496,0.0,0
20251015112045,124.487647,45.332496,0.0,0
20251015112055,124.487647,45.332496,0.0,0
20251015112105,124.487647,45.332496,0.0,0
20251015112115,124.487647,45.332496,0.0,0
20251015112125,124.487647,45.332496,0.0,0
20251015112135,124.487647,45.332496,0.0,0
20251015112145,124.487647,45.332496,0.0,0
20251015112155,124.487647,45.332496,0.0,0
20251015112205,124.487647,45.332496,0.0,0
20251015112215,124.487647,45.332496,0.0,0
20251015112225,124.487647,45.332496,0.0,0
20251015112235,124.487647,45.332496,0.0,0
20251015112245,124.487647,45.332496,0.0,0
20251015112255,124.487647,45.332496,0.0,0
20251015112305,124.487647,45.332496,0.0,0
20251015112315,124.487647,45.332496,0.0,0
20251015112325,124.487647,45.332496,0.0,0
20251015112335,124.487647,45.332496,0.0,0
20251015112345,124.487647,45.332496,0.0,0
20251015112355,124.487647,45.332496,0.0,0
20251015112405,124.487647,45.332496,0.0,0
20251015112415,124.487647,45.332496,0.0,0
20251015112425,124.487647,45.332496,0.0,0
20251015112435,124.487651,45.332494,1.4,0
20251015112445,124.487745,45.332415,1.9,0
20251015112455,124.487630,45.332415,2.6,0
20251015112505,124.487608,45.332505,2.1,0
20251015112515,124.487569,45.332536,1.6,0
20251015112526,124.487509,45.332583,2.3,0
20251015112536,124.487455,45.332619,2.8,0
20251015112546,124.487418,45.332625,3.4,0
20251015112556,124.487367,45.332603,2.3,0
20251015112606,124.487316,45.332570,2.4,0
20251015112616,124.487264,45.332531,2.0,0
20251015112626,124.487208,45.332485,1.9,0
20251015112636,124.487154,45.332444,2.5,0
20251015112646,124.487097,45.332399,2.2,0
20251015112656,124.487043,45.332355,2.4,0
20251015112706,124.486983,45.332308,2.2,0
20251015112716,124.486922,45.332261,2.5,0
20251015112726,124.486862,45.332215,2.7,0
20251015112736,124.486801,45.332167,2.0,0
20251015112746,124.486740,45.332119,2.6,0
20251015112756,124.486681,45.332074,2.2,0
20251015112806,124.486617,45.332024,2.6,0
20251015112816,124.486556,45.331976,2.3,0
20251015112826,124.486493,45.331928,2.8,0
20251015112836,124.486430,45.331877,2.6,0
20251015112846,124.486365,45.331825,2.8,0
20251015112856,124.486303,45.331777,2.7,0
20251015112906,124.486242,45.331729,2.7,0
20251015112916,124.486179,45.331681,2.8,0
20251015112926,124.486125,45.331640,2.6,0
20251015112936,124.486062,45.331589,2.3,0
20251015112946,124.485995,45.331538,2.8,0
20251015112956,124.485927,45.331483,3.2,0
20251015113006,124.485956,45.331507,1.2,0
20251015113016,124.485956,45.331507,0.0,0
20251015113026,124.485955,45.331506,0.0,0
20251015113036,124.485954,45.331505,0.0,0
20251015113046,124.485952,45.331503,0.0,0
20251015113056,124.485861,45.331457,4.6,0
20251015113106,124.485878,45.331468,3.7,0
20251015113116,124.485858,45.331502,2.8,0
20251015113126,124.485879,45.331487,0.1,0
20251015113136,124.485879,45.331487,0.0,0
20251015113146,124.485879,45.331487,0.0,0
20251015113156,124.485879,45.331487,0.0,0
20251015113206,124.485879,45.331487,0.0,0
20251015113216,124.485883,45.331493,1.2,0
20251015113226,124.485939,45.331543,3.0,0
20251015113236,124.486010,45.331600,3.0,0
20251015113246,124.486084,45.331658,2.8,0
20251015113256,124.486159,45.331716,2.9,0
20251015113306,124.486225,45.331766,2.7,0
20251015113316,124.486296,45.331822,3.0,0
20251015113326,124.486362,45.331874,2.5,0
20251015113336,124.486425,45.331924,3.6,0
20251015113346,124.486476,45.331965,1.8,0
20251015113356,124.486544,45.332019,1.1,0
20251015113406,124.486566,45.332036,2.2,0
20251015113416,124.486622,45.332080,2.5,0
20251015113426,124.486663,45.332113,2.2,0
20251015113436,124.486725,45.332160,3.0,0
20251015113446,124.486787,45.332207,2.6,0
20251015113456,124.486862,45.332266,3.1,0
20251015113506,124.486927,45.332315,2.7,0
20251015113516,124.486993,45.332368,2.7,0
20251015113526,124.487067,45.332426,2.4,0
20251015113536,124.487133,45.332478,2.4,0
20251015113546,124.487202,45.332534,3.4,0
20251015113556,124.487278,45.332592,3.2,0
20251015113606,124.487291,45.332600,4.3,0
20251015113616,124.487251,45.332546,0.0,0
20251015113626,124.487251,45.332547,0.0,0
20251015113636,124.487252,45.332546,0.0,0
20251015113646,124.487252,45.332547,0.0,0
20251015113656,124.487252,45.332547,0.0,0
20251015113706,124.487245,45.332540,1.8,0
20251015113716,124.487255,45.332545,0.0,0
20251015113726,124.487324,45.332574,0.6,0
20251015113736,124.487308,45.332564,0.0,0
20251015113746,124.487308,45.332564,0.0,0
20251015113756,124.487308,45.332564,0.0,0
20251015113806,124.487308,45.332564,0.0,0
20251015113816,124.487307,45.332565,2.2,0
20251015113826,124.487375,45.332586,4.1,0
20251015113836,124.487419,45.332563,3.8,0
20251015113846,124.487439,45.332548,0.0,0
20251015113856,124.487401,45.332586,2.6,0
20251015113906,124.487389,45.332610,0.0,0
20251015113916,124.487389,45.332610,0.0,0
20251015113926,124.487389,45.332610,0.0,0
20251015113936,124.487389,45.332610,0.0,0
20251015113946,124.487389,45.332610,0.0,0
20251015113956,124.487389,45.332610,0.0,0
20251015114006,124.487389,45.332610,0.0,0
20251015114016,124.487389,45.332610,0.0,0
20251015114026,124.487433,45.332563,2.3,0
20251015114036,124.487441,45.332557,0.1,0
20251015114046,124.487497,45.332529,3.1,0
20251015114056,124.487618,45.332499,5.5,0
20251015114106,124.487795,45.332392,8.5,0
20251015114116,124.488011,45.332310,6.4,0
20251015114126,124.488202,45.332382,5.2,0
20251015114136,124.488408,45.332479,5.6,0
20251015114146,124.488450,45.332571,3.7,0
20251015114156,124.488282,45.332796,11.7,0
20251015114206,124.488090,45.333043,10.3,0
20251015114216,124.487862,45.333280,11.5,0
20251015114226,124.487602,45.333521,13.0,0
20251015114236,124.487403,45.333686,5.4,0
20251015114246,124.487296,45.333723,2.6,0
20251015114256,124.487454,45.333778,5.5,0
20251015114306,124.487639,45.333874,7.2,0
20251015114316,124.487786,45.333954,3.0,0
20251015114326,124.487818,45.333986,2.4,0
20251015114336,124.487820,45.334037,1.5,0
20251015114346,124.488008,45.334038,7.2,0
20251015114356,124.488132,45.334112,11.7,0
20251015114406,124.488263,45.334180,1.7,0
20251015114416,124.488463,45.334279,11.0,0
20251015114426,124.488833,45.334470,14.9,0
20251015114436,124.489072,45.334939,20.1,0
20251015114446,124.489233,45.335271,0.9,0
20251015114456,124.489280,45.335358,7.0,0
20251015114506,124.489395,45.335484,6.3,0
20251015114516,124.489535,45.335615,5.5,0
20251015114526,124.489733,45.335762,10.7,0
20251015114536,124.490040,45.335970,14.6,0
20251015114546,124.490458,45.336218,7.5,0
20251015114556,124.490795,45.336356,8.4,0
20251015114606,124.490829,45.336367,0.0,0
20251015114616,124.491052,45.336453,13.0,0
20251015114625,124.491621,45.336664,22.1,0
20251015114635,124.492398,45.336938,21.5,0
20251015114645,124.493200,45.337203,27.6,0
20251015114655,124.494118,45.337451,29.4,0
20251015114705,124.494960,45.337783,29.5,0
20251015114715,124.495843,45.338167,27.9,0
20251015114725,124.496604,45.338558,28.5,0
20251015114735,124.497348,45.339002,26.6,0
20251015114745,124.498070,45.339360,20.2,0
20251015114755,124.498622,45.339608,17.4,0
20251015114805,124.499329,45.339964,27.5,0
20251015114815,124.499880,45.340215,8.5,0
20251015114825,124.500341,45.340446,21.7,0
20251015114835,124.500945,45.340746,16.7,0
20251015114845,124.501234,45.340889,2.9,0
20251015114855,124.501260,45.340902,0.0,0
20251015114905,124.501261,45.340902,0.0,0
20251015114915,124.501261,45.340902,0.0,0
20251015114925,124.501261,45.340902,0.0,0
20251015114935,124.501373,45.340948,8.5,0
20251015114945,124.501752,45.341137,17.6,0
20251015114955,124.502158,45.341308,10.2,0
20251015115005,124.502614,45.341520,17.1,0
20251015115015,124.503050,45.341675,16.5,0
20251015115025,124.503673,45.341871,17.8,0
20251015115035,124.504172,45.341973,11.0,0
20251015115045,124.504521,45.342063,6.9,0
20251015115055,124.504513,45.342027,4.0,0
20251015115105,124.504434,45.342114,4.3,0
20251015115115,124.504324,45.342182,0.2,0</textarea>
            <div class="button-group">
                <button id="drawTrackButton" disabled style="flex: 1;">绘制轨迹</button>
                <button id="showTrackPointsButton" disabled style="flex: 1;" class="btn-warning">打点</button>
                <button id="clearTrackButton" disabled style="flex: 1;">清空轨迹</button>
            </div>
            <!-- 回放控制 -->
            <div class="split-section" style="margin-top:8px;">
                <div class="title">轨迹回放</div>
                <div class="playback-actions" style="display:flex;gap:8px;margin-bottom:8px;">
                    <button id="playbackStartBtn" disabled>开始</button>
                    <button id="playbackPauseBtn" disabled>继续</button>
                    <button id="playbackStopBtn" disabled>结束</button>
                </div>
                <div class="playback-speed" style="display:flex;align-items:center;gap:8px;margin-bottom:8px;">
                    <label>速度：
                        <select id="playbackSpeedSelect" disabled>
                            <option value="1" selected>1×</option>
                            <option value="2">2×</option>
                            <option value="4">4×</option>
                            <option value="8">8×</option>
                            <option value="16">16×</option>
                            <option value="32">32×</option>
                            <option value="64">64×</option>
                            <option value="128">128×</option>
                            <option value="256">256×</option>
                            <option value="512">512×</option>
                            <option value="1024">1024×</option>
                        </select>
                    </label>
                    <span id="playbackTimeLabel" style="font-size:12px;color:#666;">时间：—</span>
                </div>
                <div class="playback-time" style="display:flex;flex-direction:column;gap:4px;margin-bottom:8px;">
                    <label class="playback-time-label" style="display:flex;align-items:center;gap:8px;flex:1 1 auto;min-width:0;">
                        <span class="playback-time-text" style="white-space:nowrap;">起始时间：</span>
                        <input type="range" id="playbackTimeSlider" disabled min="0" max="0" step="1000" value="0" style="flex:1 1 auto;min-width:0;max-width:100%;vertical-align:middle;">
                    </label>
                    <span id="playbackTimeCursor" style="font-size:12px;color:#666;align-self:flex-end;">—</span>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    let map;
    let currentPolygons = []; // 存储多边形和其标签
    let currentTracks = []; // 存储轨迹折线及相关覆盖物
    let mapLoaded = false;
    let mapLabelHandlers = []; // 存储地图事件处理器
    let labelsEnabled = false; // 标签显示开关（默认关闭）
    let isDrawing = false; // 绘制进行中防止重复点击

    window.onload = function () {
        if (typeof T === 'undefined') {
            alert("天地图API加载失败，请检查网络或密钥！");
            return;
        }
        initMap();
        bindDrawEvent();
        bindMinimizeEvent();
        bindTabs();
        bindBatchGenerator();
        bindMultiSplitter();
        bindLabelsToggle(); // 绑定标签显示开关
        bindTrackEvents();  // 绑定轨迹绘制与清空
        bindPlaybackControls(); // 绑定轨迹回放
    };

    function initMap() {
        showLoading();
        disableButtons(true);

        try {
            map = new T.Map("mapContainer", {
                zoom: 12,
                center: new T.LngLat(116.40769, 39.90403)
            });

            // 已移除测试标签
            map.enableScrollWheelZoom();

            // 添加地图类型控件
            const mapTypeCtrl = new T.Control.MapType({
                mapTypes: [TMAP_NORMAL_MAP, TMAP_SATELLITE_MAP, TMAP_TERRAIN_MAP],
                position: T_ANCHOR_TOP_LEFT
            });
            map.addControl(mapTypeCtrl);

            // 加载影像底图（卫星）
            const tk = "648f621977051d0199ff0f965d3fd322";

            // 方案1：使用默认地图类型（作为备选）
            map.setMapType(TMAP_SATELLITE_MAP);

            // 方案2：手动添加影像图层（底图 + 标注）
            const vecLayer = new T.TileLayer(`https://t0.tianditu.gov.cn/img_w/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=img&STYLE=default&TILEMATRIXSET=w&FORMAT=tiles&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}&tk=${tk}`);
            const cvaLayer = new T.TileLayer(`https://t0.tianditu.gov.cn/cia_w/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=cia&STYLE=default&TILEMATRIXSET=w&FORMAT=tiles&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}&tk=${tk}`);

            // 添加图层并监听加载状态
            vecLayer.addEventListener("load", function () {
                console.log("影像底图加载完成");
            });

            vecLayer.addEventListener("error", function (e) {
                console.error("影像底图加载错误:", e);
                alert("影像底图加载错误，将使用默认地图类型");
            });

            map.addLayer(vecLayer);
            map.addLayer(cvaLayer);

            // 监听地图加载事件
            map.addEventListener("loaded", function () {
                console.log("地图加载完成");
                markMapLoaded();
            });
            map.addEventListener("load", function () {
                console.log("地图load事件触发");
                markMapLoaded();
            });
            map.addEventListener("tilesloaded", function () {
                console.log("地图瓦片加载完成");
                markMapLoaded();
            });
            // 监听地图加载失败事件
            map.addEventListener("error", function (e) {
                console.error("地图加载错误:", e);
                alert("地图加载错误: " + e.message);
                hideLoading();
            });

            // 监听地图移动事件，用于更新标签位置
            const moveHandler = function () {
                updateAllLabelsPosition();
            };
            map.addEventListener("move", moveHandler);
            map.addEventListener("zoom", moveHandler);

            // 存储事件处理器，用于清理
            mapLabelHandlers.push({ event: "move", handler: moveHandler });
            mapLabelHandlers.push({ event: "zoom", handler: moveHandler });

            // 超时容错
            setTimeout(() => {
                if (!mapLoaded) markMapLoaded();
            }, 8000);

        } catch (error) {
            alert("地图初始化失败：" + error.message);
            console.error(error);
            hideLoading();
        }
    }

    function markMapLoaded() {
        if (!mapLoaded) {
            mapLoaded = true;
            hideLoading();
            disableButtons(false);
            disableTrackButtons(false);
            // 仅开启速度选择，回放按钮按状态控制
            const speedSel = document.getElementById('playbackSpeedSelect');
            if (speedSel) speedSel.disabled = false;
            updatePlaybackButtonsState('idle');
        }
    }

    function showLoading() {
        const loading = document.getElementById("mapLoading");
        loading.style.display = "flex";
        loading.style.opacity = "1";
    }

    function hideLoading() {
        const loading = document.getElementById("mapLoading");
        loading.style.opacity = "0";
        setTimeout(() => loading.style.display = "none", 300);
    }

    function disableButtons(disabled) {
        document.getElementById("drawButton").disabled = disabled;
        document.getElementById("clearButton").disabled = disabled;
    }

    function disableTrackButtons(disabled) {
        const drawTrackBtn = document.getElementById("drawTrackButton");
        const showTrackPointsBtn = document.getElementById("showTrackPointsButton");
        const clearTrackBtn = document.getElementById("clearTrackButton");
        if (drawTrackBtn) drawTrackBtn.disabled = disabled;
        if (showTrackPointsBtn) showTrackPointsBtn.disabled = disabled;
        if (clearTrackBtn) clearTrackBtn.disabled = disabled;
    }
    // 回放控件的禁用/启用
    function disablePlaybackButtons(disabled) {
        ["playbackStartBtn","playbackPauseBtn","playbackStopBtn","playbackSpeedSelect","playbackTimeSlider"].forEach(id=>{
            const el = document.getElementById(id);
            if (el) el.disabled = disabled;
        });
    }

    // 回放按钮状态管理：空闲/播放/暂停
    function updatePlaybackButtonsState(state){
        try {
            const startBtn = document.getElementById('playbackStartBtn');
            const pauseBtn = document.getElementById('playbackPauseBtn');
            const stopBtn = document.getElementById('playbackStopBtn');
            if (!startBtn || !pauseBtn || !stopBtn) return;
            if (state === 'idle') {
                startBtn.disabled = false;
                pauseBtn.disabled = true;
                stopBtn.disabled = true;
                pauseBtn.textContent = '继续';
            } else if (state === 'playing') {
                startBtn.disabled = true;
                pauseBtn.disabled = false;
                stopBtn.disabled = false;
                pauseBtn.textContent = '暂停';
            } else if (state === 'paused') {
                startBtn.disabled = true;
                pauseBtn.disabled = false;
                stopBtn.disabled = false;
                pauseBtn.textContent = '继续';
            }
        } catch(e) { console.warn('更新按钮状态失败:', e); }
    }

    function bindDrawEvent() {
        document.getElementById("drawButton").addEventListener("click", function () {
            if (isDrawing) { console.log('绘制进行中，忽略重复点击'); return; }
            isDrawing = true;
            disableButtons(true);
            showLoading();
            try {
                const wktStr = document.getElementById("wktTextarea").value.trim();
                if (!wktStr) { alert("请输入WKT字符串！"); return; }
                clearOverlays();
                const geojson = parseWkt(wktStr);
    
                const polygonData = [];
                if (geojson.type === "Polygon") {
                    polygonData.push({ index: 1, coordinates: geojson.coordinates });
                } else if (geojson.type === "MultiPolygon") {
                    geojson.coordinates.forEach((polygon, index) => {
                        polygonData.push({ index: index + 1, coordinates: polygon });
                    });
                }
    
                // 重置并绘制
                polygonInfoList = [];
                polygonData.forEach(pd => processPolygon(pd.index, pd.coordinates));
    
                // 视图居中到所有已绘制轮廓
                try { fitViewportToPolygons(); } catch (e) { console.warn('视图居中失败', e); }
    
                // 在视图稳定后再创建/更新标签
                setTimeout(() => {
                    if (labelsEnabled) {
                        try {
                            createAllLabels();
                            updateAllLabelsPosition();
                        } catch (e) {
                            console.warn('创建或更新标签失败:', e);
                        }
                    }
                }, 150);
            } catch (e) {
                alert('绘制失败：' + (e && e.message ? e.message : e));
                console.error('绘制异常:', e);
            } finally {
                hideLoading();
                isDrawing = false;
                disableButtons(false);
            }
        });

        document.getElementById("clearButton").addEventListener("click", function () {
            if (isDrawing) { console.log('绘制进行中，暂不清空'); return; }
            clearOverlays();
            console.log("已清空所有轮廓");
        });
    }

    // 存储多边形数据，用于后续标签创建
    let polygonInfoList = [];

    // 处理单个多边形的绘制和面积计算
    function processPolygon(actualPolygonIndex, polygonCoords) {
        console.log('开始处理多边形', actualPolygonIndex);

        // 坐标系选择（绘制始终使用WGS84坐标）
        const coordSys = (document.getElementById('coordSysSelect') && document.getElementById('coordSysSelect').value) || 'wgs84';

        // 统一转换为WGS84用于绘制与面积计算
        function toWgs(point){
            const lng = point[0], lat = point[1];
            if (coordSys === 'wgs84' || coordSys === 'cgcs2000') {
                return [lng, lat];
            } else if (coordSys === 'gcj02') {
                const w = gcj02ToWgs84(lng, lat);
                return [w.lng, w.lat];
            } else if (coordSys === 'bd09') {
                const gcj = bd09ToGcj02(lng, lat);
                const w = gcj02ToWgs84(gcj.lng, gcj.lat);
                return [w.lng, w.lat];
            }
            return [lng, lat];
        }
        const coordsWGS84 = polygonCoords.map(ring => ring.map(toWgs));
        let outerRingWGS = coordsWGS84[0] || [];

        // 生成用于绘制的坐标（直接使用WGS84坐标）
        const rings = coordsWGS84.map(ring => ring.map(([lng, lat]) => new T.LngLat(lng, lat)));


         // 创建半透明填充的多边形（无边框）
          const polygon = new T.Polygon(rings, {
              color: "#FFD700",
              weight: 1,
              opacity: 1,
              fillColor: "#FFFF00",
              fillOpacity: 0.35
          });
 
          // 使用WGS84坐标计算面积（更准确的面积计算）
         let areaSqm;
         let areaMu;



         try {
             // 检查Turf.js是否可用
             if (typeof turf !== 'undefined' && turf.area) {
                 // 使用Turf.js计算多边形面积
                // 构造GeoJSON格式的多边形
                const geoJsonPolygon = {
                    type: "Polygon",
                    coordinates: coordsWGS84
                };


                 // 使用Turf.js计算面积（平方米）
                 areaSqm = turf.area(geoJsonPolygon);
                 areaMu = (areaSqm / 666.6667).toFixed(4); // 转换为亩
                 console.log(`多边形${actualPolygonIndex}面积计算结果(Turf.js): ${areaSqm}平方米 = ${areaMu}亩`);
             } else {
                 // 如果Turf.js不可用，回退到之前的计算方法
                 console.warn('Turf.js不可用，使用备用计算方法');
                 // 计算带孔洞的多边形面积
                 areaSqm = 0;
                 // 计算外环面积
                 outerRingWGS = coordsWGS84[0] || [];
                 areaSqm += calculatePolygonArea(outerRingWGS);

                 // 减去内环（孔洞）面积
                 for (let i = 1; i < coordsWGS84.length; i++) {
                     const innerRingArea = calculatePolygonArea(coordsWGS84[i]);
                     areaSqm -= innerRingArea;
                 }

                  areaMu = (areaSqm / 666.6667).toFixed(4); // 使用更精确的转换系数
                  console.log(`多边形${actualPolygonIndex}面积计算结果(备用): ${areaSqm}平方米 = ${areaMu}亩`);
              }
          } catch (error) {
              console.error(`面积计算失败:`, error);
              areaSqm = 0;
              areaMu = '0.0000';
          }

          // 计算多边形的中心点和底部中心点（WGS84）
          const centerPoint = calculatePolygonCenter(outerRingWGS);
          const bottomCenterPoint = calculatePolygonBottomCenter(outerRingWGS);

          // 添加多边形到地图
          if (map) {
              map.addOverLay(polygon);
              console.log(`多边形${actualPolygonIndex}已添加到地图`);
          } else {
              console.error('地图对象不存在');
          }

          // 存储多边形信息，用于后续标签创建
          polygonInfoList.push({
              index: actualPolygonIndex,
              polygon: polygon,
              area: areaMu,
              bottomCenter: { lng: bottomCenterPoint.lng, lat: bottomCenterPoint.lat },
              ringPoints: rings
          });
      }

    // 视图居中：根据已绘制的GCJ-02点
    function fitViewportToPolygons() {
        const points = [];
        try {
            if (!map || !map.setViewport) return;
            polygonInfoList.forEach(info => {
                if (!info || !info.ringPoints) return;
                info.ringPoints.forEach(ring => {
                    ring.forEach(ll => points.push(ll));
                });
            });
            if (!points.length) return;
            map.setViewport(points);
        } catch (e) {
            try {
                const lngs = points.map(p => p.lng);
                const lats = points.map(p => p.lat);
                const center = new T.LngLat(
                    (Math.min(...lngs) + Math.max(...lngs)) / 2,
                    (Math.min(...lats) + Math.max(...lats)) / 2
                );
                if (map && map.panTo) map.panTo(center);
            } catch (e2) {
                console.warn('视图居中失败:', e2);
            }
        }
    }

    // 统一创建所有多边形的标签
    function createAllLabels() {
        const mapContainer = document.getElementById('mapContainer');
        if (!mapContainer || !map) return;

        polygonInfoList.forEach(info => {
            if (!info) return;
            // 防止重复创建
            if (info.labelRef) return;
            // 创建标签元素
            const labelDiv = document.createElement('div');
            labelDiv.className = 'area-label';
            labelDiv.innerHTML = `多边形${info.index}：${info.area}亩`;

            // 添加到地图容器并根据屏幕边界定位到轮廓下方
            mapContainer.appendChild(labelDiv);
            positionLabelForPolygon(labelDiv, info);

            // 记录引用，避免重复创建
            info.labelRef = labelDiv;

            // 存储到 currentPolygons 以复用现有定位/清理逻辑
            const labelObj = {
                domElement: labelDiv,
                isDomLabel: true,
                polygonInfo: info
            };
            currentPolygons.push({ polygon: info.polygon, label: labelObj });
        });

        // 不清空 polygonInfoList，便于开关随时创建/隐藏标签
    }

    // 根据多边形屏幕边界定位标签，保证始终在轮廓下方
    function positionLabelForPolygon(labelDiv, info) {
        if (!map || !info || !info.ringPoints) return;
        const points = [];
        info.ringPoints.forEach(ring => {
            ring.forEach(ll => {
                const p = map.lngLatToContainerPoint(ll);
                points.push(p);
            });
        });
        if (!points.length) return;
        const minX = Math.min(...points.map(p => p.x));
        const maxX = Math.max(...points.map(p => p.x));
        const maxY = Math.max(...points.map(p => p.y));
        const container = document.getElementById('mapContainer');
        const labelWidth = labelDiv.offsetWidth;
        const labelHeight = labelDiv.offsetHeight;
        const targetLeft = Math.round((minX + maxX) / 2 - labelWidth / 2);
        const targetTop = Math.round(maxY + 6);
        const clampedLeft = Math.max(0, Math.min(targetLeft, container.clientWidth - labelWidth));
        const clampedTop = Math.max(0, Math.min(targetTop, container.clientHeight - labelHeight));
        labelDiv.style.left = clampedLeft + 'px';
        labelDiv.style.top = clampedTop + 'px';
    }

    // 更新所有标签位置（地图move/zoom时调用）
    function updateAllLabelsPosition() {
        try {
            if (!map) return;
            const container = document.getElementById('mapContainer');
            if (!container) return;
            currentPolygons.forEach(item => {
                if (!item || !item.label) return;
                const labelObj = item.label;
                if (labelObj.isDomLabel && labelObj.domElement && labelObj.polygonInfo) {
                    // 确保标签在容器中
                    if (!labelObj.domElement.parentNode) {
                        container.appendChild(labelObj.domElement);
                    }
                    positionLabelForPolygon(labelObj.domElement, labelObj.polygonInfo);
                }
            });
        } catch (e) {
            console.warn('更新标签位置时出错:', e);
        }
    }
    // 确保在全局可用（处理第三方库事件回调作用域差异）
    window.updateAllLabelsPosition = updateAllLabelsPosition;

    // 绑定“显示亩数标签”开关（默认隐藏）
    function bindLabelsToggle() {
        const cb = document.getElementById('toggleLabelsCheckbox');
        const container = document.getElementById('mapContainer');
        if (!cb || !container) return;
        // 默认隐藏标签
        container.classList.add('labels-hidden');
        cb.addEventListener('change', () => {
            labelsEnabled = cb.checked;
            if (labelsEnabled) {
                container.classList.remove('labels-hidden');
                const hasAnyLabel = currentPolygons.some(item => item && item.label && item.label.domElement);
                if (!hasAnyLabel) {
                    try { createAllLabels(); } catch (e) { console.warn('创建标签失败:', e); }
                }
                updateAllLabelsPosition();
            } else {
                container.classList.add('labels-hidden');
            }
        });
    }

    /**
     * 计算多边形中心点（比底部中心更适合显示标签）
     */
    function calculatePolygonCenter(outerRing) {
        let sumLng = 0, sumLat = 0;
        const len = outerRing.length;

        for (let i = 0; i < len; i++) {
            sumLng += outerRing[i][0];
            sumLat += outerRing[i][1];
        }

        return {
            lng: sumLng / len,
            lat: sumLat / len
        };
    }

    /**
     * 计算多边形面积（球面多边形面积计算）
     * 使用更准确的球面坐标面积计算方法，确保面积与视觉大小一致
     */
    function calculatePolygonArea(coordinates) {
        // 地球半径（米）- 使用更精确的值
        const R = 6371000.8;
        const n = coordinates.length;

        // 将所有坐标转换为弧度
        const coordsRad = coordinates.map(point => [
            point[0] * Math.PI / 180,
            point[1] * Math.PI / 180
        ]);

        let areaRad = 0;

        // 使用更准确的球面多边形面积公式（Girard定理）
        for (let i = 0; i < n; i++) {
            const j = (i + 1) % n;
            const lon1 = coordsRad[i][0];
            const lat1 = coordsRad[i][1];
            const lon2 = coordsRad[j][0];
            const lat2 = coordsRad[j][1];

            // 计算球面多边形面积增量
            const dlon = lon2 - lon1;
            const sinLat1 = Math.sin(lat1);
            const sinLat2 = Math.sin(lat2);
            const cosLat1 = Math.cos(lat1);
            const cosLat2 = Math.cos(lat2);

            // 使用更精确的公式
            areaRad += dlon * (sinLat1 * cosLat2 * Math.cos(dlon / 2) + sinLat2 * cosLat1);
        }

        // 计算总面积（平方米）
        const areaSqm = Math.abs(areaRad) * R * R * 0.5;

        return areaSqm;
    }

    /**
     * 清空所有多边形和标签（同时处理 polygonInfoList 与 currentPolygons）
     */
    function clearOverlays() {
        try {
            // 先移除 polygonInfoList 中记录的多边形与其DOM标签
            polygonInfoList.forEach(info => {
                if (info && info.polygon && map && map.removeOverLay) {
                    try { map.removeOverLay(info.polygon); } catch (e) { console.warn('移除多边形失败:', e); }
                }
                if (info && info.labelRef && info.labelRef.parentNode) {
                    try { info.labelRef.parentNode.removeChild(info.labelRef); } catch (e) { console.warn('移除DOM标签失败:', e); }
                    info.labelRef = null;
                }
            });

            // 再处理 currentPolygons（兼容旧路径与标签对象）
            currentPolygons.forEach(item => {
                if (item.polygon && map && map.removeOverLay) {
                    try { map.removeOverLay(item.polygon); } catch (e) { console.warn('移除多边形失败:', e); }
                }
                if (item.label) {
                    if (item.label.domElement && item.label.domElement.parentNode) {
                        try { item.label.domElement.parentNode.removeChild(item.label.domElement); } catch (e) { console.warn('移除DOM标签失败:', e); }
                    } else if (map && map.removeOverLay && !item.label.isDomLabel) {
                        try { map.removeOverLay(item.label); } catch (e) { console.warn('移除地图覆盖物标签失败:', e); }
                    }
                }
            });

            // 清空记录数组
            currentPolygons = [];
            polygonInfoList = [];

            console.log('已清空所有多边形和标签（保留事件监听器）');
        } catch (error) {
            console.error('清空覆盖物时出错:', error);
        }
    }

    // 其他辅助函数（保持不变）
    function bindMinimizeEvent() {
        const container = document.querySelector(".wkt-input-container");
        const btn = document.getElementById("minimizeBtn");
        const minIcon = btn?.querySelector(".min-icon");
        const restoreIcon = btn?.querySelector(".restore-icon");

        btn?.addEventListener("click", () => {
            const minimized = container.classList.toggle("minimized");
            if (minIcon && restoreIcon) {
                if (minimized) {
                    minIcon.style.display = "none";
                    restoreIcon.style.display = "";
                } else {
                    minIcon.style.display = "";
                    restoreIcon.style.display = "none";
                }
            }
        });
    }

    // 在脚本内部补充：页签切换（3个页签）
     function bindTabs() {
         const tabs = [
             { btn: document.getElementById('tabDrawBtn'), pane: document.getElementById('tabDraw'), key: 'draw' },
             { btn: document.getElementById('tabTrackBtn'), pane: document.getElementById('tabTrack'), key: 'track' },
             { btn: document.getElementById('tabSplitBtn'), pane: document.getElementById('tabSplit'), key: 'split' },
             { btn: document.getElementById('tabBatchBtn'), pane: document.getElementById('tabBatch'), key: 'batch' },
         ];
         if (tabs.some(t => !t.btn || !t.pane)) return;
         function activate(key) {
             tabs.forEach(t => {
                 const active = t.key === key;
                 t.btn.classList.toggle('active', active);
                 t.pane.classList.toggle('active', active);
             });
         }
         tabs.forEach(t => t.btn.addEventListener('click', () => activate(t.key)));
         activate('draw');
     }
    function updateParserStatus() {
        const el = document.getElementById('parserStatus');
        if (!el) return;
        const ok = (typeof Terraformer !== 'undefined' && Terraformer.WKT && typeof Terraformer.WKT.parse === 'function');
        if (ok) {
            el.textContent = 'Terraformer WKT Parser';
            el.style.color = '#2f8f2f';
        } else {
            el.textContent = '本地回退解析（仅支持POLYGON/MULTIPOLYGON）';
            el.style.color = '#c77d1e';
        }
    }
     function parseWkt(wkt) {
         wkt = wkt.trim();
         // 优先使用成熟库（Terraformer WKT Parser）
         if (typeof Terraformer !== 'undefined' && Terraformer.WKT && Terraformer.WKT.parse) {
             try {
                 return Terraformer.WKT.parse(wkt);
             } catch (e) {
                 console.warn('Terraformer解析失败，尝试本地回退解析:', e);
             }
         } else {
             // 不再提示“未加载”，由状态栏展示回退信息
         }
         // 回退解析：仅支持 POLYGON / MULTIPOLYGON
         const typeMatch = wkt.match(/^\s*(POLYGON|MULTIPOLYGON)\s*\(/i);
         if (!typeMatch) throw new Error('仅支持POLYGON/MULTIPOLYGON');
         const type = typeMatch[1].toUpperCase();
         const inner = wkt.substring(wkt.indexOf('('));
         if (type === 'POLYGON') {
             const coords = parsePolygonCoords(inner.replace(/^\(/, '').replace(/\)$/, ''));
             return { type: 'Polygon', coordinates: coords };
         } else {
             const trimmed = inner.replace(/^\(\(/, '').replace(/\)\)$/, '');
             const coords = parseMultiPolygonCoords(trimmed);
             return { type: 'MultiPolygon', coordinates: coords };
         }
     }

     function bindMultiSplitter() {
         const input = document.getElementById('multiInput');
         const output = document.getElementById('polyOutput');
         const splitBtn = document.getElementById('splitMultiBtn');
         const copyBtn = document.getElementById('copyPolysBtn');
         if (!input || !output || !splitBtn || !copyBtn) return;

         // 本地WKT序列化辅助
         function ringToText(ring) {
             if (!ring || !ring.length) return '()';
             const first = ring[0];
             const last = ring[ring.length - 1];
             const closed = (first[0] === last[0] && first[1] === last[1]) ? ring : ring.concat([[first[0], first[1]]]);
             return '(' + closed.map(pt => pt[0] + ' ' + pt[1]).join(', ') + ')';
         }
         function toWktPolygonCoords(coords) {
             return 'POLYGON(' + coords.map(ringToText).join(', ') + ')';
         }
         function toWktMulti(coords) {
             return 'MULTIPOLYGON(' + coords.map(poly => '(' + poly.map(ringToText).join(', ') + ')').join(', ') + ')';
         }

         function polygonsFromMulti(text) {
             const geo = parseWkt(text.trim());
             if (geo.type !== 'MultiPolygon') throw new Error('请输入有效的 MULTIPOLYGON WKT');
             const polys = geo.coordinates.map(rings => toWktPolygonCoords(rings));
             return polys;
         }
         splitBtn.addEventListener('click', () => {
             try {
                 const list = polygonsFromMulti(input.value.trim());
                 output.value = list.join('\n');
             } catch (e) {
                 alert('分割失败：' + e.message);
             }
         });
         copyBtn.addEventListener('click', async () => {
             const val = output.value.trim();
             if (!val) { alert('没有可复制的结果'); return; }
             try { await navigator.clipboard.writeText(val); alert('已复制到剪贴板'); } catch (e) { console.warn('复制失败', e); }
         });
     }

     function bindBatchGenerator() {
         const batchInput = document.getElementById('batchInput');
         const output = document.getElementById('multiOutput');
         const genBtn = document.getElementById('generateMultiBtn');
         const copyBtn = document.getElementById('copyMultiBtn');

         // 本地WKT序列化辅助（与分割器保持一致）
         function ringToText(ring) {
             if (!ring || !ring.length) return '()';
             const first = ring[0];
             const last = ring[ring.length - 1];
             const closed = (first[0] === last[0] && first[1] === last[1]) ? ring : ring.concat([[first[0], first[1]]]);
             return '(' + closed.map(pt => pt[0] + ' ' + pt[1]).join(', ') + ')';
         }
         function toWktMulti(coords) {
             return 'MULTIPOLYGON(' + coords.map(poly => '(' + poly.map(ringToText).join(', ') + ')').join(', ') + ')';
         }

         genBtn.addEventListener('click', () => {
             try {
                 const lines = batchInput.value.trim().split(/\n|;/).map(s => s.trim()).filter(Boolean);
                 if (lines.length === 0) throw new Error('请按每行或分号输入至少一个POLYGON');
                 const polygons = lines.map((line, idx) => {
                     const g = parseWkt(line);
                     if (g.type !== 'Polygon') throw new Error(`第${idx + 1}行不是有效的POLYGON WKT`);
                     return g;
                 });
                 const multiGeo = { type: 'MultiPolygon', coordinates: polygons.map(p => p.coordinates) };
                 output.value = toWktMulti(multiGeo.coordinates);
             } catch (e) {
                 alert('生成失败：' + e.message);
             }
         });

         copyBtn.addEventListener('click', async () => {
             const val = output.value.trim();
             if (!val) { alert('没有可复制的结果'); return; }
             try { await navigator.clipboard.writeText(val); alert('已复制到剪贴板'); } catch (e) { console.warn('复制失败', e); }
         });

     }

     function setExampleWkt() {
         const exampleWkt = "MULTIPOLYGON(" +
             "(" +
             "(116.35 39.93, 116.39 39.93, 116.39 39.90, 116.35 39.90, 116.35 39.93)," + // 外环
             "(116.36 39.92, 116.38 39.92, 116.38 39.91, 116.36 39.91, 116.36 39.92)" +  // 内环
             ")," +
             "(" +
             "(116.40 39.95, 116.43 39.97, 116.46 39.96, 116.49 39.98, 116.52 39.95, 116.55 39.93, 116.58 39.94, 116.61 39.92, 116.64 39.95, 116.40 39.95)" +
             ")" +
             ")";
         document.getElementById("wktTextarea").value = exampleWkt;
     }

     function parsePolygonCoords(coordStr) {
         const ringStrs = coordStr.split(/\)\s*,\s*\(/).map(s => s.replace(/[()]/g, '').trim());
         const rings = [];
         ringStrs.forEach(ringStr => {
             const pts = ringStr.split(/,\s*/).map(pointStr => {
                 const [lng, lat] = pointStr.split(/\s+/).map(Number);
                 if (isNaN(lng) || isNaN(lat)) throw new Error("坐标格式错误：" + pointStr);
                 return [lng, lat];
             });
             // 自动拆分：如果一个ring中包含多次回到起点（闭合），则拆分为多个环
             // 兼容用户将外环与内环错误地写在同一对括号中的情况
             let start = 0;
             while (start < pts.length) {
                 const startPt = pts[start];
                 let closeIdx = -1;
                 for (let i = start + 1; i < pts.length; i++) {
                     if (pts[i][0] === startPt[0] && pts[i][1] === startPt[1]) {
                         closeIdx = i;
                         break;
                     }
                 }
                 if (closeIdx === -1) {
                     // 未找到闭合：将剩余点视为一个环，并强制闭合
                     const ring = pts.slice(start);
                     if (ring.length && (ring[0][0] !== ring[ring.length - 1][0] || ring[0][1] !== ring[ring.length - 1][1])) {
                         ring.push([ring[0][0], ring[0][1]]);
                     }
                     rings.push(ring);
                     break;
                 } else {
                     const ring = pts.slice(start, closeIdx + 1);
                     rings.push(ring);
                     start = closeIdx + 1;
                 }
             }
         });
         return rings;
     }

     function parseMultiPolygonCoords(coordStr) {
         const polygonStrs = coordStr.split(/\)\s*\)\s*,\s*\(\s*\(/).map(s => s.replace(/[()]/g, '').trim());
         return polygonStrs.map(polygonStr => parsePolygonCoords(polygonStr));
     }

     function wgs84ToGcj02(lng, lat) {
         const x_PI = 3.14159265358979324 * 3000.0 / 180.0;
         const PI = 3.1415926535897932384626;
         const a = 6378245.0;
         const ee = 0.00669342162296594323;

         if (outOfChina(lng, lat)) return { lng, lat };

         let dlat = transformLat(lng - 105.0, lat - 35.0);
         let dlng = transformLng(lng - 105.0, lat - 35.0);
         const radlat = lat / 180.0 * PI;
         let magic = Math.sin(radlat);
         magic = 1 - ee * magic * magic;
         const sqrtmagic = Math.sqrt(magic);
         dlat = (dlat * 180.0) / ((a * (1 - ee)) / (magic * sqrtmagic) * PI);
         dlng = (dlng * 180.0) / (a / sqrtmagic * Math.cos(radlat) * PI);

         return { lng: lng + dlng, lat: lat + dlat };

         function outOfChina(lng, lat) {
             return (lng < 72.004 || lng > 137.8347) || (lat < 0.8293 || lat > 55.8271);
         }

         function transformLat(x, y) {
             let ret = -100.0 + 2.0 * x + 3.0 * y + 0.2 * y * y + 0.1 * x * y + 0.2 * Math.sqrt(Math.abs(x));
             ret += (20.0 * Math.sin(6.0 * x * PI) + 20.0 * Math.sin(2.0 * x * PI)) * 2.0 / 3.0;
             ret += (20.0 * Math.sin(y * PI) + 40.0 * Math.sin(y / 3.0 * PI)) * 2.0 / 3.0;
             ret += (160.0 * Math.sin(y / 12.0 * PI) + 320 * Math.sin(y * PI / 30.0)) * 2.0 / 3.0;
             return ret;
         }

         function transformLng(x, y) {
             let ret = 300.0 + x + 2.0 * y + 0.1 * x * x + 0.1 * x * y + 0.1 * Math.sqrt(Math.abs(x));
             ret += (20.0 * Math.sin(6.0 * x * PI) + 20.0 * Math.sin(2.0 * x * PI)) * 2.0 / 3.0;
             ret += (20.0 * Math.sin(x * PI) + 40.0 * Math.sin(x / 3.0 * PI)) * 2.0 / 3.0;
             ret += (150.0 * Math.sin(x / 12.0 * PI) + 300.0 * Math.sin(x / 30.0 * PI)) * 2.0 / 3.0;
             return ret;
         }
     }

     function gcj02ToWgs84(lng, lat) {
         const g = wgs84ToGcj02(lng, lat);
         return { lng: lng * 2 - g.lng, lat: lat * 2 - g.lat };
     }

     function bd09ToGcj02(bdLng, bdLat) {
         const x_PI = 3.14159265358979324 * 3000.0 / 180.0;
         const x = bdLng - 0.0065;
         const y = bdLat - 0.006;
         const z = Math.sqrt(x * x + y * y) - 0.00002 * Math.sin(y * x_PI);
         const theta = Math.atan2(y, x) - 0.000003 * Math.cos(x * x_PI);
         const ggLng = z * Math.cos(theta);
         const ggLat = z * Math.sin(theta);
         return { lng: ggLng, lat: ggLat };
     }

     function calculatePolygonBottomCenter(outerRing) {
         let minLat = Infinity;
         let bottomPoints = [];
         outerRing.forEach(point => {
             const lat = point[1];
             if (lat < minLat) {
                 minLat = lat;
                 bottomPoints = [point];
             } else if (lat === minLat) {
                 bottomPoints.push(point);
             }
         });

         const sumLng = bottomPoints.reduce((sum, point) => sum + point[0], 0);
         const centerLng = sumLng / bottomPoints.length;

         return { lng: centerLng, lat: minLat };
     }

     function fitBounds(geojson) {
         try {
             const allPoints = [];
             function collectPoints(coords) {
                 if (typeof coords[0] === 'number') {
                     allPoints.push(coords);
                 } else {
                     coords.forEach(coord => collectPoints(coord));
                 }
             }
             collectPoints(geojson.coordinates);

             if (allPoints.length === 0) return;

             const lats = allPoints.map(p => p[1]);
             const lngs = allPoints.map(p => p[0]);
             const minLng = Math.min(...lngs);
             const maxLng = Math.max(...lngs);
             const minLat = Math.min(...lats);
             const maxLat = Math.max(...lats);

             const sw = wgs84ToGcj02(minLng, minLat);
             const ne = wgs84ToGcj02(maxLng, maxLat);

             // 修复setViewport方法的使用，确保参数格式正确
             if (map && map.setViewport) {
                 map.setViewport([
                     new T.LngLat(sw.lng, sw.lat),
                     new T.LngLat(ne.lng, ne.lat)
                 ], { padding: [50, 50] });
             } else {
                 console.warn('地图对象或setViewport方法不可用');
             }
         } catch (error) {
             console.error('调整视图范围时出错:', error);
         }
     }
// 轨迹绘制与解析
    function bindTrackEvents() {
        const drawBtn = document.getElementById('drawTrackButton');
        const showPointsBtn = document.getElementById('showTrackPointsButton');
        const clearBtn = document.getElementById('clearTrackButton');
        const ta = document.getElementById('trackTextarea');
        if (!drawBtn || !showPointsBtn || !clearBtn || !ta) return;

        drawBtn.addEventListener('click', function(){
            try {
                const text = ta.value.trim();
                if (!text) { alert('请粘贴轨迹文本（时间戳,经度,纬度）'); return; }
                const points = parseTrackText(text);
                if (points.length < 2) { alert('有效轨迹点不足，至少需要两点'); return; }
                drawTrackFromPoints(points);
                fitViewportToTrack(points);
            } catch (e) {
                alert('绘制轨迹失败：' + (e && e.message ? e.message : e));
                console.error('绘制轨迹异常:', e);
            }
        });

        showPointsBtn.addEventListener('click', function(){
            try {
                const text = ta.value.trim();
                if (!text) { alert('请粘贴轨迹文本（时间戳,经度,纬度）'); return; }
                const points = parseTrackText(text);
                if (points.length === 0) { alert('未找到有效轨迹点'); return; }
                showTrackPoints(points);
                fitViewportToTrack(points);
            } catch (e) {
                alert('显示轨迹点失败：' + (e && e.message ? e.message : e));
                console.error('显示轨迹点异常:', e);
            }
        });

        clearBtn.addEventListener('click', function(){
            clearTrackOverlays();
            console.log('已清空轨迹');
        });
    }

    function showTrackPoints(points) {
        // 先移除旧轨迹（不影响轮廓）
        clearTrackOverlays(false);
        
        if (!map || !points || points.length === 0) {
            console.log('无轨迹点可显示');
            return;
        }
        
        console.log(`准备显示${points.length}个轨迹点`);
        
        // 使用批量处理和更小的图标来提高性能
        // 创建一个更小的红点SVG图标
        const smallRedDotIcon = new T.Icon({
            iconUrl: 'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="1" height="1"><circle cx="0.5" cy="0.5" r="0.3" fill="%23FF0000"/></svg>',
            iconSize: new T.Point(1, 1),
            iconAnchor: new T.Point(0.5, 0.5)
        });
        
        // 优化批量添加点的速度
        const batchSize = 2000; // 增加每批处理的点数
        const concurrentBatches = 4; // 并发批次数量
        
        // 预创建点击事件处理函数，避免重复创建
        function createClickHandler(point, index) {
            return function() {
                const infoWindow = new T.InfoWindow({
                    content: `点${index + 1}<br/>经度: ${point.lng.toFixed(6)}<br/>纬度: ${point.lat.toFixed(6)}`,
                    offset: new T.Point(0, -20)
                });
                infoWindow.open(map, point);
            };
        }
        
        // 使用setTimeout实现更高效的批量添加，避免阻塞UI
        let currentIndex = 0;
        
        function addBatch() {
            if (currentIndex >= points.length) {
                console.log(`已显示${points.length}个轨迹点`);
                return;
            }
            
            // 添加当前批次的点
            const endIndex = Math.min(currentIndex + batchSize, points.length);
            const markersToAdd = [];
            
            // 先创建所有标记
            for (let i = currentIndex; i < endIndex; i++) {
                const point = points[i];
                const index = i;
                
                const marker = new T.Marker(point, {
                    icon: smallRedDotIcon
                });
                
                // 添加点击事件
                marker.addEventListener('click', createClickHandler(point, index));
                
                markersToAdd.push(marker);
            }
            
            // 批量添加到地图和数组
            markersToAdd.forEach(marker => {
                map.addOverLay(marker);
                currentTracks.push(marker);
            });
            
            currentIndex = endIndex;
            
            // 使用setTimeout而不是requestAnimationFrame，减少对渲染周期的依赖
            // 设置为0，将任务放入微任务队列，但允许UI有短暂的呼吸空间
            setTimeout(addBatch, 0);
        }
        
        // 启动批量添加
        addBatch();
    }
    
    // 恢复原始的clearTrackOverlays函数
    function clearTrackOverlays(resetArray = true){        
        try {
            currentTracks.forEach(pl => {
                if (pl && map && map.removeOverLay) {
                    try { map.removeOverLay(pl); } catch (e) { console.warn('移除轨迹失败:', e); }
                }
            });
            if (resetArray) currentTracks = [];
        } catch (e) {
            console.warn('清空轨迹时出错:', e);
        }
    }

    function parseTrackText(text){
        // 选择输入坐标系（优先使用轨迹页签专属选择器，若未设置则回退到绘制页签选择器）
        const coordSysEl = document.getElementById('trackCoordSysSelect') || document.getElementById('coordSysSelect');
        const coordSys = (coordSysEl && coordSysEl.value) || 'wgs84';
        const isHash = text.indexOf('#') !== -1;
        const items = isHash ? text.split('#') : text.split(/\r?\n/);
        const pts = [];
        for (let i=0;i<items.length;i++){
            const raw = items[i];
            if (!raw) continue;
            const line = raw.trim();
            if (!line) continue;
            const parts = line.split(',');
            if (parts.length < 3) continue;
            let lng = parseFloat((parts[isHash ? 0 : 1] || '').trim());
            let lat = parseFloat((parts[isHash ? 1 : 2] || '').trim());
            // 初步过滤：数值合法性与正常范围
            if (!isFinite(lng) || !isFinite(lat)) continue;
            if (lng === 0 || lat === 0) continue; // 丢弃0.0异常点
            if (lng < -180 || lng > 180 || lat < -90 || lat > 90) continue; // 超出经纬度范围丢弃

            // 将输入坐标转换为WGS84
            let w;
            if (coordSys === 'wgs84' || coordSys === 'cgcs2000') {
                w = { lng, lat };
            } else if (coordSys === 'gcj02') {
                w = gcj02ToWgs84(lng, lat);
            } else if (coordSys === 'bd09') {
                const g = bd09ToGcj02(lng, lat);
                w = gcj02ToWgs84(g.lng, g.lat);
            } else {
                w = { lng, lat };
            }
            // 转换结果兜底检查
            if (!isFinite(w.lng) || !isFinite(w.lat)) continue;
            if (w.lng < -180 || w.lng > 180 || w.lat < -90 || w.lat > 90) continue;

            // 使用WGS84坐标绘制到地图
            pts.push(new T.LngLat(w.lng, w.lat));
        }
        return pts;
    }

    function drawTrackFromPoints(points){
        // 先移除旧轨迹（不影响轮廓）
        clearTrackOverlays(false);
        const polyline = new T.Polyline(points, {
            color: '#FF3B30',
            weight: 2.5,
            opacity: 0.9
        });
        if (map) {
            map.addOverLay(polyline);
        }
        currentTracks.push(polyline);
    }

    function clearTrackOverlays(resetArray = true){
        try {
            currentTracks.forEach(pl => {
                if (pl && map && map.removeOverLay) {
                    try { map.removeOverLay(pl); } catch (e) { console.warn('移除轨迹失败:', e); }
                }
            });
            if (resetArray) currentTracks = [];
        } catch (e) {
            console.warn('清空轨迹时出错:', e);
        }
    }


    function fitViewportToTrack(points){
        try {
            if (!map || !map.setViewport || !points || !points.length) return;
            map.setViewport(points);
        } catch (e) {
            console.warn('轨迹视图居中失败:', e);
        }
    }

    // ========= 轨迹回放功能 =========
    let playbackState = { points: [], idx: 0, speed: 1, timer: null, running: false, marker: null, line: null, path: [] };

    function bindPlaybackControls(){
        const startBtn = document.getElementById('playbackStartBtn');
        const pauseBtn = document.getElementById('playbackPauseBtn');
        const stopBtn = document.getElementById('playbackStopBtn');
        const speedSel = document.getElementById('playbackSpeedSelect');
        const timeSlider = document.getElementById('playbackTimeSlider');
        const timeCursor = document.getElementById('playbackTimeCursor');
        const ta = document.getElementById('trackTextarea');
        if (!startBtn || !pauseBtn || !stopBtn || !speedSel) return;

        // 初始按钮状态
        updatePlaybackButtonsState('idle');

        startBtn.addEventListener('click', function(){
            try {
                const text = (ta && ta.value || '').trim();
                if (!text) { alert('请粘贴轨迹文本（时间戳,经度,纬度）'); return; }
                const pts = parseTrackTextWithTime(text);
                if (pts.length < 2) { alert('有效轨迹点不足，至少需要两点'); return; }
                startPlayback(pts);
                // 状态在startPlayback中已设置为playing
            } catch (e) {
                alert('开始回放失败：' + (e && e.message ? e.message : e));
                console.error('开始回放异常:', e);
            }
        });

        pauseBtn.addEventListener('click', function(){
            if (!playbackState.running) {
                // 继续
                playbackState.running = true;
                scheduleNext();
                updatePlaybackButtonsState('playing');
            } else {
                // 暂停
                if (playbackState.timer) { clearTimeout(playbackState.timer); playbackState.timer = null; }
                playbackState.running = false;
                updatePlaybackButtonsState('paused');
            }
        });

        stopBtn.addEventListener('click', function(){ 
            stopPlayback(); 
            updatePlaybackButtonsState('idle');
        });

        speedSel.addEventListener('change', function(){
            const v = parseFloat(speedSel.value);
            playbackState.speed = (isFinite(v) && v > 0) ? v : 1;
        });

        if (timeSlider) {
            timeSlider.addEventListener('input', function(){
                const ms = parseInt(timeSlider.value, 10);
                const txt = formatTimeForLabel(ms);
                if (timeCursor) timeCursor.textContent = txt;
            });
            timeSlider.addEventListener('change', function(){
                jumpToSliderTime();
            });
        }
    }

    function parseTrackTextWithTime(text){
        const coordSysEl = document.getElementById('trackCoordSysSelect') || document.getElementById('coordSysSelect');
        const coordSys = (coordSysEl && coordSysEl.value) || 'wgs84';
        const isHash = text.indexOf('#') !== -1;
        const items = isHash ? text.split('#') : text.split(/\r?\n/);
        const out = [];
        for (let i=0;i<items.length;i++){
            const raw = items[i];
            if (!raw) continue;
            const line = raw.trim();
            if (!line) continue;
            const parts = line.split(',');
            if (parts.length < 3) continue;
            const tsRaw = (parts[isHash ? 2 : 0] || '').trim();
            const ts = (tsRaw || '').replace(/\D/g,'');
            let lng = parseFloat((parts[isHash ? 0 : 1] || '').trim());
            let lat = parseFloat((parts[isHash ? 1 : 2] || '').trim());
            if (!isFinite(lng) || !isFinite(lat)) continue;
            if (lng === 0 || lat === 0) continue;
            if (lng < -180 || lng > 180 || lat < -90 || lat > 90) continue;
            const t = parseTimestamp(ts);
            if (!t) continue;
            let w;
            if (coordSys === 'wgs84' || coordSys === 'cgcs2000') {
                w = { lng, lat };
            } else if (coordSys === 'gcj02') {
                w = gcj02ToWgs84(lng, lat);
            } else if (coordSys === 'bd09') {
                const g = bd09ToGcj02(lng, lat);
                w = gcj02ToWgs84(g.lng, g.lat);
            } else { w = { lng, lat }; }
            if (!isFinite(w.lng) || !isFinite(w.lat)) continue;
            if (w.lng < -180 || w.lng > 180 || w.lat < -90 || w.lat > 90) continue;
            out.push({ ll: new T.LngLat(w.lng, w.lat), time: t, ts });
        }
        out.sort((a,b)=>a.time - b.time);
        return out;
    }

    function parseTimestamp(ts){
        const tstr = (ts || '').replace(/\D/g,'');
        const m = tstr && tstr.match(/^\d{14}$/);
        if (!m) return null;
        const y = parseInt(tstr.slice(0,4),10);
        const M = parseInt(tstr.slice(4,6),10) - 1;
        const d = parseInt(tstr.slice(6,8),10);
        const h = parseInt(tstr.slice(8,10),10);
        const m2 = parseInt(tstr.slice(10,12),10);
        const s = parseInt(tstr.slice(12,14),10);
        const dt = new Date(y,M,d,h,m2,s);
        return isNaN(dt.getTime()) ? null : dt;
    }

    function startPlayback(points){
        console.log('[Playback] startPlayback: 点数=', points && points.length);
        stopPlayback();
        playbackState.points = points;
        playbackState.idx = 0;
        playbackState.speed = playbackState.speed || 1;
        playbackState.running = true;
        // 配置时间滑动条，并尊重现有滑块位置作为起始
        configureTimeSlider(points);
        // 启用滑块
        const slider = document.getElementById('playbackTimeSlider');
        if (slider) slider.disabled = false;
        let initIdx = 0;
        if (slider && slider.min && slider.max) {
            const ms = parseInt(slider.value, 10);
            if (isFinite(ms)) initIdx = findIndexByTime(points, ms);
        }
        playbackState.idx = initIdx;
        const first = points[initIdx];
        console.log('[Playback] 首点:', first && first.ts, first && first.ll, 'initIdx=', initIdx);
        playbackState.path = points.slice(0, initIdx+1).map(p=>p.ll);
        playbackState.line = new T.Polyline(playbackState.path, { color: '#00FFFF', weight: 3, opacity: 0.9 });
        if (map) {
            map.addOverLay(playbackState.line);
        }
        currentTracks.push(playbackState.line);
        // 创建并定位DOM标记以保证可见移动
        ensurePlaybackDom(first.ll);
        updatePlaybackDom(first.ll);
        updatePlaybackTimeLabel(first.ts);
        try { fitViewportToTrack(points.map(p=>p.ll)); } catch(e){}
        // 更新按钮状态
        updatePlaybackButtonsState('playing');
        scheduleNext();
    }

    function scheduleNext(){
        if (!playbackState.running) return;
        if (!playbackState.points || playbackState.idx >= playbackState.points.length - 1) {
            playbackState.running = false;
            console.log('[Playback] 回放结束：idx=', playbackState.idx, '点数=', playbackState.points ? playbackState.points.length : 0);
            updatePlaybackButtonsState('idle'); // 播放结束后按钮回到初始状态：开始可点，继续/结束灰化
            return;
        }
        const next = playbackState.points[playbackState.idx+1];
        const speed = playbackState.speed || 1;
        const delay = Math.max(4, Math.round(1000 / speed)); // 1x=1000ms/点，2x=500ms/点...
        console.log('[Playback] scheduleNext: idx=', playbackState.idx, '->', playbackState.idx+1, 'delay=', delay, 'speed=', speed);
        playbackState.timer = setTimeout(()=>{
            playbackState.idx++;
            const nextLL = next.ll;
            console.log('[Playback] 下一点:', next && next.ts, nextLL);
            try {
                // 维护路径数组
                playbackState.path = playbackState.path || [];
                playbackState.path.push(nextLL);
                console.log('[Playback] 路径长度=', playbackState.path.length);
                // 使用DOM标记进行移动（容器/图层坐标）
                if (!playbackDom.el) console.log('[Playback] DOM标记不存在，将尝试创建');
                updatePlaybackDom(nextLL);
                // 折线更新：优先setLngLats，兜底重建
                if (playbackState.line && typeof playbackState.line.setLngLats === 'function') {
                    try { playbackState.line.setLngLats(playbackState.path); }
                    catch(e){
                        console.warn('[Playback] setLngLats失败，重建折线', e);
                        if (map) { try { map.removeOverLay(playbackState.line); } catch(e){} }
                        playbackState.line = new T.Polyline(playbackState.path, { color: '#00FFFF', weight: 3, opacity: 0.9 });
                        if (map) map.addOverLay(playbackState.line);
                    }
                } else {
                    console.log('[Playback] 折线不支持setLngLats，重建');
                    if (playbackState.line && map) { try { map.removeOverLay(playbackState.line); } catch(e){} }
                    playbackState.line = new T.Polyline(playbackState.path, { color: '#00FFFF', weight: 3, opacity: 0.9 });
                    if (map) map.addOverLay(playbackState.line);
                }
            } catch(e) { console.warn('更新回放覆盖物失败:', e); }
            updatePlaybackTimeLabel(next.ts);
            scheduleNext();
        }, delay);
    }

    function stopPlayback(){
        if (playbackState.timer) { clearTimeout(playbackState.timer); playbackState.timer = null; }
        playbackState.running = false;
        playbackState.idx = 0;
        try {
            // 移除DOM标记
            removePlaybackDom();
            if (playbackState.marker && map) map.removeOverLay(playbackState.marker);
            if (playbackState.line && map) map.removeOverLay(playbackState.line);
        } catch(e){}
        playbackState.marker = null;
        playbackState.line = null;
        updatePlaybackTimeLabel('—');
        // 按钮回到初始状态
        updatePlaybackButtonsState('idle');
    }

    function updatePlaybackTimeLabel(text){
        const el = document.getElementById('playbackTimeLabel');
        if (el) el.textContent = '时间：' + (text || '—');
    }

    // 时间滑动条：配置与跳转
    function configureTimeSlider(points){
        try {
            const slider = document.getElementById('playbackTimeSlider');
            const cursor = document.getElementById('playbackTimeCursor');
            if (!slider || !points || !points.length) return;
            const minMs = points[0].time.getTime();
            const maxMs = points[points.length - 1].time.getTime();
            const prev = parseInt(slider.value, 10);
            slider.min = String(minMs);
            slider.max = String(maxMs);
            slider.step = '1000'; // 以秒为步进
            let val = (isFinite(prev) && prev >= minMs && prev <= maxMs) ? prev : minMs;
            slider.value = String(val);
            if (cursor) cursor.textContent = formatTimeForLabel(val);
        } catch(e) { console.warn('配置时间滑动条失败:', e); }
    }
    function formatTimeForLabel(ms){
        if (!isFinite(ms)) return '—';
        const d = new Date(ms);
        const pad = n => String(n).padStart(2,'0');
        const y = d.getFullYear();
        const M = pad(d.getMonth()+1);
        const da = pad(d.getDate());
        const h = pad(d.getHours());
        const m = pad(d.getMinutes());
        const s = pad(d.getSeconds());
        return `${y}-${M}-${da} ${h}:${m}:${s}`;
    }
    function findIndexByTime(points, ms){
        try {
            if (!points || !points.length) return 0;
            const n = points.length;
            const minMs = points[0].time.getTime();
            const maxMs = points[n-1].time.getTime();
            if (!isFinite(ms)) return 0;
            if (ms <= minMs) return 0;
            if (ms >= maxMs) return n-1;
            let lo = 0, hi = n - 1, ans = 0;
            while (lo <= hi) {
                const mid = (lo + hi) >> 1;
                const t = points[mid].time.getTime();
                if (t < ms) { lo = mid + 1; ans = lo; }
                else { hi = mid - 1; ans = mid; }
            }
            return Math.max(0, Math.min(n-1, ans));
        } catch(e){ console.warn('findIndexByTime失败:', e); return 0; }
    }
    function jumpToSliderTime(){
        try {
            const slider = document.getElementById('playbackTimeSlider');
            if (!slider || !playbackState.points || !playbackState.points.length) return;
            const ms = parseInt(slider.value, 10);
            if (!isFinite(ms)) return;
            const idx = findIndexByTime(playbackState.points, ms);
            playbackState.idx = idx;
            const pts = playbackState.points;
            const ll = pts[idx].ll;
            playbackState.path = pts.slice(0, idx+1).map(p=>p.ll);
            // 更新折线
            try {
                if (playbackState.line && typeof playbackState.line.setLngLats === 'function') {
                    playbackState.line.setLngLats(playbackState.path);
                } else {
                    if (playbackState.line && map) { try { map.removeOverLay(playbackState.line); } catch(e){} }
                    playbackState.line = new T.Polyline(playbackState.path, { color: '#00FFFF', weight: 3, opacity: 0.9 });
                    if (map) map.addOverLay(playbackState.line);
                }
            } catch(e){ console.warn('滑块更新折线失败:', e); }
            // 更新标记与时间
            ensurePlaybackDom(ll);
            updatePlaybackDom(ll);
            updatePlaybackTimeLabel(pts[idx].ts);
            // 若正在播放，立即按新位置继续
            if (playbackState.running) {
                if (playbackState.timer) { clearTimeout(playbackState.timer); playbackState.timer = null; }
                scheduleNext();
            }
        } catch(e) { console.warn('滑块跳转失败:', e); }
    }

    // DOM标记：使用容器坐标实现可见移动
    let playbackDom = { el: null, lastLL: null, bound: false };

    function ensurePlaybackDom(ll){
        try {
            playbackDom.lastLL = ll;
            const pane = (map && map.getPanes && map.getPanes().overlayPane) || document.getElementById('mapContainer');
            if (!pane) { console.warn('未找到overlayPane或mapContainer'); return; }
            if (!playbackDom.el) {
                const el = document.createElement('div');
                el.id = 'playbackDomMarker';
                el.style.position = 'absolute';
                el.style.width = '16px';
                el.style.height = '16px';
                el.style.borderRadius = '50%';
                el.style.background = '#2C64A7';
                el.style.border = '2px solid #fff';
                el.style.boxShadow = '0 0 0 1px rgba(0,0,0,.25)';
                el.style.zIndex = '9999';
                pane.appendChild(el);
                playbackDom.el = el;
                console.log('[Playback] 创建DOM标记，父节点=', pane === document.getElementById('mapContainer') ? '#mapContainer' : 'overlayPane');
                bindPlaybackDomEvents();
            }
            updatePlaybackDom(ll);
        } catch(e) { console.warn('创建DOM标记失败:', e); }
    }

    function updatePlaybackDom(ll){
        try {
            playbackDom.lastLL = ll;
            if (!map || !playbackDom.el || !ll) { console.log('[Playback] update取消：map/el/ll缺失'); return; }
            let p;
            if (typeof map.lngLatToLayerPoint === 'function') {
                p = map.lngLatToLayerPoint(ll);
                console.log('[Playback] 使用layerPoint定位:', ll && ll.lng, ll && ll.lat, '=>', p && p.x, p && p.y);
            } else if (typeof map.lngLatToContainerPoint === 'function') {
                p = map.lngLatToContainerPoint(ll);
                console.log('[Playback] 使用containerPoint定位:', ll && ll.lng, ll && ll.lat, '=>', p && p.x, p && p.y);
            } else {
                console.warn('地图对象不支持lngLat到像素坐标转换');
                return;
            }
            playbackDom.el.style.left = p.x + 'px';
            playbackDom.el.style.top = p.y + 'px';
        } catch(e) { console.warn('更新DOM标记位置失败:', e); }
    }

    function bindPlaybackDomEvents(){
        if (playbackDom.bound) return;
        const updater = function(){
            try {
                if (!map || !playbackDom.el || !playbackDom.lastLL) return;
                let p;
                if (typeof map.lngLatToLayerPoint === 'function') {
                    p = map.lngLatToLayerPoint(playbackDom.lastLL);
                } else if (typeof map.lngLatToContainerPoint === 'function') {
                    p = map.lngLatToContainerPoint(playbackDom.lastLL);
                }
                if (!p) return;
                playbackDom.el.style.left = p.x + 'px';
                playbackDom.el.style.top = p.y + 'px';
            } catch(e){}
        };
        try {
            map.addEventListener('move', updater);
            map.addEventListener('zoom', updater);
            playbackDom.bound = true;
        } catch(e){}
    }

    function removePlaybackDom(){
        try {
            const el = playbackDom.el;
            playbackDom.lastLL = null;
            if (el && el.parentNode) el.parentNode.removeChild(el);
        } catch(e){}
        playbackDom.el = null;
        playbackDom.bound = false;
    }

</script>
</body>

</html>
