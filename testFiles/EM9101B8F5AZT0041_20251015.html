<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>展示轮廓</title>
    <style>
        body {
            margin: 0;
            padding: 0;
        }

        #mapContainer {
            width: 100vw;
            height: 100vh;
            position: relative;
        }

        #mapLoading {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 999;
            transition: opacity 0.3s;
        }

        .loading-text {
            font-size: 16px;
            color: #333;
            padding: 10px 20px;
            background: white;
            border-radius: 4px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        .wkt-input-container {
            position: absolute;
            top: 20px;
            right: 10px;
            z-index: 1000;
            background: white;
            padding: 12px;
            border-radius: 6px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
            width: min(320px, 90vw);
            box-sizing: border-box;
            transition: all 0.3s;
        }

        .minimize-btn {
            position: absolute;
            top: -5px;
            right: -4px;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #f0f0f0;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            color: #666;
            z-index: 1001;
            transition: background 0.2s;
        }

        .minimize-btn:hover {
            background: #e0e0e0;
        }

        .content-wrapper {
            transition: all 0.3s;
        }

        .wkt-input-container.minimized {
            width: 40px;
            height: 40px;
            padding: 0;
        }

        .wkt-input-container.minimized .content-wrapper {
            display: none;
        }

        .wkt-input-container.minimized .min-icon {
            display: none;
        }

        .wkt-input-container.minimized .restore-icon {
            display: inline;
        }

        #wktTextarea {
            width: 100%;
            height: 120px;
            margin-bottom: 10px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-family: monospace;
            resize: vertical;
            box-sizing: border-box;
        }

        .button-group {
            display: flex;
            gap: 10px;
        }

        /* 页签样式 */
        .tabs-header {
            display: flex;
            gap: 8px;
            margin-bottom: 8px;
        }
        .tab-btn {
            flex: 1;
            padding: 6px 0;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 13px;
            background: #f5f5f5;
            color: #333;
            transition: background 0.2s;
        }
        .tab-btn.active { background: #337AFF; color: #fff; }
        .tab-pane { display: none; }
        .tab-pane.active { display: block; }

        /* Multi → Polygons 分割器样式 */
        .split-section {
            margin-top: 10px;
            padding: 10px;
            background: #fafafa;
            border: 1px solid #eee;
            border-radius: 6px;
        }
        .split-section .title {
            font-size: 13px;
            font-weight: 600;
            color: #333;
            margin-bottom: 6px;
        }
        .split-section .desc {
            font-size: 12px;
            color: #666;
            margin-bottom: 8px;
        }
        #multiInput, #polyOutput {
            width: 100%;
            height: 90px;
            margin-bottom: 8px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-family: monospace;
            resize: vertical;
            box-sizing: border-box;
        }
        .split-actions {
            display: flex;
            gap: 8px;
            margin-bottom: 8px;
        }
        .split-actions button {
            flex: 1;
            padding: 6px 0;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 13px;
            transition: background 0.2s;
        }
        #splitMultiBtn { background: #337AFF; color: #fff; }
        #splitMultiBtn:hover { background: #2860E0; }
        #copyPolysBtn { background: #f5f5f5; color: #333; }
        #copyPolysBtn:hover { background: #e0e0e0; }
        #drawButton,
        #clearButton,
        #drawTrackButton,
        #clearTrackButton {
            width: 50%;
            padding: 8px 0;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.2s;
        }

        #drawButton,
        #drawTrackButton {
            background: #337AFF;
            color: white;
        }

        #drawButton:hover,
        #drawTrackButton:hover {
            background: #2860E0;
        }

        #clearButton,
        #clearTrackButton {
            background: #f5f5f5;
            color: #333;
        }

        #clearButton:hover,
        #clearTrackButton:hover {
            background: #e0e0e0;
        }

        #drawButton:disabled,
        #clearButton:disabled,
        #drawTrackButton:disabled,
        #clearTrackButton:disabled {
            background: #e0e0e0;
            color: #999;
            cursor: not-allowed;
        }

        .tip {
            font-size: 12px;
            color: #666;
            margin-bottom: 8px;
            line-height: 1.4;
        }

        .area-label {
             position: absolute;
             background: rgba(255, 0, 0, 0.85);
             border: 1px solid #000;
             border-radius: 3px;
             padding: 4px 6px;
             font-size: 12px;
             color: #fff;
             font-weight: 600;
             box-shadow: 0 2px 6px rgba(0, 0, 0, 0.25);
             white-space: nowrap;
             z-index: 9999;
             pointer-events: none;
         }
         /* 默认隐藏标签容器下的标签 */
          .labels-hidden .area-label { display: none; }

          /* Batch → Generator 样式 */
          .batch-section { margin-top: 10px; padding: 10px; background: #fafafa; border: 1px solid #eee; border-radius: 6px; }
          .batch-section .title { font-size: 13px; font-weight: 600; color: #333; margin-bottom: 6px; }
          .batch-section .desc { font-size: 12px; color: #666; margin-bottom: 8px; }
          #batchInput, #multiOutput { width: 100%; height: 90px; margin-bottom: 8px; padding: 8px; border: 1px solid #ddd; border-radius: 4px; font-family: monospace; resize: vertical; box-sizing: border-box; }
          .batch-actions { display: flex; gap: 8px; margin-bottom: 8px; }
          .batch-actions button { flex: 1; padding: 6px 0; border: none; border-radius: 4px; cursor: pointer; font-size: 13px; transition: background 0.2s; }
          #generateMultiBtn { background: #337AFF; color: #fff; }
          #generateMultiBtn:hover { background: #2860E0; }
          #copyMultiBtn { background: #f5f5f5; color: #333; }
          #copyMultiBtn:hover { background: #e0e0e0; }
          
          /* 左侧工具条样式 */
          #leftToolbar {
              position: absolute;
              bottom: 20px;
              left: 20px;
              z-index: 1000;
              background: white;
              border-radius: 4px;
              box-shadow: 0 1px 4px rgba(0, 0, 0, 0.15);
              padding: 6px 0;
              display: flex;
              flex-direction: column;
              gap: 2px;
              width: 40px;
          }
          
          .toolbar-btn {
              width: 100%;
              padding: 6px 0;
              border: none;
              background: transparent;
              cursor: pointer;
              font-size: 12px;
              color: #333;
              transition: background 0.2s;
              display: flex;
              flex-direction: column;
              align-items: center;
              justify-content: center;
          }
          
          .toolbar-btn:hover {
              background: #f5f5f5;
          }
          
          .toolbar-btn span {
              font-size: 12px;
              margin-top: 4px;
          }
          
          .toolbar-divider {
            height: 1px;
            background-color: #e0e0e0;
            margin: 2px 4px;
        }
        
        /* 颜色选择器样式 */
        .color-picker-container {
            margin-top: 10px;
            padding: 10px;
            background-color: #f9f9f9;
            border-radius: 4px;
            border: 1px solid #e0e0e0;
        }
        
        .color-picker-title {
            font-size: 13px;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }
        
        .color-picker-row {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }
        
        .color-picker-label {
            font-size: 12px;
            color: #555;
            width: 60px;
            flex-shrink: 0;
        }
        
        .color-picker {
            width: 30px;
            height: 30px;
            border: 1px solid #ccc;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 8px;
            flex-shrink: 0;
        }
        
        .color-input {
            flex: 1;
            padding: 4px 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 12px;
            font-family: monospace;
        }
        
        .opacity-slider-container {
            display: flex;
            align-items: center;
            margin-top: 8px;
        }
        
        .opacity-slider {
            flex: 1;
            margin-right: 8px;
        }
        
        .opacity-value {
            font-size: 12px;
            color: #555;
            width: 40px;
            text-align: right;
        }
      </style>
    <script src="https://api.tianditu.gov.cn/api?v=4.0&tk=648f621977051d0199ff0f965d3fd322"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/Turf.js/6.5.0/turf.min.js"></script>
    <script src="https://lib.baomitu.com/terraformer/1.0.12/terraformer.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://unpkg.com/terraformer-wkt-parser@1.2.1/terraformer-wkt-parser.min.js" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <!-- 已移除动态备用加载器 ensureTerraformer：改为仅使用静态脚本标签加载 Terraformer 核心库与 WKT 解析器 -->
    <script>
        // 检查Turf.js是否加载成功
        window.addEventListener('load', function () {
            if (typeof turf === 'undefined') {
                console.warn('Turf.js加载失败，已启用备用面积算法');
            } else {
                console.log('Turf.js加载成功');
            }
        });
    </script>
</head>

<body>
<!-- 左侧工具条 -->
<div id="leftToolbar">
    <button class="toolbar-btn" id="measureDistanceBtn" title="测距">
        <span>测距</span>
    </button>
    <div class="toolbar-divider"></div>
    <button class="toolbar-btn" id="measureAreaBtn" title="测面">
        <span>测面</span>
    </button>
    <div class="toolbar-divider"></div>
    <button class="toolbar-btn" id="mapTypeBtn" title="切换地图类型">
        <span>地图</span>
    </button>
</div>

<div id="mapContainer">
    <div id="mapLoading">
        <div class="loading-text">地图正在加载中...</div>
    </div>
</div>

<div class="wkt-input-container">
    <div class="minimize-btn" id="minimizeBtn">
        <span class="min-icon">−</span>
        <span class="restore-icon" style="display:none;">+</span>
    </div>

    <div class="content-wrapper">
        <div class="tabs-header">
            <button class="tab-btn active" id="tabDrawBtn">轮廓</button>
            <button class="tab-btn" id="tabTrackBtn">轨迹</button>
            <button class="tab-btn" id="tabSplitBtn">分割器</button>
            <button class="tab-btn" id="tabBatchBtn">合并器</button>
        </div>
        <div class="tab-pane active" id="tabDraw">
            <div class="tip">请输入WKT字符串（支持POLYGON/MULTIPOLYGON）：</div>
            <textarea id="wktTextarea">POLYGON ((124.48584118558382 45.33117103543205, 124.48584124453785 45.33117102361691, 124.48584130560765 45.3311710199757, 124.485841366537 45.3311710246429, 124.48584142507497 45.33117103744611, 124.48584147905885 45.33117105791233, 124.48584152649428 45.33117108528544, 124.48584156562879 45.33117111855415, 124.48584159501658 45.33117115648941, 124.48584161357196 45.331171197689706, 124.48584162060946 45.33117124063294, 124.48584306174152 45.331225222756174, 124.48584344178637 45.331227450495646, 124.48584344880277 45.33122747255441, 124.48584445445891 45.33122960128849, 124.48584446760412 45.331229621906886, 124.4858460580192 45.3312315651622, 124.48584607675888 45.331231583502365, 124.48584818732512 45.33123326233743, 124.485848210898 45.331233277654455, 124.48585075587728 45.33123462386943, 124.48585078325772 45.33123463551216, 124.48585368900245 45.33123560308058, 124.485864873349 45.33123839916754, 124.4858649315749 45.331238418592335, 124.48586498307837 45.33123844587448, 124.48586502575783 45.3312384799008, 124.48586599974027 45.33123943584777, 124.48586603180858 45.33123947515806, 124.48586605204363 45.33123951820709, 124.48586605962261 45.33123956324435, 124.48586605423736 45.33123960843842, 124.48586603610676 45.331239651951535, 124.48586600596818 45.33123969201424, 124.48586596504715 45.33123972699743, 124.48586591500762 45.33123975547856, 124.48586585788446 45.331239776299455, 124.48586579600058 45.33123978861346, 124.48586270176948 45.33124017217192, 124.48586267118952 45.33124017823448, 124.48585973664107 45.33124099069455, 124.48585970837907 45.331241000923, 124.4858570612887 45.33124220854481, 124.48585703647261 45.33124222253096, 124.48585478244769 45.33124377713551, 124.48585476206708 45.33124379432162, 124.48585299103301 45.331245633887356, 124.48585297590182 45.33124565358708, 124.48585175851517 45.33124770472355, 124.48585174923652 45.33124772615117, 124.48585113406628 45.331249907026304, 124.48585113101005 45.331249929328116, 124.48585114259872 45.3312521529343, 124.48585114587904 45.33125217516376, 124.48585179175323 45.33125437456171, 124.4858542042339 45.33125980264652, 124.48585421742374 45.33125984879358, 124.48585421670582 45.331259895866374, 124.48585420211157 45.33125994180262, 124.4858448898351 45.331279416378656, 124.48584418840746 45.33128156768778, 124.48584418442137 45.331281589752685, 124.4858440985787 45.33128379638341, 124.4858441008433 45.331283818568906, 124.48584463395922 45.33128599376641, 124.48584464238535 45.33128601520071, 124.48584577349902 45.331288073441605, 124.48584578775525 45.33128809328145, 124.48584747239376 45.33128995363958, 124.48584749191969 45.33128997110554, 124.48584966384666 45.3312915604359, 124.48584968787492 45.33129157484117, 124.4858522616946 45.33129283065446, 124.48585228928022 45.33129284143251, 124.48585486601951 45.33129362392567, 124.48585491779932 45.33129364383826, 124.48585496349422 45.331293670136475, 124.48585500154111 45.33129370192067, 124.4858550306385 45.331293738103504, 124.48585504979093 45.33129377744721, 124.48585505834313 45.331293818605864, 124.48585505600266 45.33129386017144, 124.48585096329482 45.331315551494, 124.48585094786294 45.33131559675846, 124.48585091954953 45.33131563881219, 124.48585087956761 45.33131567585333, 124.48584737635377 45.33131830494322, 124.48584543430962 45.33132009441235, 124.48584541743065 45.33132011374589, 124.48584402611627 45.33132214238284, 124.48584401510348 45.33132216371739, 124.48584323149949 45.33132434842437, 124.48584322681529 45.33132437083, 124.48584308319818 45.331326644877606, 124.48584605529696 45.33136379627235, 124.48584605184088 45.33136384428987, 124.48584603399422 45.33136389069208, 124.48584600257242 45.33136393335844, 124.48584595901161 45.33136397033909, 124.48584479183258 45.331364769324274, 124.48584477085109 45.33136478698533, 124.48584295455305 45.331366681640276, 124.48584293917035 45.33136670190145, 124.48584169926687 45.33136884020038, 124.48583170091209 45.33139284025516, 124.48583111734041 45.331395035208615, 124.485831114635 45.33139505762852, 124.48583116390058 45.33139729056844, 124.4858311675936 45.33139731291775, 124.48583184771256 45.33139949399484, 124.4858318576558 45.33139951537558, 124.4858331412596 45.33140155682194, 124.48583315705231 45.33140157637198, 124.48583499248853 45.33140339603941, 124.48583501349613 45.33140341297338, 124.48583732690582 45.33140493763733, 124.48583735228225 45.33140495127297, 124.48583787522612 45.33140517769751, 124.4858379177322 45.331405199710694, 124.48583795451336 45.3314052263642, 124.48583798456352 45.33140525692903, 124.48584320008146 45.33141162947399, 124.48584491279125 45.331413331389896, 124.48584493225651 45.33141334732605, 124.48584706520938 45.33141479384438, 124.48584708854975 45.33141480693796, 124.48584956679368 45.331415947232145, 124.4858495931893 45.33141595702309, 124.48585161319605 45.3314165431405, 124.48585166768007 45.33141656349559, 124.48585171559161 45.331416590866155, 124.48585175513955 45.331416624228915, 124.48585178484514 45.33141666233646, 124.48585180359773 45.331416703764035, 124.48585181069629 45.33141674696277, 124.4858526155228 45.33144733068962, 124.4858526112288 45.331447371882355, 124.48585259632733 45.33144741182657, 124.48585257132095 45.33144744917507, 124.48585253705296 45.3314474826682, 124.48585249467928 45.331447511176364, 124.48585244562898 45.33144753373806, 124.48585218902448 45.3314476293299, 124.4858521623951 45.331447641814215, 124.48584970946033 45.331449061995144, 124.48584968690993 45.331449077984615, 124.4858476863432 45.331450815573184, 124.48584766878363 45.33145083442112, 124.48584620146255 45.33145281917139, 124.48584618960354 45.33145284011602, 124.48584531484815 45.33145499178947, 124.48584530916901 45.33145501398452, 124.48584506234353 45.33145724559455, 124.485845063074 45.33145726814197, 124.48584545415696 45.3314594894709, 124.48584546126744 45.331459511459464, 124.4858464744486 45.33146163270459, 124.4858464876512 45.33146165324472, 124.48584808197043 45.331463588649534, 124.48584810068537 45.33146360686653, 124.48585023420574 45.33146529431899, 124.48585286139672 45.33146699426681, 124.48585290602746 45.33146702998394, 124.48585293899905 45.33146707152731, 124.4858529588341 45.33146711703526, 124.48585296464361 45.331467164468556, 124.48585255009344 45.33148188085909, 124.48585254337884 45.33148192251581, 124.48585252581977 45.331481962569754, 124.48584326958017 45.33149770100305, 124.48584236814244 45.33149979441587, 124.48584236204157 45.33149981603833, 124.48584205845853 45.33150199336879, 124.48584205847085 45.331502015414685, 124.48584236446489 45.33150419257691, 124.48584237058995 45.33150421419665, 124.48584327434244 45.33150630710449, 124.48584328634368 45.33150632746165, 124.48584475295098 45.331508255284575, 124.48584477036451 45.33150827359261, 124.48584674318381 45.331509961874524, 124.48584676533656 45.33150997742638, 124.485849168174 45.33151136096269, 124.485849194212 45.33151137315869, 124.48585151971967 45.33151224338727, 124.48585156868677 45.331512266000246, 124.48585161096914 45.33151229454527, 124.48585164514218 45.33151232806057, 124.4858516700545 45.33151236541695, 124.48585168486679 45.33151240535581, 124.48585168908004 45.331512446531484, 124.4858510601903 45.331534781159604, 124.48585306018565 45.33160322857762, 124.48585314265345 45.33160416484055, 124.48586314501713 45.33167217087843, 124.48586374990029 45.33167427590529, 124.48586375886919 45.33167429660598, 124.48586492559055 45.33167628052517, 124.48586494002782 45.33167629962516, 124.48586662516017 45.331678088592255, 124.48586664452873 45.33167810538127, 124.48586878534769 45.33167963280688, 124.48586880892678 45.33167964666005, 124.48587132574644 45.33168085569007, 124.4858713526581 45.331680866091666, 124.48587415179715 45.33168171172348, 124.48587418104029 45.33168171828645, 124.48587715830872 45.33168216904383, 124.48587718879406 45.331682171523745, 124.4858802333718 45.33168221062859, 124.48588026396492 45.331682208933195, 124.48588326252646 45.33168183492988, 124.48588329208818 45.33168182912233, 124.48588613302054 45.33168105593201, 124.48588616045097 45.331681046228496, 124.48588873800844 45.33167990263092, 124.48588876228655 45.33167988939259, 124.48589098052665 45.331678417955146, 124.48589100074909 45.331678401674615, 124.48589277710435 45.33167665716725, 124.48589279251797 45.331676638450745, 124.48589406086883 45.33167468580773, 124.48589407090022 45.33167466535143, 124.48589478403602 45.331672577254466, 124.48589478830073 45.33167255587374, 124.48589491953345 45.33167038832545, 124.48588395687881 45.33152588113964, 124.48588395657313 45.33152586222827, 124.4858845101576 45.331513129710295, 124.48588451871147 45.331513084414446, 124.48588454006892 45.33151304127304, 124.48588457334816 45.33151300206696, 124.48588461717554 45.33151296841467, 124.48588466974174 45.33151294170535, 124.48588472887691 45.33151292304161, 124.48588479213977 45.331512913193855, 124.48588485691887 45.33151291256864, 124.48588492054012 45.33151292119175, 124.48588498037707 45.33151293870725, 124.48588503395976 45.331512964392076, 124.4858850790761 45.33151299718594, 124.48592648708367 45.33154996861691, 124.48592702566152 45.331550424482735, 124.48599823126492 45.33160758628726, 124.48621316162803 45.331773532574225, 124.4866510904902 45.332120476271236, 124.4869151721336 45.332322541371155, 124.48719006264045 45.33254145420957, 124.48726629758649 45.33259963683375, 124.48726752480411 45.33260047753756, 124.48728053124367 45.33260848004429, 124.48728307119679 45.332609754918096, 124.48728309846342 45.33260976591855, 124.48728594411196 45.332610663810165, 124.48728597391232 45.33261067081613, 124.48728901425848 45.33261115670457, 124.48728904543015 45.332611159442735, 124.48729216186948 45.332611214373415, 124.48729219319613 45.33261121273686, 124.48729526415558 45.332610834566985, 124.48729529441533 45.33261082861953, 124.48729820009632 45.33261003210155, 124.48729822810809 45.33261002207538, 124.48730085515957 45.3326088382815, 124.48730087983097 45.33260882456772, 124.48730312577027 45.332607299678266, 124.48730314613923 45.3326072828116, 124.48730492335221 45.332605476312764, 124.48730493862386 45.332605456951434, 124.48730617778094 45.332603439315115, 124.48730618735961 45.33260341821443, 124.48730684012105 45.332601268148856, 124.48730684363296 45.33260124613226, 124.48730688453452 45.33259904751243, 124.48730688184268 45.33259902543734, 124.487306309289 45.332596864032595, 124.48730630052015 45.33259684281402, 124.48730512366072 45.33259478274144, 124.48728854726959 45.332572404635194, 124.48728852356689 45.3325723629543, 124.48728851207755 45.332572318782766, 124.48728851325947 45.332572273881745, 124.48728852706562 45.33257223004148, 124.48728855294554 45.3325721890099, 124.4872885898673 45.33257215242298, 124.48728863635895 45.33257212173946, 124.48728869056676 45.3325720981827, 124.4872887503294 45.33257208269197, 124.48728881326409 45.33257207588485, 124.4872888768616 45.33257207803276, 124.48728893858632 45.332572089050075, 124.48728899597705 45.332572108497516, 124.48730891195557 45.332580679924725, 124.48730896141943 45.33258070617783, 124.4873562343652 45.33261129312988, 124.48735869469076 45.33261259908074, 124.48735988891737 45.33261311423784, 124.4873599390816 45.33261314100716, 124.4873599808192 45.332613174201526, 124.48736001250595 45.33261321252914, 124.48736003290861 45.33261325449841, 124.48736004123334 45.33261329847609, 124.48736003715604 45.332613342750705, 124.48736002083547 45.332613385599245, 124.48735999290669 45.332613425354246, 124.48735995445666 45.33261346046859, 124.48732539547107 45.33263929026922, 124.48732352251163 45.332640994255605, 124.48732350608307 45.33264101263607, 124.48732213394176 45.33264293931264, 124.48732212287251 45.3326429595311, 124.48732129616593 45.33264505788486, 124.48731829764073 45.3326570582577, 124.48731806192247 45.33265924481585, 124.48731806263542 45.33265926690661, 124.48731843915284 45.33266144362512, 124.48731844599122 45.33266146518925, 124.48731942013461 45.33266354762355, 124.48731943283329 45.33266356782395, 124.48732096680644 45.332665475177166, 124.48732098487272 45.332665493230024, 124.48732301915832 45.33266715149753, 124.48732304189113 45.33266716670237, 124.4873254975609 45.332668511545094, 124.4873255240776 45.3326685233117, 124.4873283058529 45.33266950255017, 124.48732833512499 45.3326695104223, 124.48733133507416 45.332670086062514, 124.48733136596654 45.33267008973489, 124.48733446769305 45.33267023944235, 124.48733449900686 45.33267023877237, 124.48733758216595 45.332669956738556, 124.48733761260974 45.33266995176469, 124.48734058683283 45.332669240807306, 124.48738642181688 45.33265461262061, 124.48738646824079 45.33265460076376, 124.48742626418985 45.33264683476792, 124.4874289295835 45.332646127651664, 124.48753493033826 45.332610126162734, 124.48753760296646 45.33260897531515, 124.48753762807006 45.33260896192541, 124.48753994814666 45.33260744562546, 124.48766294670794 45.332509445186496, 124.48766472914505 45.33250771512733, 124.48766474465098 45.33250769655552, 124.48766602518106 45.33250575802321, 124.48766603534077 45.33250573775322, 124.48766677268067 45.332503641071305, 124.48766845674588 45.33249564176296, 124.48766847088321 45.3324956011188, 124.48766849545173 45.332495563025645, 124.4876685296006 45.33249552880245, 124.48772375572737 45.33244988273143, 124.48772379077566 45.33244985795777, 124.48780404385309 45.33240134329897, 124.48780410023576 45.332401316023365, 124.48800020460213 45.332326869013805, 124.48800025925925 45.33232685268934, 124.48800031725892 45.332326843792714, 124.48801776759095 45.33232534804341, 124.48801783248926 45.332325347174894, 124.48801789629233 45.33232535559418, 124.48801795635613 45.332325372952404, 124.48819378304846 45.33239165315738, 124.48819380979558 45.33239166445915, 124.48839443449145 45.33248613338234, 124.4883944888783 45.33248616572037, 124.48839453174784 45.332486205757924, 124.48839456096664 45.332486251502544, 124.48842376155434 45.33255021475682, 124.48842377379566 45.332550252377544, 124.48842377673664 45.33255029092059, 124.48842377029058 45.33255032925071, 124.48842375464743 45.3325503662389, 124.48835316235574 45.332676557716574, 124.48835314787674 45.33267657996856, 124.48826788739295 45.33279077015218, 124.48826672088188 45.33279279149487, 124.48826671201418 45.33279281257842, 124.48826612701009 45.33279495559636, 124.48826612414452 45.33279497749462, 124.48826614312861 45.33279715983376, 124.48826614637497 45.332797181705146, 124.48826646333626 45.332798270665634, 124.48826646974463 45.3327983100937, 124.48826646622786 45.33279834970241, 124.4882664528953 45.33279838825847, 124.4882664301621 45.33279842456137, 124.48816303484122 45.33293057677162, 124.4881618125871 45.332932581662526, 124.48816180313725 45.33293260262005, 124.48816115891238 45.332934737171826, 124.488161155441 45.33293475902642, 124.4881611140019 45.33293694121123, 124.488161116642 45.33293696312275, 124.48816167958145 45.332939109079256, 124.48816168823195 45.33293913020759, 124.48816283391646 45.332941157468134, 124.48816284824436 45.33294117699971, 124.48816453264583 45.332943007657605, 124.48816455210125 45.332943024842734, 124.48816671048928 45.33294458854729, 124.48816673432381 45.33294460272483, 124.48816928375281 45.33294583938357, 124.48816931105105 45.33294585000914, 124.48817215354768 45.33294671209786, 124.48817218326015 45.33294671876288, 124.48817520958913 45.3329471731521, 124.48817524057435 45.33294717560055, 124.48817833443496 45.332947204828244, 124.4881783655022 45.33294720296599, 124.48818140799938 45.33294680590901, 124.48818143795452 45.332946799807615, 124.48818431216672 45.33294599172466, 124.48818433985873 45.33294598161857, 124.48818693533151 45.33294479356385, 124.48818695969618 45.33294477984142, 124.48818917668694 45.33294325747122, 124.48818919673784 45.33294324070174, 124.48819096650647 45.33294142374876, 124.48835996327634 45.33272542684906, 124.4883608344509 45.332724120698636, 124.48838217297656 45.332685975821775, 124.48838218745546 45.33268595356991, 124.48846411263165 45.33257622967672, 124.48846529125545 45.33257417936115, 124.48846530016246 45.332574157971145, 124.48846588067244 45.33257198375066, 124.48846588340642 45.33257196154138, 124.48846584287557 45.33256974928728, 124.48846583933761 45.33256972718953, 124.488465171173 45.33256754265978, 124.48845768106999 45.33255113580071, 124.48845766882897 45.332551098181675, 124.48845766588748 45.33255105964037, 124.48845767233219 45.33255102131189, 124.4884576879732 45.332550984324996, 124.48847383476475 45.332522117467214, 124.48847464518917 45.332520159764606, 124.48847465076105 45.33252013958688, 124.48847494125394 45.3325181104604, 124.48847494151364 45.33251808990378, 124.4884747023271 45.33251605744898, 124.48847469726581 45.33251603720395, 124.48847393642711 45.33251406962972, 124.48847392621464 45.332514050375714, 124.48847266925827 45.332512213715304, 124.48847265427402 45.33251219614133, 124.48847092503182 45.332510535979345, 124.48836292537615 45.33242453737623, 124.48836108533882 45.33242329140705, 124.48836106545383 45.33242327996927, 124.48835894309967 45.33242224961425, 124.48806093860661 45.33230124928559, 124.48805784764993 45.332300288397846, 124.48805781522753 45.33230028112491, 124.48805450517825 45.332299806146274, 124.48805447138908 45.33229980391157, 124.48805105975929 45.33229983820513, 124.48802411669945 45.33230214762813, 124.48802405182764 45.3323021484982, 124.48802398804918 45.332302140087975, 124.4880239280047 45.33230212274568, 124.48801850044408 45.33230007797924, 124.48801563320025 45.332299241076235, 124.48801560327259 45.332299234687085, 124.48801255933756 45.33229880963292, 124.48801252821632 45.33229880749719, 124.48800942520495 45.33229881070998, 124.48800939409284 45.33229881291014, 124.48800635194007 45.33229924426574, 124.4880063221139 45.332299250700686, 124.48800343006383 45.33230010303568, 124.48799049381087 45.3323050140384, 124.48799043915587 45.3323050303624, 124.48799038115837 45.3323050392591, 124.48787606135927 45.33231483917634, 124.4878729865515 45.3323153250733, 124.48779999245625 45.332332324142286, 124.48779817898874 45.3323328357604, 124.48773817864674 45.33235283641388, 124.48773634265845 45.33235355694677, 124.48766274831097 45.332387075177955, 124.48766269679132 45.33238709419124, 124.48766264123309 45.332387106289595, 124.48766258348383 45.33238711107077, 124.48766252546385 45.33238710837574, 124.48766246910229 45.33238709829414, 124.48766241627332 45.3323870811612, 124.48766236873368 45.33238705754664, 124.48766207661603 45.33238688227598, 124.4876620489502 45.3323868635406, 124.48751884029734 45.33227746805737, 124.48746845149024 45.332237175800294, 124.48740978841079 45.33219442135884, 124.48740977582558 45.33219441163223, 124.48735975270732 45.33215340127497, 124.4871468605692 45.331989484349016, 124.48704170918558 45.33190536795956, 124.48682200793623 45.331737596122764, 124.48682199670515 45.331737587072254, 124.486774820598 45.33169745391787, 124.48662475172537 45.331580400608026, 124.48629086515292 45.33132348792593, 124.48618467150075 45.33123833939525, 124.48600677194894 45.33110341559836, 124.48588085223773 45.331004480359525, 124.48587857842621 45.33100301173961, 124.48587855357361 45.33100299858976, 124.4858759183695 45.331001869786036, 124.48587589036592 45.33100186029469, 124.48587299432238 45.33100111437934, 124.4858729642373 45.33100110890912, 124.4858699178605 45.331000774344524, 124.4858698868419 45.33100077310409, 124.48586680637537 45.33100086265655, 124.48586677560654 45.33100086569323, 124.48586377859402 45.331001375945625, 124.48586374924932 45.33100138314349, 124.48586095461089 45.33100229314072, 124.48586089691833 45.33100230737576, 124.48586083643508 45.331002313584825, 124.48586077538334 45.3310023115398, 124.4858607160064 45.331002301315806, 124.48586066048603 45.33100228328852, 124.48586061086215 45.33100225812031, 124.48584649317397 45.33099353518918, 124.48584392619894 45.330992244139175, 124.48584389862147 45.33099223301773, 124.48584101908138 45.33099132759398, 124.48584098892051 45.33099132056056, 124.48583791169953 45.33099083688438, 124.48583788015858 45.33099083421954, 124.48583472803985 45.33099079159, 124.48583469637727 45.33099079340007, 124.48583159513201 45.33099119351807, 124.48583156461122 45.33099119973081, 124.48582863798147 45.33099202663136, 124.48582860981969 45.33099203699906, 124.48582597457977 45.33099325768825, 124.48582594990108 45.33099327179718, 124.48582371119858 45.33099483756863, 124.48582369098747 45.33099485485614, 124.48582193814751 45.33099670323499, 124.48582192321155 45.33099672300995, 124.48582072617343 45.33099878024537, 124.4858207171077 45.33099880171974, 124.48582056344272 45.330999367213444, 124.48582054453819 45.33099941150997, 124.48582051318489 45.33099945214135, 124.48582047070927 45.330999487388645, 124.48582041890836 45.330999515760666, 124.4858203599736 45.3309995360571, 124.485819123264 45.33099985564383, 124.48581909582649 45.3309998649202, 124.48581651062004 45.33100096481612, 124.48581648618804 45.33100097760805, 124.48581424519355 45.33100240458753, 124.48581422466201 45.3310024204266, 124.48581240987731 45.331004122276646, 124.48581239399776 45.331004140582635, 124.48581107182635 45.33100605503248, 124.48581106117891 45.331006075136486, 124.48581028000001 45.3310081321353, 124.48581027498683 45.33100815324886, 124.48581006269025 45.33101029905758, 124.48581206431567 45.33106529959951, 124.48581246551394 45.33106752414935, 124.48581247273611 45.33106754616182, 124.48581349784601 45.331069668866625, 124.4858135111758 45.33106968941137, 124.4858151186035 45.33107162414398, 124.48581513750058 45.33107164238803, 124.48581726202457 45.33107331064644, 124.48581728572199 45.33107332584922, 124.48581984113994 45.3310746599441, 124.48581986867605 45.331074671488594, 124.48582275130158 45.33107561728894, 124.48582278155894 45.33107562470674, 124.48582587442966 45.331076143836654, 124.4858259061804 45.331076146826774, 124.48582908380298 45.33107621822247, 124.48582911575902 45.331076216663725, 124.4858322492008 45.33107583742821, 124.48583228006571 45.33107583138383, 124.48583524218678 45.33107501690472, 124.48583527070842 45.33107500661987, 124.48583794132063 45.331073789944796, 124.4858379663418 45.33107377583663, 124.48584023708501 45.331072206332266, 124.48584025759006 45.33107218897345, 124.48584203632919 45.33107033032216, 124.48584205148568 45.331070310417346, 124.48584326604777 45.331068238034646, 124.48584327521881 45.33106821644439, 124.48584388081883 45.33106599195979, 124.4858459839496 45.331049429781025, 124.48584599527568 45.331049387252044, 124.48584601793911 45.33104934704019, 124.48584605110095 45.33104931063405, 124.48584609353365 45.33104927938135, 124.48584614366645 45.331049254439, 124.4858461996434 45.331049236730344, 124.48584625939226 45.33104922691094, 124.48584632070133 45.3310492253443, 124.485846381301 45.33104923208838, 124.48584643894797 45.33104924689356, 124.48584649150806 45.33104926921176, 124.48584653703577 45.33104929821679, 124.48584657384555 45.3310493328349, 124.4858763929571 45.33108385844353, 124.4858781100843 45.331085491610565, 124.48588938238916 45.33109440847291, 124.48588942027921 45.33109444538208, 124.48588944684379 45.331094486920776, 124.48588946099247 45.33109453138375, 124.48588946214447 45.3310945769457, 124.48588945025234 45.33109462173623, 124.48588942580439 45.33109466391659, 124.48588938980416 45.33109470175519, 124.48588934372955 45.33109473369869, 124.4858892894722 45.33109475843572, 124.48588922925926 45.331094774950806, 124.48588916556268 45.331094782565934, 124.48588910099737 45.33109478096852, 124.48588903821374 45.33109477022413, 124.48588897978935 45.33109475077383, 124.48588686639799 45.331093852212895, 124.4858868382558 45.33109384276288, 124.48588392863365 45.331093102498656, 124.4858838984185 45.33109309710146, 124.48588083998436 45.331092771318495, 124.4858808088572 45.33109277018152, 124.4858777190745 45.331092871391895, 124.48587768823052 45.33109287455883, 124.48587468576672 45.33109339887541, 124.48587465639092 45.331093406224554, 124.48587185655937 45.33109433351038, 124.48587182978011 45.33109434475937, 124.48586934011303 45.331095639400516, 124.48586931695792 45.331095654117775, 124.48586723307488 45.33109726639141, 124.48586721443347 45.331097284011705, 124.48586561636814 45.33109915199667, 124.48586560295712 45.331099171842446, 124.48586455208581 45.331101223795756, 124.48586454441961 45.331101245105934, 124.48586408110272 45.331103402219796, 124.48586407947617 45.33110342417479, 124.48586411995316 45.331104045280895, 124.48586411653035 45.33110409004184, 124.48586410059056 45.33110413343497, 124.4858640727669 45.33110417373652, 124.4858640341647 45.33110420934555, 124.48586398631726 45.33110423884753, 124.48586393112552 45.33110426107052, 124.48586387078166 45.33110427513176, 124.48586380768297 45.33110428047265, 124.48586374433576 45.331104276881064, 124.48586368325672 45.331104264499636, 124.48586349982102 45.33110421287071, 124.48586347102872 45.33110420691597, 124.48586054799807 45.33110380875744, 124.48586051813241 45.33110380672213, 124.48585754110046 45.331103802804, 124.48585751122448 45.33110380476064, 124.4858556957681 45.331104047098336, 124.48585563358644 45.331104051011536, 124.48585557151563 45.331104046303764, 124.48585551193494 45.33110403315551, 124.48585545712821 45.33110401207075, 124.48585540919652 45.331103983857744, 124.48585536997709 45.33110394959794, 124.48585432213694 45.33110282450404, 124.48585245282209 45.33110117837787, 124.48585243183976 45.33110116312121, 124.48585015603157 45.331099795248534, 124.48585013134714 45.33109978305709, 124.48584753064624 45.33109874246318, 124.48584750314461 45.33109873377394, 124.48584467088644 45.33109805780422, 124.48584464155526 45.33109805292926, 124.48584167938452 45.331097765843076, 124.48584164927615 45.33109776495729, 124.48583866350059 45.33109787705771, 124.48583863369562 45.331097880192935, 124.4858357314699 45.33109838745687, 124.48583570303829 45.331098394500486, 124.48583298851831 45.331099278723066, 124.48583296247996 45.331099289422404, 124.48583053308602 45.33110051887018, 124.48583051037518 45.33110053284148, 124.48582845329389 45.33110206339166, 124.4858284347267 45.33110208013276, 124.48582682378326 45.33110385685655, 124.48582681002492 45.33110387576776, 124.48582570303418 45.33110583490063, 124.48582569460002 45.33110585525194, 124.48582512699343 45.331107947595164, 124.48582284310247 45.331124913616634, 124.48582283312157 45.33112495198032, 124.48582281389386 45.331124988550805, 124.48582198216613 45.33112622841029, 124.48582197145033 45.331126249706415, 124.48582121517674 45.33112842810387, 124.4858212107301 45.331128450481984, 124.48582108882046 45.33113069159324, 124.48582109082312 45.331130714146035, 124.48582160822532 45.33113292701376, 124.48582161659591 45.33113294882598, 124.48582170596539 45.33113311366689, 124.48582172408459 45.33113316366039, 124.48582172557268 45.33113321525095, 124.4858181284398 45.33115994793967, 124.48581813580256 45.33116210592686, 124.48581813886474 45.331162127566635, 124.48581873635052 45.33116424400367, 124.48581874527417 45.33116426482039, 124.48581991043245 45.33116626018676, 124.48581992488248 45.331166279398104, 124.48582161393226 45.33116807871765, 124.48582163336516 45.33116809560132, 124.48582378284073 45.331169631264736, 124.48582380652637 45.331169645186534, 124.48582633566018 45.3311708594904, 124.48582636270933 45.331170869927625, 124.48582917646878 45.33117171724434, 124.4858292058642 45.33117172380446, 124.48583219852249 45.33117217229611, 124.48583222915987 45.33117217473276, 124.485835288267 45.3311722075471, 124.48583531899529 45.3311722057687, 124.48583832960429 45.33117182167277, 124.4858383592692 45.33117181574612, 124.48584118558382 45.33117103543205), (124.48768643609314 45.33240375464271, 124.48768637214296 45.332403750073155, 124.48768631079146 45.332403736550205, 124.48768625453152 45.332403714623325, 124.48768620564942 45.332403685183536, 124.48768616613133 45.33240364942711, 124.48768613758313 45.332403608807034, 124.48768605045352 45.332403445165724, 124.48768603445077 45.332403403133064, 124.48768603022535 45.332403359713425, 124.48768603793546 45.33240331653272, 124.48768605729225 45.332403275207874, 124.48768608757108 45.332403237286364, 124.48768612763793 45.3324032041882, 124.48768617599264 45.33240317715278, 124.48775274640498 45.33237285793554, 124.48775278313178 45.33237284353319, 124.48781090991862 45.33235346793667, 124.48781094619268 45.33235345771197, 124.48788146498225 45.33233703552783, 124.48788152648665 45.332337025830924, 124.48791167866963 45.332334441377235, 124.48791174161315 45.33233444039836, 124.48791180360224 45.33233444816156, 124.48791186222064 45.332334464364244, 124.4879119151829 45.332334488374705, 124.48791196042428 45.33233451925692, 124.48791199618123 45.332334555806945, 124.48791202105953 45.332334596599914, 124.4879120340895 45.33233464004547, 124.487912034763 45.33233468444993, 124.48791202305397 45.33233472808219, 124.48791199941873 45.33233476924125, 124.48791196477885 45.33233480632253, 124.4879119204845 45.332334837880424, 124.48791186826278 45.332334862684654, 124.48778742979545 45.332382104604775, 124.48778461177382 45.332383469403844, 124.48775016230495 45.332404294839236, 124.48775011044526 45.33240432036434, 124.48775005246375 45.33240433816895, 124.48774999064106 45.33240434755279, 124.48774992740863 45.33240434814678, 124.48774986525353 45.33240433992754, 124.48774802195983 45.33240395950669, 124.48774799243242 45.332403955506294, 124.48774498492537 45.3324037546284, 124.48768643609314 45.33240375464271), (124.48767922555344 45.33244717753161, 124.48767917269493 45.332447203448986, 124.48767911353323 45.33244722134965, 124.48767905047961 45.332447230504016, 124.4876789861041 45.33244723053891, 124.48767892303066 45.33244722145296, 124.48767886382994 45.33244720361646, 124.48767881091506 45.332447177756436, 124.48767876644268 45.33244714492689, 124.48767873222543 45.33244710646594, 124.48767870965798 45.3324470639412, 124.48767869966017 45.33244701908593, 124.48767870263958 45.33244697372841, 124.48768302609871 45.332426437257176, 124.4876830420549 45.332426393012106, 124.48768307035004 45.33242635195135, 124.48768310981818 45.33242631576682, 124.48768315883315 45.33242628594948, 124.48768321537514 45.33242626372796, 124.48768327711446 45.33242625001791, 124.48768334150702 45.33242624538427, 124.4877097437293 45.33242624538211, 124.48770980387806 45.332426249419726, 124.48770986186732 45.33242626138761, 124.4877099156148 45.33242628085607, 124.48770996319078 45.33242630712609, 124.48771000288707 45.33242633925445, 124.48771003327832 45.33242637608759, 124.48771005327343 45.33242641630304, 124.48771006215443 45.33242645845686, 124.4877100596025 45.33242650103552, 124.48771004570906 45.332426542510234, 124.48771002097325 45.332426581391914, 124.4877099862831 45.33242661628449, 124.48770114801678 45.332433921387, 124.48770111296848 45.332433946160656, 124.48767922555344 45.33244717753161), (124.487650460488 45.332426245378436, 124.48765052099439 45.332426249464675, 124.48765057930223 45.33242626157487, 124.48765063329265 45.33242628126898, 124.48765068100388 45.332426307831376, 124.48765072070235 45.33242634029688, 124.48765075094536 45.33242637748577, 124.48765077063405 45.33242641804672, 124.48765077905288 45.3324264605059, 124.48765077589613 45.332426503320434, 124.48764165750605 45.33246981562305, 124.48764164415843 45.33246985464073, 124.48764162119042 45.332469891363644, 124.48764158933378 45.3324699246222, 124.48764154960293 45.332469953357176, 124.4876318911258 45.33247579208462, 124.48763183772506 45.332475818213595, 124.48763177792226 45.33247583616279, 124.48763171420184 45.332475845186515, 124.48763164921098 45.332475844909915, 124.48763158564965 45.33247583534447, 124.48763152615828 45.332475816887566, 124.48763147320844 45.33247579030596, 124.48763142899982 45.33247575670394, 124.48763139536894 45.33247571747745, 124.48763137371301 45.332475674256095, 124.48763136493174 45.33247562883541, 124.48763136938982 45.332475583102344, 124.48763484131074 45.332461379776674, 124.48763485780482 45.33246133748, 124.48763488562568 45.3324612982462, 124.48763492371504 45.33246126356782, 124.48763497062376 45.33246123476419, 124.48763644635396 45.33246049381807, 124.48763646957981 45.332460479579446, 124.48763856971215 45.332458916045645, 124.48763858861616 45.33245889891893, 124.48764022259152 45.33245707940851, 124.48764023646572 45.33245706003522, 124.48764134312538 45.332455052651724, 124.48764135145119 45.332455031755835, 124.48764188937284 45.33245291163514, 124.48764189183817 45.332452890000226, 124.4876418408881 45.33245073649641, 124.48764183740084 45.33245071493181, 124.48764119948599 45.33244860865039, 124.48764119017666 45.33244858796285, 124.48763998917421 45.33244660774116, 124.48763997439077 45.33244658870458, 124.48763883601866 45.332445410001775, 124.48763880658203 45.3324453721675, 124.48763878793274 45.33244533106405, 124.48763878075755 45.332445288204894, 124.4876387853205 45.33244524516815, 124.4876433840685 45.33242643206999, 124.48764340109662 45.33242638879736, 124.48764342997444 45.33242634877361, 124.48764346955029 45.33242631359449, 124.48764351824647 45.33242628466261, 124.48764357412136 45.332426263131495, 124.48764363494728 45.33242624985958, 124.48764369829904 45.33242624537605, 124.487650460488 45.332426245378436), (124.48759727610651 45.332371145435935, 124.48759727224676 45.33237110137024, 124.48759728066625 45.33237105762175, 124.48759730104027 45.33237101587626, 124.48759733258386 45.332370977742436, 124.48759737408143 45.332370944689714, 124.48759742393398 45.33237091799178, 124.48759748022046 45.332370898677425, 124.48759754077184 45.332370887490896, 124.48759760325495 45.33237088486325, 124.48759766526187 45.33237089089578, 124.48759772440334 45.332370905355994, 124.48759777840029 45.332370927686696, 124.48759782517197 45.33237095702738, 124.48763507140534 45.33239940896093, 124.48763511019594 45.332399445396156, 124.48763513777902 45.332399486598106, 124.48763515302268 45.33239953087575, 124.48763515530113 45.332399576411774, 124.4876351445208 45.332399621337224, 124.48763512112434 45.332399663808204, 124.48763508607186 45.33239970208156, 124.48763504080205 45.3323997345864, 124.48763242832618 45.33240126424033, 124.48762905902309 45.3324037664343, 124.48762901654332 45.332403792833716, 124.48762896811373 45.33240381351805, 124.48762891526125 45.33240382783516, 124.48762885965202 45.33240383533372, 124.48762684830365 45.332403977680926, 124.48762681718108 45.332403982130955, 124.48762380637622 45.332404639073154, 124.48762377712757 45.332404647795805, 124.48762101139012 45.332405713558664, 124.48762098518203 45.33240572620597, 124.48761857478299 45.33240715829721, 124.48761855265961 45.33240717436508, 124.48761659370243 45.33240891568682, 124.48761657654596 45.332408934534804, 124.48761514713468 45.332410915659906, 124.48761513565819 45.332410936484, 124.48761428578973 45.332413100358934, 124.4876138132118 45.33241503363292, 124.48761379660999 45.33241507612758, 124.48761376857625 45.332415115522224, 124.48761373018728 45.3324151503037, 124.4876087158577 45.33241887416451, 124.48760866710184 45.332418903732695, 124.48760861092686 45.33241892580038, 124.48760854961715 45.33241893947026, 124.48760848566575 45.33241894418644, 124.48760842167304 45.332418939757176, 124.48760836024138 45.33241892636255, 124.48760830386858 45.332418904547225, 124.48760825484722 45.33241887519832, 124.48760821517035 45.332418839509245, 124.48760818645155 45.33241879893123, 124.48760816985866 45.33241875511435, 124.48760735587798 45.33241519772381, 124.48760735191473 45.332415155980954, 124.48760735898101 45.33241511444256, 124.48760737683237 45.33241507454591, 124.48760740485123 45.33241503767153, 124.48760744206788 45.332415005095335, 124.4876074871946 45.33241497794452, 124.48760837348732 45.33241453814046, 124.48760839671367 45.33241452407432, 124.4876105003174 45.33241297834623, 124.48761051929291 45.3324129614025, 124.48761216411687 45.33241116006477, 124.48761217813991 45.33241114086975, 124.48761330325812 45.33240915064639, 124.48761331180779 45.332409129912925, 124.48761387554467 45.33240702452325, 124.48761387830457 45.3324070030196, 124.48761385977815 45.33240486045144, 124.48761385664632 45.33240483897158, 124.487613256543 45.332402738589366, 124.4876132476578 45.33240271798251, 124.48761207513994 45.33240071797619, 124.4876005583747 45.33238541490788, 124.48760053774556 45.33238538106077, 124.48760052522773 45.332385345292266, 124.48759727610651 45.332371145435935), (124.48758619443109 45.332494965801544, 124.48758613558273 45.33249497608301, 124.4875860750392 45.332494978322444, 124.48758601498906 45.332494972438916, 124.48758595760302 45.332494958645086, 124.48758590495581 45.332494937439634, 124.4875858589504 45.33249490958912, 124.48758582125012 45.33249487610035, 124.48758579321773 45.33249483818394, 124.4875857758666 45.33249479721058, 124.48758576982394 45.332494754661454, 124.48758577530833 45.33249471207473, 124.4875857921213 45.3324946709899, 124.4875858196552 45.33249463289219, 124.48758722856604 45.332493070950086, 124.48758724282457 45.33249305099707, 124.48758837125115 45.33249098121499, 124.48758837961977 45.332490959664746, 124.48758890404014 45.332488773192225, 124.48758890618707 45.332488750899884, 124.48758880579317 45.332486534491174, 124.48758880163312 45.3324865123404, 124.48758808040894 45.33248435393834, 124.4875880701067 45.33248433280816, 124.48758675666835 45.33248231805195, 124.48758674063382 45.33248229878229, 124.48758488709532 45.332480507612956, 124.48758486596337 45.33248049096674, 124.48758254586987 45.3324789944546, 124.4875825205425 45.33247898112603, 124.48757979792192 45.33247782805712, 124.48757651885283 45.332476735034675, 124.48757646296639 45.33247671118674, 124.487576415142 45.332476679806966, 124.48757637738657 45.33247664221203, 124.48757635128423 45.3324765999795, 124.48757633793032 45.332476554881495, 124.48757633788514 45.3324765088104, 124.4875763511507 45.332476463699436, 124.48757637717019 45.3324764214415, 124.48757641485199 45.3324763838098, 124.48758932252626 45.332465951551264, 124.4875893685849 45.332465921041305, 124.4875894222687 45.3324658975362, 124.48758948146963 45.332465881958925, 124.48758954386294 45.332465874921134, 124.48758960699881 45.3324658766992, 124.48758966839804 45.33246588722329, 124.48758972564963 45.33246590608015, 124.48758977650556 45.33246593252935, 124.48759149282652 45.33246702596916, 124.48759151747335 45.33246703885862, 124.48759412662663 45.33246814552075, 124.48759415432335 45.33246815483263, 124.48759701617574 45.332468887571274, 124.487597045892 45.3324688929592, 124.48760005395785 45.33246922451006, 124.48760008458767 45.33246922577352, 124.48760017615837 45.332469223306234, 124.48760023899449 45.3324692259994, 124.48760029985587 45.33246923734723, 124.48760035637035 45.332469256907494, 124.4876004063354 45.332469283917746, 124.48760044780336 45.332469317325234, 124.48760047915803 45.332469355827904, 124.48760049917733 45.33246939792501, 124.48760050708098 45.332469441975796, 124.48760050256091 45.33246948626332, 124.4875948273139 45.33249270313819, 124.4875948088305 45.332492749003585, 124.48759477705393 45.33249279108983, 124.48759473341256 45.33249282750524, 124.48759467986785 45.33249285661308, 124.4875946188267 45.33249287710499, 124.48758619443109 45.332494965801544), (124.48756275014392 45.33245322260118, 124.4875627052723 45.33245325246198, 124.48756265308833 45.33245327566945, 124.4875625955451 45.33245329135494, 124.4875625347964 45.33245329893132, 124.48756247311636 45.33245329811502, 124.48756241281346 45.33245328893658, 124.48756235614503 45.33245327173955, 124.48756230523203 45.332453247167635, 124.48756226198014 45.332453216140564, 124.48756222800843 45.33245317981969, 124.48756220458846 45.33245313956453, 124.48754552136566 45.33241406570625, 124.48754550913826 45.332414021275525, 124.48754550977061 45.332413976017726, 124.48754552323707 45.3324139317656, 124.48754554899237 45.332413890311244, 124.48754558599344 45.33241385333345, 124.48754563274183 45.33241382232968, 124.48754568734445 45.332413798555514, 124.48754574759008 45.332413782973696, 124.4875458110388 45.332413776215276, 124.48754587512131 45.33241377855392, 124.48754593724237 45.33241378989496, 124.48754599488635 45.33241380977907, 124.48754604571873 45.33241383740103, 124.48757983274407 45.33243636208357, 124.48757987765315 45.3324363993378, 124.48757991008489 45.33243644255772, 124.4875799285062 45.332436489700214, 124.48758063935057 45.33243959635317, 124.48758064333263 45.332439637566395, 124.48758063656092 45.332439678598156, 124.4875806192639 45.33243971806426, 124.48758059202484 45.33243975463332, 124.4875805557629 45.33243978707168, 124.48756599233954 45.332450602492514, 124.48756275014392 45.33245322260118), (124.48754612191408 45.33253689280825, 124.48754607583349 45.33253692262912, 124.48754602238716 45.332536945532745, 124.48754596363088 45.33253696063815, 124.48754590182472 45.332536967364284, 124.48754583934591 45.332536965452455, 124.48754577859768 45.3325369549762, 124.48754572191692 45.332536936338464, 124.48754567148363 45.33253691025616, 124.48754562923763 45.33253687773252, 124.48754559680413 45.33253684001857, 124.48754557543063 45.33253679856496, 124.48754497483894 45.33253514356187, 124.48754496386441 45.33253512242705, 124.48754358182548 45.3325331125282, 124.48754356508991 45.332533093364304, 124.48754164197689 45.332531318537214, 124.4875416201543 45.332531302115996, 124.48754035830065 45.33253052584324, 124.48754031675386 45.33253049493256, 124.48754028421448 45.33253045905142, 124.4875402618494 45.33253041948673, 124.48754025046092 45.33253037765749, 124.48754025045733 45.33253033506395, 124.48754026183879 45.33253029323376, 124.48754028419712 45.33253025366719, 124.48754031673056 45.33253021778331, 124.48754035827203 45.33253018686916, 124.48754040733185 45.33253016203344, 124.4875404621502 45.33253014416696, 124.48756004777647 45.332525288229085, 124.48756011059619 45.332525277549166, 124.48756017517864 45.33252527602152, 124.48756023887165 45.332525283708925, 124.48756029905944 45.33252530029566, 124.48756035327034 45.33252532510057, 124.48756039927795 45.33252535710495, 124.48756043519293 45.33252539499449, 124.4875604595404 45.33252543721315, 124.48756047132031 45.33252548202713, 124.48756047004896 45.33252552759603, 124.48756045577862 45.33252557204844, 124.48756042909528 45.332525613558815, 124.4875603910948 45.33252565042246, 124.48754612191408 45.33253689280825), (124.48754006384196 45.3325064031428, 124.48754000132963 45.33250641379316, 124.48753993705895 45.33250641537965, 124.48753987364398 45.33250640783773, 124.48753981366433 45.332506391474155, 124.4875397595597 45.33250636695459, 124.48753971353081 45.332506335276314, 124.48753967744999 45.33250629772794, 124.48753965278492 45.332506255836755, 124.48753964053876 45.332506211306736, 124.48753964120964 45.33250616594919, 124.48753965477039 45.33250612160908, 124.48753968066927 45.33250608008999, 124.48753971785291 45.33250604308075, 124.48754831817502 45.33249909212697, 124.48754836543863 45.33249906096772, 124.4875484206463 45.33249903717857, 124.48754848152531 45.332499021738755, 124.48754854556967 45.33249901528388, 124.48754861014298 45.33249901807962, 124.48754867258725 45.33249903001091, 124.48754873033194 45.332499050586605, 124.48754878099996 45.332499078959735, 124.48754882250567 45.33249911396233, 124.48754885314055 45.3324991541535, 124.48754893285597 45.33249929028974, 124.48754894769868 45.33249930987798, 124.48755068629696 45.332501141421105, 124.48755070631955 45.33250115856226, 124.4875529224412 45.33250271260502, 124.48755294686008 45.332502726628185, 124.48755308682468 45.33250279189824, 124.48755313656066 45.33250282056102, 124.4875531771441 45.33250285567239, 124.48755320692865 45.33250289580784, 124.4875532247057 45.33250293933906, 124.48755322975433 45.3325029845, 124.48755322186948 45.33250302945844, 124.48755320137116 45.332503072390374, 124.48755316909089 45.33250311155406, 124.4875531263384 45.3325031453606, 124.48755307484814 45.332503172438436, 124.4875530167091 45.33250319168905, 124.48754006384196 45.3325064031428), (124.48587985339702 45.33104463559279, 124.48587982558074 45.33104459453628, 124.48587981004994 45.33104455037082, 124.48587980744048 45.331044504904305, 124.48587981785896 45.33104445999787, 124.48587984087915 45.33104441748973, 124.4858798755585 45.33104437911991, 124.48587992047767 45.33104434645904, 124.48587997379782 45.3310443208441, 124.48588003333623 45.331044303323594, 124.4858800966559 45.3310442946147, 124.48588016116476 45.33104429507392, 124.48588022422237 45.331044304682464, 124.48588028324733 45.331044323047024, 124.48588033582361 45.33104434941584, 124.48591450687792 45.33106546483679, 124.48591708242682 45.331066759337624, 124.4859171100994 45.33106677048117, 124.48591733838614 45.331066842080816, 124.48591739638236 45.33106686569942, 124.4859174461057 45.33106689734128, 124.48598332740305 45.33111865975126, 124.48616117199214 45.331253541904, 124.48626724976111 45.33133860049454, 124.4866012103172 45.331595570183545, 124.48675093952392 45.33171235897576, 124.48679772194765 45.33175217348353, 124.48679829122197 45.33175263232431, 124.48701816065025 45.33192053264082, 124.48712324598645 45.33200459769232, 124.48733607221193 45.33216846391968, 124.48738590999845 45.33220933074279, 124.4873865466358 45.33220982282595, 124.48744528076763 45.33225262906388, 124.48745950241157 45.33226400474741, 124.4874595359582 45.33226403694927, 124.48745956089563 45.3322640728303, 124.48745957643678 45.332264111257786, 124.48745958209096 45.332264151018656, 124.48745957767967 45.332264190857686, 124.48745909913899 45.33226619445331, 124.48745909698015 45.33226621594172, 124.48745917397407 45.332268352815404, 124.48745917767766 45.33226837419886, 124.48745983227113 45.33227046130332, 124.48745984170026 45.3322704817925, 124.48746104976043 45.3322724421821, 124.4874610645311 45.33227246097618, 124.48746280006452 45.332274239585104, 124.48751168563726 45.33231530347429, 124.48751172308809 45.33231534265163, 124.48752328648533 45.33233070774385, 124.48752330990907 45.33233074775281, 124.4875233220326 45.33233079018577, 124.48752332240683 45.332330833471, 124.48752331101787 45.332330876005095, 124.48752328828765 45.33233091621256, 124.48752325505806 45.332330952604075, 124.48752321256005 45.332330983831596, 124.48752316236768 45.33233100873844, 124.48752310634035 45.332331026402024, 124.48752304655322 45.33233103616805, 124.48752298522096 45.332331037674784, 124.48752292461539 45.33233103086639, 124.4875228669815 45.3323310159951, 124.48752281445397 45.33233099361174, 124.48752276897855 45.33233096454544, 124.48734279528934 45.33219143416537, 124.4872686988876 45.33213635873236, 124.48705393732303 45.33196854507081, 124.48698469843828 45.33191235976292, 124.48684182465844 45.33180345598932, 124.48670377952847 45.33169342203606, 124.48643878302626 45.33148842477353, 124.48636771239738 45.33143536932949, 124.48596886964093 45.33112349233523, 124.48590288193425 45.33107129311939, 124.48590284761187 45.33107126044457, 124.48587985339702 45.33104463559279), (124.48749832183233 45.33257455343699, 124.48749827216474 45.3325745851305, 124.48749821420672 45.33257460880715, 124.48749815051538 45.332574623422325, 124.4874980839007 45.3325746283312, 124.48749801730175 45.3325746233172, 124.48749795365688 45.332574608601554, 124.48746740011661 45.332564933318245, 124.48746734840846 45.33256491266282, 124.48746730303209 45.33256488559875, 124.48746726556347 45.332564853065996, 124.48746723730386 45.332564816194456, 124.48746721923487 45.33256477626474, 124.48746721198387 45.33256473466361, 124.48746721580288 45.332564692835945, 124.48746723055908 45.33256465223444, 124.48746725574016 45.33256461426923, 124.48746729047143 45.33256458025889, 124.48748978603003 45.3325463989411, 124.48748984186919 45.332546363340704, 124.48749043797126 45.33254606528952, 124.48749049572112 45.332546042367696, 124.48749055894092 45.33254602835994, 124.48749062490039 45.33254602387126, 124.48749069075097 45.332546029095454, 124.48749075364866 45.33254604380693, 124.48749081087706 45.332546067370345, 124.4874908599647 45.33254609876805, 124.48749089879152 45.33254613664402, 124.48749208589385 45.33254759251359, 124.48749210557652 45.332547611652835, 124.48749433267247 45.33254935581059, 124.48749435760679 45.332549371613396, 124.48749705367584 45.33255074764229, 124.48749708275425 45.33255075940662, 124.487500127941 45.332551706134446, 124.48750015986947 45.33255171333681, 124.48750341879727 45.332552188675805, 124.48750345207422 45.33255219099048, 124.48750681346655 45.33255217239463, 124.48752814722751 45.33255046569406, 124.48752821125763 45.332550465135846, 124.48752827415466 45.332550473612564, 124.48752833338227 45.332550490782396, 124.48752838655166 45.332550515952896, 124.48752843151865 45.33255054810895, 124.48752846646995 45.33255058595376, 124.4875284899957 45.33255062796109, 124.48752850114745 45.332550672436845, 124.48752849947523 45.332550717587374, 124.48752848504664 45.33255076159181, 124.48752845844345 45.33255080267552, 124.48752842073857 45.33255083918164, 124.48749832183233 45.33257455343699), (124.48745481496316 45.332433134397945, 124.48745479504362 45.33243309134699, 124.48745478775508 45.332433046354126, 124.48745479339333 45.332433001243466, 124.4874548117295 45.332432957843935, 124.48745484202041 45.33243291791505, 124.4874548830378 45.33243288307565, 124.4874549331189 45.3324328547382, 124.48745499023325 45.332432834051616, 124.48745505206516 45.33243282185455, 124.48745511610784 45.33243281864153, 124.48745517976486 45.332432824542806, 124.48745524045545 45.33243283931912, 124.48745529571895 45.33243286237142, 124.48745534331486 45.33243289276508, 124.48745616082827 45.33243353169301, 124.48745682688825 45.332434021956956, 124.48752641360552 45.332482268758774, 124.48752645233675 45.332482301224715, 124.48752648173385 45.33248233824376, 124.48752650075022 45.332482378498305, 124.4875265087093 45.332482420555664, 124.48752650532774 45.33248246291894, 124.48752649072586 45.33248250408036, 124.48752646542337 45.33248254257493, 124.48752643032087 45.33248257703256, 124.48749979812982 45.3325041016932, 124.48749975149087 45.332504132516576, 124.48749969707364 45.332504156160326, 124.48749963706435 45.33250417167456, 124.48749957387392 45.33250417843598, 124.48749951004109 45.33250417617294, 124.48749944813044 45.332504164976335, 124.48749939062917 45.33250414529602, 124.48749933984752 45.332504117922674, 124.48749929782566 45.332504083956024, 124.48749926625187 45.332504044760725, 124.48745481496316 45.332433134397945), (124.48738777363458 45.33226039464297, 124.48738773656137 45.33226035921889, 124.48738770998354 45.332260319379074, 124.48738769491956 45.33226027665035, 124.48738769194695 45.33226023267034, 124.48738770117944 45.332260189124625, 124.48738772226335 45.33226014768209, 124.48738775439048 45.33226010993106, 124.48738779632968 45.33226007731836, 124.48738784647358 45.33226005109389, 124.48738790290031 45.3322600322627, 124.48738796344733 45.332260021546546, 124.48738802579406 45.33226001935612, 124.4873880875512 45.33226002577535, 124.48738814635173 45.33226004055822, 124.48738819994215 45.332260063138186, 124.48738824626854 45.33226009264983, 124.48747917015633 45.33233058426672, 124.48747920746312 45.332330619602196, 124.48747923428776 45.33233065938951, 124.48747924960097 45.33233070210193, 124.48747925281509 45.332330746100475, 124.48747924380685 45.332330789696805, 124.48747922292179 45.33233083121801, 124.4874791909615 45.33233086907083, 124.48747914915221 45.332330901802756, 124.48747909909841 45.33233092815776, 124.48747904272061 45.33233094712458, 124.4874789821823 45.33233095797536, 124.4874789198065 45.33233096029377, 124.48747885798666 45.3323309539908, 124.48747879909493 45.33233093930835, 124.48747874539116 45.33233091680982, 124.48747869893623 45.332330887358516, 124.48741980415113 45.332285440935344, 124.48738777363458 45.33226039464297), (124.48744393352243 45.33253735977779, 124.48744387608143 45.332537343522674, 124.48744382417455 45.33253731974696, 124.48744377975727 45.332537289346384, 124.48744374450315 45.33253725346626, 124.48744371974024 45.33253721345838, 124.48744370640148 45.33253717082999, 124.48744370498953 45.33253712718708, 124.48744489897707 45.33252582661635, 124.48744485869024 45.332523851184284, 124.48744485578047 45.33252383137322, 124.4874443210716 45.33252189207779, 124.48744431326261 45.33252187298998, 124.48744328958504 45.33252001260747, 124.48742629498717 45.33249573465138, 124.48742627244185 45.332495692067866, 124.48742626249646 45.3324956471566, 124.48742626555736 45.33249560175212, 124.48742628149957 45.332495557709095, 124.48742630967187 45.33249551682659, 124.48742634892338 45.33249548077458, 124.4874263976509 45.33249545102573, 124.48742645386388 45.3324954287952, 124.4874265152661 45.33249541499106, 124.48742657934962 45.33249541017721, 124.4874266434965 45.33249541455025, 124.48742670508669 45.33249542793158, 124.4874267616042 45.3324954497746, 124.48742681074043 45.33249547918704, 124.48745451651263 45.332515800224236, 124.48745600133627 45.3325167591254, 124.48747225918311 45.33252600378999, 124.48747230476178 45.33252603553658, 124.4874723404247 45.33252607306814, 124.48747236473248 45.332526114870014, 124.48747237670423 45.33252615925522, 124.48747237585694 45.33252620443257, 124.4874723622246 45.33252624857887, 124.4874723363574 45.332526289912536, 124.48747229929933 45.33252632676551, 124.48746830330025 45.332529556405184, 124.48746824746108 45.33252959200558, 124.48744910674145 45.332539162364235, 124.48744905548844 45.33253918324171, 124.48744899964791 45.3325391970785, 124.48744894114373 45.33253920339787, 124.48744888199161 45.3325392019821, 124.4874488242294 45.33253919287997, 124.48744876984713 45.33253917640509, 124.48744872071848 45.33253915312505, 124.48744780918624 45.33253862840174, 124.48744778269345 45.33253861603949, 124.48744499275824 45.33253758046689, 124.4874449633097 45.33253757206483, 124.48744393352243 45.33253735977779), (124.48743835647424 45.33258769512569, 124.48743836999954 45.33258764501311, 124.4874383991878 45.33258759833938, 124.48743844253747 45.33258755750566, 124.48744400805748 45.33258339725376, 124.48744493574652 45.33258264773666, 124.48744498538079 45.332582615328555, 124.48744504358974 45.332582591033514, 124.4874451077542 45.332582575944656, 124.48744517498731 45.33258257074086, 124.48744524226403 45.332582575656254, 124.48744530655739 45.33258259046968, 124.48746127597266 45.33258764745233, 124.48746133075986 45.33258766964033, 124.4874613782697 45.33258769901138, 124.48746141663747 45.33258773441259, 124.48746144435708 45.33258777445428, 124.48746146034023 45.332587817564686, 124.48746146395968 45.33258786205153, 124.48746145507326 45.332587906168555, 124.4874614340298 45.33258794818398, 124.48746140165547 45.332587986448516, 124.48746135922096 45.33258801946014, 124.48746130839199 45.332588045923025, 124.48745583986852 45.332590340387824, 124.48745336370776 45.33259162284103, 124.48743742846092 45.3326016689791, 124.48743737757414 45.3326016951729, 124.48743732037934 45.33260171379918, 124.48743725910907 45.33260172413093, 124.48743719615469 45.33260172576491, 124.48743713397353 45.33260171863728, 124.48743707499257 45.332601703026285, 124.48743702151397 45.332601679541256, 124.48743697562509 45.332601649098834, 124.48743693911696 45.332601612887245, 124.48743691341475 45.332601572319895, 124.48743689952151 45.3326015289802, 124.48743689797949 45.332601484559774, 124.48743835647424 45.33258769512569), (124.48742588150444 45.332342443565636, 124.48742589189541 45.332342485853616, 124.48742589070842 45.332342528763846, 124.4874258779868 45.33234257073375, 124.48742585419362 45.33234261023501, 124.48742582019558 45.332342645829186, 124.48742577723043 45.33234267622013, 124.4874257268629 45.332342700301126, 124.48742567092714 45.33234271719529, 124.48742561145991 45.33234272628741, 124.48742555062685 45.33234272724642, 124.48742549064312 45.332342720037374, 124.48742543369306 45.33234270492279, 124.48742538185041 45.33234268245309, 124.48742533700313 45.332342653446496, 124.48719784887562 45.33216447594141, 124.48706775540316 45.33206540310097, 124.48678785489187 45.33184748059386, 124.48656872005814 45.3316743763013, 124.48625384407823 45.33143347122368, 124.48617878241267 45.331373424316126, 124.48597097622972 45.33121257436346, 124.48593308109898 45.33118109249089, 124.48590389675633 45.33115456161537, 124.48590386395564 45.33115452499079, 124.48590384171824 45.331154484609996, 124.48590383086896 45.331154441971144, 124.48590383181045 45.33115439865614, 124.48590384450767 45.331154356271924, 124.48590386848964 45.33115431639095, 124.48590390286662 45.33115428049278, 124.48590394636321 45.33115424990926, 124.48590399736567 45.331154225775016, 124.48590405398177 45.3311542089854, 124.48590411411124 45.331154200163354, 124.4859041755233 45.33115419963611, 124.48590423593934 45.331154207423275, 124.48590429311808 45.33115422323593, 124.48590434493825 45.33115424648742, 124.4859666934121 45.331188590955165, 124.48596673392956 45.33118861757711, 124.48623523455369 45.33139858879042, 124.48672513459414 45.331776511737615, 124.4868651876204 45.331888552506435, 124.48706818360768 45.332046549407806, 124.48713030398291 45.33209264357945, 124.48739616063588 45.332300531520474, 124.48743304495432 45.33232899360261, 124.48743308313004 45.332329029757645, 124.48743311031612 45.33232907055638, 124.48743312542055 45.33232911435971, 124.4874331278364 45.33232915940777, 124.48743311746658 45.33232920389073, 124.48743309472772 45.33232924602145, 124.48743306053338 45.33232928410728, 124.48743301625726 45.3323293166181, 124.48743296367836 45.33232934224776, 124.48743201639195 45.33232971103083, 124.4874319914104 45.332329723075034, 124.48742968503893 45.33233107902685, 124.48742966374327 45.332331094189726, 124.48742776314847 45.33233273366473, 124.48742774630901 45.33233275139765, 124.48742632026956 45.33233461506642, 124.48742630849523 45.3323346347286, 124.4874254086161 45.332336655149035, 124.48742540233354 45.332336676028476, 124.48742506117891 45.33233878008722, 124.48742506061579 45.33233880142676, 124.48742529053136 45.33234091298305, 124.48742529570781 45.33234093401183, 124.48742588150444 45.332342443565636), (124.4858733471544 45.33116505056582, 124.48587335222935 45.33116500614975, 124.4858733696194 45.331164963311146, 124.48587339864183 45.331164923731606, 124.4858734381576 45.33116488896479, 124.48587348661539 45.331164860375424, 124.48587354211301 45.33116483908578, 124.4858736024721 45.33116482593154, 124.48587366532333 45.331164821429056, 124.48587372819938 45.331164825755096, 124.4858737886322 45.33116483873982, 124.48587384424957 45.33116485987353, 124.48587389286821 45.331164888326654, 124.48587393257984 45.33116492298226, 124.48588067433184 45.33117217275916, 124.48588185295107 45.33117328349951, 124.48590825527785 45.3311952134469, 124.48592224431363 45.33120793039299, 124.48592227784792 45.33120796805058, 124.48592230022217 45.33120800962603, 124.48592231056149 45.33120805349392, 124.48592230846187 45.33120809793919, 124.48592229400526 45.33120814122428, 124.48592226775696 45.33120818165693, 124.48592223074293 45.33120821765641, 124.48592218441051 45.331208247815304, 124.48592213057088 45.33120827095453, 124.4859220713291 45.33120828616946, 124.48592200900111 45.331208292865284, 124.48592194602378 45.33120829078019, 124.4859218848591 45.3312082799957, 124.48592182789831 45.33120826093346, 124.48592086267115 45.33120785095, 124.48592083457596 45.33120784152208, 124.48591793016193 45.33120710276764, 124.48591790000233 45.331207097378126, 124.48591484725843 45.33120677158669, 124.48591481618813 45.33120677044174, 124.48591173193317 45.331206870080315, 124.48591170114143 45.33120687322374, 124.4859087033994 45.33120739447949, 124.48590867406442 45.33120740179107, 124.48590587754926 45.33120832471718, 124.48590585079336 45.33120833591714, 124.4859033625184 45.33120962519631, 124.48590333936582 45.33120963985597, 124.48590125454918 45.331211246151796, 124.48590123588603 45.33121126370991, 124.48589963430653 45.33121312555508, 124.48589962084687 45.331213145339845, 124.48589856379212 45.33121519148726, 124.48589855605061 45.3312152127419, 124.48589808397102 45.33121736489138, 124.48589808224396 45.33121738680369, 124.48589821320417 45.331219562599664, 124.48589821755809 45.331219584329965, 124.48589894654651 45.33122170051268, 124.48589895681444 45.33122172122869, 124.48590025593579 45.33122369681924, 124.48590027168527 45.33122371568114, 124.48590211083045 45.331225492223574, 124.48596924764637 45.33127859885916, 124.48614719753883 45.33141556032842, 124.48636026214136 45.33158261004367, 124.48663114294419 45.331790518588676, 124.48677727724039 45.33190762166361, 124.48698612184663 45.33206750272659, 124.48704927332045 45.33211861869511, 124.48725021583759 45.332272574677084, 124.48740114410413 45.3323905333063, 124.48740118098587 45.33239056848274, 124.4874012075144 45.332390608030046, 124.48740122268576 45.33239065045174, 124.48740122592599 45.332390694142546, 124.48740121711234 45.33239073744916, 124.48740119657838 45.33239077873285, 124.48740116510108 45.33239081643139, 124.48740112387163 45.332390849118255, 124.48740010586371 45.33239151309311, 124.48740008540527 45.33239152929395, 124.48739828517861 45.33239326784597, 124.487398269524 45.332393286520954, 124.4873969773893 45.3323952369649, 124.48739696712371 45.33239525741573, 124.48739623140294 45.33239734681039, 124.48739622691006 45.332397368272844, 124.48739607511736 45.33239951848064, 124.48739607656535 45.33239954015166, 124.48739651437728 45.33240167076067, 124.48739652169398 45.332401691778216, 124.48739754434598 45.33240374328346, 124.4874015794888 45.33240987671148, 124.4874016006294 45.33240991984679, 124.48740160898866 45.33240996510423, 124.48740160422213 45.33241001062013, 124.48740158652629 45.332410054520146, 124.48740155662978 45.33241009499652, 124.48740151576364 45.33241013038242, 124.48740146561089 45.3324101592207, 124.48740140823666 45.332410180323805, 124.48740134600358 45.33241019282272, 124.48740128147448 45.33241019620273, 124.48740121730663 45.33241019032466, 124.48740115614235 45.332410175430574, 124.48740110050048 45.33241015213378, 124.4874010526722 45.332410121393664, 124.48727588077509 45.33231150098489, 124.48717675332031 45.332236401188005, 124.48699784147034 45.33209647015388, 124.48686978788167 45.3319994273956, 124.48653790981386 45.33173652402792, 124.48646876665357 45.33168441087726, 124.48634489824066 45.33158651488904, 124.48629067488757 45.33154634068841, 124.48594142847354 45.331274926377205, 124.4859414056573 45.33127490647928, 124.48588793584258 45.331222428827466, 124.48588582326475 45.33122074456837, 124.48588579965906 45.33122072920223, 124.48588325030474 45.33121937877041, 124.48588322287085 45.331219367093034, 124.48588031096106 45.331218396908206, 124.48587494067792 45.33121705433776, 124.48587488257523 45.33121703496543, 124.48587483116022 45.33121700776849, 124.48587478852144 45.33121697385176, 124.48587475639103 45.33121693459309, 124.48587473607415 45.33121689158725, 124.48587472839627 45.331216846581306, 124.4858733471544 45.33116505056582), (124.48735563735721 45.332567744328315, 124.48735558055363 45.33256772164114, 124.48735553149056 45.33256769127029, 124.4873554922243 45.33256765448863, 124.48735546440048 45.33256761283764, 124.48735544918524 45.33256756806295, 124.48735544721619 45.332567522041025, 124.48735545857589 45.33256747670068, 124.4873554827883 45.3325674339421, 124.48735551883848 45.3325673955573, 124.48735556521582 45.332567363155, 124.48735619374928 45.33256700603756, 124.48735621663451 45.332566990087, 124.48735824932423 45.33256525302371, 124.48735826718884 45.33256523415104, 124.48735976257511 45.33256324406039, 124.48735977468876 45.33256322303716, 124.48736067156192 45.33256106137827, 124.48736067742833 45.33256103906562, 124.48736093907763 45.33255879431939, 124.48736093845672 45.33255877163059, 124.4873605541726 45.33255653567989, 124.48736054710713 45.332556513598256, 124.4873595208358 45.33255435675494, 124.48733327833806 45.33251341850464, 124.48733325785508 45.33251337539772, 124.4873332500815 45.33251333026605, 124.48733325533495 45.33251328495379, 124.48733327340072 45.33251324131249, 124.48733330354048 45.3325132011254, 124.48733334452294 45.33251316603467, 124.48733339467339 45.33251313747416, 124.48733345194245 45.3325131166109, 124.48733351399011 45.3325131042974, 124.48733357828095 45.33251310103681, 124.48733364218792 45.33251310696239, 124.4873337030998 45.33251312183199, 124.48733375852738 45.332513145038, 124.48733380620594 45.332513175632194, 124.48735712907366 45.33253150680324, 124.48735818747808 45.33253226414293, 124.48739923113907 45.33255900472538, 124.48739927248857 45.33255903748804, 124.48739930403576 45.33255907528853, 124.48739932458078 45.332559116689076, 124.48739933334205 45.33255916011497, 124.48739932998649 45.332559203914435, 124.4873993146416 45.33255924642154, 124.48739928789115 45.33255928601945, 124.4873992507525 45.332559321202034, 124.4873992046383 45.332559350631065, 124.48737307894949 45.33257300723919, 124.48737302134654 45.33257303119419, 124.48737295792708 45.33257304614904, 124.48737289148032 45.33257305144604, 124.48737282492851 45.33257304685226, 124.48737276119836 45.33257303256971, 124.48735563735721 45.332567744328315), (124.48739651253608 45.332628912665825, 124.48739656175623 45.3326289388216, 124.48739660292378 45.332628971167, 124.48739663450121 45.33262900849385, 124.48739665530894 45.33262904940797, 124.48739666456986 45.33262909238115, 124.48739666193798 45.332629135808254, 124.48739664751164 45.332629178067236, 124.48739662182972 45.33262921757969, 124.48739658585141 45.33262925286973, 124.4873965409206 45.33262928261923, 124.48739648871545 45.33262930571702, 124.48739643118597 45.33262932130036, 124.48737877650882 45.33263276611358, 124.48737871382984 45.332632773702514, 124.4873786502624 45.33263277236725, 124.48737858833479 45.3326327621609, 124.48737853051055 45.33263274348943, 124.48737847908956 45.33263271709556, 124.48737843611738 45.33263268402915, 124.48737840330311 45.3326326456055, 124.48737838195224 45.33263260335299, 124.48737837291394 45.33263255895228, 124.48737837654765 45.33263251416956, 124.48737839270899 45.3326324707861, 124.48737842075498 45.33263243052761, 124.48737845957008 45.33263239499545, 124.48738784186294 45.33262538170359, 124.48738788859909 45.332625352963866, 124.48738794233728 45.33262533114709, 124.48738800104559 45.33262531707822, 124.4873880625043 45.33262531128917, 124.4873881243895 45.33262531399888, 124.4873881843612 45.332625325104864, 124.48738824015187 45.33262534418721, 124.48739651253608 45.332628912665825), (124.48739031364629 45.33252196636583, 124.48739034995819 45.33252200071349, 124.48739037637641 45.33252203929486, 124.48739039194223 45.33252208070976, 124.48739039609066 45.33252212345519, 124.48739038867137 45.332522165979874, 124.48739036995339 45.33252220674053, 124.48739034061616 45.3325222442579, 124.48739030172419 45.332522277170426, 124.4873902546891 45.33252230428368, 124.48739020121783 45.3325223246137, 124.48739014325092 45.33252233742267, 124.48739008289188 45.33252234224573, 124.48739002233144 45.33252233890785, 124.4873899637674 45.33252232753017, 124.48738990932493 45.332522308525604, 124.48738986098004 45.33252228258384, 124.48738037786089 45.33251610418244, 124.48738035690246 45.33251608918566, 124.48721884854085 45.332389147667755, 124.48721881160085 45.33238911218283, 124.48721878516878 45.332389072302156, 124.4872187702573 45.332389029553745, 124.48721876743777 45.332388985575435, 124.48721877681824 45.33238894205222, 124.48721879803934 45.332388900651644, 124.48721883028786 45.332388862959924, 124.48721887232833 45.33238883042118, 124.48721892255 45.33238880428208, 124.48721897902868 45.33238878554415, 124.48721903960046 45.332388774925285, 124.48721910194469 45.332388772832346, 124.48721916367256 45.33238877934552, 124.48721922241911 45.33238879421525, 124.48721927593343 45.33238881687184, 124.48721932216534 45.33238884644723, 124.48739031364629 45.33252196636583), (124.48588521106338 45.33130540541393, 124.48588516108772 45.33130537301281, 124.48588512196794 45.331305333884316, 124.48588509547712 45.33130528980173, 124.48588508281576 45.331305242762866, 124.48588508455752 45.331305194899485, 124.48588620287026 45.331299267830865, 124.48588621641946 45.33129922643581, 124.48588624076325 45.33129918757647, 124.48588627503277 45.331299152639374, 124.48588631800543 45.331299122871144, 124.48588636814782 45.33129909933392, 124.48588642367089 45.33129908286758, 124.48588648259333 45.33129907405966, 124.48588654281293 45.33129907322441, 124.48588660218076 45.33129908039165, 124.48588665857865 45.33129909530565, 124.48588670999413 45.33129911743426, 124.48588675459271 45.33129914598789, 124.4859532286602 45.33135058273274, 124.48595545151936 45.331352004141614, 124.48595548968267 45.33135202406506, 124.48595553513066 45.3313520529398, 124.48629120628776 45.33161056706011, 124.48649612969584 45.331770507309194, 124.48675708544945 45.33197747225035, 124.4869982014435 45.33216456329203, 124.48714423066919 45.332275586436715, 124.48734736092449 45.332434840728524, 124.4873473964284 45.33243487442125, 124.4873474224365 45.33243491218087, 124.48734743804283 45.33243495269185, 124.48734744270351 45.332434994542766, 124.4873474362563 45.33243503627556, 124.48734741892578 45.33243507643631, 124.4873473913157 45.332435113625785, 124.48734735438798 45.332435146548335, 124.48734730942921 45.33243517405695, 124.48734725800577 45.33243519519324, 124.48734693410813 45.332435301122246, 124.48734690746912 45.33243531216819, 124.4873444274504 45.332436584232426, 124.4873444043421 45.33243659870322, 124.48734231985561 45.33243818499783, 124.48734230115065 45.33243820234687, 124.48734069087557 45.33244004299711, 124.48734067728002 45.33244006256951, 124.48733960199701 45.33244208809905, 124.48733959402345 45.33244210915682, 124.4873390943192 45.33244424311204, 124.48733909226898 45.3324442648593, 124.48733918700515 45.33244642669337, 124.48733919093873 45.33244644821792, 124.4873398883833 45.33244858466103, 124.48733989642338 45.332448629759604, 124.48733989144336 45.33244867507739, 124.48733987364663 45.33244871876342, 124.48733984375994 45.332448759033404, 124.48733980300412 45.3324487942425, 124.48733975304373 45.33244882295265, 124.48733969591945 45.332448843991216, 124.48733963396444 45.33244885649886, 124.4873395697092 45.33244885996474, 124.48733950577818 45.33244885424729, 124.48733944478253 45.33244883958004, 124.48733938921373 45.33244881656205, 124.48733934134141 45.33244878613347, 124.48684181771611 45.33206145161542, 124.48675973951019 45.3320003889954, 124.48637891402487 45.331698527371906, 124.48630571280088 45.33164436850799, 124.4860258905622 45.33142350884681, 124.48595423359461 45.33136976071683, 124.48595421081302 45.331369741605656, 124.4858877431991 45.33130724397561, 124.4858856840223 45.331305654678054, 124.48588566117287 45.33130564015261, 124.48588521106338 45.33130540541393), (124.4872273326908 45.33248361856007, 124.48722729700374 45.33248358269354, 124.48722727185383 45.332483542627024, 124.48722725819576 45.332483499881306, 124.48722725654777 45.332483456078926, 124.48722726697265 45.33248341288247, 124.48722728907454 45.33248337193155, 124.48722732201458 45.33248333478057, 124.48722736454245 45.33248330283966, 124.48722741504395 45.33248327732121, 124.48722747160208 45.332483259193836, 124.4872275320702 45.332483249145575, 124.48722759415296 45.33248324755786, 124.48722765549397 45.33248325449094, 124.48722771376485 45.33248326968166, 124.4872277667538 45.33248329255342, 124.48722781244963 45.332483322238076, 124.4873147818104 45.33255201523279, 124.48731481841415 45.33255205052663, 124.48731484464297 45.33255209014934, 124.48731485950549 45.332552132603055, 124.48731486243982 45.33255217628288, 124.48731485333512 45.33255221953761, 124.48731483253533 45.33255226073205, 124.48731480082695 45.33255229830893, 124.4873147594087 45.33255233084772, 124.48731470984607 45.33255235711836, 124.48731465401299 45.33255237612772, 124.48731459401989 45.332552387157186, 124.48731453213482 45.33255238978984, 124.4873144706973 45.33255238392612, 124.48731441202968 45.332552369787706, 124.48731435834989 45.33255234790909, 124.48731431168714 45.33255231911733, 124.48727585646637 45.332523477363345, 124.4872273326908 45.33248361856007), (124.48593399093765 45.33141993690102, 124.48593405347695 45.33141997370955, 124.48599916503444 45.33146953636002, 124.48607025140284 45.33152660178754, 124.48629118353473 45.3316965496331, 124.4866792000568 45.33200256219092, 124.48708616587189 45.33231853569857, 124.48728306249974 45.332473292332935, 124.48728309982812 45.332473328281004, 124.4872831263762 45.3324733687142, 124.48728314110188 45.33247341204546, 124.48728314342719 45.33247345657398, 124.48728313326073 45.332473500551906, 124.48728311100174 45.33247354225306, 124.48728307752374 45.33247358004061, 124.48728149598315 45.332475024077155, 124.48728147940105 45.332475042759505, 124.48728010003278 45.332477001786536, 124.48728008895003 45.332477022394464, 124.48727927927263 45.332479133840465, 124.48727927411663 45.33247915557901, 124.48727906538684 45.33248133793444, 124.48727906635659 45.33248135996505, 124.487279466632 45.33248352898296, 124.48727947367257 45.33248355040111, 124.48728047898668 45.332485642934785, 124.48728677919513 45.33249547127715, 124.48728679969031 45.33249551442235, 124.48728680745378 45.33249555959421, 124.48728680216782 45.33249560494376, 124.48728678404872 45.33249564861474, 124.48728675383818 45.3324956888196, 124.4872867127727 45.332495723912665, 124.48728666253332 45.33249575245753, 124.4872866051764 45.33249577328576, 124.48728654304966 45.33249578554483, 124.48728647869602 45.33249578873294, 124.48728641474963 45.33249578271962, 124.48728635382798 45.332495767750984, 124.48728629842482 45.33249574443974, 124.48728625080773 45.33249571374006, 124.48708078259754 45.3323334243099, 124.48658983158707 45.33195346228342, 124.48644402850627 45.331838617422385, 124.48637171885824 45.33177837536546, 124.48607785917432 45.33155348278481, 124.48593573865351 45.33143919018205, 124.48593571163337 45.33143916510825, 124.48590711321094 45.33140836683075, 124.48590708451725 45.3314083282183, 124.48590706692359 45.33140828642669, 124.4859070610912 45.33140824302606, 124.48590706723911 45.331408199647115, 124.48590708513643 45.33140815791968, 124.48590711411057 45.33140811941158, 124.48590715307292 45.33140808556963, 124.48590720055977 45.33140805766536, 124.48590725478661 45.331408036747206, 124.48590731371634 45.33140802360109, 124.48590737513456 45.33140801872097, 124.48590743673384 45.331408022290205, 124.4859074961996 45.33140803417467, 124.48590755129761 45.33140805392784, 124.48593399093765 45.33141993690102), (124.48722939428166 45.33253783053586, 124.48722937249062 45.3325378712414, 124.4872293399948 45.33253790822564, 124.48722929801062 45.33253794010442, 124.48722924810933 45.33253796568458, 124.48722919215845 45.33253798400879, 124.48722913225232 45.33253799439115, 124.48722907063285 45.33253799644316, 124.48722900960618 45.33253799008799, 124.48722895145657 45.332537975563476, 124.48722889836034 45.33253795341325, 124.48722885230454 45.33253792446633, 124.48721382090996 45.332526453052736, 124.48693893721475 45.332307545708524, 124.48667481412734 45.33210544816198, 124.48623690902146 45.3317585233955, 124.48602187715453 45.331592497421106, 124.48595125757029 45.331535802898784, 124.48595124690546 45.33153579387174, 124.48590272151799 45.33149246764749, 124.485902688581 45.33149243165897, 124.48590266591502 45.33149239191853, 124.48590265434217 45.331492349867794, 124.48590265428224 45.33149230703213, 124.48590266573747 45.331492264965355, 124.48590268829217 45.331492225193465, 124.48590272112848 45.33149218915914, 124.48590276305491 45.33149215816957, 124.48590281255083 45.33149213334883, 124.48590286782073 45.331492115597314, 124.48590292685977 45.33149210555896, 124.48590298752609 45.33149210359788, 124.48590304761936 45.331492109785245, 124.48590310495953 45.331492123896574, 124.48590315746665 45.331492145419986, 124.48593895676174 45.331510241753, 124.48593901365825 45.33151027864048, 124.48594387697662 45.33151430188371, 124.4859460344671 45.331515776491955, 124.48594605811695 45.33151578982619, 124.48594830930178 45.331516827940014, 124.485948373059 45.331516866703865, 124.4861132394265 45.3316475925874, 124.4863531206449 45.33183250105535, 124.48648120146987 45.33193556327806, 124.48703111192754 45.33236249382756, 124.4871420264161 45.33245142523498, 124.48719610281246 45.33249248944072, 124.48724047427919 45.33252893718284, 124.48724050994068 45.332528973017354, 124.48724053508352 45.33252901304606, 124.48724054875501 45.33252905575214, 124.487240550437 45.332529099517274, 124.48724054006588 45.33252914268306, 124.48724051803467 45.332529183613744, 124.48724048517799 45.33252922075836, 124.48724044274113 45.33252925270933, 124.48724039233214 45.3325292782559, 124.48724033586109 45.332529296430025, 124.48723839469882 45.33252976629154, 124.48723836649775 45.33252977537041, 124.48723570577292 45.33253086437703, 124.48723568060416 45.33253087714184, 124.48723336990405 45.332532309495214, 124.4872333487242 45.33253232546077, 124.48723147582466 45.33253404675064, 124.48723145943795 45.33253406531052, 124.48723009548496 45.33253601015026, 124.48723008451348 45.33253603060019, 124.48722939428166 45.33253783053586), (124.48706381452801 45.33209616112978, 124.48706377857944 45.33209612558025, 124.4870637530475 45.33209608580116, 124.48706373889449 45.33209604329193, 124.48706373665392 45.33209599965491, 124.4870637464102 45.332095956534914, 124.48706376779576 45.332095915557346, 124.48706380000426 45.3320958782668, 124.4870638418218 45.33209584606891, 124.48706389167205 45.33209582017733, 124.48706394767589 45.33209580156802, 124.48706400772248 45.33209579094245, 124.4870640695483 45.33209578870114, 124.48706413082286 45.33209579492854, 124.48706418923656 45.33209580938997, 124.4870642425876 45.33209583154027, 124.48706428886477 45.332095860544555, 124.48717422575108 45.33217958254048, 124.48722699209314 45.33222091130378, 124.48722702905677 45.332220946668244, 124.48722705556725 45.332220986426734, 124.48722707061295 45.33222102906196, 124.48722707361964 45.33222107294688, 124.48722706447259 45.33222111640672, 124.48722704352078 45.33222115778296, 124.48722701156393 45.33222119549659, 124.48722696982159 45.33222122810834, 124.48722691988658 45.33222125437367, 124.4872268636647 45.332221273290266, 124.48722680330143 45.332221284136196, 124.4872267411004 45.33222128649756, 124.4872266794354 45.33222128028424, 124.48722662065964 45.332221265733345, 124.48722656701621 45.3322212434002, 124.48722652055224 45.332221214137064, 124.48707288024448 45.33210349896, 124.48706381452801 45.33209616112978), (124.48702798243829 45.33232661783217, 124.48702794515815 45.332326582469236, 124.48702791836992 45.332326542657725, 124.48702790310206 45.33232649992607, 124.4870278999408 45.332326455914796, 124.48702790900732 45.33232641231354, 124.48702792995373 45.332326370796245, 124.48702796197577 45.33232633295678, 124.48702800384409 45.332326300247885, 124.48702805395143 45.33232627392529, 124.4870281103739 45.33232625499954, 124.4870281709454 45.332326244197226, 124.48702823334067 45.332326241933075, 124.48702829516407 45.332326248294024, 124.48702835404221 45.33232626303583, 124.48702840771472 45.332326285592565, 124.48702845412093 45.332326315098214, 124.48705716295368 45.33234853356618, 124.48721304916663 45.33247166139391, 124.48721308583384 45.332471696763704, 124.48721311208223 45.33247173647686, 124.48721312691531 45.33247177902609, 124.48721312977028 45.332471822796435, 124.48721312053868 45.33247186612656, 124.487213099571 45.332471907371875, 124.487213067663 45.33247194496692, 124.48721302602578 45.33247197748476, 124.48721297623958 45.33247200369116, 124.48721292019417 45.33247202259149, 124.48721286001675 45.33247203346836, 124.4872127979913 45.33247203590895, 124.48721273647207 45.332472029820615, 124.48721267779389 45.33247201543444, 124.48721262418402 45.332471993296465, 124.48721257767728 45.33247196424696, 124.487165825117 45.33243645572237, 124.4870547987307 45.332347436809506, 124.48702798243829 45.33232661783217), (124.4870181953998 45.33214597218595, 124.48701823247058 45.33214600761654, 124.48701825904321 45.33214604746281, 124.48701827409914 45.332146090197334, 124.48701827706115 45.332146134181976, 124.4870182678157 45.33214617773066, 124.48701824671723 45.33214621917404, 124.4870182145746 45.33214625692345, 124.48701817261976 45.33214628953188, 124.48701812246105 45.33214631574932, 124.48701806602124 45.332146334570766, 124.48701800546368 45.33214634527477, 124.48701794310993 45.33214634745099, 124.48701788135018 45.332146341016, 124.48701782255169 45.33214632621649, 124.48701776896851 45.33214630361977, 124.48701772265473 45.33214627409202, 124.48695872297306 45.33210049441924, 124.48695868578406 45.33210045918626, 124.48695865901341 45.33210041952674, 124.48695864368234 45.33210037695344, 124.4869586403756 45.33210033309026, 124.48695864921925 45.33210028961027, 124.48695866987599 45.332100248171955, 124.48695870155802 45.33210021035589, 124.48695874305672 45.332100177604545, 124.48695879278925 45.33210015116713, 124.4869588488587 45.33210013205208, 124.48695890912629 45.33210012098851, 124.48695897129323 45.3321001183984, 124.48695903298832 45.33210012438055, 124.48695909185828 45.3321001387068, 124.4869591456577 45.33210016083069, 124.48695919233433 45.33210018990832, 124.48697424586706 45.33211159815302, 124.4870181953998 45.33214597218595), (124.48700793036586 45.33196549036804, 124.48700796634343 45.33196552606698, 124.4870079918292 45.33196556600739, 124.48700800585655 45.331965608674516, 124.48700800789356 45.3319656524502, 124.48700799786295 45.33196569567427, 124.48700797614515 45.33196573670745, 124.48700794356381 45.33196577399355, 124.48700790135453 45.33196580611848, 124.48700785111807 45.33196583186393, 124.48700779475976 45.331965850253475, 124.487007734417 45.33196586058969, 124.48700767237817 45.3319658624806, 124.48700761099617 45.33196585585446, 124.48700755259884 45.33196584096262, 124.48700749940107 45.331965818369795, 124.48700745342016 45.33196578893284, 124.48688888833466 45.33187350660965, 124.48687828308258 45.33186502267319, 124.48687824677862 45.33186498719569, 124.4868782209003 45.33186494743163, 124.4868782064269 45.33186490488593, 124.48687820390626 45.331864861168754, 124.48687821343366 45.331864817934566, 124.48687823464867 45.33186477681962, 124.48687826674825 45.33186473937994, 124.48687830851772 45.331864707032416, 124.48687835837619 45.331864681001264, 124.48687841443677 45.33186466227166, 124.48687847457782 45.331864651552436, 124.48687853652332 45.33186464924925, 124.48687859792885 45.33186465544929, 124.48687865647048 45.33186466991789, 124.48687870993272 45.331864692107494, 124.48687875629221 45.3318647211783, 124.48696112597558 45.33192750639717, 124.48700793036586 45.33196549036804), (124.48676970911825 45.33186752134666, 124.48676967275946 45.33186748572945, 124.48676964690004 45.331867445809756, 124.48676963252471 45.331867403107786, 124.48676963018089 45.331867359249664, 124.48676963995784 45.33186731590555, 124.48676966148328 45.33186727472604, 124.48676969393743 45.33186723727928, 124.48676973608441 45.3318672049913, 124.48676978631934 45.33186717909166, 124.48676984272913 45.33186716056663, 124.48676990316554 45.33186715012167, 124.48676996532724 45.33186714815453, 124.48677002684693 45.33186715474014, 124.48677008538199 45.33186716962769, 124.48677013870324 45.331867192250265, 124.48677018478024 45.33186722174638, 124.48685575849379 45.331933847244, 124.48685579563266 45.331933882561685, 124.48685582231892 45.33193392230139, 124.48685583753252 45.331933964944035, 124.48685584069197 45.331934008859605, 124.48685583167638 45.33193405236945, 124.48685581083053 45.33193409381041, 124.48685577895112 45.33193413159841, 124.48685573725672 45.33193416428898, 124.48685568734125 45.331934190632566, 124.4868556311127 45.33193420962216, 124.48685557072024 45.33193422053191, 124.4868555084724 45.33193422294476, 124.48685544674875 45.331934216768495, 124.48685538790856 45.33193420223923, 124.48685533420098 45.331934179912295, 124.48685528767906 45.33193415064115, 124.48680085046819 45.33189247610215, 124.48676970911825 45.33186752134666), (124.48634713107796 45.33153868800637, 124.48634709415217 45.33153865264359, 124.48634706767386 45.331538612893276, 124.48634705265272 45.331538570271256, 124.48634704966172 45.3315385264028, 124.48634705881476 45.33153848296075, 124.48634707976298 45.33153844160169, 124.48634711170726 45.33153840390273, 124.48634715342975 45.33153837130149, 124.48634720333942 45.33153834504111, 124.48634725953295 45.331538326122995, 124.48634731986752 45.33153831526854, 124.48634738204251 45.331538312891674, 124.4863474436869 45.331538319083, 124.48634750245006 45.33153833360646, 124.4863475560912 45.331538355908194, 124.48634760256478 45.331538385137804, 124.48654519044166 45.331689555222475, 124.48659377088806 45.331727931551946, 124.48659380760455 45.331727966985866, 124.48659383386534 45.331728006774746, 124.48659384867055 45.3317280494034, 124.48659385145632 45.33172809324849, 124.48659384211649 45.33172813664037, 124.48659382100695 45.33172817792662, 124.48659378893126 45.33172821553506, 124.48659374711112 45.33172824803351, 124.48659369713906 45.33172827418441, 124.4865936409179 45.33172829299191, 124.48659358058876 45.33172830373983, 124.48659351844884 45.33172830601886, 124.48659345686464 45.33172829974222, 124.48659339818128 45.33172828514892, 124.48659334463343 45.33172826279469, 124.48659329826022 45.33172823353079, 124.48638379725604 45.331567435543924, 124.48634713107796 45.33153868800637), (124.48613733857607 45.33163285295644, 124.48613730113914 45.331632817711615, 124.48613727415716 45.33163277799674, 124.48613725866494 45.33163273533453, 124.48613725525617 45.33163269136081, 124.4861372640618 45.33163264776155, 124.48613728474399 45.33163260620849, 124.48613731650991 45.33163256829483, 124.4861373581416 45.33163253547424, 124.48613740804267 45.33163250900518, 124.48613746429996 45.33163248990248, 124.48613752475629 45.33163247889859, 124.4861375870938 45.331632476415436, 124.48613764892227 45.331632482548216, 124.48613770787104 45.331632497061804, 124.48613776167993 45.331632519399676, 124.48613780828586 45.3316325487054, 124.48634804377345 45.33179344297431, 124.48636667652718 45.331808968227065, 124.48636671166895 45.33180900403447, 124.48636673636814 45.33180904394759, 124.48636674969867 45.33180908646999, 124.4863667511608 45.331809130007315, 124.48636674069955 45.33180917292719, 124.4863667187072 45.331809213620396, 124.4863666860084 45.3318092505612, 124.48636664382907 45.33180928236453, 124.48636659375082 45.331809307837965, 124.48636653765104 45.331809326026416, 124.48636647763331 45.331809336247936, 124.4863664159478 45.33180933811926, 124.48636635490746 45.33180933157022, 124.48636629680085 45.3318093168464, 124.48636624380654 45.331809294499834, 124.48636619791166 45.33180926536837, 124.48613733857607 45.33163285295644), (124.48588703707425 45.331456326574596, 124.48588699358686 45.33145630010176, 124.48588695753917 45.33145626855505, 124.48588693010096 45.331456232958296, 124.48588691216278 45.3314561944668, 124.485886904307 45.33145615432978, 124.4858849120474 45.331426270618444, 124.48588491545341 45.33142622562609, 124.48588493150564 45.331426182015456, 124.48588495955977 45.33142614153678, 124.48588499848996 45.33142610581461, 124.48588504673369 45.3314260762826, 124.48588510235496 45.33142605412596, 124.48588516312131 45.33142604023393, 124.48588522659409 45.331426035164036, 124.48588529022597 45.33142603911974, 124.48588535146307 45.33142605194229, 124.48588540784775 45.33142607311709, 124.48588545711719 45.33142610179431, 124.4858854972939 45.33142613682303, 124.48590966970848 45.3314521676363, 124.48591102131944 45.33145342098442, 124.48593530020716 45.3314729451363, 124.48593533767584 45.33147298227115, 124.48593536376058 45.33147302397176, 124.48593537739009 45.331473068525504, 124.48593537800457 45.331473114102536, 124.48593536557885 45.33147315883105, 124.48593534062323 45.33147320087405, 124.4859353041626 45.3314732385048, 124.48593525769449 45.33147327017783, 124.48593520312717 45.33147329459235, 124.48593514270193 45.331473310745615, 124.48593507890021 45.33147331797424, 124.48593501434249 45.33147331598135, 124.48593495168005 45.33147330484877, 124.48593489348654 45.33147328503374, 124.4859340015678 45.331472898238346, 124.48593397373143 45.331472888663214, 124.48593109340786 45.33147213269554, 124.48593106346895 45.33147212710696, 124.48592803004851 45.331471779182, 124.48592799914138 45.331471777791734, 124.48592492763541 45.33147185110096, 124.48592489693205 45.33147185396176, 124.48592190379502 45.331472345725615, 124.4859218744595 45.33147235272906, 124.4859201191497 45.33147291139695, 124.48592005594934 45.33147292613538, 124.48591998978783 45.331472931297405, 124.48591992354844 45.331472926658094, 124.48591986011816 45.33147291241962, 124.485919802261 45.33147288920251, 124.48588703707425 45.331456326574596), (124.48590051822161 45.33137801019902, 124.48590047077163 45.33137803883966, 124.48590041631704 45.331378060407275, 124.48590035694686 45.33137807407451, 124.48590029493852 45.33137807931708, 124.48590023267084 45.33137807593386, 124.48590017253244 45.331378064054654, 124.48590011683027 45.33137804413513, 124.48588126737629 45.33136957246505, 124.48588121937308 45.33136954602573, 124.48588117937248 45.33136951363099, 124.48588114883397 45.33136947646269, 124.48588112887164 45.331369435876894, 124.48588112021376 45.33136939335429, 124.4858789940984 45.33133750170054, 124.48587899653319 45.331337461466234, 124.48587904797043 45.3313371888486, 124.48587906233168 45.33133714575629, 124.48587908838103 45.33133710548271, 124.48587912510943 45.33133706958807, 124.48587917109387 45.33133703946286, 124.48587922455312 45.331337016274134, 124.48587928341607 45.331337000920186, 124.48587934540252 45.331336993995826, 124.48587940811119 45.33133699576929, 124.4858794691127 45.33133700617188, 124.48587952604392 45.33133702480059, 124.48587957669949 45.33133705093379, 124.48587961911686 45.331337083559106, 124.48591911665875 45.33137422304062, 124.4859191493741 45.33137426115847, 124.48591917079338 45.33137430307748, 124.48591918007595 45.331374347152284, 124.48591917685735 45.33137439165288, 124.48591916126409 45.33137443483257, 124.48591913390817 45.3313744749965, 124.48591909586321 45.3313745105682, 124.48591904862265 45.331374540151444, 124.48591899404065 45.33137456258501, 124.48591893425969 45.331374576988445, 124.48591887162618 45.33137458279631, 124.48591880859867 45.331374579780686, 124.48591874765091 45.33137456805991, 124.48591723305985 45.33137415934865, 124.48591720316419 45.3313741535629, 124.48591417133379 45.331373786081215, 124.48591414041543 45.33137378449581, 124.48591106511053 45.33137383881816, 124.48591103434316 45.33137384149323, 124.48590803239132 45.331374315556005, 124.48590800294423 45.33137432238988, 124.48590518838611 45.331375198183984, 124.48590516137776 45.331375208917095, 124.48590264113537 45.33137645317212, 124.48590261759183 45.33137646739667, 124.48590051822161 45.33137801019902))</textarea>
            <div class="coord-settings" style="margin-bottom:8px;font-size:12px;color:#333;">
                <label>WKT坐标系：
                    <select id="coordSysSelect" style="margin-left:6px;">
                        <option value="wgs84" selected>WGS84</option>
                        <option value="gcj02">GCJ-02（国测局）</option>
                        <option value="bd09">BD-09（百度）</option>
                        <option value="cgcs2000">CGCS2000</option>
                    </select>
                </label>
                <!-- 已移除“不进行绘制坐标转换”选项，统一使用WGS84绘制 -->
            </div>

            <div class="button-group">
                <button id="drawButton">绘制轮廓</button>
                <button id="clearButton">清空轮廓</button>
            </div>
            <!-- 显示开关：仅保留显示亩数 -->
            <div class="display-toggles" style="margin-top:8px;font-size:12px;color:#333;">
                <label><input type="checkbox" id="toggleLabelsCheckbox"> 显示亩数</label>
            </div>
            <!-- 颜色选择器 -->
            <div class="color-picker-container" style="margin-top:8px;">
                <div style="margin-bottom:6px;font-size:12px;color:#333;">轮廓颜色设置：</div>
                <div style="display:flex;align-items:center;gap:8px;">
                    <div style="display:flex;align-items:center;gap:4px;">
                        <label style="font-size:12px;">边框颜色:</label>
                        <div id="outlineColorPicker" class="color-picker" style="width:24px;height:24px;border:1px solid #ccc;cursor:pointer;background-color:#FFD700;"></div>
                        <input type="color" id="outlineColorInput" value="#FFD700" style="display:none;">
                    </div>
                    <div style="display:flex;align-items:center;gap:4px;">
                        <label style="font-size:12px;">填充颜色:</label>
                        <div id="fillColorPicker" class="color-picker" style="width:24px;height:24px;border:1px solid #ccc;cursor:pointer;background-color:#FFFF00;"></div>
                        <input type="color" id="fillColorInput" value="#FFFF00" style="display:none;">
                    </div>
                    <div style="display:flex;align-items:center;gap:4px;">
                        <label style="font-size:12px;">透明度:</label>
                        <input type="range" id="fillOpacitySlider" min="0" max="100" value="35" style="width:60px;">
                        <span id="fillOpacityValue" style="font-size:12px;">35%</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="tab-pane" id="tabSplit">
            <!-- MultiPolygon → 多个 Polygon 分割器 -->
            <div class="split-section">
                <div class="title">MultiPolygon → 多个 Polygon 分割器</div>
                <div class="desc">输入一个 MULTIPOLYGON WKT，分割为多行 POLYGON WKT。</div>
                <textarea id="multiInput"></textarea>
                <div class="split-actions">
                    <button id="splitMultiBtn">分割为多个 POLYGON</button>
                    <button id="copyPolysBtn">复制结果</button>
                </div>
                <textarea id="polyOutput" readonly></textarea>
            </div>
        </div>

        <div class="tab-pane" id="tabBatch">
            <!-- 批量POLYGON → MULTIPOLYGON 生成器 -->
            <div class="batch-section">
                <div class="title">批量POLYGON → MULTIPOLYGON 合并器</div>
                <div class="desc">每行一个 POLYGON WKT（或用分号分隔）。生成后可一键填充到上方并绘制。</div>
                <textarea id="batchInput"></textarea>
                <div class="batch-actions">
                    <button id="generateMultiBtn">生成 MULTIPOLYGON</button>
                    <button id="copyMultiBtn">复制结果</button>
                </div>
                <textarea id="multiOutput" readonly></textarea>
            </div>
        </div>
        <div class="tab-pane" id="tabTrack">
            <div class="tip">请粘贴轨迹文本（支持两种格式：1）每行一条：定位时间yyyyMMddHHmmss, 经度, 纬度；2）单行#分隔：经度,纬度,定位时间yyyyMMddHHmmss#经度,纬度,定位时间yyyyMMddHHmmss#…）。</div>
            <div class="coord-settings" style="margin-bottom:8px;font-size:12px;color:#333;">
                <label>轨迹坐标系：
                    <select id="trackCoordSysSelect" style="margin-left:6px;">
                        <option value="wgs84" selected>WGS84</option>
                        <option value="gcj02">GCJ-02（国测局）</option>
                        <option value="bd09">BD-09（百度）</option>
                        <option value="cgcs2000">CGCS2000</option>
                    </select>
                </label>
            </div>
            <textarea id="trackTextarea" style="width:100%;height:120px;margin-bottom:10px;padding:8px;border:1px solid #ddd;border-radius:4px;font-family:monospace;resize:vertical;box-sizing:border-box;">20251015095653,124.504354,45.342155
20251015095703,124.504421,45.342118
20251015095713,124.504494,45.342044
20251015095723,124.504459,45.342031
20251015095733,124.504307,45.341991
20251015095743,124.503701,45.341875
20251015095753,124.503401,45.341786
20251015095803,124.503350,45.341770
20251015095813,124.503113,45.341685
20251015095823,124.502814,45.341598
20251015095833,124.502274,45.341354
20251015095843,124.501753,45.341134
20251015095853,124.501187,45.340860
20251015095903,124.500561,45.340542
20251015095913,124.500107,45.340319
20251015095923,124.499830,45.340192
20251015095933,124.499298,45.339941
20251015095943,124.498862,45.339724
20251015095953,124.498567,45.339575
20251015100003,124.497980,45.339306
20251015100013,124.497170,45.338902
20251015100023,124.496631,45.338580
20251015100033,124.496358,45.338409
20251015100043,124.495598,45.338059
20251015100053,124.494821,45.337716
20251015100103,124.493822,45.337369
20251015100113,124.492812,45.337082
20251015100123,124.492024,45.336793
20251015100133,124.491306,45.336556
20251015100143,124.491041,45.336470
20251015100153,124.490423,45.336204
20251015100203,124.489772,45.335783
20251015100213,124.489356,45.335433
20251015100223,124.488979,45.334728
20251015100233,124.488583,45.334327
20251015100243,124.487900,45.333999
20251015100253,124.487686,45.333899
20251015100303,124.487430,45.333771
20251015100313,124.487395,45.333694
20251015100323,124.487441,45.333670
20251015100333,124.487557,45.333569
20251015100343,124.487718,45.333423
20251015100353,124.487885,45.333267
20251015100403,124.488049,45.333099
20251015100413,124.488177,45.332936
20251015100423,124.488346,45.332720
20251015100433,124.488459,45.332518
20251015100443,124.488351,45.332432
20251015100453,124.488053,45.332311
20251015100503,124.487878,45.332326
20251015100513,124.487805,45.332343
20251015100523,124.487745,45.332363
20251015100533,124.487720,45.332374
20251015100543,124.487644,45.332409
20251015100553,124.487578,45.332458
20251015100603,124.487505,45.332517
20251015100613,124.487432,45.332576
20251015100623,124.487337,45.332647
20251015100633,124.487334,45.332659
20251015100643,124.487381,45.332644
20251015100653,124.487422,45.332636
20251015100703,124.487528,45.332600
20251015100713,124.487651,45.332502
20251015100723,124.487671,45.332407
20251015100733,124.487651,45.332395
20251015100743,124.487572,45.332334
20251015100753,124.487578,45.332339
20251015100803,124.487507,45.332285
20251015100813,124.487457,45.332245
20251015100823,124.487398,45.332202
20251015100833,124.487348,45.332161
20251015100843,124.487297,45.332121
20251015100853,124.487241,45.332079
20251015100903,124.487188,45.332037
20251015100913,124.487135,45.331997
20251015100923,124.487083,45.331955
20251015100933,124.487030,45.331913
20251015100943,124.486976,45.331873
20251015100953,124.486922,45.331831
20251015101003,124.486866,45.331787
20251015101013,124.486810,45.331745
20251015101023,124.486762,45.331705
20251015101033,124.486763,45.331705
20251015101043,124.486727,45.331678
20251015101053,124.486669,45.331632
20251015101103,124.486613,45.331588
20251015101113,124.486556,45.331544
20251015101123,124.486496,45.331498
20251015101133,124.486441,45.331455
20251015101143,124.486386,45.331413
20251015101153,124.486331,45.331370
20251015101203,124.486279,45.331331
20251015101213,124.486226,45.331288
20251015101223,124.486173,45.331246
20251015101233,124.486118,45.331204
20251015101243,124.486055,45.331156
20251015101253,124.485995,45.331111
20251015101303,124.485931,45.331061
20251015101313,124.485869,45.331012
20251015101323,124.485925,45.331057
20251015101333,124.485924,45.331056
20251015101343,124.485924,45.331056
20251015101353,124.485924,45.331056
20251015101403,124.485924,45.331056
20251015101413,124.485924,45.331056
20251015101423,124.485836,45.331002
20251015101433,124.485833,45.331028
20251015101443,124.485828,45.331065
20251015101453,124.485826,45.331010
20251015101503,124.485832,45.331024
20251015101513,124.485833,45.331012
20251015101523,124.485890,45.331078
20251015101533,124.485957,45.331131
20251015101543,124.486024,45.331183
20251015101553,124.486090,45.331234
20251015101603,124.486153,45.331283
20251015101613,124.486223,45.331338
20251015101623,124.486291,45.331391
20251015101633,124.486356,45.331443
20251015101643,124.486427,45.331496
20251015101653,124.486495,45.331549
20251015101703,124.486559,45.331598
20251015101713,124.486626,45.331650
20251015101723,124.486692,45.331701
20251015101733,124.486761,45.331755
20251015101743,124.486830,45.331811
20251015101753,124.486901,45.331865
20251015101803,124.486973,45.331920
20251015101813,124.487042,45.331976
20251015101823,124.487110,45.332029
20251015101833,124.487184,45.332087
20251015101843,124.487257,45.332144
20251015101853,124.487331,45.332199
20251015101903,124.487401,45.332254
20251015101913,124.487469,45.332306
20251015101923,124.487539,45.332361
20251015101933,124.487598,45.332406
20251015101943,124.487525,45.332309
20251015101953,124.487475,45.332267
20251015102003,124.487477,45.332268
20251015102013,124.487477,45.332268
20251015102023,124.487477,45.332268
20251015102033,124.487574,45.332340
20251015102043,124.487601,45.332458
20251015102053,124.487626,45.332452
20251015102103,124.487613,45.332441
20251015102113,124.487613,45.332441
20251015102123,124.487613,45.332441
20251015102133,124.487604,45.332437
20251015102143,124.487535,45.332391
20251015102153,124.487472,45.332342
20251015102203,124.487408,45.332293
20251015102213,124.487344,45.332243
20251015102223,124.487275,45.332189
20251015102233,124.487210,45.332139
20251015102243,124.487142,45.332085
20251015102253,124.487080,45.332039
20251015102303,124.487012,45.331985
20251015102313,124.486945,45.331934
20251015102323,124.486877,45.331881
20251015102333,124.486806,45.331825
20251015102343,124.486737,45.331769
20251015102353,124.486667,45.331715
20251015102403,124.486598,45.331661
20251015102413,124.486529,45.331608
20251015102423,124.486461,45.331556
20251015102433,124.486393,45.331503
20251015102443,124.486321,45.331448
20251015102453,124.486247,45.331391
20251015102503,124.486180,45.331338
20251015102513,124.486101,45.331276
20251015102523,124.486035,45.331224
20251015102533,124.485963,45.331168
20251015102543,124.485880,45.331104
20251015102553,124.485977,45.331180
20251015102603,124.485977,45.331180
20251015102613,124.485977,45.331179
20251015102623,124.485977,45.331179
20251015102633,124.485977,45.331179
20251015102643,124.485859,45.331115
20251015102653,124.485854,45.331119
20251015102703,124.485834,45.331161
20251015102713,124.485841,45.331109
20251015102723,124.485894,45.331166
20251015102733,124.485959,45.331220
20251015102743,124.486026,45.331271
20251015102753,124.486095,45.331325
20251015102803,124.486167,45.331381
20251015102813,124.486242,45.331441
20251015102823,124.486316,45.331498
20251015102833,124.486356,45.331528
20251015102843,124.486421,45.331579
20251015102853,124.486485,45.331628
20251015102903,124.486557,45.331682
20251015102913,124.486629,45.331738
20251015102923,124.486705,45.331798
20251015102933,124.486776,45.331855
20251015102943,124.486844,45.331907
20251015102953,124.486913,45.331961
20251015103003,124.486985,45.332018
20251015103013,124.487056,45.332073
20251015103023,124.487127,45.332127
20251015103033,124.487186,45.332172
20251015103043,124.487252,45.332224
20251015103053,124.487321,45.332277
20251015103103,124.487399,45.332338
20251015103113,124.487474,45.332397
20251015103123,124.487532,45.332443
20251015103133,124.487441,45.332339
20251015103143,124.487452,45.332346
20251015103153,124.487452,45.332346
20251015103203,124.487452,45.332346
20251015103213,124.487452,45.332346
20251015103223,124.487454,45.332348
20251015103233,124.487525,45.332405
20251015103243,124.487563,45.332494
20251015103253,124.487563,45.332493
20251015103303,124.487573,45.332488
20251015103313,124.487573,45.332488
20251015103323,124.487573,45.332488
20251015103333,124.487543,45.332478
20251015103343,124.487468,45.332426
20251015103353,124.487400,45.332373
20251015103403,124.487331,45.332319
20251015103413,124.487262,45.332265
20251015103423,124.487194,45.332213
20251015103433,124.487127,45.332162
20251015103443,124.487061,45.332111
20251015103453,124.486998,45.332060
20251015103503,124.486930,45.332009
20251015103513,124.486860,45.331954
20251015103523,124.486789,45.331900
20251015103533,124.486713,45.331840
20251015103543,124.486643,45.331783
20251015103553,124.486576,45.331731
20251015103603,124.486508,45.331680
20251015103613,124.486440,45.331626
20251015103623,124.486372,45.331575
20251015103633,124.486302,45.331520
20251015103643,124.486232,45.331465
20251015103653,124.486159,45.331408
20251015103703,124.486120,45.331378
20251015103713,124.486049,45.331323
20251015103723,124.485981,45.331271
20251015103733,124.485914,45.331218
20251015103743,124.485933,45.331233
20251015103753,124.485945,45.331242
20251015103803,124.485944,45.331242
20251015103813,124.485944,45.331241
20251015103823,124.485955,45.331250
20251015103833,124.485981,45.331243
20251015103843,124.485860,45.331133
20251015103853,124.485837,45.331130
20251015103903,124.485874,45.331138
20251015103913,124.485857,45.331150
20251015103923,124.485858,45.331204
20251015103933,124.485859,45.331225
20251015103943,124.485875,45.331229
20251015103953,124.485929,45.331282
20251015104003,124.486002,45.331338
20251015104013,124.486071,45.331392
20251015104023,124.486139,45.331444
20251015104033,124.486208,45.331498
20251015104043,124.486279,45.331554
20251015104053,124.486294,45.331565
20251015104103,124.486333,45.331594
20251015104113,124.486395,45.331643
20251015104123,124.486457,45.331692
20251015104133,124.486526,45.331744
20251015104143,124.486592,45.331796
20251015104153,124.486656,45.331846
20251015104203,124.486720,45.331897
20251015104213,124.486791,45.331953
20251015104223,124.486858,45.332007
20251015104233,124.486921,45.332055
20251015104243,124.486986,45.332104
20251015104253,124.487051,45.332155
20251015104303,124.487117,45.332206
20251015104313,124.487165,45.332244
20251015104323,124.487217,45.332283
20251015104333,124.487264,45.332319
20251015104343,124.487314,45.332359
20251015104353,124.487374,45.332406
20251015104403,124.487443,45.332459
20251015104413,124.487462,45.332475
20251015104423,124.487412,45.332399
20251015104433,124.487412,45.332399
20251015104443,124.487412,45.332399
20251015104453,124.487412,45.332399
20251015104503,124.487421,45.332407
20251015104513,124.487505,45.332539
20251015104523,124.487505,45.332541
20251015104533,124.487530,45.332539
20251015104543,124.487529,45.332539
20251015104553,124.487529,45.332539
20251015104603,124.487529,45.332539
20251015104613,124.487529,45.332539
20251015104623,124.487529,45.332539
20251015104633,124.487529,45.332539
20251015104643,124.487529,45.332539
20251015104653,124.487529,45.332539
20251015104703,124.487529,45.332539
20251015104713,124.487529,45.332539
20251015104723,124.487529,45.332539
20251015104733,124.487529,45.332539
20251015104743,124.487529,45.332539
20251015104753,124.487529,45.332539
20251015104803,124.487517,45.332537
20251015104813,124.487466,45.332508
20251015104823,124.487406,45.332464
20251015104833,124.487348,45.332419
20251015104843,124.487286,45.332371
20251015104853,124.487229,45.332325
20251015104902,124.487156,45.332268
20251015104912,124.487082,45.332211
20251015104922,124.487010,45.332157
20251015104932,124.486943,45.332104
20251015104942,124.486905,45.332075
20251015104952,124.486840,45.332025
20251015105002,124.486769,45.331970
20251015105012,124.486704,45.331918
20251015105022,124.486638,45.331866
20251015105032,124.486574,45.331815
20251015105042,124.486508,45.331763
20251015105052,124.486440,45.331711
20251015105102,124.486371,45.331656
20251015105112,124.486303,45.331603
20251015105122,124.486234,45.331551
20251015105132,124.486168,45.331499
20251015105142,124.486099,45.331447
20251015105152,124.486027,45.331390
20251015105202,124.485953,45.331333
20251015105212,124.485881,45.331278
20251015105222,124.485951,45.331332
20251015105232,124.485965,45.331343
20251015105242,124.485965,45.331343
20251015105252,124.485964,45.331342
20251015105302,124.485964,45.331342
20251015105312,124.485964,45.331342
20251015105322,124.485963,45.331341
20251015105332,124.485963,45.331341
20251015105342,124.485963,45.331341
20251015105352,124.485956,45.331335
20251015105402,124.485867,45.331251
20251015105412,124.485871,45.331260
20251015105422,124.485860,45.331283
20251015105432,124.485873,45.331284
20251015105442,124.485863,45.331337
20251015105452,124.485866,45.331398
20251015105502,124.485871,45.331457
20251015105512,124.485868,45.331526
20251015105522,124.485874,45.331592
20251015105532,124.485879,45.331659
20251015105542,124.485879,45.331671
20251015105552,124.485869,45.331603
20251015105602,124.485867,45.331535
20251015105612,124.485869,45.331464
20251015105622,124.485867,45.331388
20251015105632,124.485865,45.331401
20251015105642,124.485859,45.331326
20251015105652,124.485875,45.331314
20251015105702,124.485942,45.331377
20251015105712,124.486014,45.331431
20251015105722,124.486088,45.331490
20251015105732,124.486148,45.331536
20251015105742,124.486220,45.331593
20251015105752,124.486294,45.331652
20251015105802,124.486367,45.331706
20251015105812,124.486443,45.331766
20251015105822,124.486521,45.331827
20251015105832,124.486600,45.331890
20251015105842,124.486675,45.331949
20251015105852,124.486748,45.332008
20251015105902,124.486830,45.332069
20251015105912,124.486902,45.332125
20251015105922,124.486978,45.332185
20251015105932,124.487047,45.332239
20251015105942,124.487124,45.332298
20251015105952,124.487202,45.332358
20251015110002,124.487282,45.332422
20251015110012,124.487367,45.332488
20251015110022,124.487426,45.332533
20251015110032,124.487355,45.332445
20251015110042,124.487357,45.332446
20251015110052,124.487357,45.332446
20251015110102,124.487357,45.332446
20251015110112,124.487357,45.332446
20251015110122,124.487357,45.332446
20251015110132,124.487358,45.332446
20251015110142,124.487366,45.332435
20251015110152,124.487429,45.332525
20251015110202,124.487418,45.332629
20251015110212,124.487464,45.332600
20251015110222,124.487495,45.332587
20251015110232,124.487495,45.332586
20251015110242,124.487495,45.332586
20251015110252,124.487495,45.332586
20251015110302,124.487435,45.332567
20251015110312,124.487369,45.332524
20251015110322,124.487298,45.332469
20251015110332,124.487240,45.332422
20251015110342,124.487165,45.332364
20251015110352,124.487098,45.332311
20251015110402,124.487030,45.332258
20251015110412,124.486964,45.332207
20251015110422,124.486898,45.332156
20251015110432,124.486828,45.332101
20251015110442,124.486759,45.332048
20251015110452,124.486691,45.331995
20251015110502,124.486620,45.331939
20251015110512,124.486551,45.331885
20251015110522,124.486481,45.331829
20251015110532,124.486409,45.331773
20251015110542,124.486333,45.331713
20251015110552,124.486303,45.331689
20251015110602,124.486303,45.331689
20251015110612,124.486299,45.331687
20251015110622,124.486228,45.331632
20251015110632,124.486153,45.331574
20251015110642,124.486082,45.331519
20251015110652,124.486011,45.331462
20251015110702,124.485944,45.331411
20251015110712,124.485913,45.331385
20251015110722,124.485960,45.331423
20251015110732,124.485958,45.331421
20251015110742,124.485957,45.331420
20251015110752,124.485957,45.331420
20251015110802,124.485946,45.331412
20251015110812,124.485857,45.331372
20251015110822,124.485847,45.331396
20251015110832,124.485848,45.331395
20251015110842,124.485857,45.331406
20251015110852,124.485871,45.331390
20251015110902,124.485923,45.331446
20251015110912,124.485992,45.331502
20251015110922,124.486066,45.331561
20251015110932,124.486141,45.331618
20251015110942,124.486219,45.331679
20251015110952,124.486290,45.331733
20251015111002,124.486360,45.331786
20251015111012,124.486432,45.331846
20251015111022,124.486508,45.331906
20251015111032,124.486578,45.331961
20251015111042,124.486649,45.332016
20251015111052,124.486721,45.332072
20251015111102,124.486793,45.332127
20251015111112,124.486858,45.332179
20251015111122,124.486935,45.332237
20251015111132,124.487000,45.332288
20251015111142,124.487069,45.332341
20251015111152,124.487137,45.332396
20251015111202,124.487208,45.332452
20251015111212,124.487274,45.332504
20251015111222,124.487345,45.332559
20251015111232,124.487337,45.332546
20251015111242,124.487295,45.332481
20251015111252,124.487296,45.332481
20251015111302,124.487296,45.332481
20251015111312,124.487296,45.332481
20251015111322,124.487296,45.332481
20251015111332,124.487296,45.332481
20251015111342,124.487296,45.332481
20251015111352,124.487296,45.332481
20251015111402,124.487296,45.332481
20251015111412,124.487296,45.332481
20251015111422,124.487296,45.332481
20251015111432,124.487296,45.332482
20251015111442,124.487296,45.332482
20251015111452,124.487296,45.332482
20251015111502,124.487296,45.332482
20251015111512,124.487296,45.332482
20251015111522,124.487296,45.332482
20251015111532,124.487296,45.332482
20251015111542,124.487296,45.332482
20251015111552,124.487296,45.332482
20251015111602,124.487296,45.332482
20251015111701,124.487415,45.332632
20251015111935,124.487647,45.332496
20251015111945,124.487647,45.332496
20251015111955,124.487647,45.332496
20251015112005,124.487647,45.332496
20251015112015,124.487647,45.332496
20251015112025,124.487647,45.332496
20251015112035,124.487647,45.332496
20251015112045,124.487647,45.332496
20251015112055,124.487647,45.332496
20251015112105,124.487647,45.332496
20251015112115,124.487647,45.332496
20251015112125,124.487647,45.332496
20251015112135,124.487647,45.332496
20251015112145,124.487647,45.332496
20251015112155,124.487647,45.332496
20251015112205,124.487647,45.332496
20251015112215,124.487647,45.332496
20251015112225,124.487647,45.332496
20251015112235,124.487647,45.332496
20251015112245,124.487647,45.332496
20251015112255,124.487647,45.332496
20251015112305,124.487647,45.332496
20251015112315,124.487647,45.332496
20251015112325,124.487647,45.332496
20251015112335,124.487647,45.332496
20251015112345,124.487647,45.332496
20251015112355,124.487647,45.332496
20251015112405,124.487647,45.332496
20251015112415,124.487647,45.332496
20251015112425,124.487647,45.332496
20251015112435,124.487651,45.332494
20251015112445,124.487745,45.332415
20251015112455,124.487630,45.332415
20251015112505,124.487608,45.332505
20251015112515,124.487569,45.332536
20251015112526,124.487509,45.332583
20251015112536,124.487455,45.332619
20251015112546,124.487418,45.332625
20251015112556,124.487367,45.332603
20251015112606,124.487316,45.332570
20251015112616,124.487264,45.332531
20251015112626,124.487208,45.332485
20251015112636,124.487154,45.332444
20251015112646,124.487097,45.332399
20251015112656,124.487043,45.332355
20251015112706,124.486983,45.332308
20251015112716,124.486922,45.332261
20251015112726,124.486862,45.332215
20251015112736,124.486801,45.332167
20251015112746,124.486740,45.332119
20251015112756,124.486681,45.332074
20251015112806,124.486617,45.332024
20251015112816,124.486556,45.331976
20251015112826,124.486493,45.331928
20251015112836,124.486430,45.331877
20251015112846,124.486365,45.331825
20251015112856,124.486303,45.331777
20251015112906,124.486242,45.331729
20251015112916,124.486179,45.331681
20251015112926,124.486125,45.331640
20251015112936,124.486062,45.331589
20251015112946,124.485995,45.331538
20251015112956,124.485927,45.331483
20251015113006,124.485956,45.331507
20251015113016,124.485956,45.331507
20251015113026,124.485955,45.331506
20251015113036,124.485954,45.331505
20251015113046,124.485952,45.331503
20251015113056,124.485861,45.331457
20251015113106,124.485878,45.331468
20251015113116,124.485858,45.331502
20251015113126,124.485879,45.331487
20251015113136,124.485879,45.331487
20251015113146,124.485879,45.331487
20251015113156,124.485879,45.331487
20251015113206,124.485879,45.331487
20251015113216,124.485883,45.331493
20251015113226,124.485939,45.331543
20251015113236,124.486010,45.331600
20251015113246,124.486084,45.331658
20251015113256,124.486159,45.331716
20251015113306,124.486225,45.331766
20251015113316,124.486296,45.331822
20251015113326,124.486362,45.331874
20251015113336,124.486425,45.331924
20251015113346,124.486476,45.331965
20251015113356,124.486544,45.332019
20251015113406,124.486566,45.332036
20251015113416,124.486622,45.332080
20251015113426,124.486663,45.332113
20251015113436,124.486725,45.332160
20251015113446,124.486787,45.332207
20251015113456,124.486862,45.332266
20251015113506,124.486927,45.332315
20251015113516,124.486993,45.332368
20251015113526,124.487067,45.332426
20251015113536,124.487133,45.332478
20251015113546,124.487202,45.332534
20251015113556,124.487278,45.332592
20251015113606,124.487291,45.332600
20251015113616,124.487251,45.332546
20251015113626,124.487251,45.332547
20251015113636,124.487252,45.332546
20251015113646,124.487252,45.332547
20251015113656,124.487252,45.332547
20251015113706,124.487245,45.332540
20251015113716,124.487255,45.332545
20251015113726,124.487324,45.332574
20251015113736,124.487308,45.332564
20251015113746,124.487308,45.332564
20251015113756,124.487308,45.332564
20251015113806,124.487308,45.332564
20251015113816,124.487307,45.332565
20251015113826,124.487375,45.332586
20251015113836,124.487419,45.332563
20251015113846,124.487439,45.332548
20251015113856,124.487401,45.332586
20251015113906,124.487389,45.332610
20251015113916,124.487389,45.332610
20251015113926,124.487389,45.332610
20251015113936,124.487389,45.332610
20251015113946,124.487389,45.332610
20251015113956,124.487389,45.332610
20251015114006,124.487389,45.332610
20251015114016,124.487389,45.332610
20251015114026,124.487433,45.332563
20251015114036,124.487441,45.332557
20251015114046,124.487497,45.332529
20251015114056,124.487618,45.332499
20251015114106,124.487795,45.332392
20251015114116,124.488011,45.332310
20251015114126,124.488202,45.332382
20251015114136,124.488408,45.332479
20251015114146,124.488450,45.332571
20251015114156,124.488282,45.332796
20251015114206,124.488090,45.333043
20251015114216,124.487862,45.333280
20251015114226,124.487602,45.333521
20251015114236,124.487403,45.333686
20251015114246,124.487296,45.333723
20251015114256,124.487454,45.333778
20251015114306,124.487639,45.333874
20251015114316,124.487786,45.333954
20251015114326,124.487818,45.333986
20251015114336,124.487820,45.334037
20251015114346,124.488008,45.334038
20251015114356,124.488132,45.334112
20251015114406,124.488263,45.334180
20251015114416,124.488463,45.334279
20251015114426,124.488833,45.334470
20251015114436,124.489072,45.334939
20251015114446,124.489233,45.335271
20251015114456,124.489280,45.335358
20251015114506,124.489395,45.335484
20251015114516,124.489535,45.335615
20251015114526,124.489733,45.335762
20251015114536,124.490040,45.335970
20251015114546,124.490458,45.336218
20251015114556,124.490795,45.336356
20251015114606,124.490829,45.336367
20251015114616,124.491052,45.336453
20251015114625,124.491621,45.336664
20251015114635,124.492398,45.336938
20251015114645,124.493200,45.337203
20251015114655,124.494118,45.337451
20251015114705,124.494960,45.337783
20251015114715,124.495843,45.338167
20251015114725,124.496604,45.338558
20251015114735,124.497348,45.339002
20251015114745,124.498070,45.339360
20251015114755,124.498622,45.339608
20251015114805,124.499329,45.339964
20251015114815,124.499880,45.340215
20251015114825,124.500341,45.340446
20251015114835,124.500945,45.340746
20251015114845,124.501234,45.340889
20251015114855,124.501260,45.340902
20251015114905,124.501261,45.340902
20251015114915,124.501261,45.340902
20251015114925,124.501261,45.340902
20251015114935,124.501373,45.340948
20251015114945,124.501752,45.341137
20251015114955,124.502158,45.341308
20251015115005,124.502614,45.341520
20251015115015,124.503050,45.341675
20251015115025,124.503673,45.341871
20251015115035,124.504172,45.341973
20251015115045,124.504521,45.342063
20251015115055,124.504513,45.342027
20251015115105,124.504434,45.342114
20251015115115,124.504324,45.342182</textarea>
            <div class="button-group">
                <button id="drawTrackButton" disabled style="flex: 1;">绘制轨迹</button>
                <button id="showTrackPointsButton" disabled style="flex: 1;" class="btn-warning">打点</button>
                <button id="clearTrackButton" disabled style="flex: 1;">清空轨迹</button>
            </div>
            <!-- 轨迹颜色选择器 -->
            <div class="color-picker-container" style="margin-top:8px;">
                <div style="margin-bottom:6px;font-size:12px;color:#333;">轨迹颜色设置：</div>
                <div style="display:flex;align-items:center;gap:8px;">
                    <div style="display:flex;align-items:center;gap:4px;">
                        <label style="font-size:12px;">轨迹线颜色:</label>
                        <div id="trackLineColorPicker" class="color-picker" style="width:24px;height:24px;border:1px solid #ccc;cursor:pointer;background-color:#FF0000;"></div>
                        <input type="color" id="trackLineColorInput" value="#FF0000" style="display:none;">
                    </div>
                    <div style="display:flex;align-items:center;gap:4px;">
                        <label style="font-size:12px;">轨迹点颜色:</label>
                        <div id="trackPointColorPicker" class="color-picker" style="width:24px;height:24px;border:1px solid #ccc;cursor:pointer;background-color:#68EAF3;"></div>
                        <input type="color" id="trackPointColorInput" value="#68EAF3" style="display:none;">
                    </div>
                </div>
            </div>
            <!-- 回放控制 -->
            <div class="split-section" style="margin-top:8px;">
                <div class="title">轨迹回放</div>
                <div class="playback-actions" style="display:flex;gap:8px;margin-bottom:8px;">
                    <button id="playbackStartBtn" disabled>开始</button>
                    <button id="playbackPauseBtn" disabled>继续</button>
                    <button id="playbackStopBtn" disabled>结束</button>
                </div>
                <div class="playback-speed" style="display:flex;align-items:center;gap:8px;margin-bottom:8px;">
                    <label>速度：
                        <select id="playbackSpeedSelect" disabled>
                            <option value="1" selected>1×</option>
                            <option value="2">2×</option>
                            <option value="4">4×</option>
                            <option value="8">8×</option>
                            <option value="16">16×</option>
                            <option value="32">32×</option>
                            <option value="64">64×</option>
                            <option value="128">128×</option>
                            <option value="256">256×</option>
                            <option value="512">512×</option>
                            <option value="1024">1024×</option>
                        </select>
                    </label>
                    <span id="playbackTimeLabel" style="font-size:12px;color:#666;">时间：—</span>
                </div>
                <div class="playback-time" style="display:flex;flex-direction:column;gap:4px;margin-bottom:8px;">
                    <label class="playback-time-label" style="display:flex;align-items:center;gap:8px;flex:1 1 auto;min-width:0;">
                        <span class="playback-time-text" style="white-space:nowrap;">起始时间：</span>
                        <input type="range" id="playbackTimeSlider" disabled min="0" max="0" step="1000" value="0" style="flex:1 1 auto;min-width:0;max-width:100%;vertical-align:middle;">
                    </label>
                    <span id="playbackTimeCursor" style="font-size:12px;color:#666;align-self:flex-end;">—</span>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    let map;
    let currentPolygons = []; // 存储多边形和其标签
    let currentTracks = []; // 存储轨迹折线及相关覆盖物
    let mapLoaded = false;
    let mapLabelHandlers = []; // 存储地图事件处理器
    let labelsEnabled = false; // 标签显示开关（默认关闭）
    let isDrawing = false; // 绘制进行中防止重复点击
    let currentMapType = 'satellite'; // 当前地图类型：'satellite'（卫星图）或'street'（街道图）

    window.onload = function () {
        if (typeof T === 'undefined') {
            alert("天地图API加载失败，请检查网络或密钥！");
            return;
        }
        initMap();
        bindDrawEvent();
        bindMinimizeEvent();
        bindTabs();
        bindBatchGenerator();
        bindMultiSplitter();
        bindLabelsToggle(); // 绑定标签显示开关
        bindTrackEvents();  // 绑定轨迹绘制与清空
        bindPlaybackControls(); // 绑定轨迹回放
        bindMeasureEvents(); // 绑定测量功能
        bindMapTypeEvent(); // 绑定地图类型切换功能
        initColorPickers(); // 初始化颜色选择器
    };

    function initMap() {
        showLoading();
        disableButtons(true);

        try {
            map = new T.Map("mapContainer", {
                zoom: 12,
                center: new T.LngLat(116.40769, 39.90403)
            });

            // 已移除测试标签
            map.enableScrollWheelZoom();

            // 不再添加地图类型控件到地图，改为使用左侧工具条按钮切换
            // const mapTypeCtrl = new T.Control.MapType({
            //     mapTypes: [TMAP_NORMAL_MAP, TMAP_SATELLITE_MAP, TMAP_TERRAIN_MAP],
            //     position: T_ANCHOR_TOP_LEFT
            // });
            // map.addControl(mapTypeCtrl);

            // 加载影像底图（卫星）
            const tk = "648f621977051d0199ff0f965d3fd322";

            // 方案1：使用默认地图类型（作为备选）
            map.setMapType(TMAP_SATELLITE_MAP);
            currentMapType = 'satellite';
            updateMapTypeButton('卫星图');

            // 方案2：手动添加影像图层（底图 + 标注）
            const vecLayer = new T.TileLayer(`https://t0.tianditu.gov.cn/img_w/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=img&STYLE=default&TILEMATRIXSET=w&FORMAT=tiles&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}&tk=${tk}`);
            const cvaLayer = new T.TileLayer(`https://t0.tianditu.gov.cn/cia_w/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=cia&STYLE=default&TILEMATRIXSET=w&FORMAT=tiles&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}&tk=${tk}`);

            // 添加图层并监听加载状态
            vecLayer.addEventListener("load", function () {
                console.log("影像底图加载完成");
            });

            vecLayer.addEventListener("error", function (e) {
                console.error("影像底图加载错误:", e);
                alert("影像底图加载错误，将使用默认地图类型");
            });

            map.addLayer(vecLayer);
            map.addLayer(cvaLayer);

            // 监听地图加载事件
            map.addEventListener("loaded", function () {
                console.log("地图加载完成");
                markMapLoaded();
            });
            map.addEventListener("load", function () {
                console.log("地图load事件触发");
                markMapLoaded();
            });
            map.addEventListener("tilesloaded", function () {
                console.log("地图瓦片加载完成");
                markMapLoaded();
            });
            // 监听地图加载失败事件
            map.addEventListener("error", function (e) {
                console.error("地图加载错误:", e);
                alert("地图加载错误: " + e.message);
                hideLoading();
            });

            // 监听地图移动事件，用于更新标签位置
            const moveHandler = function () {
                updateAllLabelsPosition();
            };
            map.addEventListener("move", moveHandler);
            map.addEventListener("zoom", moveHandler);

            // 存储事件处理器，用于清理
            mapLabelHandlers.push({ event: "move", handler: moveHandler });
            mapLabelHandlers.push({ event: "zoom", handler: moveHandler });

            // 超时容错
            setTimeout(() => {
                if (!mapLoaded) markMapLoaded();
            }, 8000);

        } catch (error) {
            alert("地图初始化失败：" + error.message);
            console.error(error);
            hideLoading();
        }
    }

    function markMapLoaded() {
        if (!mapLoaded) {
            mapLoaded = true;
            hideLoading();
            // 不再禁用按钮，保持按钮始终可用
            // disableButtons(false);
            disableTrackButtons(false);
            // 仅开启速度选择，回放按钮按状态控制
            const speedSel = document.getElementById('playbackSpeedSelect');
            if (speedSel) speedSel.disabled = false;
            updatePlaybackButtonsState('idle');
        }
    }

    function showLoading() {
        const loading = document.getElementById("mapLoading");
        loading.style.display = "flex";
        loading.style.opacity = "1";
    }

    function hideLoading() {
        const loading = document.getElementById("mapLoading");
        loading.style.opacity = "0";
        setTimeout(() => loading.style.display = "none", 300);
    }

    function disableButtons(disabled) {
        // 不再禁用按钮，保持按钮始终可用
        // document.getElementById("drawButton").disabled = disabled;
        // document.getElementById("clearButton").disabled = disabled;
    }

    function disableTrackButtons(disabled) {
        const drawTrackBtn = document.getElementById("drawTrackButton");
        const showTrackPointsBtn = document.getElementById("showTrackPointsButton");
        const clearTrackBtn = document.getElementById("clearTrackButton");
        if (drawTrackBtn) drawTrackBtn.disabled = disabled;
        if (showTrackPointsBtn) showTrackPointsBtn.disabled = disabled;
        if (clearTrackBtn) clearTrackBtn.disabled = disabled;
    }
    // 回放控件的禁用/启用
    function disablePlaybackButtons(disabled) {
        ["playbackStartBtn","playbackPauseBtn","playbackStopBtn","playbackSpeedSelect","playbackTimeSlider"].forEach(id=>{
            const el = document.getElementById(id);
            if (el) el.disabled = disabled;
        });
    }

    // 回放按钮状态管理：空闲/播放/暂停
    function updatePlaybackButtonsState(state){
        try {
            const startBtn = document.getElementById('playbackStartBtn');
            const pauseBtn = document.getElementById('playbackPauseBtn');
            const stopBtn = document.getElementById('playbackStopBtn');
            if (!startBtn || !pauseBtn || !stopBtn) return;
            if (state === 'idle') {
                startBtn.disabled = false;
                pauseBtn.disabled = true;
                stopBtn.disabled = true;
                pauseBtn.textContent = '继续';
            } else if (state === 'playing') {
                startBtn.disabled = true;
                pauseBtn.disabled = false;
                stopBtn.disabled = false;
                pauseBtn.textContent = '暂停';
            } else if (state === 'paused') {
                startBtn.disabled = true;
                pauseBtn.disabled = false;
                stopBtn.disabled = false;
                pauseBtn.textContent = '继续';
            }
        } catch(e) { console.warn('更新按钮状态失败:', e); }
    }

    function bindDrawEvent() {
        document.getElementById("drawButton").addEventListener("click", function () {
            if (isDrawing) { console.log('绘制进行中，忽略重复点击'); return; }
            isDrawing = true;
            showLoading();
            try {
                const wktStr = document.getElementById("wktTextarea").value.trim();
                if (!wktStr) { alert("请输入WKT字符串！"); return; }
                clearOverlays();
                const geojson = parseWkt(wktStr);
    
                const polygonData = [];
                if (geojson.type === "Polygon") {
                    polygonData.push({ index: 1, coordinates: geojson.coordinates });
                } else if (geojson.type === "MultiPolygon") {
                    geojson.coordinates.forEach((polygon, index) => {
                        polygonData.push({ index: index + 1, coordinates: polygon });
                    });
                }
    
                // 重置并绘制
                polygonInfoList = [];
                polygonData.forEach(pd => processPolygon(pd.index, pd.coordinates));
    
                // 视图居中到所有已绘制轮廓
                try { fitViewportToPolygons(); } catch (e) { console.warn('视图居中失败', e); }
    
                // 在视图稳定后再创建/更新标签
                setTimeout(() => {
                    if (labelsEnabled) {
                        try {
                            createAllLabels();
                            updateAllLabelsPosition();
                        } catch (e) {
                            console.warn('创建或更新标签失败:', e);
                        }
                    }
                }, 150);
            } catch (e) {
                alert('绘制失败：' + (e && e.message ? e.message : e));
                console.error('绘制异常:', e);
            } finally {
                hideLoading();
                isDrawing = false;
                // 不再禁用按钮，保持按钮始终可用
                // disableButtons(false);
            }
        });

        document.getElementById("clearButton").addEventListener("click", function () {
            if (isDrawing) { console.log('绘制进行中，暂不清空'); return; }
            clearOverlays();
            console.log("已清空所有轮廓");
        });
    }

    // 存储多边形数据，用于后续标签创建
    let polygonInfoList = [];

    // 处理单个多边形的绘制和面积计算
    function processPolygon(actualPolygonIndex, polygonCoords) {
        console.log('开始处理多边形', actualPolygonIndex);

        // 坐标系选择（绘制始终使用WGS84坐标）
        const coordSys = (document.getElementById('coordSysSelect') && document.getElementById('coordSysSelect').value) || 'wgs84';

        // 统一转换为WGS84用于绘制与面积计算
        function toWgs(point){
            const lng = point[0], lat = point[1];
            if (coordSys === 'wgs84' || coordSys === 'cgcs2000') {
                return [lng, lat];
            } else if (coordSys === 'gcj02') {
                const w = gcj02ToWgs84(lng, lat);
                return [w.lng, w.lat];
            } else if (coordSys === 'bd09') {
                const gcj = bd09ToGcj02(lng, lat);
                const w = gcj02ToWgs84(gcj.lng, gcj.lat);
                return [w.lng, w.lat];
            }
            return [lng, lat];
        }
        const coordsWGS84 = polygonCoords.map(ring => ring.map(toWgs));
        let outerRingWGS = coordsWGS84[0] || [];

        // 生成用于绘制的坐标（直接使用WGS84坐标）
        const rings = coordsWGS84.map(ring => ring.map(([lng, lat]) => new T.LngLat(lng, lat)));


         // 创建半透明填充的多边形（无边框）
          const polygon = new T.Polygon(rings, {
              color: currentOutlineColor,
              weight: 1,
              opacity: 1,
              fillColor: currentFillColor,
              fillOpacity: currentFillOpacity
          });
 
          // 使用WGS84坐标计算面积（更准确的面积计算）
         let areaSqm;
         let areaMu;



         try {
             // 检查Turf.js是否可用
             if (typeof turf !== 'undefined' && turf.area) {
                 // 使用Turf.js计算多边形面积
                // 构造GeoJSON格式的多边形
                const geoJsonPolygon = {
                    type: "Polygon",
                    coordinates: coordsWGS84
                };


                 // 使用Turf.js计算面积（平方米）
                 areaSqm = turf.area(geoJsonPolygon);
                 areaMu = (areaSqm / 666.6667).toFixed(4); // 转换为亩
                 console.log(`多边形${actualPolygonIndex}面积计算结果(Turf.js): ${areaSqm}平方米 = ${areaMu}亩`);
             } else {
                 // 如果Turf.js不可用，回退到之前的计算方法
                 console.warn('Turf.js不可用，使用备用计算方法');
                 // 计算带孔洞的多边形面积
                 areaSqm = 0;
                 // 计算外环面积
                 outerRingWGS = coordsWGS84[0] || [];
                 areaSqm += calculatePolygonArea(outerRingWGS);

                 // 减去内环（孔洞）面积
                 for (let i = 1; i < coordsWGS84.length; i++) {
                     const innerRingArea = calculatePolygonArea(coordsWGS84[i]);
                     areaSqm -= innerRingArea;
                 }

                  areaMu = (areaSqm / 666.6667).toFixed(4); // 使用更精确的转换系数
                  console.log(`多边形${actualPolygonIndex}面积计算结果(备用): ${areaSqm}平方米 = ${areaMu}亩`);
              }
          } catch (error) {
              console.error(`面积计算失败:`, error);
              areaSqm = 0;
              areaMu = '0.0000';
          }

          // 计算多边形的中心点和底部中心点（WGS84）
          const centerPoint = calculatePolygonCenter(outerRingWGS);
          const bottomCenterPoint = calculatePolygonBottomCenter(outerRingWGS);

          // 添加多边形到地图
          if (map) {
              map.addOverLay(polygon);
              console.log(`多边形${actualPolygonIndex}已添加到地图`);
          } else {
              console.error('地图对象不存在');
          }

          // 存储多边形信息，用于后续标签创建
          polygonInfoList.push({
              index: actualPolygonIndex,
              polygon: polygon,
              area: areaMu,
              bottomCenter: { lng: bottomCenterPoint.lng, lat: bottomCenterPoint.lat },
              ringPoints: rings
          });
      }

    // 视图居中：根据已绘制的GCJ-02点
    function fitViewportToPolygons() {
        const points = [];
        try {
            if (!map || !map.setViewport) return;
            polygonInfoList.forEach(info => {
                if (!info || !info.ringPoints) return;
                info.ringPoints.forEach(ring => {
                    ring.forEach(ll => points.push(ll));
                });
            });
            if (!points.length) return;
            map.setViewport(points);
        } catch (e) {
            try {
                const lngs = points.map(p => p.lng);
                const lats = points.map(p => p.lat);
                const center = new T.LngLat(
                    (Math.min(...lngs) + Math.max(...lngs)) / 2,
                    (Math.min(...lats) + Math.max(...lats)) / 2
                );
                if (map && map.panTo) map.panTo(center);
            } catch (e2) {
                console.warn('视图居中失败:', e2);
            }
        }
    }

    // 统一创建所有多边形的标签
    function createAllLabels() {
        const mapContainer = document.getElementById('mapContainer');
        if (!mapContainer || !map) return;

        polygonInfoList.forEach(info => {
            if (!info) return;
            // 防止重复创建
            if (info.labelRef) return;
            // 创建标签元素
            const labelDiv = document.createElement('div');
            labelDiv.className = 'area-label';
            labelDiv.innerHTML = `多边形${info.index}：${info.area}亩`;

            // 添加到地图容器并根据屏幕边界定位到轮廓下方
            mapContainer.appendChild(labelDiv);
            positionLabelForPolygon(labelDiv, info);

            // 记录引用，避免重复创建
            info.labelRef = labelDiv;

            // 存储到 currentPolygons 以复用现有定位/清理逻辑
            const labelObj = {
                domElement: labelDiv,
                isDomLabel: true,
                polygonInfo: info
            };
            currentPolygons.push({ polygon: info.polygon, label: labelObj });
        });

        // 不清空 polygonInfoList，便于开关随时创建/隐藏标签
    }

    // 根据多边形屏幕边界定位标签，保证始终在轮廓下方
    function positionLabelForPolygon(labelDiv, info) {
        if (!map || !info || !info.ringPoints) return;
        const points = [];
        info.ringPoints.forEach(ring => {
            ring.forEach(ll => {
                const p = map.lngLatToContainerPoint(ll);
                points.push(p);
            });
        });
        if (!points.length) return;
        const minX = Math.min(...points.map(p => p.x));
        const maxX = Math.max(...points.map(p => p.x));
        const maxY = Math.max(...points.map(p => p.y));
        const container = document.getElementById('mapContainer');
        const labelWidth = labelDiv.offsetWidth;
        const labelHeight = labelDiv.offsetHeight;
        const targetLeft = Math.round((minX + maxX) / 2 - labelWidth / 2);
        const targetTop = Math.round(maxY + 6);
        const clampedLeft = Math.max(0, Math.min(targetLeft, container.clientWidth - labelWidth));
        const clampedTop = Math.max(0, Math.min(targetTop, container.clientHeight - labelHeight));
        labelDiv.style.left = clampedLeft + 'px';
        labelDiv.style.top = clampedTop + 'px';
    }

    // 更新所有标签位置（地图move/zoom时调用）
    function updateAllLabelsPosition() {
        try {
            if (!map) return;
            const container = document.getElementById('mapContainer');
            if (!container) return;
            currentPolygons.forEach(item => {
                if (!item || !item.label) return;
                const labelObj = item.label;
                if (labelObj.isDomLabel && labelObj.domElement && labelObj.polygonInfo) {
                    // 确保标签在容器中
                    if (!labelObj.domElement.parentNode) {
                        container.appendChild(labelObj.domElement);
                    }
                    positionLabelForPolygon(labelObj.domElement, labelObj.polygonInfo);
                }
            });
        } catch (e) {
            console.warn('更新标签位置时出错:', e);
        }
    }
    // 确保在全局可用（处理第三方库事件回调作用域差异）
    window.updateAllLabelsPosition = updateAllLabelsPosition;

    // 绑定“显示亩数标签”开关（默认隐藏）
    function bindLabelsToggle() {
        const cb = document.getElementById('toggleLabelsCheckbox');
        const container = document.getElementById('mapContainer');
        if (!cb || !container) return;
        // 默认隐藏标签
        container.classList.add('labels-hidden');
        cb.addEventListener('change', () => {
            labelsEnabled = cb.checked;
            if (labelsEnabled) {
                container.classList.remove('labels-hidden');
                const hasAnyLabel = currentPolygons.some(item => item && item.label && item.label.domElement);
                if (!hasAnyLabel) {
                    try { createAllLabels(); } catch (e) { console.warn('创建标签失败:', e); }
                }
                updateAllLabelsPosition();
            } else {
                container.classList.add('labels-hidden');
            }
        });
    }

    /**
     * 计算多边形中心点（比底部中心更适合显示标签）
     */
    function calculatePolygonCenter(outerRing) {
        let sumLng = 0, sumLat = 0;
        const len = outerRing.length;

        for (let i = 0; i < len; i++) {
            sumLng += outerRing[i][0];
            sumLat += outerRing[i][1];
        }

        return {
            lng: sumLng / len,
            lat: sumLat / len
        };
    }

    /**
     * 计算多边形面积（球面多边形面积计算）
     * 使用更准确的球面坐标面积计算方法，确保面积与视觉大小一致
     */
    function calculatePolygonArea(coordinates) {
        // 地球半径（米）- 使用更精确的值
        const R = 6371000.8;
        const n = coordinates.length;

        // 将所有坐标转换为弧度
        const coordsRad = coordinates.map(point => [
            point[0] * Math.PI / 180,
            point[1] * Math.PI / 180
        ]);

        let areaRad = 0;

        // 使用更准确的球面多边形面积公式（Girard定理）
        for (let i = 0; i < n; i++) {
            const j = (i + 1) % n;
            const lon1 = coordsRad[i][0];
            const lat1 = coordsRad[i][1];
            const lon2 = coordsRad[j][0];
            const lat2 = coordsRad[j][1];

            // 计算球面多边形面积增量
            const dlon = lon2 - lon1;
            const sinLat1 = Math.sin(lat1);
            const sinLat2 = Math.sin(lat2);
            const cosLat1 = Math.cos(lat1);
            const cosLat2 = Math.cos(lat2);

            // 使用更精确的公式
            areaRad += dlon * (sinLat1 * cosLat2 * Math.cos(dlon / 2) + sinLat2 * cosLat1);
        }

        // 计算总面积（平方米）
        const areaSqm = Math.abs(areaRad) * R * R * 0.5;

        return areaSqm;
    }

    /**
     * 清空所有多边形和标签（同时处理 polygonInfoList 与 currentPolygons）
     */
    function clearOverlays() {
        try {
            // 先移除 polygonInfoList 中记录的多边形与其DOM标签
            polygonInfoList.forEach(info => {
                if (info && info.polygon && map && map.removeOverLay) {
                    try { map.removeOverLay(info.polygon); } catch (e) { console.warn('移除多边形失败:', e); }
                }
                if (info && info.labelRef && info.labelRef.parentNode) {
                    try { info.labelRef.parentNode.removeChild(info.labelRef); } catch (e) { console.warn('移除DOM标签失败:', e); }
                    info.labelRef = null;
                }
            });

            // 再处理 currentPolygons（兼容旧路径与标签对象）
            currentPolygons.forEach(item => {
                if (item.polygon && map && map.removeOverLay) {
                    try { map.removeOverLay(item.polygon); } catch (e) { console.warn('移除多边形失败:', e); }
                }
                if (item.label) {
                    if (item.label.domElement && item.label.domElement.parentNode) {
                        try { item.label.domElement.parentNode.removeChild(item.label.domElement); } catch (e) { console.warn('移除DOM标签失败:', e); }
                    } else if (map && map.removeOverLay && !item.label.isDomLabel) {
                        try { map.removeOverLay(item.label); } catch (e) { console.warn('移除地图覆盖物标签失败:', e); }
                    }
                }
            });

            // 清空记录数组
            currentPolygons = [];
            polygonInfoList = [];

            console.log('已清空所有多边形和标签（保留事件监听器）');
        } catch (error) {
            console.error('清空覆盖物时出错:', error);
        }
    }

    // 其他辅助函数（保持不变）
    function bindMinimizeEvent() {
        const container = document.querySelector(".wkt-input-container");
        const btn = document.getElementById("minimizeBtn");
        const minIcon = btn?.querySelector(".min-icon");
        const restoreIcon = btn?.querySelector(".restore-icon");

        btn?.addEventListener("click", () => {
            const minimized = container.classList.toggle("minimized");
            if (minIcon && restoreIcon) {
                if (minimized) {
                    minIcon.style.display = "none";
                    restoreIcon.style.display = "";
                } else {
                    minIcon.style.display = "";
                    restoreIcon.style.display = "none";
                }
            }
        });
    }

    // 在脚本内部补充：页签切换（3个页签）
     function bindTabs() {
         const tabs = [
             { btn: document.getElementById('tabDrawBtn'), pane: document.getElementById('tabDraw'), key: 'draw' },
             { btn: document.getElementById('tabTrackBtn'), pane: document.getElementById('tabTrack'), key: 'track' },
             { btn: document.getElementById('tabSplitBtn'), pane: document.getElementById('tabSplit'), key: 'split' },
             { btn: document.getElementById('tabBatchBtn'), pane: document.getElementById('tabBatch'), key: 'batch' },
         ];
         if (tabs.some(t => !t.btn || !t.pane)) return;
         function activate(key) {
             tabs.forEach(t => {
                 const active = t.key === key;
                 t.btn.classList.toggle('active', active);
                 t.pane.classList.toggle('active', active);
             });
         }
         tabs.forEach(t => t.btn.addEventListener('click', () => activate(t.key)));
         activate('draw');
     }
    function updateParserStatus() {
        const el = document.getElementById('parserStatus');
        if (!el) return;
        const ok = (typeof Terraformer !== 'undefined' && Terraformer.WKT && typeof Terraformer.WKT.parse === 'function');
        if (ok) {
            el.textContent = 'Terraformer WKT Parser';
            el.style.color = '#2f8f2f';
        } else {
            el.textContent = '本地回退解析（仅支持POLYGON/MULTIPOLYGON）';
            el.style.color = '#c77d1e';
        }
    }
     function parseWkt(wkt) {
         wkt = wkt.trim();
         // 优先使用成熟库（Terraformer WKT Parser）
         if (typeof Terraformer !== 'undefined' && Terraformer.WKT && Terraformer.WKT.parse) {
             try {
                 return Terraformer.WKT.parse(wkt);
             } catch (e) {
                 console.warn('Terraformer解析失败，尝试本地回退解析:', e);
             }
         } else {
             // 不再提示“未加载”，由状态栏展示回退信息
         }
         // 回退解析：仅支持 POLYGON / MULTIPOLYGON
         const typeMatch = wkt.match(/^\s*(POLYGON|MULTIPOLYGON)\s*\(/i);
         if (!typeMatch) throw new Error('仅支持POLYGON/MULTIPOLYGON');
         const type = typeMatch[1].toUpperCase();
         const inner = wkt.substring(wkt.indexOf('('));
         if (type === 'POLYGON') {
             const coords = parsePolygonCoords(inner.replace(/^\(/, '').replace(/\)$/, ''));
             return { type: 'Polygon', coordinates: coords };
         } else {
             const trimmed = inner.replace(/^\(\(/, '').replace(/\)\)$/, '');
             const coords = parseMultiPolygonCoords(trimmed);
             return { type: 'MultiPolygon', coordinates: coords };
         }
     }

     function bindMultiSplitter() {
         const input = document.getElementById('multiInput');
         const output = document.getElementById('polyOutput');
         const splitBtn = document.getElementById('splitMultiBtn');
         const copyBtn = document.getElementById('copyPolysBtn');
         if (!input || !output || !splitBtn || !copyBtn) return;

         // 本地WKT序列化辅助
         function ringToText(ring) {
             if (!ring || !ring.length) return '()';
             const first = ring[0];
             const last = ring[ring.length - 1];
             const closed = (first[0] === last[0] && first[1] === last[1]) ? ring : ring.concat([[first[0], first[1]]]);
             return '(' + closed.map(pt => pt[0] + ' ' + pt[1]).join(', ') + ')';
         }
         function toWktPolygonCoords(coords) {
             return 'POLYGON(' + coords.map(ringToText).join(', ') + ')';
         }
         function toWktMulti(coords) {
             return 'MULTIPOLYGON(' + coords.map(poly => '(' + poly.map(ringToText).join(', ') + ')').join(', ') + ')';
         }

         function polygonsFromMulti(text) {
             const geo = parseWkt(text.trim());
             if (geo.type !== 'MultiPolygon') throw new Error('请输入有效的 MULTIPOLYGON WKT');
             const polys = geo.coordinates.map(rings => toWktPolygonCoords(rings));
             return polys;
         }
         splitBtn.addEventListener('click', () => {
             try {
                 const list = polygonsFromMulti(input.value.trim());
                 output.value = list.join('\n');
             } catch (e) {
                 alert('分割失败：' + e.message);
             }
         });
         copyBtn.addEventListener('click', async () => {
             const val = output.value.trim();
             if (!val) { alert('没有可复制的结果'); return; }
             try { await navigator.clipboard.writeText(val); alert('已复制到剪贴板'); } catch (e) { console.warn('复制失败', e); }
         });
     }

     function bindBatchGenerator() {
         const batchInput = document.getElementById('batchInput');
         const output = document.getElementById('multiOutput');
         const genBtn = document.getElementById('generateMultiBtn');
         const copyBtn = document.getElementById('copyMultiBtn');

         // 本地WKT序列化辅助（与分割器保持一致）
         function ringToText(ring) {
             if (!ring || !ring.length) return '()';
             const first = ring[0];
             const last = ring[ring.length - 1];
             const closed = (first[0] === last[0] && first[1] === last[1]) ? ring : ring.concat([[first[0], first[1]]]);
             return '(' + closed.map(pt => pt[0] + ' ' + pt[1]).join(', ') + ')';
         }
         function toWktMulti(coords) {
             return 'MULTIPOLYGON(' + coords.map(poly => '(' + poly.map(ringToText).join(', ') + ')').join(', ') + ')';
         }

         genBtn.addEventListener('click', () => {
             try {
                 const lines = batchInput.value.trim().split(/\n|;/).map(s => s.trim()).filter(Boolean);
                 if (lines.length === 0) throw new Error('请按每行或分号输入至少一个POLYGON');
                 const polygons = lines.map((line, idx) => {
                     const g = parseWkt(line);
                     if (g.type !== 'Polygon') throw new Error(`第${idx + 1}行不是有效的POLYGON WKT`);
                     return g;
                 });
                 const multiGeo = { type: 'MultiPolygon', coordinates: polygons.map(p => p.coordinates) };
                 output.value = toWktMulti(multiGeo.coordinates);
             } catch (e) {
                 alert('生成失败：' + e.message);
             }
         });

         copyBtn.addEventListener('click', async () => {
             const val = output.value.trim();
             if (!val) { alert('没有可复制的结果'); return; }
             try { await navigator.clipboard.writeText(val); alert('已复制到剪贴板'); } catch (e) { console.warn('复制失败', e); }
         });

     }

     function setExampleWkt() {
         const exampleWkt = "MULTIPOLYGON(" +
             "(" +
             "(116.35 39.93, 116.39 39.93, 116.39 39.90, 116.35 39.90, 116.35 39.93)," + // 外环
             "(116.36 39.92, 116.38 39.92, 116.38 39.91, 116.36 39.91, 116.36 39.92)" +  // 内环
             ")," +
             "(" +
             "(116.40 39.95, 116.43 39.97, 116.46 39.96, 116.49 39.98, 116.52 39.95, 116.55 39.93, 116.58 39.94, 116.61 39.92, 116.64 39.95, 116.40 39.95)" +
             ")" +
             ")";
         document.getElementById("wktTextarea").value = exampleWkt;
     }

     function parsePolygonCoords(coordStr) {
         const ringStrs = coordStr.split(/\)\s*,\s*\(/).map(s => s.replace(/[()]/g, '').trim());
         const rings = [];
         ringStrs.forEach(ringStr => {
             const pts = ringStr.split(/,\s*/).map(pointStr => {
                 const [lng, lat] = pointStr.split(/\s+/).map(Number);
                 if (isNaN(lng) || isNaN(lat)) throw new Error("坐标格式错误：" + pointStr);
                 return [lng, lat];
             });
             // 自动拆分：如果一个ring中包含多次回到起点（闭合），则拆分为多个环
             // 兼容用户将外环与内环错误地写在同一对括号中的情况
             let start = 0;
             while (start < pts.length) {
                 const startPt = pts[start];
                 let closeIdx = -1;
                 for (let i = start + 1; i < pts.length; i++) {
                     if (pts[i][0] === startPt[0] && pts[i][1] === startPt[1]) {
                         closeIdx = i;
                         break;
                     }
                 }
                 if (closeIdx === -1) {
                     // 未找到闭合：将剩余点视为一个环，并强制闭合
                     const ring = pts.slice(start);
                     if (ring.length && (ring[0][0] !== ring[ring.length - 1][0] || ring[0][1] !== ring[ring.length - 1][1])) {
                         ring.push([ring[0][0], ring[0][1]]);
                     }
                     rings.push(ring);
                     break;
                 } else {
                     const ring = pts.slice(start, closeIdx + 1);
                     rings.push(ring);
                     start = closeIdx + 1;
                 }
             }
         });
         return rings;
     }

     function parseMultiPolygonCoords(coordStr) {
         const polygonStrs = coordStr.split(/\)\s*\)\s*,\s*\(\s*\(/).map(s => s.replace(/[()]/g, '').trim());
         return polygonStrs.map(polygonStr => parsePolygonCoords(polygonStr));
     }

     function wgs84ToGcj02(lng, lat) {
         const x_PI = 3.14159265358979324 * 3000.0 / 180.0;
         const PI = 3.1415926535897932384626;
         const a = 6378245.0;
         const ee = 0.00669342162296594323;

         if (outOfChina(lng, lat)) return { lng, lat };

         let dlat = transformLat(lng - 105.0, lat - 35.0);
         let dlng = transformLng(lng - 105.0, lat - 35.0);
         const radlat = lat / 180.0 * PI;
         let magic = Math.sin(radlat);
         magic = 1 - ee * magic * magic;
         const sqrtmagic = Math.sqrt(magic);
         dlat = (dlat * 180.0) / ((a * (1 - ee)) / (magic * sqrtmagic) * PI);
         dlng = (dlng * 180.0) / (a / sqrtmagic * Math.cos(radlat) * PI);

         return { lng: lng + dlng, lat: lat + dlat };

         function outOfChina(lng, lat) {
             return (lng < 72.004 || lng > 137.8347) || (lat < 0.8293 || lat > 55.8271);
         }

         function transformLat(x, y) {
             let ret = -100.0 + 2.0 * x + 3.0 * y + 0.2 * y * y + 0.1 * x * y + 0.2 * Math.sqrt(Math.abs(x));
             ret += (20.0 * Math.sin(6.0 * x * PI) + 20.0 * Math.sin(2.0 * x * PI)) * 2.0 / 3.0;
             ret += (20.0 * Math.sin(y * PI) + 40.0 * Math.sin(y / 3.0 * PI)) * 2.0 / 3.0;
             ret += (160.0 * Math.sin(y / 12.0 * PI) + 320 * Math.sin(y * PI / 30.0)) * 2.0 / 3.0;
             return ret;
         }

         function transformLng(x, y) {
             let ret = 300.0 + x + 2.0 * y + 0.1 * x * x + 0.1 * x * y + 0.1 * Math.sqrt(Math.abs(x));
             ret += (20.0 * Math.sin(6.0 * x * PI) + 20.0 * Math.sin(2.0 * x * PI)) * 2.0 / 3.0;
             ret += (20.0 * Math.sin(x * PI) + 40.0 * Math.sin(x / 3.0 * PI)) * 2.0 / 3.0;
             ret += (150.0 * Math.sin(x / 12.0 * PI) + 300.0 * Math.sin(x / 30.0 * PI)) * 2.0 / 3.0;
             return ret;
         }
     }

     function gcj02ToWgs84(lng, lat) {
         const g = wgs84ToGcj02(lng, lat);
         return { lng: lng * 2 - g.lng, lat: lat * 2 - g.lat };
     }

     function bd09ToGcj02(bdLng, bdLat) {
         const x_PI = 3.14159265358979324 * 3000.0 / 180.0;
         const x = bdLng - 0.0065;
         const y = bdLat - 0.006;
         const z = Math.sqrt(x * x + y * y) - 0.00002 * Math.sin(y * x_PI);
         const theta = Math.atan2(y, x) - 0.000003 * Math.cos(x * x_PI);
         const ggLng = z * Math.cos(theta);
         const ggLat = z * Math.sin(theta);
         return { lng: ggLng, lat: ggLat };
     }

     function calculatePolygonBottomCenter(outerRing) {
         let minLat = Infinity;
         let bottomPoints = [];
         outerRing.forEach(point => {
             const lat = point[1];
             if (lat < minLat) {
                 minLat = lat;
                 bottomPoints = [point];
             } else if (lat === minLat) {
                 bottomPoints.push(point);
             }
         });

         const sumLng = bottomPoints.reduce((sum, point) => sum + point[0], 0);
         const centerLng = sumLng / bottomPoints.length;

         return { lng: centerLng, lat: minLat };
     }

     function fitBounds(geojson) {
         try {
             const allPoints = [];
             function collectPoints(coords) {
                 if (typeof coords[0] === 'number') {
                     allPoints.push(coords);
                 } else {
                     coords.forEach(coord => collectPoints(coord));
                 }
             }
             collectPoints(geojson.coordinates);

             if (allPoints.length === 0) return;

             const lats = allPoints.map(p => p[1]);
             const lngs = allPoints.map(p => p[0]);
             const minLng = Math.min(...lngs);
             const maxLng = Math.max(...lngs);
             const minLat = Math.min(...lats);
             const maxLat = Math.max(...lats);

             const sw = wgs84ToGcj02(minLng, minLat);
             const ne = wgs84ToGcj02(maxLng, maxLat);

             // 修复setViewport方法的使用，确保参数格式正确
             if (map && map.setViewport) {
                 map.setViewport([
                     new T.LngLat(sw.lng, sw.lat),
                     new T.LngLat(ne.lng, ne.lat)
                 ], { padding: [50, 50] });
             } else {
                 console.warn('地图对象或setViewport方法不可用');
             }
         } catch (error) {
             console.error('调整视图范围时出错:', error);
         }
     }
// 轨迹绘制与解析
    function bindTrackEvents() {
        const drawBtn = document.getElementById('drawTrackButton');
        const showPointsBtn = document.getElementById('showTrackPointsButton');
        const clearBtn = document.getElementById('clearTrackButton');
        const ta = document.getElementById('trackTextarea');
        if (!drawBtn || !showPointsBtn || !clearBtn || !ta) return;

        drawBtn.addEventListener('click', function(){
            try {
                const text = ta.value.trim();
                if (!text) { alert('请粘贴轨迹文本（时间戳,经度,纬度）'); return; }
                const points = parseTrackText(text);
                if (points.length < 2) { alert('有效轨迹点不足，至少需要两点'); return; }
                drawTrackFromPoints(points);
                fitViewportToTrack(points);
            } catch (e) {
                alert('绘制轨迹失败：' + (e && e.message ? e.message : e));
                console.error('绘制轨迹异常:', e);
            }
        });

        showPointsBtn.addEventListener('click', function(){
            try {
                const text = ta.value.trim();
                if (!text) { alert('请粘贴轨迹文本（时间戳,经度,纬度）'); return; }
                const points = parseTrackText(text);
                if (points.length === 0) { alert('未找到有效轨迹点'); return; }
                showTrackPoints(points);
                fitViewportToTrack(points);
            } catch (e) {
                alert('显示轨迹点失败：' + (e && e.message ? e.message : e));
                console.error('显示轨迹点异常:', e);
            }
        });

        clearBtn.addEventListener('click', function(){
            clearTrackOverlays();
            console.log('已清空轨迹');
        });
    }

    function showTrackPoints(points) {
        // 先移除旧轨迹（不影响轮廓）
        clearTrackOverlays(false);
        
        if (!map || !points || points.length === 0) {
            console.log('无轨迹点可显示');
            return;
        }
        
        console.log(`准备显示${points.length}个轨迹点`);
        
        // 使用批量处理和更小的图标来提高性能
        // 创建一个更小的自定义颜色点SVG图标
        const smallColoredDotIcon = new T.Icon({
            iconUrl: `data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="1" height="1"><circle cx="0.5" cy="0.5" r="0.3" fill="%23${currentTrackPointColor.substring(1)}"/></svg>`,
            iconSize: new T.Point(1, 1),
            iconAnchor: new T.Point(0.5, 0.5)
        });
        
        // 优化批量添加点的速度
        const batchSize = 2000; // 增加每批处理的点数
        const concurrentBatches = 4; // 并发批次数量
        
        // 预创建点击事件处理函数，避免重复创建
        function createClickHandler(point, index) {
            return function() {
                const infoWindow = new T.InfoWindow({
                    content: `点${index + 1}<br/>经度: ${point.lng.toFixed(6)}<br/>纬度: ${point.lat.toFixed(6)}`,
                    offset: new T.Point(0, -20)
                });
                infoWindow.open(map, point);
            };
        }
        
        // 使用setTimeout实现更高效的批量添加，避免阻塞UI
        let currentIndex = 0;
        
        function addBatch() {
            if (currentIndex >= points.length) {
                console.log(`已显示${points.length}个轨迹点`);
                return;
            }
            
            // 添加当前批次的点
            const endIndex = Math.min(currentIndex + batchSize, points.length);
            const markersToAdd = [];
            
            // 先创建所有标记
            for (let i = currentIndex; i < endIndex; i++) {
                const point = points[i];
                const index = i;
                
                const marker = new T.Marker(point, {
                    icon: smallColoredDotIcon
                });
                
                // 添加点击事件
                marker.addEventListener('click', createClickHandler(point, index));
                
                markersToAdd.push(marker);
            }
            
            // 批量添加到地图和数组
            markersToAdd.forEach(marker => {
                map.addOverLay(marker);
                currentTracks.push(marker);
            });
            
            currentIndex = endIndex;
            
            // 使用setTimeout而不是requestAnimationFrame，减少对渲染周期的依赖
            // 设置为0，将任务放入微任务队列，但允许UI有短暂的呼吸空间
            setTimeout(addBatch, 0);
        }
        
        // 启动批量添加
        addBatch();
    }
    
    // 恢复原始的clearTrackOverlays函数
    function clearTrackOverlays(resetArray = true){        
        try {
            currentTracks.forEach(pl => {
                if (pl && map && map.removeOverLay) {
                    try { map.removeOverLay(pl); } catch (e) { console.warn('移除轨迹失败:', e); }
                }
            });
            if (resetArray) currentTracks = [];
        } catch (e) {
            console.warn('清空轨迹时出错:', e);
        }
    }

    function parseTrackText(text){
        // 选择输入坐标系（优先使用轨迹页签专属选择器，若未设置则回退到绘制页签选择器）
        const coordSysEl = document.getElementById('trackCoordSysSelect') || document.getElementById('coordSysSelect');
        const coordSys = (coordSysEl && coordSysEl.value) || 'wgs84';
        const isHash = text.indexOf('#') !== -1;
        const items = isHash ? text.split('#') : text.split(/\r?\n/);
        const pts = [];
        for (let i=0;i<items.length;i++){
            const raw = items[i];
            if (!raw) continue;
            const line = raw.trim();
            if (!line) continue;
            const parts = line.split(',');
            if (parts.length < 3) continue;
            let lng = parseFloat((parts[isHash ? 0 : 1] || '').trim());
            let lat = parseFloat((parts[isHash ? 1 : 2] || '').trim());
            // 初步过滤：数值合法性与正常范围
            if (!isFinite(lng) || !isFinite(lat)) continue;
            if (lng === 0 || lat === 0) continue; // 丢弃0.0异常点
            if (lng < -180 || lng > 180 || lat < -90 || lat > 90) continue; // 超出经纬度范围丢弃

            // 将输入坐标转换为WGS84
            let w;
            if (coordSys === 'wgs84' || coordSys === 'cgcs2000') {
                w = { lng, lat };
            } else if (coordSys === 'gcj02') {
                w = gcj02ToWgs84(lng, lat);
            } else if (coordSys === 'bd09') {
                const g = bd09ToGcj02(lng, lat);
                w = gcj02ToWgs84(g.lng, g.lat);
            } else {
                w = { lng, lat };
            }
            // 转换结果兜底检查
            if (!isFinite(w.lng) || !isFinite(w.lat)) continue;
            if (w.lng < -180 || w.lng > 180 || w.lat < -90 || w.lat > 90) continue;

            // 使用WGS84坐标绘制到地图
            pts.push(new T.LngLat(w.lng, w.lat));
        }
        return pts;
    }

    function drawTrackFromPoints(points){
        // 先移除旧轨迹（不影响轮廓）
        clearTrackOverlays(false);
        const polyline = new T.Polyline(points, {
            color: currentTrackLineColor,
            weight: 1,
            opacity: 0.9
        });
        if (map) {
            map.addOverLay(polyline);
        }
        currentTracks.push(polyline);
    }

    function clearTrackOverlays(resetArray = true){
        try {
            currentTracks.forEach(pl => {
                if (pl && map && map.removeOverLay) {
                    try { map.removeOverLay(pl); } catch (e) { console.warn('移除轨迹失败:', e); }
                }
            });
            if (resetArray) currentTracks = [];
        } catch (e) {
            console.warn('清空轨迹时出错:', e);
        }
    }


    function fitViewportToTrack(points){
        try {
            if (!map || !map.setViewport || !points || !points.length) return;
            map.setViewport(points);
        } catch (e) {
            console.warn('轨迹视图居中失败:', e);
        }
    }

    // ========= 轨迹回放功能 =========
    let playbackState = { points: [], idx: 0, speed: 1, timer: null, running: false, marker: null, line: null, path: [] };

    function bindPlaybackControls(){
        const startBtn = document.getElementById('playbackStartBtn');
        const pauseBtn = document.getElementById('playbackPauseBtn');
        const stopBtn = document.getElementById('playbackStopBtn');
        const speedSel = document.getElementById('playbackSpeedSelect');
        const timeSlider = document.getElementById('playbackTimeSlider');
        const timeCursor = document.getElementById('playbackTimeCursor');
        const ta = document.getElementById('trackTextarea');
        if (!startBtn || !pauseBtn || !stopBtn || !speedSel) return;

        // 初始按钮状态
        updatePlaybackButtonsState('idle');

        startBtn.addEventListener('click', function(){
            try {
                const text = (ta && ta.value || '').trim();
                if (!text) { alert('请粘贴轨迹文本（时间戳,经度,纬度）'); return; }
                const pts = parseTrackTextWithTime(text);
                if (pts.length < 2) { alert('有效轨迹点不足，至少需要两点'); return; }
                startPlayback(pts);
                // 状态在startPlayback中已设置为playing
            } catch (e) {
                alert('开始回放失败：' + (e && e.message ? e.message : e));
                console.error('开始回放异常:', e);
            }
        });

        pauseBtn.addEventListener('click', function(){
            if (!playbackState.running) {
                // 继续
                playbackState.running = true;
                scheduleNext();
                updatePlaybackButtonsState('playing');
            } else {
                // 暂停
                if (playbackState.timer) { clearTimeout(playbackState.timer); playbackState.timer = null; }
                playbackState.running = false;
                updatePlaybackButtonsState('paused');
            }
        });

        stopBtn.addEventListener('click', function(){ 
            stopPlayback(); 
            updatePlaybackButtonsState('idle');
        });

        speedSel.addEventListener('change', function(){
            const v = parseFloat(speedSel.value);
            playbackState.speed = (isFinite(v) && v > 0) ? v : 1;
        });

        if (timeSlider) {
            timeSlider.addEventListener('input', function(){
                const ms = parseInt(timeSlider.value, 10);
                const txt = formatTimeForLabel(ms);
                if (timeCursor) timeCursor.textContent = txt;
            });
            timeSlider.addEventListener('change', function(){
                jumpToSliderTime();
            });
        }
    }

    function parseTrackTextWithTime(text){
        const coordSysEl = document.getElementById('trackCoordSysSelect') || document.getElementById('coordSysSelect');
        const coordSys = (coordSysEl && coordSysEl.value) || 'wgs84';
        const isHash = text.indexOf('#') !== -1;
        const items = isHash ? text.split('#') : text.split(/\r?\n/);
        const out = [];
        for (let i=0;i<items.length;i++){
            const raw = items[i];
            if (!raw) continue;
            const line = raw.trim();
            if (!line) continue;
            const parts = line.split(',');
            if (parts.length < 3) continue;
            const tsRaw = (parts[isHash ? 2 : 0] || '').trim();
            const ts = (tsRaw || '').replace(/\D/g,'');
            let lng = parseFloat((parts[isHash ? 0 : 1] || '').trim());
            let lat = parseFloat((parts[isHash ? 1 : 2] || '').trim());
            if (!isFinite(lng) || !isFinite(lat)) continue;
            if (lng === 0 || lat === 0) continue;
            if (lng < -180 || lng > 180 || lat < -90 || lat > 90) continue;
            const t = parseTimestamp(ts);
            if (!t) continue;
            let w;
            if (coordSys === 'wgs84' || coordSys === 'cgcs2000') {
                w = { lng, lat };
            } else if (coordSys === 'gcj02') {
                w = gcj02ToWgs84(lng, lat);
            } else if (coordSys === 'bd09') {
                const g = bd09ToGcj02(lng, lat);
                w = gcj02ToWgs84(g.lng, g.lat);
            } else { w = { lng, lat }; }
            if (!isFinite(w.lng) || !isFinite(w.lat)) continue;
            if (w.lng < -180 || w.lng > 180 || w.lat < -90 || w.lat > 90) continue;
            out.push({ ll: new T.LngLat(w.lng, w.lat), time: t, ts });
        }
        out.sort((a,b)=>a.time - b.time);
        return out;
    }

    function parseTimestamp(ts){
        const tstr = (ts || '').replace(/\D/g,'');
        const m = tstr && tstr.match(/^\d{14}$/);
        if (!m) return null;
        const y = parseInt(tstr.slice(0,4),10);
        const M = parseInt(tstr.slice(4,6),10) - 1;
        const d = parseInt(tstr.slice(6,8),10);
        const h = parseInt(tstr.slice(8,10),10);
        const m2 = parseInt(tstr.slice(10,12),10);
        const s = parseInt(tstr.slice(12,14),10);
        const dt = new Date(y,M,d,h,m2,s);
        return isNaN(dt.getTime()) ? null : dt;
    }

    function startPlayback(points){
        console.log('[Playback] startPlayback: 点数=', points && points.length);
        stopPlayback();
        playbackState.points = points;
        playbackState.idx = 0;
        playbackState.speed = playbackState.speed || 1;
        playbackState.running = true;
        // 配置时间滑动条，并尊重现有滑块位置作为起始
        configureTimeSlider(points);
        // 启用滑块
        const slider = document.getElementById('playbackTimeSlider');
        if (slider) slider.disabled = false;
        let initIdx = 0;
        if (slider && slider.min && slider.max) {
            const ms = parseInt(slider.value, 10);
            if (isFinite(ms)) initIdx = findIndexByTime(points, ms);
        }
        playbackState.idx = initIdx;
        const first = points[initIdx];
        console.log('[Playback] 首点:', first && first.ts, first && first.ll, 'initIdx=', initIdx);
        playbackState.path = points.slice(0, initIdx+1).map(p=>p.ll);
        playbackState.line = new T.Polyline(playbackState.path, { color: currentTrackLineColor, weight: 1, opacity: 0.9 });
        if (map) {
            map.addOverLay(playbackState.line);
        }
        currentTracks.push(playbackState.line);
        // 创建并定位DOM标记以保证可见移动
        ensurePlaybackDom(first.ll);
        updatePlaybackDom(first.ll);
        updatePlaybackTimeLabel(first.ts);
        try { fitViewportToTrack(points.map(p=>p.ll)); } catch(e){}
        // 更新按钮状态
        updatePlaybackButtonsState('playing');
        scheduleNext();
    }

    function scheduleNext(){
        if (!playbackState.running) return;
        if (!playbackState.points || playbackState.idx >= playbackState.points.length - 1) {
            playbackState.running = false;
            console.log('[Playback] 回放结束：idx=', playbackState.idx, '点数=', playbackState.points ? playbackState.points.length : 0);
            updatePlaybackButtonsState('idle'); // 播放结束后按钮回到初始状态：开始可点，继续/结束灰化
            return;
        }
        const next = playbackState.points[playbackState.idx+1];
        const speed = playbackState.speed || 1;
        const delay = Math.max(4, Math.round(1000 / speed)); // 1x=1000ms/点，2x=500ms/点...
        console.log('[Playback] scheduleNext: idx=', playbackState.idx, '->', playbackState.idx+1, 'delay=', delay, 'speed=', speed);
        playbackState.timer = setTimeout(()=>{
            playbackState.idx++;
            const nextLL = next.ll;
            console.log('[Playback] 下一点:', next && next.ts, nextLL);
            try {
                // 维护路径数组
                playbackState.path = playbackState.path || [];
                playbackState.path.push(nextLL);
                console.log('[Playback] 路径长度=', playbackState.path.length);
                // 使用DOM标记进行移动（容器/图层坐标）
                if (!playbackDom.el) console.log('[Playback] DOM标记不存在，将尝试创建');
                updatePlaybackDom(nextLL);
                // 折线更新：优先setLngLats，兜底重建
                if (playbackState.line && typeof playbackState.line.setLngLats === 'function') {
                    try { playbackState.line.setLngLats(playbackState.path); }
                    catch(e){
                        console.warn('[Playback] setLngLats失败，重建折线', e);
                        if (map) { try { map.removeOverLay(playbackState.line); } catch(e){} }
                        playbackState.line = new T.Polyline(playbackState.path, { color: currentTrackLineColor, weight: 1, opacity: 0.9 });
                        if (map) map.addOverLay(playbackState.line);
                    }
                } else {
                    console.log('[Playback] 折线不支持setLngLats，重建');
                    if (playbackState.line && map) { try { map.removeOverLay(playbackState.line); } catch(e){} }
                    playbackState.line = new T.Polyline(playbackState.path, { color: currentTrackLineColor, weight: 1, opacity: 0.9 });
                    if (map) map.addOverLay(playbackState.line);
                }
            } catch(e) { console.warn('更新回放覆盖物失败:', e); }
            updatePlaybackTimeLabel(next.ts);
            scheduleNext();
        }, delay);
    }

    function stopPlayback(){
        if (playbackState.timer) { clearTimeout(playbackState.timer); playbackState.timer = null; }
        playbackState.running = false;
        playbackState.idx = 0;
        try {
            // 移除DOM标记
            removePlaybackDom();
            if (playbackState.marker && map) map.removeOverLay(playbackState.marker);
            if (playbackState.line && map) map.removeOverLay(playbackState.line);
        } catch(e){}
        playbackState.marker = null;
        playbackState.line = null;
        updatePlaybackTimeLabel('—');
        // 按钮回到初始状态
        updatePlaybackButtonsState('idle');
    }

    function updatePlaybackTimeLabel(text){
        const el = document.getElementById('playbackTimeLabel');
        if (el) el.textContent = '时间：' + (text || '—');
    }

    // 时间滑动条：配置与跳转
    function configureTimeSlider(points){
        try {
            const slider = document.getElementById('playbackTimeSlider');
            const cursor = document.getElementById('playbackTimeCursor');
            if (!slider || !points || !points.length) return;
            const minMs = points[0].time.getTime();
            const maxMs = points[points.length - 1].time.getTime();
            const prev = parseInt(slider.value, 10);
            slider.min = String(minMs);
            slider.max = String(maxMs);
            slider.step = '1000'; // 以秒为步进
            let val = (isFinite(prev) && prev >= minMs && prev <= maxMs) ? prev : minMs;
            slider.value = String(val);
            if (cursor) cursor.textContent = formatTimeForLabel(val);
        } catch(e) { console.warn('配置时间滑动条失败:', e); }
    }
    function formatTimeForLabel(ms){
        if (!isFinite(ms)) return '—';
        const d = new Date(ms);
        const pad = n => String(n).padStart(2,'0');
        const y = d.getFullYear();
        const M = pad(d.getMonth()+1);
        const da = pad(d.getDate());
        const h = pad(d.getHours());
        const m = pad(d.getMinutes());
        const s = pad(d.getSeconds());
        return `${y}-${M}-${da} ${h}:${m}:${s}`;
    }
    function findIndexByTime(points, ms){
        try {
            if (!points || !points.length) return 0;
            const n = points.length;
            const minMs = points[0].time.getTime();
            const maxMs = points[n-1].time.getTime();
            if (!isFinite(ms)) return 0;
            if (ms <= minMs) return 0;
            if (ms >= maxMs) return n-1;
            let lo = 0, hi = n - 1, ans = 0;
            while (lo <= hi) {
                const mid = (lo + hi) >> 1;
                const t = points[mid].time.getTime();
                if (t < ms) { lo = mid + 1; ans = lo; }
                else { hi = mid - 1; ans = mid; }
            }
            return Math.max(0, Math.min(n-1, ans));
        } catch(e){ console.warn('findIndexByTime失败:', e); return 0; }
    }
    function jumpToSliderTime(){
        try {
            const slider = document.getElementById('playbackTimeSlider');
            if (!slider || !playbackState.points || !playbackState.points.length) return;
            const ms = parseInt(slider.value, 10);
            if (!isFinite(ms)) return;
            const idx = findIndexByTime(playbackState.points, ms);
            playbackState.idx = idx;
            const pts = playbackState.points;
            const ll = pts[idx].ll;
            playbackState.path = pts.slice(0, idx+1).map(p=>p.ll);
            // 更新折线
            try {
                if (playbackState.line && typeof playbackState.line.setLngLats === 'function') {
                    playbackState.line.setLngLats(playbackState.path);
                } else {
                    if (playbackState.line && map) { try { map.removeOverLay(playbackState.line); } catch(e){} }
                    playbackState.line = new T.Polyline(playbackState.path, { color: currentTrackLineColor, weight: 1, opacity: 0.9 });
                    if (map) map.addOverLay(playbackState.line);
                }
            } catch(e){ console.warn('滑块更新折线失败:', e); }
            // 更新标记与时间
            ensurePlaybackDom(ll);
            updatePlaybackDom(ll);
            updatePlaybackTimeLabel(pts[idx].ts);
            // 若正在播放，立即按新位置继续
            if (playbackState.running) {
                if (playbackState.timer) { clearTimeout(playbackState.timer); playbackState.timer = null; }
                scheduleNext();
            }
        } catch(e) { console.warn('滑块跳转失败:', e); }
    }

    // DOM标记：使用容器坐标实现可见移动
    let playbackDom = { el: null, lastLL: null, bound: false };

    function ensurePlaybackDom(ll){
        try {
            playbackDom.lastLL = ll;
            const pane = (map && map.getPanes && map.getPanes().overlayPane) || document.getElementById('mapContainer');
            if (!pane) { console.warn('未找到overlayPane或mapContainer'); return; }
            if (!playbackDom.el) {
                const el = document.createElement('div');
                el.id = 'playbackDomMarker';
                el.style.position = 'absolute';
                el.style.width = '0';
                el.style.height = '0';
                el.style.borderLeft = '3px solid transparent';
                el.style.borderRight = '3px solid transparent';
                el.style.borderBottom = '4px solid #2C64A7';
                el.style.borderTop = '0';
                el.style.transform = 'translate(-50%, -50%)';
                el.style.zIndex = '9999';
                // 添加伪元素来增强箭头效果
                el.style.clipPath = 'polygon(50% 0, 100% 100%, 0 100%)';
                pane.appendChild(el);
                playbackDom.el = el;
                console.log('[Playback] 创建DOM标记，父节点=', pane === document.getElementById('mapContainer') ? '#mapContainer' : 'overlayPane');
                bindPlaybackDomEvents();
            }
            updatePlaybackDom(ll);
        } catch(e) { console.warn('创建DOM标记失败:', e); }
    }

    function updatePlaybackDom(ll){
        try {
            playbackDom.lastLL = ll;
            if (!map || !playbackDom.el || !ll) { console.log('[Playback] update取消：map/el/ll缺失'); return; }
            let p;
            if (typeof map.lngLatToLayerPoint === 'function') {
                p = map.lngLatToLayerPoint(ll);
                console.log('[Playback] 使用layerPoint定位:', ll && ll.lng, ll && ll.lat, '=>', p && p.x, p && p.y);
            } else if (typeof map.lngLatToContainerPoint === 'function') {
                p = map.lngLatToContainerPoint(ll);
                console.log('[Playback] 使用containerPoint定位:', ll && ll.lng, ll && ll.lat, '=>', p && p.x, p && p.y);
            } else {
                console.warn('地图对象不支持lngLat到像素坐标转换');
                return;
            }
            playbackDom.el.style.left = p.x + 'px';
            playbackDom.el.style.top = p.y + 'px';
        } catch(e) { console.warn('更新DOM标记位置失败:', e); }
    }

    function bindPlaybackDomEvents(){
        if (playbackDom.bound) return;
        const updater = function(){
            try {
                if (!map || !playbackDom.el || !playbackDom.lastLL) return;
                let p;
                if (typeof map.lngLatToLayerPoint === 'function') {
                    p = map.lngLatToLayerPoint(playbackDom.lastLL);
                } else if (typeof map.lngLatToContainerPoint === 'function') {
                    p = map.lngLatToContainerPoint(playbackDom.lastLL);
                }
                if (!p) return;
                playbackDom.el.style.left = p.x + 'px';
                playbackDom.el.style.top = p.y + 'px';
            } catch(e){}
        };
        try {
            map.addEventListener('move', updater);
            map.addEventListener('zoom', updater);
            playbackDom.bound = true;
        } catch(e){}
    }

    function removePlaybackDom(){
        try {
            const el = playbackDom.el;
            playbackDom.lastLL = null;
            if (el && el.parentNode) el.parentNode.removeChild(el);
        } catch(e){}
        playbackDom.el = null;
        playbackDom.bound = false;
    }

    // 测量功能相关变量
    let measureState = {
        isActive: false,
        mode: '', // 'distance' or 'area'
        points: [],
        tempLine: null,
        lines: [],
        markers: [],
        labels: [],
        polygon: null,
        areaLabel: null
    };

    // 绑定测量按钮事件
    function bindMeasureEvents() {
        const distanceBtn = document.getElementById('measureDistanceBtn');
        const areaBtn = document.getElementById('measureAreaBtn');
        
        if (distanceBtn) {
            distanceBtn.addEventListener('click', function() {
                startMeasureDistance();
            });
        }
        
        if (areaBtn) {
            areaBtn.addEventListener('click', function() {
                startMeasureArea();
            });
        }
    }

    // 绑定地图类型切换按钮事件
    function bindMapTypeEvent() {
        const mapTypeBtn = document.getElementById('mapTypeBtn');
        
        if (mapTypeBtn) {
            mapTypeBtn.addEventListener('click', function() {
                toggleMapType();
            });
        }
    }

    // 切换地图类型
    function toggleMapType() {
        if (!map) {
            alert('地图未初始化');
            return;
        }
        
        // 切换地图类型
        if (currentMapType === 'satellite') {
            // 切换到街道地图
            map.setMapType(TMAP_NORMAL_MAP);
            currentMapType = 'street';
            updateMapTypeButton('街道图');
        } else {
            // 切换到卫星地图
            map.setMapType(TMAP_SATELLITE_MAP);
            currentMapType = 'satellite';
            updateMapTypeButton('卫星图');
        }
    }

    // 更新地图类型按钮显示
    function updateMapTypeButton(typeName) {
        const mapTypeBtn = document.getElementById('mapTypeBtn');
        if (mapTypeBtn) {
            mapTypeBtn.innerHTML = `<span>${typeName}</span>`;
            mapTypeBtn.title = `当前：${typeName}，点击切换`;
        }
    }

    // 开始测距
    function startMeasureDistance() {
        if (!map) {
            alert('地图未初始化');
            return;
        }
        
        // 先移除所有可能存在的事件监听器
        try {
            map.removeEventListener('click', handleMapClick);
            map.removeEventListener('click', handleAreaMapClick);
            map.removeEventListener('mousemove', handleMouseMove);
            map.removeEventListener('mousemove', handleAreaMouseMove);
            map.removeEventListener('dblclick', finishMeasure);
            map.removeEventListener('dblclick', finishAreaMeasure);
        } catch(e) {
            console.log('移除事件监听器时出错:', e);
        }
        
        // 重置测量状态
        clearMeasureResult();
        
        // 设置测量状态为激活
        measureState.isActive = true;
        measureState.mode = 'distance'; // 设置为距离测量模式
        
        // 禁用其他按钮
        disableButtons(true);
        
        // 添加地图点击事件监听器
        map.addEventListener('click', handleMapClick);
        
        // 添加鼠标移动事件监听器
        map.addEventListener('mousemove', handleMouseMove);
        
        // 添加双击事件监听器结束测量
        map.addEventListener('dblclick', finishMeasure);
        
        console.log('测距功能已启动');
    }

    // 开始测面
    function startMeasureArea() {
        if (!map) {
            alert('地图未初始化');
            return;
        }
        
        // 先移除所有可能存在的事件监听器
        try {
            map.removeEventListener('click', handleMapClick);
            map.removeEventListener('click', handleAreaMapClick);
            map.removeEventListener('mousemove', handleMouseMove);
            map.removeEventListener('mousemove', handleAreaMouseMove);
            map.removeEventListener('dblclick', finishMeasure);
            map.removeEventListener('dblclick', finishAreaMeasure);
        } catch(e) {
            console.log('移除事件监听器时出错:', e);
        }
        
        // 重置测量状态
        clearMeasureResult();
        
        // 设置测量状态为激活
        measureState.isActive = true;
        measureState.mode = 'area'; // 设置为面积测量模式
        
        // 禁用其他按钮
        disableButtons(true);
        
        // 添加地图点击事件监听器
        map.addEventListener('click', handleAreaMapClick);
        
        // 添加鼠标移动事件监听器
        map.addEventListener('mousemove', handleAreaMouseMove);
        
        // 添加双击事件监听器结束测量
        map.addEventListener('dblclick', finishAreaMeasure);
        
        console.log('测面功能已启动');
    }

    // 处理地图点击事件
    function handleMapClick(event) {
        if (!measureState.isActive || measureState.mode !== 'distance') return;
        
        const point = event.lnglat;
        measureState.points.push(point);
        
        // 创建小圆点图标
        const smallDotIcon = new T.Icon({
            iconUrl: 'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="8" height="8"><circle cx="4" cy="4" r="3" fill="%23FF0000" stroke="%23FFFFFF" stroke-width="1"/></svg>',
            iconSize: new T.Point(8, 8),
            iconAnchor: new T.Point(4, 4)
        });
        
        // 创建点标记
        const marker = new T.Marker(point, {icon: smallDotIcon});
        map.addOverLay(marker);
        measureState.markers.push(marker);
        
        // 如果不是第一个点，创建线段
        if (measureState.points.length > 1) {
            const prevPoint = measureState.points[measureState.points.length - 2];
            const line = new T.Polyline([prevPoint, point], {
                color: '#FF0000',
                weight: 3,
                opacity: 0.8
            });
            map.addOverLay(line);
            measureState.lines.push(line);
            
            // 计算距离并显示标签
            const distance = calculateDistance(prevPoint, point);
            showDistanceLabel(point, distance);
        }
        
        // 移除临时线
        if (measureState.tempLine) {
            map.removeOverLay(measureState.tempLine);
            measureState.tempLine = null;
        }
    }

    // 处理测面地图点击事件
    function handleAreaMapClick(event) {
        if (!measureState.isActive || measureState.mode !== 'area') return;
        
        const point = event.lnglat;
        measureState.points.push(point);
        
        // 创建小圆点图标（与测距功能一致）
        const smallDotIcon = new T.Icon({
            iconUrl: 'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="8" height="8"><circle cx="4" cy="4" r="3" fill="%23FF0000" stroke="%23FFFFFF" stroke-width="1"/></svg>',
            iconSize: new T.Point(8, 8),
            iconAnchor: new T.Point(4, 4)
        });
        
        // 创建点标记
        const marker = new T.Marker(point, {icon: smallDotIcon});
        map.addOverLay(marker);
        measureState.markers.push(marker);
        
        // 移除之前的多边形
        if (measureState.polygon) {
            map.removeOverLay(measureState.polygon);
        }
        
        // 如果点数大于2，创建多边形
        if (measureState.points.length >= 3) {
            const polygon = new T.Polygon(measureState.points, {
                color: currentOutlineColor,
                weight: 3,
                opacity: 0.8,
                fillColor: currentFillColor,
                fillOpacity: currentFillOpacity
            });
            map.addOverLay(polygon);
            measureState.polygon = polygon;
            
            // 计算面积并显示标签
            const area = calculatePolygonArea(measureState.points);
            showAreaLabel(getPolygonCenter(measureState.points), area);
        }
        
        // 移除临时线
        if (measureState.tempLine) {
            map.removeOverLay(measureState.tempLine);
            measureState.tempLine = null;
        }
    }

    // 处理鼠标移动事件
    function handleMouseMove(event) {
        if (!measureState.isActive || measureState.mode !== 'distance' || measureState.points.length === 0) return;
        
        const lastPoint = measureState.points[measureState.points.length - 1];
        const currentPoint = event.lnglat;
        
        // 移除之前的临时线
        if (measureState.tempLine) {
            map.removeOverLay(measureState.tempLine);
        }
        
        // 创建新的临时线
        measureState.tempLine = new T.Polyline([lastPoint, currentPoint], {
            color: '#0000FF',
            weight: 2,
            opacity: 0.6,
            dashArray: [5, 5]
        });
        map.addOverLay(measureState.tempLine);
    }

    // 处理测面鼠标移动事件
    function handleAreaMouseMove(event) {
        if (!measureState.isActive || measureState.mode !== 'area' || measureState.points.length === 0) return;
        
        const firstPoint = measureState.points[0];
        const lastPoint = measureState.points[measureState.points.length - 1];
        const currentPoint = event.lnglat;
        
        // 移除之前的临时线
        if (measureState.tempLine) {
            map.removeOverLay(measureState.tempLine);
        }
        
        // 创建新的临时线（从最后一个点到当前点，再到第一个点形成闭合效果）
        const tempPoints = [lastPoint, currentPoint];
        if (measureState.points.length >= 2) {
            tempPoints.push(firstPoint);
        }
        
        measureState.tempLine = new T.Polyline(tempPoints, {
            color: '#0000FF',
            weight: 2,
            opacity: 0.6,
            dashArray: [5, 5]
        });
        map.addOverLay(measureState.tempLine);
    }

    // 结束测量
    function finishMeasure() {
        if (!measureState.isActive || measureState.mode !== 'distance') return;
        
        // 移除事件监听器
        map.removeEventListener('click', handleMapClick);
        map.removeEventListener('mousemove', handleMouseMove);
        map.removeEventListener('dblclick', finishMeasure);
        
        // 移除临时线
        if (measureState.tempLine) {
            map.removeOverLay(measureState.tempLine);
            measureState.tempLine = null;
        }
        
        // 显示总距离
        if (measureState.points.length > 1) {
            const totalDistance = calculateTotalDistance();
            showTotalDistanceLabel(totalDistance);
        }
        
        // 重置测量状态
        measureState.isActive = false;
        measureState.mode = '';
        
        // 恢复其他按钮
        disableButtons(false);
        
        console.log('测距功能已完成');
    }

    // 结束测面测量
    function finishAreaMeasure() {
        if (!measureState.isActive || measureState.mode !== 'area') return;
        
        // 移除事件监听器
        map.removeEventListener('click', handleAreaMapClick);
        map.removeEventListener('mousemove', handleAreaMouseMove);
        map.removeEventListener('dblclick', finishAreaMeasure);
        
        // 移除临时线
        if (measureState.tempLine) {
            map.removeOverLay(measureState.tempLine);
            measureState.tempLine = null;
        }
        
        // 如果点数大于等于3，创建最终多边形
        if (measureState.points.length >= 3) {
            // 移除之前的多边形
            if (measureState.polygon) {
                map.removeOverLay(measureState.polygon);
            }
            
            const polygon = new T.Polygon(measureState.points, {
                color: currentOutlineColor,
                weight: 3,
                opacity: 0.8,
                fillColor: currentFillColor,
                fillOpacity: currentFillOpacity
            });
            map.addOverLay(polygon);
            measureState.polygon = polygon;
            
            // 计算并显示总面积
            const area = calculatePolygonArea(measureState.points);
            showTotalAreaLabel(getPolygonCenter(measureState.points), area);
        } else {
            // 点数不足3个，移除所有标记
            clearMeasureResult();
        }
        
        // 重置测量状态
        measureState.isActive = false;
        measureState.mode = '';
        
        // 恢复其他按钮
        disableButtons(false);
        
        console.log('测面功能已完成');
    }

    // 计算两点间距离（米）
    function calculateDistance(point1, point2) {
        // 使用天地图提供的距离计算方法
        if (T.CRS && T.CRS.EPSG4326 && T.CRS.EPSG4326.distance) {
            return T.CRS.EPSG4326.distance(point1, point2);
        }
        
        // 如果没有提供，则使用球面距离公式
        const R = 6371000; // 地球半径（米）
        const dLat = (point2.lat - point1.lat) * Math.PI / 180;
        const dLon = (point2.lng - point1.lng) * Math.PI / 180;
        const a = 
            Math.sin(dLat/2) * Math.sin(dLat/2) +
            Math.cos(point1.lat * Math.PI / 180) * Math.cos(point2.lat * Math.PI / 180) * 
            Math.sin(dLon/2) * Math.sin(dLon/2);
        const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
        return R * c;
    }

    // 计算多边形面积（平方米）
    function calculatePolygonArea(points) {
        // 使用天地图提供的面积计算方法（如果可用）
        if (T.GeometryUtils && T.GeometryUtils.computeArea) {
            return T.GeometryUtils.computeArea(points);
        }
        
        // 如果没有提供，则使用球面多边形面积计算公式
        // 这里使用简单的平面近似计算，对于小面积比较准确
        if (points.length < 3) return 0;
        
        let area = 0;
        const n = points.length;
        
        for (let i = 0; i < n; i++) {
            const j = (i + 1) % n;
            area += points[i].lng * points[j].lat;
            area -= points[j].lng * points[i].lat;
        }
        
        area = Math.abs(area) / 2.0;
        
        // 转换为平方米（这是一个简化的近似值）
        // 更精确的计算需要考虑地球曲率
        const earthRadius = 6371000; // 地球半径（米）
        const degreeToMeter = (2 * Math.PI * earthRadius) / 360; // 每度对应的米数
        
        // 这个转换只是一个粗略的近似
        return area * degreeToMeter * degreeToMeter;
    }

    // 获取多边形中心点
    function getPolygonCenter(points) {
        if (points.length === 0) return null;
        
        let x = 0, y = 0;
        for (let i = 0; i < points.length; i++) {
            x += points[i].lng;
            y += points[i].lat;
        }
        
        return new T.LngLat(x / points.length, y / points.length);
    }

    // 计算总距离
    function calculateTotalDistance() {
        let total = 0;
        for (let i = 1; i < measureState.points.length; i++) {
            const distance = calculateDistance(measureState.points[i-1], measureState.points[i]);
            total += distance;
        }
        return total;
    }

    // 显示两点间距离标签
    function showDistanceLabel(point, distance) {
        const label = document.createElement('div');
        label.className = 'distance-label';
        label.innerHTML = distance.toFixed(2) + ' 米';
        label.style.position = 'absolute';
        label.style.backgroundColor = 'rgba(255, 255, 255, 0.9)';
        label.style.padding = '2px 6px';
        label.style.borderRadius = '3px';
        label.style.fontSize = '12px';
        label.style.boxShadow = '0 1px 2px rgba(0,0,0,0.3)';
        label.style.zIndex = '1000';
        label.style.transform = 'translate(-50%, -50%)';
        
        // 添加删除按钮
        const closeBtn = document.createElement('span');
        closeBtn.innerHTML = '×';
        closeBtn.style.marginLeft = '5px';
        closeBtn.style.cursor = 'pointer';
        closeBtn.style.fontWeight = 'bold';
        closeBtn.onclick = function() {
            if (label.parentNode) {
                label.parentNode.removeChild(label);
            }
        };
        label.appendChild(closeBtn);
        
        document.getElementById('mapContainer').appendChild(label);
        
        // 定位标签（向上偏移20像素）
        const pixel = map.lngLatToContainerPoint(point);
        label.style.left = pixel.x + 'px';
        label.style.top = (pixel.y - 20) + 'px';
        
        measureState.labels.push(label);
    }

    // 显示面积标签
    function showAreaLabel(point, area) {
        // 如果已存在面积标签，先移除它
        if (measureState.areaLabel) {
            if (measureState.areaLabel.parentNode) {
                measureState.areaLabel.parentNode.removeChild(measureState.areaLabel);
            }
        }
        
        const label = document.createElement('div');
        label.className = 'area-label';
        label.innerHTML = area.toFixed(2) + ' 平方米';
        label.style.position = 'absolute';
        label.style.backgroundColor = 'rgba(255, 255, 255, 0.9)';
        label.style.padding = '2px 6px';
        label.style.borderRadius = '3px';
        label.style.fontSize = '12px';
        label.style.boxShadow = '0 1px 2px rgba(0,0,0,0.3)';
        label.style.zIndex = '1000';
        label.style.transform = 'translate(-50%, -50%)';
        
        // 添加删除按钮
        const closeBtn = document.createElement('span');
        closeBtn.innerHTML = '×';
        closeBtn.style.marginLeft = '5px';
        closeBtn.style.cursor = 'pointer';
        closeBtn.style.fontWeight = 'bold';
        closeBtn.onclick = function() {
            if (label.parentNode) {
                label.parentNode.removeChild(label);
            }
        };
        label.appendChild(closeBtn);
        
        document.getElementById('mapContainer').appendChild(label);
        
        // 定位标签
        const pixel = map.lngLatToContainerPoint(point);
        label.style.left = pixel.x + 'px';
        label.style.top = (pixel.y - 20) + 'px';
        
        measureState.areaLabel = label;
        measureState.labels.push(label);
    }

    // 显示总面积标签
    function showTotalAreaLabel(point, area) {
        // 如果已存在面积标签，先移除它
        if (measureState.areaLabel) {
            if (measureState.areaLabel.parentNode) {
                measureState.areaLabel.parentNode.removeChild(measureState.areaLabel);
            }
        }
        
        // 计算亩数（1亩 ≈ 666.6667平方米）
        const areaInMu = area / 666.6667;
        
        const label = document.createElement('div');
        label.className = 'total-area-label';
        label.innerHTML = '总面积: ' + area.toFixed(2) + ' 平方米<br>' + areaInMu.toFixed(2) + ' 亩';
        label.style.position = 'absolute';
        label.style.backgroundColor = 'rgba(0, 0, 0, 0.7)';
        label.style.color = 'white';
        label.style.padding = '4px 8px';
        label.style.borderRadius = '4px';
        label.style.fontSize = '14px';
        label.style.fontWeight = 'bold';
        label.style.boxShadow = '0 2px 4px rgba(0,0,0,0.3)';
        label.style.zIndex = '1000';
        label.style.transform = 'translate(-50%, -50%)';
        label.style.lineHeight = '1.4';
        
        // 添加删除按钮
        const closeBtn = document.createElement('span');
        closeBtn.innerHTML = ' ×';
        closeBtn.style.cursor = 'pointer';
        closeBtn.style.fontWeight = 'bold';
        closeBtn.onclick = function() {
            if (label.parentNode) {
                label.parentNode.removeChild(label);
            }
        };
        label.appendChild(closeBtn);
        
        document.getElementById('mapContainer').appendChild(label);
        
        // 定位标签
        const pixel = map.lngLatToContainerPoint(point);
        label.style.left = pixel.x + 'px';
        label.style.top = (pixel.y - 40) + 'px';
        
        measureState.areaLabel = label;
        measureState.labels.push(label);
    }

    // 显示总距离标签
    function showTotalDistanceLabel(totalDistance) {
        const lastPoint = measureState.points[measureState.points.length - 1];
        const label = document.createElement('div');
        label.className = 'total-distance-label';
        label.innerHTML = '总距离: ' + totalDistance.toFixed(2) + ' 米';
        label.style.position = 'absolute';
        label.style.backgroundColor = 'rgba(0, 0, 0, 0.7)';
        label.style.color = 'white';
        label.style.padding = '4px 8px';
        label.style.borderRadius = '4px';
        label.style.fontSize = '14px';
        label.style.fontWeight = 'bold';
        label.style.boxShadow = '0 2px 4px rgba(0,0,0,0.3)';
        label.style.zIndex = '1000';
        label.style.transform = 'translate(-50%, -50%)';
        
        // 添加删除按钮
        const closeBtn = document.createElement('span');
        closeBtn.innerHTML = ' ×';
        closeBtn.style.cursor = 'pointer';
        closeBtn.style.fontWeight = 'bold';
        closeBtn.onclick = function() {
            if (label.parentNode) {
                label.parentNode.removeChild(label);
            }
        };
        label.appendChild(closeBtn);
        
        document.getElementById('mapContainer').appendChild(label);
        
        // 定位标签（向上偏移40像素，比段距离标签更高）
        const pixel = map.lngLatToContainerPoint(lastPoint);
        label.style.left = pixel.x + 'px';
        label.style.top = (pixel.y - 60) + 'px';  // 从-40改为-60，增加间距
        
        measureState.labels.push(label);
    }

    // 清除测量结果
    function clearMeasureResult() {
        // 移除所有线条
        measureState.lines.forEach(line => {
            if (map && map.removeOverLay) {
                try { map.removeOverLay(line); } catch(e) {}
            }
        });
        
        // 移除所有标记
        measureState.markers.forEach(marker => {
            if (map && map.removeOverLay) {
                try { map.removeOverLay(marker); } catch(e) {}
            }
        });
        
        // 移除所有标签
        measureState.labels.forEach(label => {
            if (label.parentNode) {
                try { label.parentNode.removeChild(label); } catch(e) {}
            }
        });
        
        // 移除临时线
        if (measureState.tempLine) {
            if (map && map.removeOverLay) {
                try { map.removeOverLay(measureState.tempLine); } catch(e) {}
            }
            measureState.tempLine = null;
        }
        
        // 移除多边形
        if (measureState.polygon) {
            if (map && map.removeOverLay) {
                try { map.removeOverLay(measureState.polygon); } catch(e) {}
            }
            measureState.polygon = null;
        }
        
        // 移除面积标签
        if (measureState.areaLabel) {
            if (measureState.areaLabel.parentNode) {
                try { measureState.areaLabel.parentNode.removeChild(measureState.areaLabel); } catch(e) {}
            }
            measureState.areaLabel = null;
        }
        
        // 重置状态
        measureState.points = [];
        measureState.lines = [];
        measureState.markers = [];
        measureState.labels = [];
        measureState.isActive = false;
        measureState.mode = '';
    }

    // 添加CSS样式用于距离标签
    const style = document.createElement('style');
    style.innerHTML = `
        .distance-label, .total-distance-label {
            font-family: Arial, sans-serif;
            pointer-events: auto;
        }
    `;
    document.head.appendChild(style);

    // 颜色选择器相关变量和函数
    let currentOutlineColor = "#FFD700"; // 默认边框颜色
    let currentFillColor = "#FFFF00";   // 默认填充颜色
    let currentFillOpacity = 0.35;       // 默认透明度
    
    // 轨迹颜色相关变量
    let currentTrackLineColor = "#FF0000"; // 默认轨迹线颜色
    let currentTrackPointColor = "#68EAF3"; // 默认轨迹点颜色

    // 初始化颜色选择器
    function initColorPickers() {
        // 边框颜色选择器
        const outlineColorPicker = document.getElementById('outlineColorPicker');
        const outlineColorInput = document.getElementById('outlineColorInput');
        
        outlineColorPicker.addEventListener('click', function() {
            outlineColorInput.click();
        });
        
        outlineColorInput.addEventListener('change', function() {
            currentOutlineColor = this.value;
            outlineColorPicker.style.backgroundColor = currentOutlineColor;
        });
        
        // 填充颜色选择器
        const fillColorPicker = document.getElementById('fillColorPicker');
        const fillColorInput = document.getElementById('fillColorInput');
        
        fillColorPicker.addEventListener('click', function() {
            fillColorInput.click();
        });
        
        fillColorInput.addEventListener('change', function() {
            currentFillColor = this.value;
            fillColorPicker.style.backgroundColor = currentFillColor;
        });
        
        // 透明度滑块
        const fillOpacitySlider = document.getElementById('fillOpacitySlider');
        const fillOpacityValue = document.getElementById('fillOpacityValue');
        
        fillOpacitySlider.addEventListener('input', function() {
            currentFillOpacity = this.value / 100;
            fillOpacityValue.textContent = this.value + '%';
        });
        
        // 轨迹线颜色选择器
        const trackLineColorPicker = document.getElementById('trackLineColorPicker');
        const trackLineColorInput = document.getElementById('trackLineColorInput');
        
        if (trackLineColorPicker && trackLineColorInput) {
            trackLineColorPicker.addEventListener('click', function() {
                trackLineColorInput.click();
            });
            
            trackLineColorInput.addEventListener('change', function() {
                currentTrackLineColor = this.value;
                trackLineColorPicker.style.backgroundColor = currentTrackLineColor;
            });
        }
        
        // 轨迹点颜色选择器
        const trackPointColorPicker = document.getElementById('trackPointColorPicker');
        const trackPointColorInput = document.getElementById('trackPointColorInput');
        
        if (trackPointColorPicker && trackPointColorInput) {
            // 设置初始背景色
            trackPointColorPicker.style.backgroundColor = currentTrackPointColor;
            
            trackPointColorPicker.addEventListener('click', function() {
                trackPointColorInput.click();
            });
            
            trackPointColorInput.addEventListener('change', function() {
                currentTrackPointColor = this.value;
                trackPointColorPicker.style.backgroundColor = currentTrackPointColor;
            });
        }
    }

</script>
</body>

</html>
